[
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Reconstruction of Entry, Descent, and Landing Communications for the InSight Mars Lander",
        "url": "https://arc.aiaa.org/doi/10.2514/1.A34892",
        "date": "20210921",
        "content": "AbstractThe Interior Exploration Using Seismic Investigations, Geodesy and Heat Transport (InSight) spacecraft landed successfully on 26 November 2018 to conduct an exploration of the interior of Mars. To meet NASA’s requirement for communications during critical events, the InSight lander transmitted telemetry continuously throughout entry, descent, and landing. This allowed the public to witness the landing in real time. The transmissions were received by five assets: three at Mars and two on Earth. These included real-time relay of telemetry by the first deep-space CubeSats. This paper describes the constraints on the design of an entry, design, and landing communication link; the uncertainties in the trajectory; and the modeling that was used to meet these constraints. It then reports on the actual performance of each link, including an unexpected degradation of signal to the Mars Reconnaissance Orbiter. The lessons learned from this process contributed to the successful relay of data from the Perseverance lander, as well as to the design of future landing communications systems.I. IntroductionThe Interior Exploration Using Seismic Investigations, Geodesy and Heat Transport (InSight) spacecraft was launched on 5 May 2018 and landed on 26 November 2018 at Elysium Planitia on Mars. Since the lander was unguided during landing, the landing ellipse was large: approximately 90 by 20 km. The landing site chosen is a broad, flat plain to minimize the chances of a hazardous landing. One consequence of this strategy was that the entry, descent, and landing (EDL) communications strategy had to accommodate a broad range of possible trajectories.The objective of the InSight mission was to study the interior of Mars. This included reconstructing the interior structure of Mars, measuring the size of a possible liquid core, and measuring the heat flow from the interior of the planet. This was to be achieved by three experiments. First, an extremely sensitive seismometer was deployed to the surface to measure seismic waves, including waves caused by “Marsquakes” and meteorite impacts. Second, the instrument complement also included a heat flow probe experiment, nicknamed the Mole. The Mole was expected to penetrate 3–5 m into the Martian regolith. Due to unexpected characteristics of the regolith, the Mole was unable to penetrate more than a few centimeters into the surface, and the experiment was eventually abandoned. The third experiment is a radio science investigation, using the lander’s X-band transponder to receive and retransmit a coherent signal from Earth. Collection and analysis of these data are still ongoing.This paper provides background on the process of planning the EDL communications, the communications performance during EDL, and analysis of the results. It is intended to record this information for use with future landers.The InSight spacecraft entered the Martian atmosphere at 19:33:42 Coordinated Universal Time (UTC), 26 November 2018, and landed 348 s later. NASA and Jet Propulsion Laboratory (JPL) design policies require that spacecraft return telemetry to Earth during hazardous mission-critical activities (such as orbit insertion or landing). If a failure occurs during the activity, this telemetry would allow for analysis of the failure.Where telemetry is captured by other spacecraft at Mars, and relayed back to Earth, real-time (or “bent pipe”) data return is not required. However, real-time telemetry allows the spacecraft operators, and the general public, to participate in the “6 min of terror.” To fulfill this requirement for InSight, NASA launched the first two deep-space CubeSats, Mars Cube One (MarCO)-A and -B, on the same launch vehicle as InSight. These spacecraft returned EDL data to Earth in real time.During EDL, InSight transmitted engineering telemetry at 8000  bits/s in the ultrahigh-frequency (UHF) band at a frequency of 401.584625 MHz.This transmission was received by five assets: The first asset is the Mars Reconnaissance Orbiter (MRO), which captured an open-loop recording in a frequency band roughly centered about the UHF signal. This recording was later transmitted to Earth, where the telemetry bits were demodulated. This open-loop recording preserves information about signal strength, frequency content, and Doppler. If a failure had occurred, this information would have been invaluable for understanding any spacecraft dynamics (such as tumbling, or a significant attitude rate or orientation error.)The MRO open-loop recording was successful, and it captured InSight data from the start of telemetry transmission until the UHF radio transmitter was turned off at landing plus 5 min. There was one anomaly: an unexpected dropoff in signal before the plasma outage. Investigation is ongoing.The second and third assets are the Mars Cube One (MarCO-A and -B, nicknamed “Wall-E” and “Eva”) spacecraft, which were the first CubeSats to fly beyond lunar orbit. They were deployed from the InSight launch vehicle and “flew formation” with InSight on the way to Mars. These CubeSats returned the InSight EDL data to Earth in real time, allowing ground operators to observe the landing “live.” These data included the first image returned from the InSight lander in Elysium Planitia.Two 100-m-class Earth-based radio telescopes located in Green Bank, West Virginia and Effelsberg, Germany were also used to provide real-time monitoring of the carrier signal component of the InSight transmission. Although the received signal strengths are too low to demodulate the InSight digital telemetry, these telescopes were able to measure the InSight signal strength and Doppler during EDL. This allowed analysts to make real-time assessments of particular events during EDL (start of atmospheric deceleration; parachute deployment; lander separation from the backshell; and touchdown). Had the MarCOs been unable to return telemetry, these telescopes would have provided the only real-time monitoring during EDL. They also provided additional signal strength and Doppler information, with a geometry different from the MarCO and MRO perspectives.As expected, all five assets detected a degradation or loss of InSight signal due to plasma formation, starting about 50 s after atmosphere entry and lasting ∼56  s, which was around the time of peak atmospheric heating. Subsequent analysis of this outage showed that it is consistent with models of the Mars atmosphere and aerothermal models of the InSight interaction with the atmosphere at hypersonic speeds during this period.Before arrival at Mars, a set of models was developed to predict the InSight link performance to each asset, as well as to evaluate the trajectories of the MRO and the MarCO CubeSats to optimize the link performance. This analysis leveraged the EDL Monte Carlo simulations that were run to evaluate the planned EDL trajectories. These Monte Carlo runs were also used to optimize the MRO slewing for a High Resolution Imaging Science Experiment (known as HiRISE) instrument image of InSight during descent on the parachute. Unfortunately, this effort was unsuccessful due to a faster than expected descent trajectory [1], as well as due to the adverse lighting conditions.II. Critical Coverage PhilosophyA number of previous Mars missions have experienced mission failures during critical activities, without real-time telemetry. These include the Mars Observer (no X-band transmission during propellant pressurization, due to pyroshock concerns), the Mars Polar Lander (no X-band transmission and no UHF relay during EDL), and the ESA Beagle 2 mission. Since there was no telemetry during the critical activities, the process of failure analysis was much more complicated.As a result of these experiences, the JPL imposes a design principle that every mission must transmit and capture engineering telemetry during critical activities that may result in mission failure. This telemetry is required to be sufficient to diagnose a mission-critical failure, if any occurs. This critical coverage principle also places constraints on the Earth–Mars geometry during any critical activity, as well as the geometry between the incoming spacecraft and any relay spacecraft.III. EDL Mission Planning Constraints and DesignA more detailed description of the EDL mission planning process can be found in Ref. [2].The nature of EDL puts a set of constraints on the approach trajectory, due to requirements on the acceptable entry flight-path angle and velocity. EDL communications add another set of constraints. To support UHF direct to Earth (DTE) at the radio telescopes, the Earth must be above 10 deg elevation from the planned landing site until 1 min after landing. Fortuitously, the landing site was visible from Earth for a significant time after landing, and so an X-band (8.4 GHz) carrier-only “beep” was added from landing plus 7 min to landing plus 12 min. The selection of the center frequency, or a slight offset in the carrier frequency, also signaled whether the lander had detected and responded to any faults. (Fortunately, no faults were detected.)The landing site must also be visible from the MRO trajectory from atmosphere entry to landing plus 1 min; there was a desire to maintain MRO contact until UHF turn-off landing at landing plus 5 min, but this could not be guaranteed. (The MRO open-loop recording continued until after UHF turn-off.) The MarCO trajectories had to be chosen so that the spacecraft could maintain high-gain antenna pointing at Earth while optimizing InSight in the relay antenna beamwidth throughout the EDL flyby.As part of the EDL design process, a team from NASA Langley Research Center ran Monte Carlo simulations for each EDL design [3]. These simulations varied parameters including entry flight-path angle, velocity, and atmosphere characteristics. The EDL communications process leveraged these Monte Carlo simulations, augmenting them with models of the InSight transmitter system and the receiver systems at each asset. This design process evaluated the relay link margin, as well as geometric constraints, across the range of Monte Carlo parameters.Figure 1 shows a scorecard for the InSight–MRO link. [This particular scorecard was used to support a decision to update (or not update) onboard EDL parameters.] In the plot in Fig. 1, the horizontal axis represents the time (in seconds) relative to atmosphere entry (with 0 set at entry of 600 s). The vertical axis represents the strength of the transmitted InSight UHF signal at the input to the MRO receiver. The red dotted line at ∼−127 decibel-milliwatts (dBm), a measure of received radio power represents the threshold to demodulate telemetry from the MRO open-loop recording. The dotted line at −140  dBm represents the threshold to detect the carrier from the MRO open-loop recording.This simulated signal strength includes the effects of the InSight transmitted signal, the location of the MRO in the InSight antenna gain pattern, the location of InSight in the MRO antenna gain pattern, polarization losses, and other effects. The red line on the plot represents the median signal strength at each point in time. The blue line represents the 99-percentile upper limit on signal strength (99% of Monte Carlo runs below this point); the gold line represents the 1-percentile lower limit. The purple line represents a “beard” subtracted from the signal strength to allow for variations in telecommunications performance. (The beard was 5.6 dB for the backshell wraparound antenna used until lander separation from the backshell, and it was 3.6 dB for the helix antenna used after lander separation. The Monte Carlo simulation varied only EDL parameters, and not telecommunications parameters.)Fig. 1 Monte Carlo scorecard for InSight–MRO EDL link (TD = Touchdown on Mars Surface; PD = start of Powered Descent; EDL = EDL Parameter Update, a decision to update parameters before atmospheric entry; Elv = elevation angle; LOS = Loss of Signal; S/C = Spacecraft; MAD = Madrid Deep Space Network Station; C/No = Carrier/Noise Ratio; AOS = Acquisition of Signal; dBi = antenna gain, in decibels, compared to an istotropic antenna; El = Elevation; Az = Azimuth; LS = Loss of Signal).For these signal strength plots, the beard was above the demodulation threshold from entry through landing plus 5 min.The tables in Fig. 1 represent a set of geometric constraints on the InSight–MRO link. The link must be above the threshold from the entry interface to landing plus 1 min. The MRO must be visible from the InSight landing site (elevation greater than 10 deg) until landing plus 1 min. It was desired that the MRO be visible until landing plus 5 min, but this could not be guaranteed.This Monte Carlo analysis was used to optimize the MRO timing (phasing) in its orbit. A similar set of tables was developed for the MarCO CubeSats, and it was used to optimize the MarCO trajectories and timing. Further details can be found in Ref. [3].A similar set of tables was also developed for the Green Bank and Effelsberg radio telescopes. Although this geometry could not be optimized, these tables set expectations for the UHF DTE performance.These tables were also used to evaluate the percentage of cases where InSight was imaged by the MRO HiRISE instrument, i.e., cases where InSight was in the HiRISE field of view (FOV) during the time HiRISE was commanded to collect image data. In the example case, InSight would be imaged in approximately 25% of the cases.The HiRISE instrument is a push-broom imager, and so the field of view is scanned across the predicted InSight path. Due to thermal constraints, the HiRISE could only image for a limited time; this time was a function of the selected scan rate, which ideally would match the rate that InSight crossed the FOV. Figure 2 shows a scatterplot of InSight angular rates and times when InSight is predicted to be in the HiRISE FOV. These plots were used to optimize the MRO slew for the HiRISE image and the timing of the HiRISE image.Fig. 2 Monte Carlo plots of InSight HiRISE visibility.IV. EDL Communications TimelineFigure 3 illustrates the InSight configuration during EDL, until backshell separation. The heat shield is at the bottom of the diagram; from atmosphere entry until chute deploy, InSight travels with the heat shield essentially pointed in the velocity direction. The UHF wraparound antenna (WPA) is the silver cone at the top of the backshell; the top of the cone points primarily in the antivelocity direction. The angle down from the peak of the backshell cone is the antenna cone angle θant. The dashed red curve bisecting the patch antenna is added for illustration and represents the approximate “launch point” of the signal used in various analyses.Figure 4 illustrates the geometry of InSight and the five assets that received EDL communications. For each line, the dot represents the position at atmosphere entry; the end of the arrow represents the location at the predicted InSight landing. The dotted blue line represents the line where Earth is at 0 deg elevation at atmosphere entry. This represents the constraint on Earth visibility.Fig. 3 InSight backshell and wraparound antenna.At atmosphere entry, the Earth was at a 20 deg cone angle on the UHF wraparound antenna. MarCO-A was at 68 deg, and MarCO-B was 53 deg. MRO was at 123 deg.Fig. 4 Geometry for InSight EDL communication assets.In the MRO phasing process, 135 deg was used as the limit on the InSight–MRO cone angle. Beyond this limit, the MRO is looking through the backshell or heat shield, with essentially no antenna gain. This constraint was satisfied, but there was some unexpected signal loss during EDL. See MRO Telemetry Performance section (Sec. VII.B) for a discussion of antenna modeling at high cone angles.Figure 5 illustrates the EDL communication assets and what information is available at each phase of EDL. The as-flown EDL communication timeline is shown in Table 1. The Madrid Deep Space Network (DSN) Station (DSS-63) receives X-band telemetry until cruise stage separation at entry minus 7 min. InSight then transmits the UHF carrier for only 5 min, using the WPA, and begins transmitting 8000  bits/s telemetry at entry minus 2 min. At chute deploy, the UHF transmission is suspended for 1 s (“standby”). A carrier-only signal is transmitted for 1 s to allow receivers to reacquire the signal; then 8000  bits/s telemetry is resumed. The carrier signal strength increases by 6 dB when only the carrier is selected; then, it drops 6 dB when telemetry is resumed. This provides a clear signature in the received signals and enhances MarCO reacquisition of the signal if it is lost due to parachute deployment dynamics.The MRO HiRISE instrument attempted to acquire an image of InSight on the parachute during this time.Fig. 5 EDL communication assets and timeline.At lander separation, this process is repeated; and UHF transmission is switched to the lander helix antenna.At 10 s after lander touchdown, the standby/carrier/telemetry process is repeated for the last time. This delay allows observation of any touchdown dynamics.At 2 min after landing, an image context camera image was commanded and the results transmitted. The full image was received by the MarCOs and displayed in real time. The UHF radio was turned off at landing plus 5 min.At landing plus 7 min, the X-band transmitter was turned on to transmit a 5 min beep (carrier only); this signal was detected by the Madrid DSN station. This confirmed that the lander condition was nominal. If a fault response had been triggered, the X-band beep signature would have included a 25 kHz subcarrier and employed different timing.The first Odyssey surface relay overflight occurred ∼4  h after landing. This overflight confirmed that the spacecraft was safe and stable, and that the solar arrays had successfully deployed.V. EDL Telemetry DesignThe EDL telemetry design is largely based on the Phoenix design. Phoenix also transmitted at 8000  bits/s but switched to 32,000  bits/s before chute deploy. Early link analysis of the InSight process showed that the InSight–MRO link would not support a 32,000  bits/s rate, and so the decision was made to stay at 8000  bits/s throughout EDL. This required a redesign of the EDL telemetry. Later developments with the MarCO CubeSats showed that they would be unable to maintain a 32,000  bits/s downlink rate to Earth, and so this redesign maintained real-time telemetry throughout EDL.The Phoenix EDL design included carrier-only for 5 min, from cruise stage separation to entry minus 2 min. This carrier-only link configuration was retained for InSight. This allows the radio telescopes and MarCOs to lock on to a strong signal; there is no activity or dynamics during this time, and so it was considered safe to not transmit telemetry during this time.The EDL telemetry design retransmitted data after the expected plasma outage. Telemetry was also retransmitted after the chute deploy in case the signal was lost due to high deployment dynamics.Additional high-rate telemetry was collected and stored during EDL. This was played back a few days after landing and used for precise trajectory and attitude reconstruction.One interesting issue had to do with latency of real-time InSight data via MarCO. The MarCO downlink rate was the same as the InSight downlink rate, which meant that any downlink frame overhead, or MarCO engineering telemetry, ate into the downlink rate available for InSight data, resulting in growing latency of InSight data. In this case, the InSight telemetry would lag behind the signatures visible in the DTE signals. The MarCO team was able to reduce their engineering telemetry, thus reducing the InSight latency. In addition, the MarCO Iris radio was able to catch up with the InSight telemetry during the 56 s plasma outage, midway between telemetry start and landing, and so the latency at landing was not noticeable.VI. EDL Communications Rehearsal and TestingA. Spacecraft Telemetry TestingTesting of EDL telemetry transmission and reception was conducted on the InSight spacecraft as part of the EDL system verification tests during assembly, test, and launch operations (ATLOs) in January 2018. Since the MRO orbiter testbed (OTB) was colocated with InSight ATLOs at Lockheed Martin Space in Littleton, Colorado, the InSight UHF signal was transmitted to the MRO OTB via coaxial and fiber optics; open-loop recording was performed and processed to verify the open-processing software, and resulting data were loaded into the InSight Ground Data System (GDS).A MarCO engineering model was brought to the InSight ATLOs. EDL data were successfully collected, downlinked in real time, and displayed on InSight GDS screens. These data were also saved for later operations testing.B. UHF Direct-to-Earth (Radio Telescope) TestingDuring the summer of 2018, specialized signal recording receivers from the JPL were installed at the Green Bank and Effelsberg sites; and they were tested in conjunction with each radio telescope’s UHF front-end receivers using simulated signals.In addition, subsequent tests were planned at each antenna to monitor transmissions between the Opportunity and Curiosity rovers at Mars as well as the Odyssey orbiter and the MRO. The purposes of these tests were measurement and calibration of the spacecraft radios and the radio telescope antenna performance. Since the Opportunity rover uses the same type of UHF radio as InSight and operates at the same frequency and power level, these observations (along with a correction for range) would enable an accurate prediction of the signals that would be received from Mars on landing day. Unfortunately, after the initial test passes, Opportunity was disabled by a large dust storm, and no additional calibration attempts could be performed. As an alternative, we were able to schedule similar sets of tests observing Curiosity passes with the Odyssey spacecraft. Results from both radio telescope sites confirmed that the antenna and relay radio performance matched link analysis predictions. In addition to performing measurements of the Mars-to-Earth link, these tests were also used to practice operational communications and procedures, as well as to fully exercise real-time data flow from these ground stations to the JPL. The received signals from these tests were routed to the InSight mission support area for demonstration of the displays that would be used on landing day.C. Operational Readiness TestingThe EDL operators rehearsed the landing day operations in the JPL cruise mission support area using data recorded in earlier tests. Several different configurations were tested: The real-time data from MarCO was the actual configuration used on landing day.The second configuration was radio science (DTE) data only, in case MarCO data were not available or was of too high latency to use in real time. During one of the readiness tests, the radio science operators projected displays from the radio telescopes to demonstrate connectivity. To practice event timing, a laboratory-based signal was also used to simulate expected signal levels and Doppler frequency shifts in conjunction with a full-scale rehearsal.The third configuration was an EDL failure case, in which a simulated failure was injected, causing the mission to fail.In addition, InSight project personnel investigated the telemetry from four different simulated EDL failure cases to determine the cause of the failure. These cases included an indication that propulsion tank pressure is too low, failure of an interface bus, failure of the Inertial Measurement Unit interface, and radar resets. This analysis validated that the EDL telemetry content was sufficient to diagnose failures.VII. MarCO PerformanceA. Navigation PerformanceFigure 6 shows the B-plane targeting of MarCO-A and -B at InSight atmospheric entry. Since there were two MarCO spacecraft, one was targeted to the north of InSight and one to the south. The availability of two spacecraft provided spatial diversity to mitigate any antenna coverage dropouts; telemetry data would be available in almost any InSight orientation.Since MarCO-B had experienced a propellant plenum leak soon after launch, and was considered the less reliable of the two, it was targeted toward the southern position with marginally worse performance. Final navigation for MarCO-A [2] showed that it was 320 km away from its flyby B-plane target and 1 min early in arrival time. MarCO-B was 110 km away from its B-plane target and 4 s early in arrival. Since the MarCO–InSight ranges are on the order of 2000–2500 km and the MarCO UHF relay antennas have a broad beamwidth, these errors did not significantly affect the EDL relay.Fig. 6 MarCO targeting.B. MarCO Relay PerformanceFigure 7 shows the MarCO-A and -B carrier signal strengths throughout EDL. There are some signal dynamics at the time of chute deploy (19:42:33) but no obvious signature when the UHF signal is interrupted. This may be due to the sampling frequency for MarCO telemetry.Both MarCOs relayed telemetry throughout EDL, with the exception of planned interruptions and the plasma outage. Interestingly, MarCO-B had a much shorter but deeper plasma outage, with approximately 7 s of telemetry data lost.Fig. 7 MarCO-A and -B carrier strengths.Following the landing, Both MarCOs returned the InSight instrument context camera (ICC) image (Fig. 8) of the landing site. Since the image was taken 3 min before the UHF radio was turned off, there had been some question before EDL as to whether the entire image would be transmitted in time. In testing, the test image usually cut off at ∼90% complete. These images are Joint Photographic Experts Group (JPEG) compressed. Since the landing site image had relatively low contrast, it compressed fairly well; and the entire image was returned before EDL communication ended.Fig. 8 First ICC image of InSight landing site.VIII. MRO PerformanceA. MRO Navigation PerformanceAs shown in Ref. [4], the MRO was 8.4 s south of the targeted position at InSight atmosphere entry. This was well within the 30 s specification.B. MRO Telemetry PerformanceFigure 9 shows the carrier peak power-to-noise ratio, extracted from the MRO open-loop recording. The start of 8 k telemetry (6 dB drop in carrier power), chute deploy, plasma outage, lander separation, and landing signal can be clearly seen. This plot also shows the cone angle (theta, in blue) and clock angle (phi, in gold) of the direction to the MRO in InSight WPA coordinates.One anomaly can be seen in the MRO signal strength plot. The signal strength starts to decrease at about 19:37:53, 67 s before entry, and continues dropping until 19:39:09; then, it recovers. The plasma outage begins at 19:39:54, which is consistent with the other assets. This signal dropoff is not explained by the current models of the InSight WPA pattern. Investigation of this anomaly was led by the Lockheed Martin telecommunications team.Fig. 9 MRO carrier peak power-to-noise ratio.The Insight telecommunication team’s investigation focused primarily on potential errors in the radio frequency link analysis model used to predict the received signal strength at the MRO. Because the MRO was the only asset of the five receiving assets that experienced a drop in signal strength outside the plasma outage, the team focused on geometry-dependent parameters, which implicated the EDL antenna gain pattern. One potential explanation is that the MRO look angle passed through a null in the EDL antenna gain pattern. The cone angle (theta) relative to the antivelocity vector during the signal degradation was between 122 and 127 deg, which is in a region of the antenna pattern that is difficult to model and measure; so, the team reviewed the antenna pattern characterization process to verify the modeled EDL antenna pattern used in the link analysis was valid. As shown in Fig. 10, the EDL antenna radiation pattern was characterized in the tapered chamber at Lockheed Martin while installed on the parachute cone and covered with a layer of the thermal protection system.Shown in Fig. 3, the flight configuration includes the parachute cone, the backshell, and the heat shield, which were too large to test in the antenna test facilities available. Therefore, a simulation was performed with the computer simulation technology frequency domain solver to characterize the effect of the backshell missing from the radiation pattern measurement. The resulting antenna pattern combining the measured data, and the simulated backshell effect is shown in Fig. 11.Fig. 10 InSight EDL antenna radiation pattern characterization configuration.In both the measured (parachute cone only) and measured-plus-simulated backshell effects’ antenna pattern, an asymmetry appears in the gain pattern, resulting in a −15  dBic (dbic is the decibel gain above a circularly polarized isotropic antenna. It represents the gain of a directional antenna in a parricular direction, compared to an isotropic antenna radiating in all directions) null located between ∼82  deg<θ<∼118  deg and ∼153  deg<ϕ<∼184  deg. Using the reconstructed flight trajectory and attitude, the team confirmed that the location (cone θ/clockϕ angle) of the null in the antenna pattern does not align with the geometry during the period of signal degradation. Link analysis was performed with the clock (phi=0) reference aligned with all four possible spacecraft axes (+Xm, −Xm, +Ym, and −Ym) to prove a coordinate frame error was not the issue and the null still could not explain the signal degradation. Figure 12 displays the antenna angles during the signal degradation (blue box) compared to the null location (red boxes). The antenna angles are labelled as NSYTXmitclock (clock) and NSYTxmitcone (cone).Fig. 11 EDL antenna measurement plus backshell simulation.Another signal degradation explanation under investigation is polarization loss between the InSight and MRO antennas resulting from using the EDL antenna at large cone angles. During the peak signal degradation, the InSight EDL cone and clock angles were (θ,ϕ)=(122  deg,290  deg), which is a portion of the antenna pattern that is predominately left-hand circularly polarized (LHCP) with an axial ratio of 15.6 dB [−14.6  dBiC right-hand circularly polarized (RHCP) and −11.7  dBic LHCP]. At this same point during EDL, the MRO antenna cone and clock angles were (θ,ϕ)=(11.56  deg,250.24  deg), which is a portion of the antenna pattern that is predominately right-hand circularly polarized with an axial ratio of 4.7 dB (2.79 dBiC RHCP and −8.8  dB iC LHCP). The link analysis model assumes an arbitrary 45 deg tilt angle between transmit and receive polarization ellipses and then accounts for the possibility of a worst-case tilt angle of 90 deg in the link performance margin. In this case, the worst-case polarization loss can only account for an additional 4.5 dB of loss and not the ∼15  dB of loss seen during the anomaly. The next step in the investigation was to determine if the EDL antenna modeling error combined with polarization loss could account for the signal degradation. Shown in Fig. 13 are the results of a polarization loss variability analysis including calculating the polarization loss range (0 to 90 deg tilt between polarization ellipses) at every point in the InSight EDL antenna pattern relative to the single point in the MRO antenna pattern during the peak signal degradation.Fig. 12 InSight EDL antenna cone/clock angle during entry. Blue box identifies period of signal degradation and red boxes identify location of measured null in pattern.The plot in Fig. 13 displays three distinct polarization loss variability “islands” in theta angles between 75 and 130 deg. The EDL antenna consists of three individual patch subarrays that are electrically combined. The islands are located at the crossover points in between the patch subarray main beams. The island marked with a white box is very near the cone/clock angles [(θ,ϕ)=(122  deg,290  deg)] where the peak signal degradation occurred. The 15 dB (green) and 20 dB (yellow) islands are in the correct clock angle but ∼15  deg closer to the boresight, which indicates that polarization loss is a feasible explanation for the signal degradation but made the team question the accuracy of the EDL antenna pattern model at large cone angles. The team also investigated the possible causes of worst-case polarization losses being realized during EDL, and one possible explanation is atmospheric effects.Fig. 13 Polarization loss variability over entire EDL antenna pattern.Shown in Fig. 14, the line of sight between InSight and the MRO during the signal degradation shows the transmitted signal is traveling at a very small (less than 5 deg) ground elevation angle, indicating the signal is traversing a large section of the Martian Ionosphere.Based on Earth ionospheric modeling (International Telecommunication Union P531 ionospheric propagation data and prediction methods required for the design of satellite services and systems), low (0–5 deg) ground elevation angle Faraday rotations can approach 3  deg/s at 401 MHz as observed from a stationary terrestrial point to low Earth orbit (∼1000  km altitude and 7.4  km/s). If the EDL signal experienced similar Faraday rotation, the rate of change of the signal’s polarization ellipse can traverse from peak polarization loss to minimum polarization loss in 30 s. Although the Martian ionosphere is not as well characterized, the concept of an increased rate of rotation of the polarization ellipse due to the signal traveling through the ionosphere combined with an antenna pattern susceptible to large polarization loss variability is a feasible explanation.Fig. 14 Geometry between InSight and MRO at peak of signal degradation anomaly.To potentially improve the fidelity of the EDL antenna pattern model at large off-point angles, the team reviewed the model and contacted the EDL antenna vendor, Haigh-Farr, to verify dimensions. Haigh-Farr has since provided an update to the feed design details that could affect the polarization behavior. Additional backshell structure details have also been added to the model. The results of these updates are not yet available for review.C. MRO HiRISE Slew Design and PerformanceIn addition to communications during EDL, NASA Mars lander missions since the Phoenix mission have attempted to capture an image of the spacecraft while on the parachute. These images have both public relations value and potential forensic value (in case of an EDL anomaly, such as a parachute failure). This can be accomplished using the HiRISE instrument since the instrument is co-boresighted with the relay antenna,To accomplish EDL communications and the HiRISE descent image, the MRO had to meet two main mission design constraints: keep the UHF antenna boresight pointed toward InSight, and point the HiRISE camera at InSight to image it while the parachute would be open. To meet the first constraint, the lander must be kept within 30 deg of the UHF antenna boresight from atmospheric entry until UHF turn-off at landing plus 5 min. To meet the second constraint, the HiRISE camera field of view must be scanning in the correct direction and at the desired imaging rate at the predicted time when InSight would be under its parachute. Similar constraints were met for both the Phoenix lander and the Curiosity rover EDLs, and the MRO successfully returned images of those spacecraft on their parachutes. The InSight mission presented a more challenging situation for the MRO, however, since the orbiter would be passing much farther to the east of the InSight landing site than it had for the other two missions.The MRO team had to develop a sequence of slew commands that would meet these mission design constraints. This sequence of commands consisted of three slews: the first slew pointed the spacecraft at an attitude that aligned it with the rotation plane of the second slew, the second slew rotated the HiRISE field of view along a plane defined by the relative positions of both InSight and the MRO at the predicted time, and the third slew returned the MRO to its nominal attitude profile. Since the second slew was defined by the relative positions of the two spacecraft, the parameters for the slew were highly dependent upon the predicted navigation states and were recalculated with each navigation update leading up to the EDL. The MRO EDL relay planning process defined a series of EDL Relay Trajectory Files (ERTFs) which were generated as navigation solutions were updated. The final update for the slew sequence timing was done with the ERTF-17 set of predicted navigation states, and the final slew parameter update was done with the ERTF-18 set of predicted navigation states. The slew sequence timing and parameter values were determined to have a 100% chance of meeting the first mission constraint, as well as a 60–70% chance of meeting the second.On the day of the EDL, the MRO slew sequence executed on board as expected. The results showed that the UHF antenna was pointed at the lander so that all data were acquired successfully. The HiRISE camera field of view was also successfully pointed at the lander for approximately 12 s, from 19:43:06 to 19:43:18 UTC. Unfortunately, the HiRISE started its image scan at 19:43:20 UTC and ended at 19:44:08 UTC. The reason that the HiRISE image timing missed the lander was due to the aforementioned rapid descent experienced by InSight.D. HiRISE Image PerformanceAs a result of the aforementioned Monte Carlo analysis, a scan rate of 500  μrad/s at the center of the image time was chosen was chosen. Due to other geometric constraints (i.e., slewing to keep InSight within 30 deg of the UHF antenna boresight from entry to landing), we could not guarantee that the slew rate would be perpendicular to the HiRISE field of view. A time delay integration rate of eight lines was chosen, as was done for the Phoenix parachute image to minimize image smear. Unfortunately, the scene was bright enough (due to dust in the atmosphere and on the surface, as well as the lighting angle) that excess charge bled in from the unused detector lines and saturated the image.IX. Radio Science (UHF Direct-to-Earth) PerformanceFigure 15 shows the residual Doppler of the InSight UHF signal, as measured at the Green Bank Observatory antenna. The residual Doppler is computed relative to a predicted Doppler based on a nominal EDL trajectory. The predicted Doppler was based on a “no parachute deploy” scenario (a failure condition) so there would be a clearly observable deviation during the parachute deployment. The timing for these plots is based on seconds past 19:40:00 Earth received time. The one-way light time was 487.378 s. There is a clearly discernible signature of expected parachute dynamics (∼200  Hz jump) beginning around 640 s and lasting for approximately 1 min.The plot shows clear signatures of the plasma outage, atmospheric deceleration following the plasma outage, parachute deployment, and a brief interruption in signal at lander separation. The plot also shows an initial change in the UHF signal frequency at radio turn-on, which may be a transient warmup signature of the radio oscillator.Fig. 15 Green Bank Observatory residual Doppler. (Produced using Satellite Orbit Analysis Program/Aerospace Corporation.)In the EDL timeline, there are tight constraints on when the radio is turned on. The UHF radio cannot begin transmission before release of the cruise stage, which is approximately 5 min before atmosphere entry. The oscillator warmup during that period is considered acceptable since there are no atmospheric dynamics or changes in attitude during this time.Figure 16 shows the estimated carrier signal-to-noise ratio at Green Bank. There are clear signatures of the carrier-only period, the transition to start of telemetry, the start and end of the plasma outage, and the carrier-only beacon tone at landing. In addition, there are some other unidentified signal transients. Overall, the quality of the signal strength and Doppler frequency data is sufficient to identify spacecraft progress through different stages of EDL and would have been sufficient to assist in a case of needed failure analysis.Fig. 16 Green Bank estimated carrier signal-to-noise ratio.X. Plasma Signal DegradationAll five receive assets experienced some form of signal degradation during the period around peak heating. The 2 assets on Earth (Green Bank and Effelsberg) looked through the same portion of the plasma developing around the InSight spacecraft. The 3 assets near Mars (MRO, MarCO-A, MarCO-b) each looked through a different portion of the plasma.The received signal data from each of the Earth-based and Mars vicinity assets showed significant degradation that coincided with the expected plasma degradation period, from about 50 to 110 s past entry. The expected plasma outage period was based on parametric models of electron number density as a function of atmospheric relative velocity and atmospheric density for both stagnation and wake regions about the spacecraft provided in Ref. [5]. When compared against the threshold electron number density, one expects plasma-induced signal degradation when the curves exceed this threshold. Figure 17 shows that the wake region electron number density (blue curve) exceeds the UHF threshold (green line) from about 50 s to about 110 s after entry. The estimated outage period in the stagnation-point direction involves a longer outage period from about 20 to 125 s past entry. However, since there are no antennas on the heat-shield side of the vehicle, the stagnation curve serves to provide “upper bounds” to any observed degradation, such as at high cone angles. The WPA is located on the aft side of the vehicle, and most receive assets generally lie in directions at smaller cone angles. Thus, outages using periods when the wake region curve lies above the threshold curve serve the purpose as first-order estimates until more rigorous analyses can be employed.Figure 17 displays the MRO signal strength data (light blue) showing an obvious outage noise floor near 9 dB between 45 to 90 s past entry with a successive decrease signature around 45 to 50 s and increasing back up to nominal values between 90 s to about 100 s past entry. This degradation period at about a 10 dB Signal-to-Noise Ratio (SNR) level (except for a small peak feature near 68 s past entry) coincides nicely with the predicted degradation period of ∼60  s.Fig. 17 MRO signal strength (light blue), stagnation (red), wake (orange), and peak DPLR electron number density signatures versus time past entry.Figure 18 displays the MarCO signal strength data (MarCO-A in purple, and MarCO-B in light blue) along with the wake region electron number density estimates (orange), as well as the UHF threshold electron number density (solid green). The “predicted” outage period occurs where the wake region number density exceeds the threshold electron number density: between about 50 and 110 s past entry in Fig. 9. Both MarCO-A and MarCO-B experienced signal degradation coinciding with the expected wake region degradation period (see Fig. 9). The signal “fades” and “outages” in the received signal strength from each MarCO nicely fall within the predicted signal degradation period.The DTE link between InSight and Green Bank showed a signal outage coinciding with the expected degradation period (see Fig. 19) but starting somewhat earlier near 40 s past entry and extending to roughly 120 s past entry. Although the range distance was significant, signal detection was still possible given the large 100-m-diameter ground antenna used. Here, the noise floor near 7 dB was reached during the plasma degradation period. The two features near 51 and 60 s appear to be associated with InSight; there is a similar increase in the MRO signal at about this time. However, these features do not appear in the data from the two MarCOs. At this time, the cause of this signal is not known.Fig. 18 MarCO-A signal strength (purple), MarCO-B signal strength (light blue), wake region (orange), and critical (green) electron number density signatures versus time past entry.Additional analyses were performed by making use of NASA Ames Research Center’s Data Parallel Line Relaxation (DPLR) Computational Fluid Dynamics software. Peak electron number densities along the line of sight to each receive asset were estimated and examined as a function of the time past entry. The peak DPLR estimates are shown as blue squares in Fig. 17 at particular time instances from 35 to 115 s past entry. Here, we see a nice smooth signature centered about the signal degradation period and coinciding with the parametric curve signatures.Fig. 19 DTE received signal strength at Greenbank, West Virginia.Another analysis using DPLR made use of integrating all of the electron number densities along the signal line of sight and estimating signal attenuation using a model provided [6]. The estimated signal attenuation would then be compared against the measured signal attenuation. It was found that the electron number density signatures along the line of sight were within the expected uncertainty of electrons estimated from the DPLR program.XI. ConclusionsThis paper discussed how entry, descent, and landing communications were designed for the InSight landing, as well as how this design performed during the landing. Several lessons were learned during the process:MarCO-A and -B, which are the first-ever deep-space CubeSats, demonstrated that CubeSats could be successfully flown to Mars, opening up the field for cheap, rapid deep-space missions with multiple spacecraft. The MarCO project team was able to position both spacecraft for EDL relay despite a number of challenges with spacecraft performance. Telemetry was returned throughout EDL, including return of the first image from the landing site. EDL telemetry was also retransmitted after the Mars flyby in case any data were lost during the real-time relay.As predicted, InSight UHF signals were detected on Earth at the Green Bank and Effelsberg radiotelescopes. Although the stations were not equipped to demodulate telemetry in real time, the stations were able to detect, in real time, significant events during EDL, including atmosphere entry, parachute deploy and separation, and touchdown.The MRO open-loop relay performed well. The open-loop recording returned valuable Doppler information during EDL, supporting improved reconstruction of the Martian atmosphere and flight dynamics during entry. Analysis of the signal loss during entry provided additional information on the Mars atmosphere. It also provided an in-flight calibration of the antenna performance at high off-axis angles, which will lead to improved analysis and design of future backshell antennas.The plasma signal degradation was measured from four different geometries (MRO, two MarCOs, and Earth). This confirmed the existing models of the Martian atmosphere, and of the interaction with the InSight heat shield during hypersonic flight.The pre-entry modeling supported successful trajectory and pointing design for the MRO and the MarCOs. An unexpected lift vector during entry resulted in a descent more rapid than expected. In turn, this resulted in a failure to acquire a HiRISE image of the InSight lander. In addition, atmosphere dust conditions at the time of entry resulted in an image saturated with background light.As with previous Mars landings, and the subsequent Perseverance landing, the EDL communications design showed the value of a large skilled team integrated across a number of disciplines and across many different organizations.R. M. CummingsAssociate EditorAcknowledgmentsThe work described in this paper was carried out at the Jet Propulsion Laboratory, California Institute of Technology, under prime contract 80NM0018D0004 with NASA.\r            References\r        [1] Maddock R. W., Dwyer Ciancilo A. M., Korzun A. M., Litton D. K. and Zumwalt C. H., “InSight Entry, Descent and Landing Post-Flight Performance Assessment,” AIAA SciTech 2020 Forum, AIAA Paper  2020-1270, Jan. 2020. Google Scholar[2] Wallace M. S., Litton D., Martin-Mur T. and Wagner S., “Orbiters, CubeSats, and Radio Telescopes, Oh My; Entry, Descent, and Landing Communications for the 2018 InSight Mars Lander Mission,” 29th AAS/AIAA Space Flight Mechanics Meeting, AAS Paper  19-291, Jan. 2019. Google Scholar[3] Maddock R. W., Dwyer Cianciolo A. M., Litton D. K. and Zumwalt C. H., “InSight Entry, Descent and Landing Pre-Flight Performance Predictions,” AIAA SciTech 2020 Forum, AIAA Paper  2020-1269, Jan. 2020. Google Scholar[4] Menon P. R., Wagner S. V., Jefferson D. C., Graat E. J., Lee K. J., Schulze W. B., Woollands R. M. and Criddle K. E., “Mars Reconnaissance Orbiter Navigation Strategy for Support of InSight Lander’s Entry, Descent, and Landing Sequence,” 29th AAS/AIAA Space Flight Mechanics Meeting, AAS Paper  19-209, Jan. 2019. Google Scholar[5] Morabito D., Kornfeld R., Bruvold K., Craig L. and Edquist K., “The Mars Phoenix Communications Brownout During Entry into the Martian Atmosphere,” Jet Propulsion Lab.,  Interplanetary Network Progress Rept. 42-179, Nov. 2009, http://tmo.jpl.nasa.gov/progress_report/42-179/179A.pdf [retrieved 6 Sept. 2021]. Google Scholar[6] Morabito D., Kobayashi M. M., Krasner S., Bruvold K., Okino C., Kahan D., Lee C., Oudrhiri K., Lay N., Skylanskiy E., Litton D. and Johnson M. A., “InSight Communications Degradation During Peak Heating Phase of Atmospheric Entry,” Journal of Spacecraft and Rockets, Vol. 58, No. 3, 2021, pp. 856–864. https://doi.org/10.2514/1.A34886 LinkGoogle Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Bouncing Return Trajectory Design for Precise Lander Deployment to Asteroids",
        "url": "https://arc.aiaa.org/doi/10.2514/1.G006016",
        "date": "20210921",
        "content": "AbstractThis paper investigates a novel method to increase the accuracy of ballistic deployment by controlling the spin rate of the lander, assuming that the lander is spherical. The concept of the bouncing return trajectory is proposed, which takes off and lands at the same point on the asteroid surface. The spin rate of a spherical lander is controlled before each impact to change its postimpact velocity so that it can be driven into the bouncing return trajectory and remains in the vicinity of its original landing site until it finally rests on the surface. First, the properties of bouncing return trajectories are investigated based on a spherical model. Based on the contact dynamics, the analytical solution of the required spin rate to change velocity is derived. Next, candidate deployment trajectories of the proposed method are studied under different asteroid parameters. Finally, the feasibility and robustness of the method are verified using a model of the asteroid Bennu. It is found that the proposed deployment method can achieve a precise landing if the surface environment is ascertained and largely reduce the landing dispersion under an uncertain environment. This paper provides a novel idea for future asteroid lander deployment and surface exploration missions.Nomenclatureercoefficient of restitutionInnormal impulse acting on a lander during impact, kg⋅m/sIttangential impulse acting on a lander during impact, kg⋅m/snmean spin rate of an asteroid, rad/sraapoapsis distance of the deployment trajectory, mrpperiapsis distance of the deployment trajectory, mrssize of the lander, mvslanding velocity of a lander relative to the surface, m/sαlongitude of the landing site, radγtangential contact velocity, m/sθlanding angle, radκreciprocal of the characteristic spin rate of an asteroidλlatitude of the landing site, radμfcoefficient of frictionΩspin rate of an asteroid, rad/sωangular velocity of a lander in the body-fixed frame, rad/sI. IntroductionOver the last few decades, asteroids have become attractive destinations for deep space exploration as they contain valuable information about the evolution of the solar system, the formation of planets, and the origin of life. Several missions have been carried out or will be launched in the near future. As these exploration activities are being developed, scientists and engineers are not restricted to close flyby or orbiting, but instead are including the in situ explorations such as landing or touch-and-go sampling. Among them, deploying a small lander to the surface of asteroids is an important way that provides a great opportunity to directly contact with the surface and gain insight into the surface composition with less risk [1]. The Philae lander of Rosetta spacecraft detected the composition of the surface of comet 67P C/G [2,3]. The Hayabusa 2 mission carried a total of four rover/landers to asteroid Ryugu to achieve various scientific goals [4,5].However, lander deployment in a weak and perturbed gravity environment is a challenging task. The small lander usually does not have the ability to achieve a soft landing. Thus, it is inevitable that it bounces on the surface after its first landing, which has happened on previous missions. Because of the weak gravity, the lander may rebound several times before it settles down, resulting in a large deviation from its first landing site. Especially, although the Philae lander was equipped with several mechanisms to attach on the surface of comet 67P, all of them failed during the landing, causing a long bouncing trajectory [3,6]. The final bouncing distance was more than 1 km from its desired landing site and led to an early end of mission [7]. The MASCOT rover in the Hayabusa 2 mission also went through several rebounds, and its total bouncing time was up to half an hour [8]. Moreover, the inaccurate surface parameters and sensitive dynamic environment increase the uncertainty of lander deployment. It is hard to achieve a precise ballistic deployment for small landers on the surface, which limits their applications in surface exploration.In previous studies of ballistic deployment, Sawai et al. first pointed out the bouncing issues when studying a point mass landing on a rotating ellipsoid [9]. Then Tardivel et al. considered the global motion of a spherical lander bouncing on the polyhedron model of a small body [10]. They find that lander motion on the surface is chaotic and cannot be described by a simplified point mass model. Tardivel et al. also discussed the influence of rocks on the surface [10]. Van wal and associates developed a high-fidelity model for lander deployment that was applied to simulate the MINERVA-II deployment on the asteroid Ryugu for Hayabusa-II [11,12]. Van Wal et al. also analyzed the influence of surface parameters on spherical lander deployment and found that the coefficient of restitution dominates the motion [13], although effects on bouncing were also investigated [14]. The landing on binary asteroid system [15,16] and Phobos [17] from various orbits was investigated. Wen et al. further proposed the concept of “hop reachable domain,” which can effectively predict the natural landing dispersion of a rover [18]. Li et al. introduced attitude control at landing when investigating the motion of a cubic hopping rover and found that attitude control can change the following bouncing trajectory [19]. They also provide several control schemes to reduce the bouncing distance. The effects of solar radiation pressure on hopping motion were discussed [20] by Dong et al., providing a new ideal for rover landing.In this paper, on the basis of the previous study, we extend the use of attitude control to lander deployment and develop a novel method to increase the accuracy of ballistic deployment. The spin rate of a spherical lander is controlled before each landing to control its postimpact velocity to drive it into a bouncing return trajectory, which ideally contacts the surface at the same point when we consider the spin of the asteroid. In that case, the lander can ideally always return to the same site, and its velocity gradually dissipates by collision until it finally rests on the surface. To achieve such a deployment method, we study the problem in two aspects. First, the necessary condition of the bouncing return trajectory is investigated, and the initial states of trajectories at different landing sites are obtained. Second, the controllability of a spherical lander is discussed, and the required initial spin rate before impact to meet the velocity change is derived. Moreover, candidate deployment trajectories for the proposed method are studied. The design space of periapsis and apoapsis distance is classified, and the characteristics of candidate trajectories are analyzed. Finally, the feasibility and robustness of the proposed deployment method are verified on a spherical model and a polyhedron model of asteroid Bennu. The effect of irregular shape on the proposed method is presented. In consideration of the uncertain environment, several control strategies are discussed and compared. This study can provide a novel idea for future asteroid lander deployment and surface exploration missions.This paper is organized as follows. In Sec. II, the bouncing return trajectory is discussed based on an ideal spherical model. The influence of the characteristic spin rate of asteroids and the latitude of landing sites is investigated. In Sec. III, we build the contact dynamics of a spherical lander. The analytical solution between before-impact spin rate and change of velocity at contact is investigated. Section IV deals with the candidate deployment trajectories under different asteroid parameters. In Sec. V, the proposed deployment method is verified both in the spherical model and in the polyhedron model of asteroid Bennu. Finally, in Sec. VI, we draw our conclusions.II. Bouncing Return Trajectory DesignThe concept of bouncing return trajectories is presented in this paper. Such a trajectory is most simply defined as one that returns to the same site on a rotating body after each bounce. Though we take it for granted on the surface of the Earth, where the deviation due to Coriolis acceleration is not easily detectable, this is not the natural motion on a rapidly rotating small asteroid. Instead, a bouncing ball on a small asteroid will move far from its initial impact point. The “bouncing return” trajectory finds the necessary lateral velocity at each impact to allow the lander to re-impact at the same site each time. From the point of view of the inertial frame, the bouncing return trajectory lifts off from point A at latitude λ on the surface and contacts the surface at point B at the same latitude. The bouncing time from A to B is TB. If the surface rotates from A to B(A′) in the same time interval TB, the lander will lands at the same point on the surface. Figure 1 shows the sketch of the bouncing return trajectory. To find the characteristic of such bouncing trajectories, we first discuss the necessary conditions based on a spherical asteroid.A. Necessary Conditions for Bouncing Return TrajectoriesAssume that an asteroid has a radius re with a constant density ρ. The spin rate of the asteroid is Ω. The radius of the asteroid is taken as the unit length [L]=re. The mean spin rate is defined as n=(μ/re)(1/re)=(4π/3)Gρ, which is the ratio between the orbital velocity at the surface and the radius of the asteroid. The unit time is the reciprocal of n, [T]=3/4πGρ. Then, the normalized gravity constant becomes μ=(4/3)πGρ=n2.As shown in Fig. 1, the bouncing return trajectory has a normalized semi-axis a′ and eccentricity e. Define the true anomaly of the bouncing return trajectory at point A as θA=arccos[1e(h2μ−1)](1)where h=a′μ(1−e2).The phase angle between A and the apoapsis is γ=π−θA. By solving the Kepler equation, the time from A to apoapsis can be obtained as T1=(12−M2π)Tf(2)where E=2arctan(1−e1+etanθA2)M=E−esinE, and Tf=2π(a′3/μ).Based on symmetry, the time from apoapsis to B is equal to T1. Then the orbital time from A to B becomes TB=Tf(1−Mπ)=a′(3/2)μ(2π−2M)(3)The change of true anomaly between A and B is φ0=2π−2θA. Then, the change of longitude between A and BΔα satisfies the condition cosΔα=1−(1−cosφ0)cos2 λ(4)Δα={arccos[1−(1−cosφ0)cos2 λ],φ0<π2π−arccos[1−(1−cosφ0)cos2 λ],φ0>π(5)Therefore, the bouncing return trajectory should satisfy TB=(Δα/Ω). The time constraint is written as a′(3/2)(2π−2M)n=ΔαΩ(6)The second constraint of the bouncing return trajectory is related to its radial velocity at point A: vr=μa′(1−e2)sinθAe=na′(1−e2)sinθAe(7)Based on Eqs. (6) and (7), by choosing different initial radial velocities vr, the proper orbital parameters of a bouncing return trajectory can be solved. Moreover, Eq. (6) can be transformed to the form nΩ=a′(3/2)(2π−2M)Δα(8)The left term of Eq. (8) is related to the density and the spin rate of the asteroid, whereas the right term is a function of a′, e, and λ, which are independent of the physical parameters of the asteroid. This means that the normalized results of bouncing return trajectories are only related to the characteristic value of κ=(n/Ω). Here we define κ as the reciprocal of the characteristic spin rate. Note that κ>1 means that the surface velocity is less than the velocity of a circular orbit with the same radius as the asteroid. This means that objects can settle on the surface by the gravity of the asteroid itself. Otherwise, the normal surface acceleration points out of the surface at κ<1 (at least near the equator region). A lander needs to apply extra force to stay on the surface.The characteristics of bouncing return trajectories are analyzed in the cases of κ1=1.419,κ2=1.229,κ3=2.838,and κ4=4.257. These values can cover most of the known asteroids (2.520 for asteroid Ryugu, 5.130 for asteroid Itokawa, 2.608 for asteroid Eros, 3.007 for asteroid Vesta, and 4.040 for asteroid Ceres). Larger κ corresponds to a denser or slower asteroid. Particularly, κ=1.419 is equal to asteroid Bennu, which is taken as the target in the simulation section. The orbital parameters of bouncing return trajectories with different radial velocities are shown in Fig. 2. Here the landing point is on the equator λ=0°. As can be seen, there are two types of bouncing return trajectories at each radial velocity. Type I trajectories correspond to φ0<π (shown in solid lines), and type II trajectories correspond to φ0>π (shown in dash lines). Actually, only the type I trajectory is suitable for the same point landing as its tangential velocity decreases with the decrease of the radial velocity, whereas the tangential velocity of the type II trajectory increases during bouncing.As shown in Fig. 2, with the increase of the radial velocity, the semi-axis, transfer time, and the tangential velocity of type I bouncing return trajectories increase, but the eccentricity decreases. Type II bouncing return trajectories show an opposite trend. Two types of trajectories coincide at the maximum radial velocity. Meanwhile, if we increase κ, the upper bound of radial velocity increases. At the same radial velocity, the semimajor axis of type I trajectories decreases but the eccentricity increases. This means that the bouncing return trajectory has a low periapsis distance at a larger κ. The corresponding tangential velocity and bouncing time also decrease.Fig. 2 Bouncing return trajectories for different κ (solid lines, type I; dashed lines, type II).To give an intuitive impression about the magnitude of bouncing return trajectories, we choose the unit length as [L]=245  m, and the unit time as [T]=1734  s (which corresponds to a Bennu-like asteroid). The maximum radial velocity is 0.0423 m/s for κ=1.419 and increases to 0.0978 m/s for κ=2.838. For type I bouncing return trajectories, tangential velocity varies between 0.0995 and 0.1246 m/s with κ=1.419. The bouncing time varies between 0 and 4267 s. The range of tangential velocity changes to 0.0755–0.1379 m/s when κ increases to 2.838. The maximum bouncing time also increases to 7472 s. For type II bouncing return trajectories, the maximum tangential velocity is 0.155 m/s for κ=1.419, and the corresponding maximum bouncing time is 4.282 h. The tangential velocity and bouncing time increase to 0.173 m/s and 8.448 h, respectively, when κ increases to 2.838.Moreover, as can be seen, the eccentricity will be close to 1 when κ increases and close to 0 when κ decreases. Theoretically, the eccentricity will be infinitely close to 1 if we further increase κ. In general, it is easier to find bouncing return trajectories for asteroids with a slow spin rate or with a large density.Fig. 1 Sketch of the bouncing return trajectory.B. Bouncing Return Trajectories at Different LatitudesNow, we choose κ=1.419 as a representative value and change the latitude of the landing site. Type I bouncing return trajectories for different latitudes are shown in Fig. 3. It is found that as the latitude increases, the upper bound of radial velocity increases largely. At the same radial velocity, the bouncing return trajectory at high-latitude regions has a smaller semimajor axis and larger eccentricity than that at low-latitude regions. The corresponding tangential velocity and bouncing time also decrease. Chosen the normalized radial velocity as 0.3 (or 0.0424 m/s for the case of asteroid Bennu), the semimajor axis and eccentricity of a bouncing return trajectory that lands at the latitude of λ=20° are a=0.748 (or 183 m for the case of asteroid Bennu) and e=0.4843. In the meantime, the semimajor axis and eccentricity of a bouncing return trajectory that lands at the latitude of λ=60° are a=0.565 (or 139 m for the case of asteroid Bennu) and e=0.865. With the increase of radial velocity, the eccentricity decreases at first but increases later at high latitude. Meanwhile, the inclination of bouncing return trajectories is close to the latitude and increases slightly with radial velocity except for latitude between 20° and 30°, where the inclination seriously boosts at a large radial velocity.The results indicate that it might be easier to find a bouncing trajectory at high-latitude regions. In fact, the surface velocity of an asteroid is smaller at a high latitude, which is equivalent to a larger κ.Fig. 3 Type I bouncing return trajectories for different λ.Type II bouncing return trajectories at different latitudes are also investigated. The upper bound of the radial velocity of type II trajectories decreases with the increase of latitude. This means that fewer type II bouncing return trajectories can be found in high-latitude regions.C. Change Landing Sites by Bouncing TrajectoriesThe above bouncing conditions are for the same point landing. If we want to change the landing site by bouncing, the corresponding bouncing trajectories can also be found. Assuming that the changes of longitude and latitude after bouncing are δα and δλ, the bouncing time becomes TB=(Δα+δα)/Ω, where Δα={arccos[cosφ0−sinλsin(λ+δλ)cosλcos(λ+δλ)],φ0<π2π−arccos[cosφ0−sinλsin(λ+δλ)cosλcos(λ+δλ)],φ0>π(9)Hence, the time constraint for bouncing trajectories changes to a′(3/2)(2π−2M)n=Δα+δαΩ(10)Solving Eqs. (7) and (10), the corresponding bouncing trajectory to change the landing site is found, which can be used to correct the initial landing error.Though the bouncing return trajectories are solved based on a spherical model, they can also be found for an ellipsoid model or a polyhedron model. The major difference is the time on a bouncing return trajectory. The time may change due to nonspherical perturbation and the analytical solution is unavailable. But the trajectory in a spherical model can be taken as an initial guess for a more accurate shape model and gravity field. A differential corrector will be used to solve the precise bouncing return trajectory at the same radial velocity. We will show those results in the simulation section.III. Contact Dynamics of LanderHaving defined and analyzed the bouncing return trajectories, the next step is to find a way to drive a lander into such a trajectory. Here we assume that the lander is not equipped with thrusters to change its translational velocity, but only has the ability to alter its attitude and angular velocity by an internal momentum wheel. Therefore, it will contact the surface with a certain landing velocity and bounce. The contact dynamics of a lander is investigated. Unlike a point mass, the contact of a rigid body changes both its translational velocity as well as its angular velocity, which partly results in the chaotic landing motion. From another point of view, the change of initial angular velocity of a rigid body will change its postimpact velocity, which provides a good option to adjust the following bouncing trajectory. There are several methods to describe the impact on asteroid surface, including the hard-contact method [13] and granular mechanics [21,22]. The hard-contact method is used here. The contact dynamics is investigated in the local surface frame L, where the Z axis aligns the surface normal direction. The X and Y axes are chosen arbitrarily in the surface plane; e^1,e^2,and  e^3 are the base vectors. Define the translational velocity of the center of lander relative to the surface as vs and the angular velocity of the lander in its body-fixed as ω. The contact velocity is vc=vs+Rs⋅(ω×rc), where rc is the position vector of the contact point c in the body-fixed frame and Rs is the transfer matrix from the body-fixed frame to the local frame.Assuming that the collision happens in an infinitesimal time, the contact dynamics for a lander during the impact process can be written as [12] dvsdIn=1mdIdIn(11)JdωdIn=rc×RsTdIdIn(12)Here m and J are the mass and the inertial matrix of the lander, and I=[Ix,Iy,In]T is the impulse acting on the lander during impact. In is the normal component of I. It is taken as a time scale as it monotonically increases during the collision [23]. The surface properties are assumed known when solving the impact dynamics, which are related to I. For the impact of a spherical lander, we assume that the local frame coincides with the body-fixed frame for convenience. Then Rs is the identity matrix and rc=[0,0,−rs]T, where rs is the radius of the lander.Usually, the change of velocity and angular velocity should be solved numerically, such as by the hodograph method [23]. But if the lander is spherical, the calculation can be simplified, as the collision for a spherical lander can always be classified as a central collision. The change of angular velocity affects only the tangential part. Therefore, the tangential and normal components can be solved separately.The ratio between before and postimpact normal velocity vsn is vsn+=−ervsn−,(vsn−<0)(13)where er is the coefficient of restitution [24].The normal impulse implemented during the impact is obtained as In=−(1+er)vsn−. It is assumed that the coefficient of friction of the surface is μf. Then based on Coulomb’s law of friction, the maximum tangential impulse implemented by friction is Itmax=μfIn=−μf(1+er)vsn−. The actual tangential impulse might be smaller than the maximum value because of the “sticky phenomenon,” where the tangential contact velocity reduces to zero and remains unchanged until the impact ends.Two remarks are given for a spherical lander impact the surface. First, the hodograph of γ is a straight line pointing from its initial value to the origin, where γ=(e^1,e^2)Tvc is a 2×1 vector that describes the tangential contact velocity. Second, the sticky phenomenon appears as long as γ reduces to 0.Proof:1) The change of contact velocity is Δvc=Δvs+Δω×rc, which can be written as Δvc=WI(14)where W=(1/m)U−S, S=rc×J−1rc×, and U is the identity matrix. Here (⋅)× denotes the cross-product operator defined by rc×=[0−rc3rc2rc30−rc1−rc2rc10]The tangential contact velocity can be expressed as γ=(e^1,e^2)Tvc=γ−1+B(IxIy)+Ind(15)Here B is 2×2 matrix, B=(e^1,e^2)TW(e^1,e^2), and d is a 2×1 vector, d=(e^1,e^2)TWe^3.The change of tangential velocity with respect to impulse satisfies γ′=B(Ix′Iy′)+d=−μfBγ^+d(16)where (⋅)′ means the derivative with the normal impulse. For the central impact, d=0 and B is a diagonal matrix, and γ′=−μfBγ^, or the tangential contact velocity changes monotonically along the opposite direction of its initial velocity. It corresponds to a straight line in the hodograph.2) The condition for sticking is ‖B−1d‖≤μf [23]. Since d=0, the condition is met for arbitrary μf. Therefore, sticking will immediately start after γ=0.   □Based on these two deductions, the change of tangential contact velocity is ddIn=(e^1,e^2)T[1mdIdIn+J−1(rc×dIdIn)×rc]=(e^1,e^2)T(Um+rs2J−1)dIdIn(17)The required tangential impulse from initial tangential velocity γ− to 0 is It*=m(U+mrs2J−1)−1(e^1,e^2)γ−(18)Once the tangential velocity reduces to 0, it will keep 0 until the impact ends. This means that if the required impulse ‖It*‖<Itmax=−μf(1+er)mvsn−, the actual tangential impulse is It*. The tangential contact velocity will be γ+=0, and the normal contact velocity is −ervsn−. The postimpact velocity and angular velocity will be vs+=−ervsn−+vst−+(U+mrs2J−1)−1(e^1,e^2)γ−(19)ω+=ω−−J−1(rc×It*)(20)If ‖It*‖>Itmax, the actual impulse is It**=−(1+er)μfmvsn−It*‖It*‖(21)The tangential contact velocity does not reduce to zero. The postimpact velocity and angular velocity will be vs+=−ervsn−+vst−−(1+er)μfvsn−(e^1,e^2)γ−‖γ−‖(22)ω+=ω−−J−1(rc×It**)(23)As shown in Eqs. (19) and (22), there is a limitation to the change of tangential velocity by collision, which depends on the surface parameters er, μf, and the normal component of landing velocity. It is obvious that larger er and μf will increase the control capability. Within the limitation, we can control the spin rate of the lander before collision, ω−, to obtain the desired postimpact velocity vs+. To generate the desired impulse It*, the required spin rate satisfies [rsωy−−rsωx−]=(e^1,e^2)T[(Um−rs2J−1)It0−vst−](24)The required spin rate is related to the size and mass distribution of a lander and the initial tangential velocity before the collision. To analyze the performance of spin rate control, we discuss the influence of surface parameters, landing velocity, and lander parameters as follows.Here we set the reference values as μf=0.7, er=0.6, rs=0.05  m, and m=1  kg. The two-dimensional situation is investigated. It assumes that the tangential velocity is along the X axis and the positive spin rate is along the Y axis. The magnitude of landing velocity is Vs=0.01  m/s. The landing angle θ is assumed as tanθ=(vsn−/vst−)=(π/3). Different parameters are changed to see their effects on postimpact tangential velocity. Figure 4 shows the results. The analytical solution is equal to the numerical solution in Ref. [23].As expected, increasing er and μf will expand the control capability of spin rate control. The postimpact velocities are the same at a low spin rate, where the required impulse is less than the maximum impulse. The saturation spin rate is low at a low er and μf, where the tangential velocity will not change any more with the increase or decrease of spin rate. Larger er and μf increase the value of saturation spin rate and, in turn, increase the range of tangential velocity. Meanwhile, the tangential velocity is not influenced by surface parameters if the spin rate is not saturated.Fig. 4 Velocity change by spin rate control with different parameters.Changing the landing angle will change the upper and lower bound of saturation spin rate and the range of postimpact tangential velocity. The landing velocity close to the normal direction of the surface will have the maximum ability to change the tangential velocity by spin rate control. The direction of tangential velocity can be positive or negative along the X axis. However, if the landing angle is small, the range of effective spin rate reduces and shifts to the negative direction. Increasing the landing velocity will increase the control capability proportionally. The size of the lander and mass distribution will not increase control capability but change the required spin rate to a certain value of tangential velocity. Meanwhile, the tangential velocity is more sensitive to spin rate when the radius is large or the mass is more distributed on the shell.The results verify the ability of spin rate control to change the postimpact velocity, which will be used to find the suitable deployment trajectories.IV. Precise Deployment via Bouncing Return TrajectoriesA. Deployment Trajectories DesignBased on the controllability analysis and bouncing conditions in the above sections, here we proposed a novel deployment method, in which the spin rate of the lander is controlled before each landing to transfer into bouncing return trajectories. In that case, the lander can land at the same site after each bouncing and rest in the end, as the landing velocity gradually dissipates by collision. The lander is not required to control its translational velocity, but rather only need to control its spin rate to improve its deployment accuracy, which is easier to implement in reality.In this section, the candidate deployment trajectories for precise deployment via bouncing return trajectories are investigated. For a predesigned landing site, there are an infinity of deployment trajectories and different deployment trajectories correspond to different landing velocities and landing angles. The lander needs to satisfy both the radial and tangential velocity of the bouncing return trajectory via spin rate control. There are two constraints for deployment trajectories. First, the radial component of the postimpact velocity should be less than the upper bound of bouncing return trajectories at the landing site so that the bouncing return trajectory exists. Here the radial velocity of trajectory is equal to the normal component of postimpact velocity. Second, the spin rate control of the lander has the ability to change the tangential component of postimpact velocity such that it meets the tangential velocity of the bouncing return trajectory, which is equal to the tangential component of postimpact velocity relative to the surface plus the surface velocity at the landing site. For a spherical lander, the normal component of postimpact velocity is only determined by its initial landing velocity and the coefficient of restitution. Therefore, we only need to find a proper spin rate of the lander before landing to change its tangential component of postimpact velocity.As the longitude of landing sites can be adjusted by changing the deployment moment or the longitude of the ascending node of the trajectory, it will not affect the landing velocity. Therefore, we pay attention to deployment trajectories to different latitudes. The orbital parameters of deployment trajectories reduce to three: semimajor axis, eccentricity, and inclination, an extra constraint related to the latitude of landing sites. The normalized periapsis and apoapsis distance are chosen as the design parameters of deployment trajectories.The design procedure is given as follows. The periapsis and apoapsis distance of a deployment trajectory to a fixed landing latitude are chosen and the landing velocity and landing angle can be derived. Then, based on an assumed coefficient of restitution, er, the radial bouncing velocity is determined and the corresponding bouncing conditions are solved by Eqs. (6) and (7). The tangential velocity for the bouncing return trajectory is obtained. Next, the change in tangential velocity can be calculated. If the required tangential impulse is less than the maximum possible tangential impulse by collision, the spin rate control has the ability to change the tangential velocity. The corresponding spin rate is solved by Eq. (24). Otherwise, the proposed deployment method cannot be achieved from the deployment trajectory. The flowchart of deployment trajectory design is given in Fig. 5.It should be mentioned that we only considered the asteroid gravity when searching the bouncing return trajectory. The radius of the Hill sphere of an asteroid rH is calculated [25] as rH≈a(1−e)ma3Ms3(25)where a is the semimajor axis of the asteroid revolution orbit, e is the eccentricity, ma is the mass of the asteroid, and Ms is the mass of the sun. Take asteroid Bennu as an example. The radius of the Hill sphere is about 28.98 km, which is about 117 times the radius of Bennu. This means that the normalized distance of the radius of the Hill sphere is about 117. If we consider the stability of orbit, the stable satellite orbits exist inside 1/3 of the Hill radius in general. The normalized distance is still larger than 39. The solar radiation pressure may have an influence on the orbit in the long-term, but the duration of the landing is relatively short. Therefore it is reasonable that the gravitational perturbation of the sun or other external perturbations are not considered if the apoapsis of the deployment or bouncing return trajectory is far smaller than rH.Fig. 5 Flowchart of deployment trajectories design.B. Equatorial Deployment Trajectories for Spin Rate ControlThe available equatorial deployment trajectories are discussed at first. The normalized periapsis distance is chosen between rp′∈[0.01,1) and the normalized apoapsis varies between ra′∈(1,9]. The characteristic spin rate is chosen as κ=1.419. The surface parameters are set as μf=0.7  and  er=0.6. Figure 6 shows the map of deployment trajectories.It is found that the whole design space can be divided into five regions: the region only suitable for type I bouncing return trajectories; only suitable for type II; suitable for both types; no solution region, where the radial velocity is larger than the maximum radial velocity at the given κ; and infeasible region, where bouncing return trajectories can be found based on the radial velocity but the required tangential velocity cannot be achieved by spin rate control. Type-I-only region appears at low periapsis distance and low apoapsis distance. Type-II-only region corresponds to large periapsis distance and covers most of the apoapsis distance. The infeasible regions appear when the deployment trajectory has a small apoapsis distance or large periapsis distance close to the surface. The remaining part belongs to the no-solution region.Fig. 6 Available deployment trajectories at κ=1.419.We also draw the periapsis and apoapsis distance of bouncing return trajectories with different radial velocities in the map, which corresponds to two lines in the right-bottom corner. The bouncing return trajectory can be considered as the deployment orbit at next time. Both lines are in the feasible region, which means that once the deployment trajectory can satisfy the initial bouncing condition by spin rate control. The following bouncing return trajectory can also meet bouncing conditions by spin rate control. They will finally converge to two solutions. The convergent solution for type I trajectory is the orbit whose apoapsis has the same distance as the radius of the asteroid, and the orbital velocity is the same as the velocity of the surface. This means that the lander finally rests on the surface. The convergent solution for type II trajectory is the orbit whose periapsis distance is equal to the radius of the asteroid, and its orbital period is equal to the spin period of the asteroid. This means that the lander will finally enter into a 1:1 resonant orbit with the asteroid.We choose the radius of the asteroid as re=245  m, which is the equivalent radius of asteroid Bennu. The density and spin rate are also equal to the parameter of Bennu: ρ=1.190×103  kg/m3 and Ω=4.0626×10−4  rad/s [26]. They are compatible with the characteristic spin ratio κ=1.419. The bouncing time and landing velocity of different deployment trajectories are discussed. As the first bouncing trajectory has the largest radial velocity and bouncing time, the total bouncing time is mainly dominated by the first one. The first bouncing time values at landing for type I and II bouncing trajectories are shown in Fig. 7. The first rebound time is between 8.3 and 71.7 minutes for type I and 71.7 and 250 minutes for type II. The shortest time is at the upper-left boundary of type II, and it is also the longest time for type I bouncing trajectory. The shortest time of type I appears at the bottom edge.Figure 8 shows the change of tangential velocity at the first landing. The positive value means that the rover needs to accelerate by impact, and the negative value means that the rover needs to decelerate by the impact. It is found that for type I bouncing return trajectory, the rover needs to accelerate when the deployment orbit has a low periapsis distance. On the other hand, the rover needs to accelerate to enter type II bouncing trajectories if the deployment trajectory has a low apoapsis distance.Fig. 7 First bouncing time from feasible deployment trajectories.Based on the change of tangential velocity, the required spin rate before impact and postimpact spin rate can also be found, as shown in Figs. 9 and 10. It is found that the spin rate is between −1.5 and 2.2 rad/s for type I bouncing return trajectories and between −1 and 2.2 rad/s for type II trajectories. Here a positive value means the same direction as the spin rate of the asteroid. The spin rate for type I trajectories is more concerned with the periapsis distance. As the periapsis distance increases, the spin rate decreases from positive to negative. The required spin rate for type II trajectories is more related to apoapsis distance. The spin rate decreases as apoapsis distance increases. In the meantime, for type I bouncing trajectories, the spin is accelerated (from negative to positive) when the periapsis is relatively high, but dampened when the periapsis is low. For type II bouncing trajectories, the spin is accelerated for most of the regions.Fig. 8 Change of tangential velocity at landing.Fig. 9 Required spin rate before the first landing.Fig. 10 Postimpact spin rate for the first landing.C. Deployment Trajectories to Different LatitudesNext, the available deployment trajectories are discussed for different latitudes of landing sites. According to the two-body orbital theory, the inclination of a deployment trajectory should not be less than the latitude of the landing site. Therefore, not all ra and rp combinations can achieve deployment to the desired latitude. Different ra and rp correspond to different inclinations. Figure 11 shows one example at λ=30°. The deployment trajectories can be found when its periapsis distance is small or close to the radius of the asteroid.Figure 12 shows the feasible maps for different landing latitudes; we also mark the corresponding bouncing return trajectories in each figure. As the latitude increases, the accessible design space reduces. The region for type I bouncing return trajectory gradually occupies most of the available region in the left part, but the region for type II bouncing trajectories disappears.Fig. 11 Inclination for different ra and rp (λ=30°).Fig. 12 Feasible deployment trajectories for different latitudes.D. Parameter AnalysisThe range of feasible deployment trajectories is related to several parameters, including the characteristic reciprocal spin rate, and the surface parameters. The characteristic reciprocal spin rate changes the bouncing conditions, whereas surface parameters affect the control capability.First, the influence of the characteristic reciprocal spin rate κ is investigated. Figure 13 shows the results for κ=1.229 and κ=2.838. As can be seen, fewer opportunities can be found to achieve precise deployment by spin rate control when κ is small (low-density or slow-spin asteroids). Compared with the result of κ=1.419, the periapsis distance of type I deployment trajectories increases at κ=1.229 and the corresponding convergent solution also has a larger periapsis distance. Meanwhile, it is hard to find opportunities at a high ra. On the contrary, larger κ brings more deployment opportunities and the periapsis distance in the type I region moves to the left. Only the left-upper and right-bottom corners are unavailable. Meanwhile, the convergent solution of type I bouncing return trajectories has a lower periapsis distance.Next, the influence of surface parameters is studied. The available deployment trajectories with different coefficients of friction and coefficients of restitution are shown in Fig. 14. Decreasing er can increase the opportunities, whereas decreasing μf will reduce the size of the feasible region as the ability of spin rate control weakens. For lower μf, most of the feasible regions belong to type II trajectories, and there is a maximum apoapsis distance for two types. For lower er, solutions can be found at a larger apoapsis distance.Fig. 13 Influence of the characteristic reciprocal spin rate κ on deployment trajectories.Based on the above analysis and discussions, it can be concluded that the proposed deployment method via bouncing return trajectories and spin rate control can be accomplished on a spherical shape asteroid at different latitudes, but the feasible deployment trajectories vary with different parameters. In general, the proposed deployment method can find more opportunities at a slower rotator or a higher-density asteroid. The deployment and bouncing return trajectories in those regions will be shown in the following section.Fig. 14 Influence of surface parameter on deployment trajectories.V. Simulation of Lander Deployment by Spin Rate ControlFinally, the feasibility of the proposed method will be verified. The asteroid Bennu is chosen as the target asteroid [27]. Both the spherical model and the polyhedron model of asteroid Bennu are used in this paper.A. Lander Deployment in a Spherical ModelFirst, based on the equivalent spherical model, Fig. 15 shows the deployment and bouncing trajectories to the equator. The surface parameters are chosen as μf=0.7  and  er=0.6. The apoapsis and periapsis distance of the deployment trajectory is chosen as ra0=1000  m and rp0=209  m. The deployment and bouncing trajectories in the inertial frame and the asteroid-fixed frame are presented, respectively. It is found that by changing the spin rate, the precise deployment to the desired landing site can be achieved via type I bouncing return trajectory. The lander will land on the same position several times, and the bouncing trajectory gradually approaches the surface until the normal velocity tends to zero. If we set the threshold of normal velocity as 0.001 m/s, the lander bounces eight times before settling. The total bouncing time is 1.42 h.Meanwhile, the type II bouncing return trajectory is shown in Fig. 16. The lander does not land on the surface but goes into a periodic orbit. The orbit hovers above the landing site.Fig. 15 Lander deployment by spin rate control (type I).Figure 17 shows the periapsis and apoapsis of bouncing trajectories at each bouncing (marked with “x” and “*,” respectively). It is found that the orbital parameters of bouncing trajectories will first reach the line of bouncing condition and then moves along the line until it converges to two values. The first one has periapsis distance rp=80.92  m and apoapsis distance ra=245  m. The second one has periapsis distance rp=245  m and apoapsis distance ra=372.1  m.Fig. 16 Lander deployment by spin rate control (type II).Moreover, we change the surface parameters to μf=0.7  ander=0.5 and design the lander deployment from the same deployment trajectory. Figure 18 shows the bouncing trajectories in the inertial frame and the asteroid-fixed frame, respectively. The precise landing is still available via the spin rate control. Because the coefficient of restitution decreases, the radial velocity is smaller after each bouncing. Therefore, the number of bounces reduces to six before settling, and the total bouncing time reduces to 0.88 h.Fig. 17 Orbital parameters of bouncing trajectories.Fig. 18 Lander deployment by spin rate control (type I).B. Lander Deployment in Polyhedron ModelThe proposed deployment is further verified in the polyhedron model. Because of the irregular shape and perturbed gravity field, not all regions can achieve precise deployment by bouncing return trajectories and spin rate control. The irregular shape changes the local normal and tangential directions on the surface. Meanwhile, the gravity perturbation will change the required tangential velocity of bouncing trajectories. These two factors will affect the performance of the deployment method.The feasibility of the proposed deployment method on the whole surface of asteroid Bennu is evaluated. The center of each facet is chosen as the landing site, and we fixed the normal component of the initial landing velocity in the local frame. As the first bouncing return trajectory can always be found by choosing a proper deployment trajectory, we focus on the following bouncing to see whether the trajectories can converge by spin rate control. The initial normal landing velocity is chosen as vs−=0.066m/s. Several sets of surface parameters are selected as follows: I) er=0.5 and μf=0.7; II) er=0.4 and μf=0.7; and III) er=0.3 and μf=0.7. The bouncing condition based on a spherical model is taken as an initial value. Then the differential corrector is applied to find the accurate bouncing trajectory under the polyhedral gravity field. We keep the postimpact normal velocity vni+ constant and only adjust the postimpact tangential velocity vti+ of the bouncing return trajectory in the facet local frame. Figure 19 shows the feasible surface coverage with different parameters. The whole surface is colored. The red region means that the facet is feasible to achieve precise deployment, whereas the cyan region means that the spin rate control cannot meet the required tangential velocity. Blue means that the initial normal velocity is too large that we cannot find bouncing return trajectories in such a region.As can be seen, the feasible region mainly locates at high-latitude regions and the region near the equator. But some areas at the equator have a large radial distance. The initial normal velocity is larger than the maximum radial velocity at the given condition. The middle latitude region of Bennu is hard for landing by the proposed method especially in the northern hemisphere. The feasible region covers about 50.8% of the surface at er=0.4 and μf=0.7. Figure 20 shows two examples of deployment trajectories. Though increasing er will increase the bouncing velocity and the number of bouncing, it provides a large normal impulse, which in turn increases the ability of spin rate control. Therefore, the feasible region enlarges with the increase of er. The feasible region extends to the middle-latitude region. Most polar regions can also achieve precise deployment by spin rate control. The cover rate is about 63.76%. On the contrary, fewer feasible regions exist when er=0.3. The cover rate is only 29.40% and the distribution of the feasible regions is sparse. The change in the coefficient of friction has a similar tendency. The initial landing velocity slightly affects the cover rate because the tangential and normal velocities of a bouncing trajectory increase or decrease simultaneously.Fig. 19 Feasible region of spin rate control on the surface of asteroid Bennu.The results indicate that the proposed deployment method also can be used in the real shape model, but the surface environment of a real asteroid is complicated. However, if the bouncing time is too long, the actual bouncing return trajectory might be greatly different from the reference trajectory in the mass-point model. Both the direction and magnitude of the landing velocity are changed, which may affect the feasibility of the proposed method in certain regions. One needs to choose the landing site and landing velocity carefully before deployment.Fig. 20 Lander deployment by spin rate control in the polyhedron model.Moreover, if we want to land on an elongate asteroid, two differences should be considered. Firstly, the nonspherical gravity perturbation for an elongate asteroid is more obvious. The initial value of the bouncing return trajectory may cause a larger landing error in a real shape model. The bouncing velocity and bouncing time may change a lot. It requires correction to find the accurate bouncing trajectory. Secondly, the radial distance from the center to the surface varies largely. The maximum radial velocity for the bouncing return trajectory is different. If the radial distance is too large, the bouncing trajectory at the same radial velocity may not exist. We need to decrease the radial velocity to find the bouncing trajectory.Even if the spin rate control cannot achieve precise deployment in some regions, we can still find the optimal bouncing trajectories within control and reduce the landing error as much as possible.C. Robustness of Lander Deployment Under Uncertain EnvironmentUsually, the surface parameters are difficult to estimate and may vary in different regions [28]. Therefore, the actual value of surface parameters might deviate from the predicted one, which affects both the control capability of spin rate control and the bouncing conditions. Because the spin rate is determined based on a reference value, the actual bouncing trajectory will cause some landing errors. Moreover, the deployment position and velocity of a lander may not be accurate and result in an initial landing error, which is another factor that affects deployment accuracy. Therefore, it is necessary to see the performance of the proposed deployment method in an uncertain environment.Several kinds of deployment schemes are presented here for comparison: no-control scheme, open-loop control, and zero spin control. For the no-control deployment, the initial spin rate of a lander is set to zero and we will not control its spin rate during deployment. Its spin rate changes naturally at each impact according to Eq. (12). The zero-spin control changes the spin rate of a lander to 0 after each impact, which means that the spin rate at impact is 0. For the open-loop control, the spin rate sequence of a lander before each impact is precalculated based on reference surface parameters and landing velocities. The lander will change its spin rate to a reference value after each impact. If there is no initial landing error and the surface parameters are accurate, the designed spin rate can achieve a precise landing.Firstly, three kinds of deployment schemes are discussed in the ideal spherical model of asteroid Bennu. The periapsis and apoapsis of the deployment trajectory are set as ra=1000  m and rp=186  m. The reference coefficients of friction and restitution are μf=0.3 and er=0.6. The desired landing site is on the equator. Based on the reference parameters and deployment trajectory, the spin rates of the lander before each landing are designed. The nominal deployment trajectory, where no error or uncertainty is considered, requires three times bouncing before settling down with a threshold of 1 mm/s. The actual times of landing may vary due to uncertainty. If the bouncing times are more than three, we also change the spin rate to zero for the following bouncing in the open-loop scheme. The surface parameters are assumed in a normal distribution with standard deviations σμf=0.1 and σer=0.1, and the initial landing error is not considered here. A total of 10,000 Monte Carlo simulations are made. The statistical results of the three kinds of deployment schemes are shown in Table 1.As listed in Table 1, the spin rate control can effectively reduce the mean landing error to less than 10 m from more than 100 m. The dispersion of the landing site is also much smaller. Though the zero-spin scheme has a larger mean error than the no-control scheme, its landing sites are relatively concentrated. Meanwhile, the lander may have a relatively large tangential velocity when its normal velocity is less than the threshold. The no-control scheme may even have a large spin rate. Therefore, we also consider the possible rolling by introducing a rolling resistance Cr=0.04. The rolling dynamics in Ref. [10] is used. The landing error in Table 1 means the total error from the initial landing site to the final settling site, including bouncing and rolling phases. The no-control scheme has the longest rolling distance, and the mean landing error is twice its bouncing distance. Actually, the actual rolling distance on the surface should be much smaller because of the existence of gravel and stones. But the results reflect the tangential velocity and spin rate of a lander when it continually contacts the surface. The rolling distance for the open-loop scheme is small, which means that the final tangential velocity and spin rate of the lander for the open-loop control are generally small except for extreme cases. The rolling distance for the zero-spin scheme mainly results from a large tangential velocity. Figure 21 gives the cumulative probability of bouncing distance for the three deployment schemes. Only 3.8% cases of the no-control scheme have a landing distance less than 10 m. The value reduces to 0.9% for the zero-spin scheme. The percentage increases to 80.5% for the open-loop control. The results in Table 1 and Fig. 21 indicate that the open-loop control scheme can effectively reduce the landing error and narrow the possible landing region.Moreover, an active control scheme is proposed here to further decrease landing error due to uncertainty, in which the spin rate of a lander at each impact is calculated online. We assume that the lander can measure or update its states during deployment. Based on the updated information, it will change its spin rate to find a new bouncing trajectory that jumps back to the desired landing site or decreases the distance error as much as possible. As the surface parameters are hard to estimate based on limited measurements, the reference parameters are applied to calculate a new spin rate. Four kinds of modes are introduced based on different measurements. The simplest one is that the lander only knows the landing error between the landing site and the desired landing site. Then the bouncing trajectory and the required spin rate of the lander are solved by Eqs. (7) and (10) based on the reference landing velocities. The lander can also update its tangential velocity or/and normal velocity relative to the surface for more advanced modes. Table 2 shows the statistical results of the bouncing error and landing error for four schemes. The same surface parameters in previous simulations are used to test the performance of active control.Fig. 21 Cumulative probability of bouncing distance for different deployment schemes.As expected, the active control schemes have smaller mean bouncing errors than the open-loop control, but the dispersion of error is similar. Because the surface parameters are not updated during deployment, the active control scheme may increase the landing error in some cases, but it increases the probability of precise deployment. Figure 22 shows the cumulative probability for different modes. The probability of landing error less than 10 m increases to 89.7% for “Distance and both velocities” mode. “Distance and tangential velocity” and “Distance” modes have nearly the same curves up to distance 50 m. The measurement of tangential velocity mainly reduces the error of extreme conditions. “Distance and radial velocity” mode is better than the above two modes when the bouncing error is larger than 1.6 m. For 90% probability, the bouncing error for “Distance and both velocities,” “Distance and radial velocity,” “Distance and tangential velocity,” and “Distance” modes are 10.4, 12.2, 15.1, and 15.2 m, respectively. This means that the radial velocity might be more useful information than tangential velocity. For comparison, the results for open-loop, zero-spin, and no-control schemes are 16.0, 174.7, and 175.3 m, respectively.If we further consider the initial deployment uncertainty as σra=5  m and σrp=2  m, the bouncing errors for different deployment schemes are shown in Table 3. The bouncing errors for all deployment schemes will increase and become more dispersed. Even the best one has a mean value of about 9 m. But the spin rate control is still useful to improve the deployment accuracy. Figure 23 shows the cumulative probability of different schemes. The landing distance to 90% probability for “Distance and both velocities,” “Distance,” open-loop, and no-control schemes are 25.1, 30.1, 32.0, and 173.3 m. The results indicate that improving the initial release accuracy will largely reduce the final deployment error.Fig. 22 Cumulative probability of bouncing distance for different active control deployment schemes.Finally, we investigate the performance of the proposed deployment method on the polyhedron model of asteroid Bennu. The deployment trajectory has an apoapsis ra=889  m and a periapsis rp=167  m, and its inclination is 28.4°. The initial states and uncertainties in the asteroid-fixed frame are listed in Table 4. The nominal deployment trajectory and distributions of landing sites for no-control, open-loop, and active control (“Distance and both velocities” mode) schemes are shown in Fig. 24. Here we only consider the bouncing distance. As can be seen, the no-control scheme causes dispersive landing sites. The mean error is 175.4 m. The landing sites of the open-loop scheme concentrate around the nominal value. The mean error is 34.9 m. Most of the landing sites of the active control scheme are located in a narrow strip extending from the desired landing site to the equator. This means that the active control can eliminate the error along longitude, but the spin rate control may not provide enough velocity to reduce the error along latitude. The mean value of deployment error is 22.4 m. Though landing errors increase in a real shape model, the spin rate control method is still much better than the no-control scheme. If we can better estimate the surface parameters or deploy a lander with a low landing velocity, the error could be further reduced.Fig. 23 Cumulative probability of bouncing distance for different deployment schemes with initial errors.The simulations show that lander deployment by bouncing return trajectories and spin rate control is still effective under uncertain surface environment. Even the open-loop control scheme can reduce the deployment error by 85%. The accuracy of deployment can be further improved by active control schemes based on updated information. The feasibility of the proposed deployment method is verified on both an ideal spherical model and the polyhedron model of asteroid Bennu. Further studies will discuss its performance and control scheme on a high-fidelity surface model.Fig. 24 Distributions of landing sites on the surface of Bennu with different deployment schemes.VI. ConclusionsIn this paper, the bouncing return trajectory for precise lander deployment to asteroids is proposed. The accuracy of deployment is increased by controlling the spin rate of a lander at impact such that the lander can be driven into a bouncing return trajectory and land at the same impact site. The properties of bouncing return trajectories are investigated at different landing latitudes and characteristic spin rates of asteroids. Based on contact dynamics, the spin rate control to change bouncing velocity is analyzed, and the analytical solution is derived. A novel deployment method via bouncing return trajectories is presented, and the candidate deployment trajectories are discussed. Finally, the feasibility and robustness of the proposed method are verified on a spherical and polyhedron models of asteroid Bennu. The feasible region on the surface of the polyhedron model is obtained. Active control schemes are proposed to improve deployment accuracy in an uncertain environment. It is found that the proposed deployment method can significantly improve the landing accuracy with or without environment uncertainty, which provides a reference for future lander deployment and surface motion design in asteroid missions.AcknowledgmentsThis work was supported by the National Natural Science Foundation of China (Grant Nos. 12002028 and 51827806), Beijing Institute of Technology Research Fund Program for Young Scholars, China Postdoctoral Science Foundation–funded project (Grant No. 2019QT0038), and the Discipline Innovative Engineering Plan (111 Project).\r            References\r        [1] Yoshimitsu T., Kubota T. and Nakatani I., “MINERVARover Became a Small Artificial Solar Satellite,” 20th Annual AIAA/USU Conference on Small Satellite, AIAA/USU, 2006, Paper SSC06-IV-4. Google Scholar[2] Ulamec S., Espinasse S., Feuerbacher B., Hilchenbach M., Moura D., Rosenbauer H., Scheuerle H. and Willnecker R., “Rosetta Lander–Philae: Implications of an Alternative Mission,” Acta Astronautica, Vol. 58, No. 8, 2006, pp. 435–441. https://doi.org/10.1016/j.actaastro.2005.12.009 CrossrefGoogle Scholar[3] Biele J., Ulamec S., Maibaum M., Roll R., Witte L., Jurado E., Muñoz P., Arnold W., Auster H.-U., Casas C. and Faber C., “The Landing (s) of Philae and Inferences About Comet Surface Mechanical Properties,” Science, Vol. 349, No. 6247, 2015, Paper aaa9816. https://doi.org/10.1126/science.aaa9816 Google Scholar[4] Ho T.-M., Baturkin V., Grimm C., Grundmann J. T., Hobbie C., Ksenik E., Lange C., Sasaki K., Schlotterer M., Talapina M. and Termtanasombat N., “MASCOT—The Mobile Asteroid Surface Scout Onboard the HAYABUSA2 Mission,” Space Science Reviews, Vol. 208, Nos. 1–4, 2017, pp. 339–374. https://doi.org/10.1007/s11214-016-0251-6 CrossrefGoogle Scholar[5] Sugano R., Narumi T., Uyama N., Kimura S., Wada K., Nagaoka K. and Yohida K., “Development of a Very Small High-Performance Image Acquisition System for Asteroid Exploration Rover MINERVA-I12,” 65th International Astronautical Congress 2014, International Astronautical Federation, Toronto, 2014, pp. 6702–6708. Google Scholar[6] Jurado E., Martin T., Canalias E., Blazquez A., Garmier R., Ceolin T., Gaudon P., Delmas C., Biele J., Ulamec S. and Remetean E., “Rosetta Lander Philae: Flight Dynamics Analyses for Landing Site Selection and Post-Landing Operations,” Acta Astronautica, Vol. 125, Aug. 2016, pp. 65–79. https://doi.org/10.1016/j.actaastro.2016.03.030 CrossrefGoogle Scholar[7] Boehnhardt H., Bibring J.-P., Apathy I., Auster H. U., Ercoli Finzi A., Goesmann F., Klingelhöfer G., Knapmeyer M., Kofman W., Krüger H. and Mottola S., “The Philae Lander Mission and Science Overview,” Philosophical Transactions of the Royal Society of London, Series A: Mathematical and Physical Sciences, Vol. 375, No. 2097, 2017, Paper 20160248. https://doi.org/10.1098/rsta.2016.0248 Google Scholar[8] Jaumann R., Schmitz N., Ho T.-M., Schröder S., Otto K. A., Stephan K., Elgner S., Krohn K., Preusker F., Scholten F. and Biele J., “Images from the Surface of Asteroid Ryugu Show Rocks Similar to Carbonaceous Chondrite Meteorites,” Science, Vol. 365, No. 6455, 2019, pp. 817–820. https://doi.org/10.1126/science.aaw8627 Google Scholar[9] Sawai S., Kawaguchi J., Scheeres D. J., Yoshizawa N. and Ogasawara M., “Development of a Target Marker for Landing on Asteroids,” Journal of Spacecraft and Rockets, Vol. 38, No. 4, 2001, pp. 601–608. https://doi.org/10.2514/2.3723 LinkGoogle Scholar[10] Tardivel S., Scheeres D. J., Michel P., Van Wal S. and Sánchez P., “Contact Motion on Surface of Asteroid,” Journal of Spacecraft and Rockets, Vol. 51, No. 6, 2014, pp. 1857–1871. https://doi.org/10.2514/1.A32939 LinkGoogle Scholar[11] Van Wal S., Tsuda Y., Yoshikawa K., Miura A., Tanaka S. and Scheeres D. J., “Prearrival Deployment Analysis of Rovers on Hayabusa2 Asteroid Explorer,” Journal of Spacecraft and Rockets, Vol. 55, No. 4, 2018, pp. 797–817. https://doi.org/10.2514/1.A34157 LinkGoogle Scholar[12] Van Wal S., “High-Fidelity Simulation of Small-Body Lander/Rover Spacecraft,” Ph.D. Thesis,  Univ. of Colorado, Boulder, CO, 2018. Google Scholar[13] Van Wal S., Tardivel S. and Scheeres D. J., “Parametric Study of Ballistic Lander Deployment to Small Bodies,” Journal of Spacecraft and Rockets, Vol. 54, No. 6, 2017, pp. 1330–1355. https://doi.org/10.2514/1.A33832 LinkGoogle Scholar[14] Van Wal S., Reid R. G. and Scheeres D. J., “Simulation of Nonspherical Asteroid Landers: Contact Modeling and Shape Effects on Bouncing,” Journal of Spacecraft and Rockets, Vol. 57, No. 1, 2020, pp. 109–130. https://doi.org/10.2514/1.A34573 LinkGoogle Scholar[15] Tardivel S. and Scheeres D. J., “Ballistic Deployment of Science Packages on Binary Asteroids,” Journal of Guidance, Control, and Dynamics, Vol. 36, No. 3, 2013, pp. 700–709. https://doi.org/10.2514/1.59106 LinkGoogle Scholar[16] Çelik O. and Sánchez J. P., “Opportunities for Ballistic Soft Landing in Binary Asteroids,” Journal of Guidance, Control, and Dynamics, Vol. 40, No. 6, 2017, pp. 1390–1402. https://doi.org/10.2514/1.G002181 LinkGoogle Scholar[17] Çelik O., Baresi N., Ballouz R.-L., Ogawa K., Wada K. and Kawakatsu Y., “Ballistic Deployment from Quasi-Satellite Orbits Around Phobos Under Realistic Dynamical and Surface Environment Constraints,” Planetary and Space Science, Vol. 178, Nov. 2019, Paper 104693. https://doi.org/10.1016/j.pss.2019.06.010 Google Scholar[18] Wen T., Zeng X., Circi C. and Gao Y., “Hop Reachable Domain on Irregularly Shaped Asteroids,” Journal of Guidance, Control, and Dynamics, Vol. 43, No. 7, 2020, pp. 1–15. https://doi.org/10.2514/1.G004682 Google Scholar[19] Li X., Sanyal A. K., Warier R. R. and Qiao D., “Landing of Hopping Rovers on Irregularly-Shaped Small Bodies Using Attitude Control,” Advances in Space Research, Vol. 65, No. 11, 2020, pp. 2674–2691. https://doi.org/10.1016/j.asr.2020.02.029 CrossrefGoogle Scholar[20] Dong C., Yang H., Li S. and Liu X., “Effects of Solar Radiation Pressure on Asteroid Surface Hopping Transfers for High Area/Mass Ratio Rovers,” Research in Astronomy and Astrophysics, Vol. 21, No. 6, 2021, Paper 146. Google Scholar[21] Thuillet F., Michel P., Maurel C., Ballouz R.-L., Zhang Y., Richardson D. C., Biele J., Tatsumi E. and Sugita S., “Numerical Modeling of Lander Interaction with a Low-Gravity Asteroid Regolith Surface—Application to MASCOT on Board Hayabusa2,” Astronomy and Astrophysics, Vol. 615, July 2018, Paper A41. https://doi.org/10.1051/0004-6361/201832779 Google Scholar[22] Sunday C., Murdoch N., Tardivel S., Schwartz S. R. and Michel P., “Validating N-Body Code CHRONO for Granular DEM Simulations in Reduced-Gravity Environments,” Monthly Notices of the Royal Astronomical Society, Vol. 498, No. 1, 2020, pp. 1062–1079. https://doi.org/10.1093/mnras/staa2454 Google Scholar[23] Jia Y. and Wang F., “Analysis and Computation of Two Body Impact in Three Dimensions,” Journal of Computational and Nonlinear Dynamics, Vol. 12, No. 4, 2017, Paper 041012. https://doi.org/10.1115/1.4035411 Google Scholar[24] Stronge W. J., Impact Mechanics, Cambridge Univ. Press, Cambridge, England, U.K., 2018, p. 28. Google Scholar[25] Hamilton D. P. and Burns J. A., “Orbital Stability Zones About Asteroids: II. The Destabilizing Effects of Eccentric Orbits and of Solar Radiation,” Icarus, Vol. 96, No. 1, 1992, pp. 43–64. https://doi.org/10.1016/0019-1035(92)90005-R CrossrefGoogle Scholar[26] Chesley S. R., Farnocchia D., Nolan M. C., Vokrouhlicky D., Chodas P. W., Milani A., Spoto F., Rozitis B., Benner L. A., Bottke W. F. and Busch M. W., “Orbit and Bulk Density of the OSIRIS-REx Target Asteroid (101955) Bennu,” Icarus, Vol. 235, June 2014, pp. 5–22. https://doi.org/10.1016/j.icarus.2014.02.020 CrossrefGoogle Scholar[27] Nolan M. C., Magri C., Howell E. S., Benner L. A., Giorgini J. D., Hergenrother C. W., Hudson R. S., Lauretta D. S., Margot J.-L., Ostro S. J. and Scheeres D. J., “Shape Model and Surface Properties of the OSIRIS-REx Target Asteroid (101955) Bennu from Radar and Lightcurve Observations,” Icarus, Vol. 226, No. 1, 2013, pp. 629–640. https://doi.org/10.1016/j.icarus.2013.05.028 CrossrefGoogle Scholar[28] Yano H., Kubota T., Miyamoto H., Okada T., Scheeres D., Takagi Y., Yoshida K., Abe M., Abe S., Barnouin-Jha O. and Fujiwara A., “Touchdown of the Hayabusa Spacecraft at the Muses Sea on Itokawa,” Science, Vol. 312, No. 5778, 2006, pp. 1350–1353. https://doi.org/10.1126/science.1126164 CrossrefGoogle Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "New Solar-Sail Orbits for Polar Observation of the Earth and Moon",
        "url": "https://arc.aiaa.org/doi/10.2514/1.G005955",
        "date": "20210916",
        "content": "AbstractIn this paper, a new family of solar-sail periodic orbits with adequate properties for polar observation of the Earth and moon is developed under the simplified but nonautonomous dynamics of the solar-sail augmented Earth–moon circular restricted three-body problem. The novel orbits, termed “distant-circular orbits,” are found through differential correction and continuation and employ a simple sun-facing steering law for the solar sail. A basic coverage analysis shows that one of the distant-circular orbits is capable of providing continuous coverage of both the Earth’s and lunar north (or south) poles with just a single sailcraft at a minimum elevation angle of 14 deg and an average range of six Earth–moon distances. Moreover, simple transfer trajectories between orbits of the family are found, so that the sailcraft can switch between observing the northern and southern latitudes of the Earth and moon during a single mission. Subsequently, using multiple-shooting differential correction, all results are migrated to a higher-fidelity dynamic framework that considers, among others, the eccentricity of the moon’s orbit. The perturbations cause the periodicity of the orbits to break, turning them into seemingly quasi-periodic orbits, but it is shown that the coverage capabilities are maintained. Finally, an active control strategy is developed to counteract part of the perturbing effects such that, by appropriately steering the sail, the apparent quasi-periodicity of the orbits is enhanced and the deviation from the unperturbed orbits is reduced.I. IntroductionOver recent years, solar-sail propulsion has developed from a theoretical concept to a flight proven form of low-thrust propulsion. In 2010, the Japan Aerospace Exploration Agency was the first to prove the viability of solar sailing with its sailcraft IKAROS [1]. Also that year, NASA launched NanoSail-D2, a CubeSat technology demonstration mission that successfully validated the concept of solar-sail propulsion for small satellite platforms [2]. In later years, the Planetary Society launched LightSail-1 (2015) and LightSail-2 (2019), the last one effectively using the sail to raise the apogee of its orbit around Earth [3,4]. With NASA’s NEA Scout [5] and Solar Cruiser [6] missions on the horizon, it seems that solar-sail technology will continue to mature and enable many scientific missions otherwise unachievable with conventional propulsion [7].A solar sail can be considered a large thin mirror-like surface that reflects sunlight. The solar photons exchange their momentum upon interaction with the sail membrane, which induces a small thrust directed mainly perpendicular to the surface of the sail [8]. Although the solar-sail induced acceleration is almost negligible in magnitude, this new form of low-thrust space propulsion has been theoretically proven to outperform conventional propulsion systems reliant on an on-board reaction mass for a range of high-energy and long-duration missions [7]. For instance, solar sails can be used to accelerate a spacecraft to the outer rim of the solar system [9] or to increase the energy of an impactor aimed to deviate a threatening asteroid [10]. Because solar-sail propulsion does not require propellant, the only constraint on the duration of the mission is the lifetime of the sail film as it degrades in the harsh space environment [11].The bulk of research related to the orbital dynamics and mission design of solar-sail propelled spacecraft focuses on the sun–Earth system. One example is the pole-sitter concept that places a solar sail around the polar axis of the Earth so that one sailcraft is capable of providing continuous coverage of the polar regions [12,13]. The pole-sitter concept is designed in the sun–Earth circular restricted three-body problem (CR3BP), augmented with the solar-sail acceleration. As an alternative, several studies have shown the potential of solar-sail periodic orbits in the Earth–moon system for coverage of the high latitudes of either the Earth or moon [14–17]. Despite the nonautonomous nature of the solar-sail augmented Earth–moon system, rich families of solar-sail periodic orbits exist. In [14], the authors extend a range of traditional families of libration-point orbits with solar-sail propulsion whose applications are further investigated in [15], where different constellations of two sailcraft in so-called clover-shaped orbits and vertical Lyapunov orbits are designed for continuous observation of the high latitudes of the Earth and moon. Finally, Wawrzyniak and Howell [16] and Ozimek et al. [17] present an extensive numerical study into solar-sail orbits specifically for lunar south pole coverage using only a single sailcraft. In this paper, we develop a new family of solar-sail displaced orbits, termed “distant-circular orbits” (DC orbits), for the purpose of polar coverage of the Earth and moon. Similar to the pole-sitter concept and the work in [16,17], the DC orbits require only one sailcraft for continuous coverage of either the Earth or lunar pole. However, compared with the pole-sitter concept, the DC orbits allow the spacecraft to be positioned closer to the Earth and moon, hence improving the spatial resolution of the observations; compared with the orbits proposed in [16,17], the DC orbits present a more realistic mission scenario as they rely on much more near-term solar-sail technology. Requiring only one sailcraft is the main advantage of DC orbits compared with the clover-shaped and vertical Lypaunov orbit constellations proposed in [15], though at greater orbital distances. The DC orbits therefore present a new tradeoff solution in terms of spatial resolution and number of spacecraft required, sitting midway of the pole-sitter and the constellations in [15].Like all mission concepts presented in [12,13,15–17], the DC orbits only allow the observation of one of the poles of the Earth and moon at any time. To increase the mission scientific return, we investigate novel transfers between DC orbits above and below the Earth–moon orbital plane. Such transfers give a sole sailcraft the capability of observing both the northern and southern latitudes of the Earth and/or moon during a single mission.An additional novel contribution of this paper comes in the form of an active control strategy to counteract a range of perturbations not considered in the CR3BP without the need for propulsion methods other than the solar sail. Most of the solar-sail periodic orbits found in the solar-sail augmented Earth–moon three-body system rely on four fundamental simplifications that assume the following to be zero: the eccentricity of the moon’s orbit, the plane offset between the Earth–moon orbital plane and the ecliptic, the sun’s gravitational perturbation, and the heliocentric eccentricity of the orbit of the Earth–moon system (EMS) barycenter [15]. When relaxed, these simplifications cause perturbations that impair periodicity and often induce significant deviations from the designed orbits. In the works mentioned above, the authors repeatedly suggest the necessity for an active control strategy to palliate these effects especially considering the inherent linear instability of all developed orbits. In this paper, we develop such an active control strategy in the form of a weight-optimized multiple shooting algorithm.The remainder of this paper is organized as follows: First, Sec. II summarizes the low- and high-fidelity dynamic models used throughout the work. Subsequently, Sec. III presents the newly developed family of distant-circular orbits in the low-fidelity dynamic framework (the reference orbits) together with a discussion on their performance in terms of coverage of the Earth’s and lunar poles. Then, Sec. IV develops a multiple-shooter differential correction scheme to modify the reference orbits so that they hold under the higher fidelity dynamics but using the reference control. Section V repeats the latter process but allows for active control to reduce the deviations from the reference orbits. Finally, Sec. VI presents feasible transfers between distant-circular orbits above and below the Earth–moon plane to further increase the scientific return of this new mission concept.II. Dynamic SystemThroughout this section the parameters and notation in Table 1 are used to describe the geometry and motion of the moon with respect to the Earth and that of the EMS barycenter around the sun. Note that the values in Table 1 are the exact values used in the computations. In this study, we assume that the moon follows an unperturbed ellipse described by the mean values a, e, n, and ioff, which restricts the validity of the analyses in this paper to a time-scale of approximately one year. The next subsections present the three dynamic frameworks used to model the EMS and the equations of motion (EoM) of the solar sail.A. Dynamic FrameworksThroughout this work we employ three dynamic frameworks to describe the motion of the solar sail. They are all based on the solar-sail CR3BP but are of increasing fidelity by adding different perturbative effects. Figure 1a sorts the dynamic frameworks from simple to more complex from left to right and gives the dynamic parameters that are active in each case. As a starting point, the simplest mathematical representation that captures the essence of the dynamics is the solar-sail CR3BP, where the Earth and moon revolve around their common center of mass in circular orbits and the gravitational influence of the sailcraft on the two main bodies is neglected; this approximation discards all external dynamic effects [8]. Moreover, the sun’s apparent motion is reduced to a clockwise circular orbit around the barycenter that lies within the Earth–moon orbital plane and has a radius ah and a dimensionless angular velocity of Ω4=1−nh/n=0.9252 (see Fig. 1b). The next step on the complexity scale is the solar-sail sun-gravity CR3BP (SgC) (see again Fig. 1a). Maintaining all the assumptions of the solar-sail CR3BP, the sun’s gravitational attraction μ4 is added to the dynamics as a fourth-body acceleration on the sailcraft. Next, the introduction of the eccentricity of the moon’s orbit (e) yields the solar-sail sun-gravity elliptical restricted three-body problem (SgE). In this framework, the circular motion of the primaries is substituted by Keplerian ellipses, which are entirely described by the two-body problem formulation. Note that, in this dynamic model, the sun’s apparent angular velocity becomes time dependent because the rotation of the EMS in no longer constant. Finally, the high-fidelity (HF) framework adds two further dynamic effects to the SgE: the eccentricity of the EMS orbit around the sun (eh), and the plane offset between the EMS orbital plane and the ecliptic plane (ioff). Despite the increased fidelity, this framework still assumes that the orbit of the moon is a nonperturbed Keplerian orbit.In addition to the parameters considered in each dynamic framework, Fig. 1a also provides the name convention for the orbits that hold under each particular model. The orbits in the SgC framework will act as reference. The e-corrected orbits in the SgE framework are only corrected for the eccentricity of the orbit of the moon, using the solar-sail control law of the reference orbits. The natural orbits of the HF framework also use the control law of the reference orbits, whereas the controlled orbits employ active control to counter the perturbations. Finally, the controlled orbits are further divided into two categories, depending on how the control law is calculated (see Sec. V for further details).Fig. 1 Schematics of a) the dynamic frameworks and orbit types considered in this paper, and b) the sun’s apparent motion around the EMS barycenter (adapted from [15]).No matter which dynamic framework is used, all trajectory propagations start from the same initial state (see Fig. 2a). At the initial time (t=0), the sun is positioned along the Earth–moon line with the Earth between the sun and moon, the Earth is at perihelion and the moon at perigee. Furthermore, for the HF model, the EMS plane is tilted with respect to the ecliptic at an angle ioff so that the Earth is above the ecliptic at the initial state, whereas the moon is below the ecliptic (see Fig. 2a).Fig. 2 Schematics of a) the initial and general configuration of the EMS, and b) the vectors that define the sun’s gravitational perturbation (extracted from [15]).B. Equations of MotionThe differential equations governing the motion of the solar sail are formulated in the HF dynamic framework. By setting certain parameters to zero (see Fig. 1a) it is possible to switch to all the other frameworks discussed in the previous subsection. The following formulation is based on the work in [15] with one major difference: the eccentricity of the moon is not included via pulsating coordinates commonly employed in the elliptical restricted three-body problem, where an independent variable change from time to true anomaly is performed so that the EoM adopt a more manageable form [19]. Even though the EoM in pulsating coordinates are more compact, the physical meaning of the velocities and accelerations is lost. Hence, the nonuniformly corotating reference frame C(x^,y^,z^), centered in the EMS barycenter (see Fig. 3a), is used to express the solar-sail state vector and its derivatives as a function of time. The x^ axis coincides with the line connecting the two primaries in their elliptical motion around the barycenter and points toward the moon, the z^ axis is aligned with the angular momentum vector of the EMS, and the y^ axis completes the right-handed triad. Traditional canonical units are used to scale the variables so that the inverse of the mean motion of the moon’s orbit (n) is the unit of time, the semimajor axis of the moon’s orbit (a) is the unit of length and the total mass of the EMS is the unit of mass. In reference frame C, the solar-sail dynamics are described by dXdt=f(X,u,t)(1)where X=[rr˙]⊺ is the solar-sail state vector (position and velocity), f=[r˙r¨]⊺ its derivative with respect to time (velocity and acceleration), and u represents the control law.The solar-sail position vector expressed in C is r=[xyz]⊺, and its second-order derivative with respect to time equals r¨=arot+aE+aM+a4+as(2)where arot represents the rotational term associated with the nonuniform rotation of C; aE and aM represent the gravitational acceleration induced by the Earth and moon, respectively; a4 represents the sun’s gravitational perturbation; and as represents the solar-sail acceleration due to the solar radiation pressure acting on the sail. Hereafter, we elaborate on the precise formulation of each of these terms.Fig. 3 Schematics of a) the reference frame C(x^, y^, z^) (adapted from [15]), and b) the reference frame S(S^, p^, l^) with a definition of the attitude angles of the solar sail.1. Rotational TermWhen expanded, the rotational term reads as arot=−(2ω×r˙+α×r+ω×(ω×r))(3)where ω=θ˙z^ and α=θ¨z^ represent the vectors of angular velocity and angular acceleration of C. The magnitudes of these vectors are equal to the first- and second-order derivatives of the moon’s true anomaly (θ) when viewed from Earth. Referring to the two-body problem formulation, these derivatives can be written in terms of θ as follows [20]: θ˙=(1+ecosθ)2(1−e2)3/2(4)θ¨=−2θ˙2esinθ1+ecosθ(5)where e is the eccentricity of the moon (see Table 1).2. Gravitational Acceleration Induced by the Earth and MoonThe Earth and moon gravitational terms expand as aE=−(1−μ)r1r13(6)aM=−μr2r23(7)where μ is the dimensionless mass of the moon (see Table 1). Note that the position vectors of the sailcraft relative to the primaries r1=[x+μLyz]⊺ and r2=[x−(1−μL)yz]⊺ contain the term L, which accounts for the varying distance between the primaries on their elliptical orbits around the barycenter [19]: L=1−e21+ecosθ(8)Hence, the primaries seem to wobble around an equilibrium position along the x^ axis as time progresses. In accordance with the chosen initial condition (see Fig. 2a), L is minimum at the initial time.3. Gravitational Acceleration Induced by the SunThe gravitational effect of the sun is introduced as a fourth-body acceleration [15]: a4=μ4(rs4rs43−r4r43)(9)where μ4 is the dimensionless mass of the sun (see Table 1), r4 is the Earth–sun vector, and rs4=r4−r is the sun-sail vector (see Fig. 2b). To define r4, we introduce the unit vector S^, which is aligned with the direction of sunlight (see Figs. 1b and 2). The following sequence of rotations yields the Cartesian coordinates of S^ in the reference frame C [15]: S^=Rz(−θ)Ry(−ioff)Rz(θh)[100](10)where Rz(θh) accounts for the motion of the barycenter around the sun, Ry(−ioff) for the offset between the EMS and ecliptic planes, and Rz(−θ) for the rotation of C within the orbital plane of the EMS (see Fig. 2a). Then, r4 can be expressed as [15] r4=−aha1−eh21+ehcosθhS^(11)where ah, eh, and θh are the semimajor axis, eccentricity, and true anomaly of the barycenter’s heliocentric orbit (see Table 1).4. Solar-Sail AccelerationIn this study, we neglect all optical and geometrical imperfections of the sail membrane and adopt the ideal solar-sail acceleration model. The ideal model assumes pure specular reflection of the incoming photons, causing the solar-sail acceleration vector to act perpendicular to the sail [15]: as=a0(ahr4)2(S^⋅n^)2n^(12)where a0 is the solar-sail characteristic acceleration and n^ is the unit vector normal to the sail membrane. The quantity a0 is defined as the magnitude of the solar-sail acceleration when the sail is placed perpendicular to the incoming sunlight (i.e., S^ and n^ are parallel) at one astronomical unit from the sun. Hence, a0 depends on the solar radiation pressure at one astronomical unit, the effective area of the sail membrane, and the spacecraft mass [8]. For this study we assume a feasible near-term value for a0 of 0.3  mm/s2 (i.e., approximately 0.1 in dimensionless units) for the generation of the reference orbits [7,21]. In Eq. (12), the term (ah/r4)2 scales a0 to account for variations in the heliocentric radial distance due to eh. This scaling is required because, in the HF framework, the distance between the sun and the EMS barycenter is no longer constant at one astronomical unit, which changes the solar radiation pressure experienced at the EMS barycenter. Finally, note that Eq. (12) neglects the variation in as due to the motion of the solar sail within the EMS; i.e., we assume that the solar radiation pressure is constant throughout the EMS.In this paper, the solar-sail acceleration is controlled by two angles (which uniquely define the orientation of n^) and by a variation in a0 around its reference value of 0.3  mm/s2. We can then write the control law as u=[γφa0]⊺, where the angles γ and φ are defined in Fig. 3b. The angles are bounded to the interval [−90,90]  deg, such that the back of the sail membrane is never exposed to the sun. Also note that by defining the bounds on the angles as such, ambiguity in the angles is avoided. The orthogonal reference frame employed to define γ and φ (see Fig. 3b), S(S^,p^,l^), is centered at the solar sail, where the S^ axis matches the sun-sail line (i.e., the S^ vector), the p^ axis is contained in the ecliptic plane, and the l^ axis is aligned with the ecliptic north pole. To better understand the possible orientations of as within frame S, it is useful to introduce the concept of the acceleration bubble. The acceleration bubble is an imaginary bubble-shaped surface in the frame S that contains all feasible as vectors [22]. Figure 4a depicts an schematic of this acceleration bubble. The shown vector as in Fig. 4a is the largest (in magnitude) achievable solar-sail acceleration vector, for which the sail is placed perpendicular to the direction of sunlight. Figure 4b shows a side view of the acceleration bubble along the p^ axis. As an example, it includes two solar-sail acceleration vectors: one feasible and one unfeasible acceleration vector. The vector that extends up to the bubble surface is feasible; the one that extends beyond it is unfeasible unless the performance of the sail (a0) is increased. Indeed, the size of the bubble depends on the reference performance of the sail a0. Hence, varying a0 around the reference value modifies the size of the acceleration bubble (i.e., we can change the magnitude of the solar-sail acceleration for a given orientation), further increasing the control authority of the solar sail. However, note that, no matter how much a0 is increased, the sail cannot generate an acceleration component toward the sun (i.e., along the negative S^ axis).Variations in a0 may be achieved with a heliogyro-type solar sail or a fixed-shape sail equipped with reflectivity control devices (RCDs). The heliogyro sail configuration resembles the rotor of a helicopter: the sail membrane is divided into several long slender blades that are deployed and maintained by spinning the sailcraft. Contrary to the fixed-shape sail, these blades can be independently pitched with respect to the incoming sunlight, which, in theory, grants the heliogyro more control authority [23]. The RCDs are thin devices that are attached to the sail membrane [1] and can change their reflectivity upon electric excitation [24]. The RCDs enable variations in both a0 and the orientation of the solar-sail acceleration vector [25]. However, both the heliogyro-type sail and the use of RCDs can only enable a downscaling of a0: the heliogyro configuration can downscale a0 all the way down to zero, effectively switching the sail off, whereas RCDs can only downscale a0 to a certain value, which depends on the percentage of the sail surface covered with RCDs.Fig. 4 Schematics of a) the acceleration bubble of the reference solar sail, and b) side view indicating feasible and unfeasible as vectors.In this investigation, due to the distance of the EMS from the sun, we assume that the direction of sunlight remains parallel to the ecliptic even when the sailcraft moves out of the ecliptic. As we will see, the maximum out-of-plane displacement of the DC orbits is approximately four Earth–moon (EM) distances. If we neglect ioff, the angle between the sun-sail line and the ecliptic when the solar sail is at its maximum out-of-plane distance is approximately 0.6 deg, which yields an error in the solar-sail acceleration of 0.01%. Thus, it is justified to assume that the l^ axis remains parallel to the ecliptic north pole no matter where the solar sail is within the EMS. Therefore, with the definition of γ and φ as in Fig. 3b, the solar-sail acceleration in frame S can be derived as as|S=a0(ahr4)2(cosγcosφ)2[cosγcosφcosγsinφsinγ](13)To substitute Eq. (13) into Eq. (2), we need to express as in frame C. This transformation is obtained by means of the same sequence of rotations introduced in Eq. (10): as=Rz(−θ)Ry(−ioff)Rz(θh)as|S(14)Recall that Rz(θh) accounts for the motion of the barycenter around the sun, Ry(−ioff) for the offset between the EMS and ecliptic planes, and Rz(−θ) for the rotation of C within the orbital plane of the EMS.C. True Anomalies of the Earth and MoonTo numerically integrate Eq. (1), expressions for θ and θh are needed as Eqs. (4), (5), (8), (10), and (11) explicitly depend on θ, θh, or both. A direct relation between θh and the dimensionless time t does not exist. However, the heliocentric orbit of the EMS barycenter is a Keplerian ellipse that obeys the equations of the two-body problem. Therefore, solving Kepler’s equation at every integration step provides θh as a function of time [20]. To do so, the mean anomaly Mh is required, which is computed by retrieving the dimensional time (t*=t/n) and multiplying by the mean motion of the barycenter’s heliocentric orbit (Mh=nht*).Mh=Eh−ehsinEh(15)θh=2tan−1[1+eh1−ehtan(Eh2)](16)At every integration step, Eq. (15) is numerically solved for the eccentric anomaly Eh, after which Eq. (16) is employed to obtain θh. Because we are not interested in the values of the angles themselves (i.e., we only use them to evaluate trigonometric functions), the proposed methodology does not require any kind of quadrant check or test for ambiguity in the angles.Given that the orbit of the moon has been modeled as a Keplerian ellipse as well, a similar procedure can be used to compute θ from t. Notice that the dimensionless time directly represents the mean anomaly of the moon’s orbit (M) since t=nt*. However, dealing with two nonlinear equations at every integration step is computationally expensive. We therefore consider the expanded state vector X˜=[rr˙θ]⊺. Its expanded derivative f˜ can be constructed with Eq. (4), inasmuch as it provides the relationship θ˙ as a function of θ. In this way, we trade one nonlinear equation for one extra first-order differential equation; numerical integration of the expanded state [with the extra initial condition θ(0)=0] then provides θ at every integration step.III. Distant-Circular Orbit FamilyThis section derives the novel family of DC solar-sail periodic orbits in the low-fidelity SgC dynamic framework (i.e., the reference orbits in Fig. 1a). It also presents a basic coverage analysis of these new orbits for observation of the poles of the Earth and moon as well as a qualitative discussion concerning the dynamic perturbations that arise in the HF dynamic framework.A. Periodicity and Symmetry ConditionsFirst of all, let us review the periodicity and symmetry conditions that must be respected to allow for solar-sail periodic orbits to exist in the EMS. For the sake of clarity, we base the following discussion on the simplest dynamic framework, the solar-sail CR3BP. The apparent motion of the sun around the barycenter (see Fig. 1b) introduces a time dependency in the EoM, which requires all periodic solar-sail orbits to have a period commensurable with the synodic lunar month (2π/Ω4). Concerning the symmetry, the dynamics of the traditional CR3BP are symmetric with respect to both the (x, z) plane and the (x, y) plane [26]. The introduction of the solar-sail acceleration can break the (x, y)-plane symmetry when an out-of-plane component of the solar-sail acceleration is applied, which is the case for the DC orbits. However, the (x, z)-plane symmetry has to be respected, so that the accumulated effect of the solar-sail acceleration after one orbit revolution is zero (i.e., the time variation of the energy of the orbit must be periodic). Thus, the control law must be symmetric with respect to the initial sun-sail line (i.e., the x^ axis) as well as periodic with a period commensurable with 2π/Ω4 [14]. To this end, the DC orbits employ a simple control law in which the attitude of the solar sail is kept constant with respect to the incoming sunlight, though pitched in the out-of-plane direction (i.e., uDC=[γ00.1]⊺ and u˙DC=0).Symmetrical periodic solar-sail orbits with a constant control law do not exist for dynamic frameworks more complex than the SgC framework. The SgC framework differs from the solar-sail CR3BP only in the sun’s gravitational perturbation. Since a4 is defined through S^, it is a periodic perturbation and does not break the symmetry conditions. Conversely, in both the SgE and HF frameworks, nonperiodic asymmetrical perturbations arise that, if not counteracted, forbid periodic motion. Consider, for example, the addition of the eccentricity of the moon’s orbit (i.e., the SgC→SgE migration). Despite the fact that the motion of the moon is periodic and symmetric with respect to the (x, z) plane, its perturbation over an orbit of period 2π/Ω4 is not, because the synodic and sidereal months are noncommensurable; when the solar sail completes one orbit, the dynamics do not return to the same initial condition (i.e., the moon is not at perigee). The SgC is therefore taken as the reference dynamic framework in which the reference DC orbits are computed.B. Generation of the Distant-Circular Orbit FamilyFollowing the approach in [14], we start from a classical CR3BP orbit with a suitable period, which in this case is a circular orbit confined to the (x, y) plane with r∼5.6, period 2π/Ω4, and γ=90  deg (i.e., the sail is deactivated as it is parallel to the direction of sunlight). We choose the crossing of this orbit with the (x, z) plane either along the negative (left) x^ axis or positive (right) x^ axis as initial condition. Table 2 shows the numerical value of the left and right initial conditions of the classical orbit. The initial position (x, y, y) and velocity (x˙,y˙,z˙) components are given, as well as the γ angle. Note that both initial conditions are part of the same classical orbit. Then, we use a differential corrector scheme in parallel with a slow continuation of the sun’s parameter μ4 to migrate the classical orbit to the SgC dynamic framework (i.e., a CR3BP→SgC migration without solar-sail acceleration). The differential corrector iteratively adjusts the initial conditions so that a new periodic orbit is found that holds for an ever-increasing value for μ4. At the end of the process, the parameter μ4 is fully introduced and the new orbit holds in the SgC dynamic framework. The precise formulation of the corrector is omitted here for brevity, but can be found in [14]. Figure 5a depicts the continuation process. The outer orbit (dark red orbit) is the classical orbit in the CR3BP framework. As μ4 is increased, the orbit moves inward to counteract the ever-increasing perturbation from the sun with an extra gravitational pull from the Earth and moon.Table 3 gathers the initial conditions of the migrated classical orbit in the SgC framework. Contrary to Table 2, these initial conditions represent two distinct orbits (referred to as left and right seed orbits). Although both orbits lay very close to one another and are contained in the (x, y) plane, they are different. Figure 5b provides a zoomed view of the left initial condition to show the difference between the orbits (the continuous and dashed lines represent the left and right seed orbits, respectively). The slight difference between the orbits is caused by the difference in the sun–spacecraft configuration at the initial time. At t0=0, the sun is located along the negative x^ axis (i.e., to the left of the barycenter; see Fig. 2), whereas the initial conditions are at either side of the barycenter. Hence, the sun’s gravitational pull is slightly stronger on the left initial condition, which ultimately causes the continuation to yield two distinct orbits in the SgC framework, although both orbits originated from the same classical orbit in the CR3BP framework.Fig. 5 a) CR3BP→SgC migration of the classical orbit, and b) zoomed view of the left crossing.To compute the family of DC orbits, the differential corrector scheme is used again, but with a slow continuation on the attitude angle γ. Variations in the angle γ do not break the required (x, z)-plane symmetry and provide an out-of-plane component of the solar-sail acceleration, which we used to vary the out-of-plane distance of the DC orbits. The starting points for the continuation are the left and right seed orbits (initial conditions in Table 3), which hold in the SgC framework. Recall that the seed orbits exist without a solar-sail acceleration because γ is set to 90 deg (i.e., the sail is placed parallel to the direction of sunlight). The continuation decreases the angle γ by a small amount δγ and the differential corrector finds a new orbit that holds for the reduced value for γ. By continuing this process until γ=0  deg, the right and left DC subfamilies, parameterized in γ, arise. Note that, in this second continuation, we do not vary any dynamic parameter; the whole process occurs in the SgC framework.The subfamilies are depicted separately in Figs. 6a and 6b and together in Fig. 6c. The initial conditions (indicated with black dots in Figs. 6a–6c) of the subfamily in Fig. 6a lie along the negative x^ axis (referred to as left DC orbits), whereas those of the subfamily in Fig. 6b lie along the positive x^ axis (referred to as right DC orbits). Both subfamilies originate from the two mentioned seed orbits, depicted in Fig. 6c as the darkest blue orbits although the seed orbits are indistinguishable due to their proximity (see Fig. 5b). Recall that the angle γ is bounded to the interval [−90,90]. At 0 deg, the solar-sail acceleration is maximum but does not have a component out of the (x, y) plane. As γ increases, the out-of-plane component increases until it reaches a maximum at ±35.26  deg. Subsequently, it decreases until, at ±90  deg, the solar-sail acceleration magnitude is zero. When γ is positive/negative, the out-of-plane component points along the positive/negative z^ axis, which yields orbits above and below the EM orbital plane [(x, y) plane], respectively. We distinguish these orbits as northern and southern orbits accordingly. The southern orbits exist for γ∈[−90,0], whereas the northern orbits exist for γ∈[0,90]. Taking advantage of the symmetry, the angle γ appears as an absolute value in Fig. 6 to represent both the northern and southern orbits at the same time. Note that all DC orbits in both subfamilies (left and right, north and south) exist for a0=0.1 and φ=0 and have a period of one synodic month (2π/Ω4).The DC orbits resemble circular orbits that have been displaced out of the (x, y) plane by the solar-sail acceleration. Indeed, as the angle γ decreases and thus the solar-sail acceleration increases, both left and right DC orbits move out of the (x, y) plane. However, the orbits in the left DC subfamily are pushed away from the EMS barycenter, whereas the orbits in the right DC subfamily are pulled toward it. As explained for the seed orbits, this behavior is caused by the initial sun-sail configuration. Recall that, at t0=0, the sun is located along the negative x^ axis. Consequently, the solar-sail acceleration vector is contained in the (x, z) plane with its x component directed along the positive x^ axis. Because the initial conditions of the left and right DC orbits are at either side of the barycenter, the solar-sail acceleration contributes to an inward (toward the barycenter) acceleration for the left DC orbits, whereas the opposite holds for the right DC orbits. The left/right DC orbits therefore move away/toward the barycenter so that the combined gravitational pull of the Earth and moon compensates for this imbalance in the total acceleration acting on the sailcraft.Fig. 6 Family of solar-sail DC orbits and optimal reference orbits (black) for coverage of the poles of the Earth and moon: a) left DC subfamily, b) right DC subfamily, c) complete family, and d) linear stability.To end this section, Fig. 6d shows the evolution of the linear stability as a function of the angle γ for both DC subfamilies and seed orbits. All orbits are linearly unstable because the module of the largest eigenvalue of the monodromy matrix (λmax) is greater than unity for all values for γ [20]. Hence, none of the DC orbits can be maintained for a long period of time without an active control strategy. Finally, note how increasing the solar-sail acceleration (i.e., reducing γ) stabilizes the left DC orbits, whereas it produces the opposite effect for the right DC orbits.C. Coverage AnalysisThe large out-of-plane displacement of the DC orbits suggests their potential for polar observation. To assess their coverage capabilities, the sailcraft elevation and range with respect to the Earth’s north pole and lunar south pole are computed for 12 orbital revolutions (i.e., approximately one year). Figure 7 presents the results for four selected orbits, which are selected based on the fact that they exhibit the largest initial elevation angle. We refer to these orbits as the northern and southern left optimal distant-circular (ODC) orbits and right ODC orbits and they exist for γL≃±33  deg and γR≃±40  deg, respectively (i.e., the orbits depicted in black in Fig. 6). Table 4 gathers the initial conditions of the northern left and right ODC orbits. In Fig. 7, the results for the reference ODC orbits are represented with dashed black lines; the solid blue lines are discussed later and are not relevant for this section. We employ the northern orbits for coverage of the Earth’s north pole, whereas the southern ones are used for coverage of the lunar south pole. However, it is also possible to use only one orbit for northern (or southern) polar coverage of both bodies. Note that the results can be easily extrapolated to the other poles (i.e., the Earth’s south pole and the lunar north pole) due to the symmetry of the problem.The coverage results for the left ODC orbits are shown in Figs. 7a and 7c. The left northern ODC orbit provides continuous coverage of the Earth’s north pole (see Fig. 7a), whereas the left southern ODC orbit achieves the same for the lunar south pole (see Fig. 7c). Both northern and southern left ODC orbits maintain continuous coverage throughout the whole year, reaching a minimum elevation of 14 and 25 deg for the Earth’s north and lunar south poles, respectively, during the first orbit. The variation of the elevation is explained as follows; as an example, consider Fig. 7a. The elevation increases steadily because the polar axes precess when viewed in the reference frame C at a rotational rate n; the axes thus seem to chase the solar sail along its orbit. The observed drift is then due to the difference between n and the sailcraft’s angular rate Ω4. Concerning the range of the left ODC orbits, it varies between 5.5 and 6.9 Earth–moon distances with respect to the lunar south pole (see Fig. 7c) and is more constant at approximately six Earth–moon distances with respect to the Earth’s north pole (see Fig. 7a). The larger oscillations in the range with respect to the moon are due to the larger distance of the moon with respect to the barycenter.Fig. 7 Elevation and range of the optimal (reference and natural) ODC orbits: a,b) left and right northern ODC orbits with respect to the Earth’s north pole; c,d) left and right southern ODC orbits with respect to the lunar south pole.The coverage results for the right ODC orbits are shown in Figs. 7b and 7d. Although the right ODC orbits cannot be used for continuous observation of the Earth’s north pole (note the negative elevation in Fig. 7b at the start of the sixth orbit revolution), their smaller size grants them better performance (in terms of range and thus spatial resolution) for observing the lunar south pole. The right southern ODC orbit reaches a minimum elevation of 7 deg during the seventh orbit (Fig. 7d), while its range varies between 2.2 and 4.4 Earth–moon distances.The main drawback of the ODC orbits is their remoteness from the primaries. In [15], the spatial resolution provided by the clover-shaped and vertical Lyapunov orbits is computed with respect to the Earth’s north pole and lunar south pole, respectively. The authors assume a linear relation between range, wavelength (0.5  μm), and imager aperture diameter (0.5 m), which leads to an image resolution of the order of 1.2 km at a range of 1.3 Earth–moon distances for the clover-shaped orbit and 0.3 km at a range of 0.3 Earth–moon distances for the vertical Lyapunov orbit. Because of the mentioned linear relation, we can extrapolate these values to the ODC orbits to give an idea of how image resolution deteriorates for these orbits. At an average range of 6 and 3 Earth–moon distances, the left and right ODC orbits provide an image resolution of the order of 5.5 and 2.8 km, respectively. We do not distinguish between the Earth’s north and lunar south poles because the average range is approximately the same for both cases (see Fig. 7). To increase the image resolution, a larger aperture diameter would be required, the associated mass increment of which may yield an unreasonably large solar sail to maintain the solar-sail acceleration at the required magnitude.The main advantage of the ODC orbits is their temporal resolution. The left ODC orbits achieve continuous coverage of both the Earth and lunar poles throughout the year, whereas the right ODC orbits only for the lunar poles. Traditional missions for polar observation of the Earth and moon rely on constellations of at least two satellites to achieve continuous coverage [27]. By using the ODC orbits, this can be achieved with just one sailcraft (i.e., the ODC orbits sacrifice spatial resolution for temporal resolution in the ever-present tradeoff between these metrics).Rather than for scientific observations or imaging, the ODC orbits could be used for laser communications between a future lunar base located at the lunar south pole and the Earth. The left southern ODC orbit provides continuous coverage of both the Earth’s and lunar south poles at the same time. Imagine that, instead of a camera, the solar sail is equipped with stabilized laser reflectors. A laser beam could be sent to the solar sail orbiting above the lunar south pole, which then would be reflected toward the Earth. The beam could be received either by a ground station located near the south pole or a satellite-based system. This way, a continuous link between the lunar base and the Earth could be established with just a single sailcraft. Of course, this is entirely theoretical. To our knowledge, a laser beam has never been reflected midway in outer space using reflectors for communication purposes. However, laser communications between the Earth and a spacecraft orbiting the moon have been tested and proved not only feasible but better than traditional radio links [28]. Furthermore, high-quality pocket-size laser retroreflectors are widely used in the field of laser ranging [29]. It would be required to adapt and migrate this technology to the specific task at hand: a highly stabilized laser reflector of small mass with tight aiming constraints. Compared with the technological readiness level of solar sails, it does not seem impossible that such a system could be developed in parallel in the near future.D. Perturbing AccelerationThe difference between any two dynamic frameworks depicted in Fig. 1a resides in the accelerations acting on the sailcraft. For discussion purposes, we assume that r¨(t) is the total acceleration acting on the sailcraft along a certain reference orbit in the SgC framework. If we compute the total acceleration along the same reference orbit but in the HF dynamic framework, we would obtain a different acceleration r¨′(t). The difference between these two, Δa(t)=r¨′(t)−r¨(t), is what we call the perturbing acceleration, which is composed of several terms dependent on the dynamic parameters e, eh, and ioff. Recall that these parameters are set to zero in the SgC framework, deactivating the perturbations. The key point is that, if we want to follow the exact same reference orbit under the HF dynamics, the solar sail must counteract the perturbing acceleration. To achieve that, the reference constant control law must be modified and become time dependent. We refer to the solar-sail acceleration that results from the new control law as the solar-sail counter-acceleration. It has to be equal to the solar-sail acceleration due to the reference control law plus a term that cancels out the perturbing acceleration: as′′(t)=as′(t)−Δa(t), where as′′(t) is the solar-sail counter-acceleration and as′(t) is the solar-sail acceleration due to the reference control law in the HF framework. Note the prime in as′(t); this term differs from the solar-sail acceleration in the SgC framework (as) because the plane offset ioff moves the sun out of the Earth–moon plane [i.e., the S^ vector in Eq. (12) differs between both frameworks; see Fig. 2]. Recall that the reference control law is defined with respect to the S^ vector, which causes the difference between as and as′.Figure 8 shows the magnitude of the perturbing acceleration (i.e., ‖Δa(t)‖), in the HF framework) acting on the two right ODC orbits depicted in Fig. 6b over the course of one year; for comparison, the separate contributions by e and ioff+eh are also provided. Note that the perturbing acceleration over the two right ODC orbits only differs in orientation, having the same magnitude in both cases. The eccentricity of the moon’s orbit (e) introduces perturbations (i.e., variations in acceleration) in the gravitational pull of the Earth and moon as well as in the rotational term, which are combined in the term Δae. Similarly, Δaioff,eh gathers the perturbations induced by the plane offset ioff and the heliocentric eccentricity eh, parameters that appear and modify the expressions for the accelerations as and a4 in Eq. (2) when activated in the HF framework. From Fig. 8, one can appreciate that the term Δae is one order of magnitude larger than Δaioff,eh (note the difference in scale between the left and right vertical axes).Figure 8 indicates that, to counteract the perturbations induced by the moon’s eccentricity, the reference value a0=0.1 has to be increased, at least, fourfold. However, it might be possible to counteract the perturbing accelerations represented by Δaioff,eh, because its magnitude is smaller than that of a0. Finally, for the left ODC orbits, the quasi-periodic pattern of the perturbing acceleration is identical. However, the average magnitude of Δae is larger (i.e., approximately 0.6) and that of Δaioff,eh is smaller (i.e., approximately 0.004) because of the larger radial distance from the barycenter for these orbits.Fig. 8 Magnitude of the perturbing acceleration in the SgC→HF migration and the contributions due to e and ioff+eh for the right ODC orbits.Additional information concerning the direction of the perturbing acceleration vector is displayed in Fig. 9. This graph combines the solar-sail acceleration bubble with a sample of the required solar-sail counter-acceleration as′′, all displayed in frame S. Figure 9 only shows the results for the northern right ODC orbit as the results for the remaining ODC orbits are similar. Recall that the acceleration bubble represents the envelope of all possible solar-sail acceleration vectors [22]. Although we can enlarge the bubble by augmenting a0, it is impossible to generate accelerations toward the sun (i.e., in negative S^ direction). Hence, it is clear from Fig. 9 that the perfect SgC→HF migration, where the solar sail counteracts all perturbations of the HF dynamic framework to perfectly follow the reference orbits is impossible; an additional propulsion system would be required for that purpose.Fig. 9 View from the positive l^ axis of the acceleration bubble (gray) and the required solar-sail counter-acceleration as′′ (black arrows) in the SgC→HF migration for the right northern ODC orbit.IV. Natural OrbitsIn the previous section, we demonstrated that the reference ODC orbits cannot be perfectly tracked in the HF dynamic framework. The perturbations are too strong and act in directions that cannot be counteracted by the solar sail. Moreover, their nonperiodic nature prevents the existence of periodic orbits with a constant control law. However, it is still possible to compute nearby open trajectories that hold under the HF dynamics and follow the same simple reference control law. The one-step multiple-shooter differential corrector (OsMSDC) algorithm in parallel with a slow continuation on e, eh, and ioff can be used to this end. We refer to the nearby open trajectories as quasi-periodic orbits as they seem to be bounded to the reference orbits. This quasi-periodicity was investigated by numerically propagating the trajectories for 12 orbital revolutions to demonstrate that they remain bounded for a complete cycle of the perturbations.A. One-Step Multiple-Shooter Differential CorrectorThe general idea of the one-step multiple-shooter differential corrector is as follows. Suppose that we divide a reference trajectory into N−1 segments that are connected through N nodes. Each node represents the trajectory at a particular epoch; it has a state vector and a time variable associated to it. Subsequently, we increase the parameters e, eh, and ioff by a small amount and forward propagate the states at the nodes from the time associated with that node to the time associated with the next node. Because the dynamics have changed, the resulting trajectory is open and composed of N−1 arcs that do not arrive at the next node (see Fig. 10a). The OsMSDC iteratively modifies the nodes (i.e., state and time at the node) to build a nearby continuous trajectory that holds under the modified dynamics. By repeating this continuation-correction process, trajectories that resemble the original reference orbit and hold under the HF dynamics are found. The OsMSDC algorithm presented here is a modification of the ones used in [30,31] in order for it to be applicable to nonautonomous systems. For the following exposition, it is important to point out that we do not consider active control; that is, the control laws are equal to the reference control laws presented in the previous section (i.e., uDC=[γ00.1]⊺).The targeted continuous trajectory must satisfy the following problem: g0(P1)=0(17)Γ(ti+1|Pi)−Xi+1=0for  i={1,2,…,N−1}(18)gf(PN)=0(19)where Eqs. (17) and (19) represent the constraints imposed on the initial and final nodes and Eq. (18) the continuity constraints; g0 and gf are generic functions that adopt an explicit expression depending on the particular problem investigated; Pi=[Xi⊺ti]⊺ is a node variable and Γ(ti+1|Pi) is the last state of a trajectory arc propagated from Pi to time ti+1 (see Fig. 10a), i.e., Γ(ti+1|Pi)=Γi=Xi+∫titi+1f(X,t) dt(20)Fig. 10 Schematics of a) the initial and converged trajectories, and b) the contemporaneous and noncontemporaneous trajectory variations (adapted from [27,32]).Because, in this section, we consider a constant control law equal to its reference value, we suppress the dependency of f on u. If we gather all the nodes in a single vector P=[P1⊺P2⊺…PN⊺]⊺, Eqs. (17–19) can be written as G(P)=0, which, after linearization, becomes −G(Po)=JG(Po)δP(21)where Po represents an initial guess for the vector of node variables and JG(Po) the Jacobian matrix of the constraints evaluated at the initial guess. When solved, this linear system suggests an update for P*=Po+δP that, after some iterations, should drive G(P*) to zero, thereby resulting in a continuous trajectory (see Fig. 10a).The main nonzero elements of the Jacobian are the partials ∂(Γi−Xi+1)∂Pi=[∂Γi∂Xi∂Γi∂ti](22)∂(Γi−Xi+1)∂Pi+1=[−I6×6∂Γi∂ti+1](23)which are approximated through the variational equations of Γi. For the remainder of this subsection, which focuses on obtaining the partials on the right-hand sides of Eqs. (22) and (23), we adopt the nomenclature and methods used in [27]. As depicted in Fig. 10b, the total variation in Xi at the nodal epoch ti is composed of two effects: first, the change of the state at the epoch ti and, second, the change of the state due to a variation δti in the epoch, namely, δχi=δXi+fiδti(24)where δXi and δχi are the so-called contemporaneous and noncontemporaneous variations of the state Xi at the epoch ti. Note that the change due to a variation in the epoch is approximated as the derivative of the state vector times the variation in the epoch (i.e., fiδti). Furthermore, in accordance with the definition of the state transition matrix (STM) [20], we can relate the contemporaneous variations between two consecutive epochs ti and ti+1 as follows: δXi+1=ΦiδXi(25)where Φi is the STM from epoch ti to epoch ti+1 along the path Γi. Then, substitution of Eq. (24) in Eq. (25) yields δχi+1−fi+1δti+1=Φi(δχi−fiδti)(26)which relates all possible variations at epoch ti with those at epoch ti+1. Moreover, the variation δχi+1 must satisfy the integral relation Xi+1+δχi+1=Γ(ti+1+δti+1|Xi+δχi,ti+δti)(27)If we assume that the variations are small, we can linearize Eq. (27) and rearrange to obtain δχi+1−∂Γi∂ti+1δti+1=∂Γi∂Xiδχi+∂Γi∂tiδti(28)Finally, by comparing Eq. (28) with Eq. (26), we obtain the desired link between the partials on the right-hand side of Eqs. (22) and (23) with Φi, fi, and fi+1, which allows us to expand the Jacobian as JG=[Jg00⋯0[Φ1−Φ1f1]H2⋯00[Φ2−Φ2f2]⋯0⋮⋱⋱⋮0⋯HN−100⋯[ΦN−1−ΦN−1fN−1]HN0⋯0Jgf](29)where Jg0 and Jgf are the Jacobians of the initial and final constraints, respectively, and Hk=[−I6×6fk]. In the versions of this multiple-shooter differential corrector that work with autonomous dynamic systems (see [30,31]), the Jacobian matrix is formulated differently because the integration time between two nodes (Δt=ti+1−ti) is used as nodal epoch instead of assigning an epoch to each node. Assigning Δt to each node is allowed for autonomous systems because the same result is obtained when integrating the dynamics from zero to Δt as from ti to ti+1. However, this is not true for a nonautonomous system, because the initial integration time of each integrated trajectory segment has to correspond to a certain epoch. For example, in our case, starting each trajectory segment propagation from t=0 places the S^ vector aligned with the x^ axis for all nodes, which would be incorrect.B. ResultsIt is important to reiterate that all results in this section maintain the constant control law of the reference ODC orbits (i.e., they do not apply active control). To illustrate the effect of the different perturbations on the reference ODC orbits, we analyze two migrations: Fig. 11a corresponds to the SgC→SgE migration, whereas Fig. 11b is the result of the SgC→HF migration. Therefore, the deviations (solid dark blue lines) from the reference ODC orbits (dashed cyan lines) in subplot (a) are only caused by the eccentricity of the moon’s orbit (e), whereas the deviations appearing in subplot (b) are the result of all perturbations acting together. We call the resulting open trajectories e-corrected and natural ODC orbits, respectively (see Fig. 1a), despite the fact that these orbits are, at most, quasi-periodic orbits. The migrations are performed for approximately one year (12 orbital revolutions) so that a complete cycle of the perturbations is taken into account (i.e., after 12 orbital revolutions, the relative positions of the sun, Earth, and moon are approximately the same). Also, recall that the Earth and moon wobble around their mean positions along the x^ axis throughout the year, which causes the elongated black moon in Fig. 11. In all cases, the imposed constraints on the initial and final nodes are g0(P1)≡[y1t1]⊺=0(30)gf(PN)≡yN=0(31)which force the initial and final nodes to coincide with the (x, z) plane. In addition, the initial epoch is kept fixed to zero in order for all results to depart from the same initial condition. Conversely, the final epoch is free so that the correction process can adjust this variable to meet the constraints.Concerning the e-corrected ODC orbits in Fig. 11a, we can appreciate that they barely deviate from the reference orbits: the solid dark blue trajectory and the dashed cyan orbit nearly overlap. Interestingly, these e-corrected orbits appear to demonstrate quasi-periodic behavior as the boundary nodes (i.e., initial and final nodes) of the e-corrected orbits (depicted in Fig. 11a as light green triangles) match almost perfectly. In addition, they also match the boundary nodes of the reference orbits (depicted in red circles) so well that the red circles are not visible in Fig. 11a. Conversely, for the natural ODC orbits in Fig. 11b, a clear discrepancy between the boundary nodes is observable. Moreover, the boundary nodes of the natural orbits no longer match those of the reference orbits. This is interesting as the ioff+eh perturbation is one order of magnitude smaller than the perturbation due to the eccentricity of the moon. It therefore seems that the coupling between the perturbations due to ioff+eh and the perturbations due to the eccentricity of the moon impairs the apparent quasi-periodic motion of the natural orbits. Furthermore, it suggests that elimination of the ioff+eh-related perturbations via an active control strategy may allow permanently bounded quasi-periodic orbits, which will be investigated in the next section.Fig. 11 a) E-corrected ODC orbits (SgC→SgE migration), and b) natural ODC orbits (SgC→HF migration).Lastly, to demonstrate the effect of the perturbations on the observation capabilities of the reference ODC orbits, Fig. 7 shows the coverage and range of the natural ODC orbits (solid dark blue lines) in addition to the coverage and range for the reference ODC orbits. We can conclude that, within the considered time frame, the general coverage capabilities of these orbits are preserved despite the effect of the perturbations.V. Controlled OrbitsThis section analyzes the controllability of the ODC orbits by computing nonconstant, continuous control laws to partially counteract the perturbations (see the controlled orbits in Fig. 1a). We have seen that total cancellation of the perturbing acceleration Δa is not possible for the SgC→HF migration. Therefore, we seek a compromise between the reference ODC orbits and the natural ODC orbits.We obtain time-varying control laws in two different ways. First we derive an extended version of the OsMSDC to numerically obtain u(t) during the SgC→HF migration (i.e., the numerical control in Fig. 1a). Subsequently, it is shown that the control law to counter the perturbing acceleration introduced in the SgE→HF migration can be obtained analytically, which leads to the second method of computing the controls (i.e., the analytic control in Fig. 1a).A. Weights OptimizationSeveral minor modifications to the OsMSDC of the previous section are required to permit variations in the reference control law. In the first place, the nodal variables are expanded as P˜i=[X˜i⊺ti]⊺, where X˜i=[Xi⊺ui⊺]⊺ is the expanded state vector and ui is the control law evaluated at ti. This causes the partials in Eqs. (22) and (23) to change as ∂(Γi−Xi+1)∂P˜i=[Φ˜i−Φifi](32)∂(Γi−Xi+1)∂P˜i+1=[−I6×606×3fi+1](33)where Φ˜i=[Φi∂Γi∂ui]is the expanded STM, which can be calculated by substituting the state vector Xi by the expanded state vector X˜i and reformulating the differential equations of the STM accordingly [33].A second modification is the application of a piecewise cubic spline interpolation for the controls, which generates a continuous control law in between two nodal epochs after every iteration of the OsMSDC. For example, at initialization, the algorithm is provided with the reference trajectory and its associated constant control law. The latter are sampled at every ti to obtain the discrete ui. Then, after the first iteration, the nodal controls are updated independently from one another, which results in a discontinuous control law. It is at this point that the interpolation takes place, such that a continuous control law is passed to the next iteration. When convergence is reached, both trajectory and control law are continuous (see Fig. 10a).The expansion of the nodes with the controls increases the number of variables in Eq. (21). To obtain the natural orbits in the previous section and Fig. 11, the underdetermined linear system in Eq. (21) was solved by choosing the least norm solution (i.e., variations in positions, velocities, and epochs participate equally in closing the trajectory). However, in this section we introduce a matrix W that assigns different weights to each component of ui such that the controls are varied more (or less if Wi<1) intensively than the nodal positions, velocities, and epochs, which ultimately yields a less deviated trajectory. Mathematically, the weighting matrix is introduced as δP=WJG⊺(JGWJG⊺)−1(−G)(34)where W is a diagonal matrix with the position, velocity, and epoch terms equal to one and the control terms equal to Wγ, Wφ, and Wa0, where the subscript refers to the control parameter. Although large weights increase the control effort and thus should keep the perturbed trajectory closer to the reference orbit, they also introduce numerical instabilities that impair the convergence of the algorithm. A tradeoff needs to be made between numerical and control performances: when the weights are too large, the algorithm diverges; the controls barely counteract the perturbations when the weights are too small. Indeed, smaller weights just reduce the usage of the controls to the limit Wγ=Wφ=Wa0=0, where the controls are ignored by the algorithm leading to the natural orbits of the previous section and the constant reference controls. This opens up a variety of options, like leaving one control unchanged or pushing the weights to the convergence limit. In fact, one of the reasons to define the weights as they are (i.e., smaller weights yield less control effort) was to allow the algorithm to easily switch off one control variable if needed. If the inverse definition of the weights would have been adopted (i.e., larger weights yield less control effort), the algorithm would have to drive one weight to infinity to deactivate one control variable. Such behavior is not numerically desirable.We use the particle swarm optimization algorithm implemented in MATLAB® to select the best values for the weights. The upper bounds of the search space are found by trial and error: with a reasonable value for γ˙ and φ˙ of approximately 24  deg/day [34], we force the algorithm manually until the derivatives of the attitude controls just surpass this limit, which then defines the upper bounds. For this particular problem, the obtained upper bounds for the weights were not large enough to cause numerical instabilities and thus convergence issues, which eased the optimization process. The optimization algorithm targets the minimum error solution minE, understanding for error, the normal distance from the reference orbit to the perturbed trajectory (see Fig. 12a). More precisely, the root mean square (RMS) of the normal error along the entire trajectory ERMS is minimized.The posed optimal control problem is similar in many aspects to the direct collocation and nonlinear programming (DCNLP) approach [35]. As in DCNLP, the trajectory and controls are discretized in N nodes, yielding N−1 trajectory segments. Then, the nodes are grouped in the vector P, which is used as the independent variable of the constraints. However, the OsMSDC solves the dynamics [represented by Eq. (27)] numerically with an explicit integrator, whereas in DCNLP, Eq. (27) is solved implicitly with, for instance, Gauss–Lobatto quadrature. The OsMSDC is a shooting algorithm that employs the information in the STM to compute updates of the initial vector P, aimed at closing the trajectory. In DCNLP, no shooting is required as the entire trajectory is linked via suitable interpolation functions. The choice of such functions must be done carefully, for they have to appropriately capture the dynamics of the problem. In this work, the OsMSDC algorithm was selected to solve the posed optimal control problem for practical reasons, as it had already been implemented to obtain the natural trajectories, and to investigate the applicability and performance of the weighting matrix introduced in Eq. (34). Future work may focus on using different methods such as DCNLP to shed more light on the problem of the controllability of solar-sail orbits in the EMS.Fig. 12 a) Definition of the normal error E, and b) normal error for all ODC-RS cases.Some final considerations regarding the OsMSDC algorithm are as follows. In theory, the more nodes along the trajectory, the faster the convergence, because the tradeoff between continuity in the trajectory and controls is handled better. Nonetheless, the more nodes, the larger the matrix that has to be inverted to solve Eq. (34). For our case study, a good intermediate situation was found to be 51 nodes per orbit revolution. For the optimizations to run in a reasonable time, 3 orbit revolutions instead of 12 were used. It turned out that with three orbit revolutions, the overall behavior of the one-year analysis is well represented. Further improvements in performance were obtained by relaxing the OsMSDC convergence criteria at intermediate steps during the continuation on e, ioff, and eh. Only in the last step, when e, ioff, and eh have reached their final value, the sum over all components of the constraint vector [i.e., sum(G)] is forced to be less than 1×10−8; in terms of position, this represents a cumulative error of just 4 m. This way, the intermediate steps take 2–3 OsMSDC iterations to converge and the last one never surpasses 10. One last remark concerning the algorithm is that the first and last revolutions seem to absorb most of the effect of the perturbations and deviate significantly more than the rest of the trajectory. To palliate this effect, additional pieces of trajectory (i.e., about half an orbit) are added before and after the initial and final nodes, respectively, which are removed after the OsMSDC converges in the last step of the continuation. With the aforementioned settings, one function evaluation took approximately 3 minutes in a computer equipped with 16 GB of memory and an Intel® Core™ i7-8750H processor.Note that, for brevity, we do not present the results for all ODC orbits, but only for the southern orbit of the right ODC subfamily (in short, ODC-RS). Figure 12b shows the normal error curves for all cases in logarithmic scale. The short-period oscillations are related to the rotation of the EMS, whereas the spikes around the third and ninth revolutions correlate to the minima in the component of the perturbing acceleration due to ioff+eh (see Fig. 8, ‖Δaioff,eh‖ component). Table 5 gathers the normal error statistics for the ODC-RS orbit, which are the RMS of the normal error ERMS, minimum error Emin, average error Eavg, and maximum error Emax. In addition to the results for the controlled orbit, the values for the natural ODC-RS orbit and the e-corrected ODC-RS orbit of the previous section are also presented. The table is thus the statistical summary of Fig. 12b.Controlling the orbits reduces the maximum error Emax compared with the natural ODC-RS orbit without significantly modifying the minimum error Emin, indicating that nodes that suffered large deviations in the natural orbit are more readily helped by the controls. Zero error is never reached, which is a consequence of the formulation of the algorithm (i.e., no matter how large the control weights are, all nodes suffer a nonzero deviation at every iteration). Note that the e-corrected ODC-RS orbit has such small errors that even when active control is applied, the algorithm cannot achieve a similar performance when correcting for all perturbing effects. This behavior is better understood with the aid of Fig. 9b. As already commented, this plot displays both the solar-sail acceleration bubble and the required solar-sail acceleration for the SgC→HF migration. Notice that the majority of the solar-sail acceleration vectors require a large component along the p^ axis. Creating an acceleration mainly along the p^ axis requires the sail to be oriented near-parallel to the direction of sunlight, under which condition little thrust is generated. The control algorithm tries to find an intermediate solution in which these perturbations are reduced to the minimum within the thrusting capabilities of the solar sail. Nevertheless, the algorithm does improve the trajectory with respect to the natural orbit. This is partly because the accelerations required to counter the effects due to ioff and eh are mostly aligned with the S^ axis and can be effectively countered by the solar sail. This is further explained in the following subsection.Figure 13 presents the full-year propagation of the minE case and its associated control law. Note how the control profiles for the attitude angles [i.e., γ(t) and φ(t)] satisfy the constraint on their rates of change of ±24  deg/day (dashed red lines), which suggests that solar sails can handle the slow-varying perturbations considered in this work. These perturbations are of the order of magnitude of a0 and vary in accordance with the orbits’ time scale (i.e., one synodic month). We therefore cannot conclude anything about other, faster or potentially stronger, disturbances. However, as proof of the versatility and robustness of the methodology presented in this work, Gámez Losada [36] successfully applied the control algorithm to other solar-sail periodic orbits in the EMS, in particular to the clover-shaped and vertical-Lyapunov orbits presented in [15].Fig. 13 Trajectory and control law for the minE ODC-RS orbit for 12 orbital revolutions.B. Analytic ControlWe have seen that the e-corrected ODC orbits of Fig. 11a perform best in terms of deviation from the reference orbits (see Table 5). However, the e-corrected ODC orbits only account for the e-induced perturbation and not for the perturbations related to ioff+eh. Therefore, this section investigates whether we can track the e-corrected ODC-RS orbit in the HF framework so that we only have to counter the perturbations related to ioff+eh. We refer to this new problem as the SgE→HF migration, in which the reference ODC-RS orbit in the SgC framework is substituted by the e-corrected ODC-RS orbit in the SgE framework. Figure 14a depicts the solar-sail acceleration bubble as viewed along the negative p^ axis and a sample of the required solar-sail acceleration to counter the perturbations (black arrows) in this SgE→HF migration. It is clear that with a slight increase of the solar-sail performance, all acceleration vectors can be engulfed by the bubble. The control law required to counter these perturbations can subsequently be computed analytically, the results of which appear in Fig. 14b.The controls in Fig. 14b again satisfy the maximum angular rates of 24  deg/day and, considering the maximum value for a0 of 0.14, require an increase in the reference sail’s performance of 40%. With these controls, it is possible to perfectly track the e-corrected orbit in the HF framework such that the small errors for the e-corrected DC-RS orbit in Table 5 apply in the HF framework. It is thus clear that, for the DC-RS orbit, the strategy of first correcting for the eccentricity without active control and then fully counteracting the remaining perturbations with the analytic control law of Fig. 14b provides the best control solution. However, this is not always the case. As mentioned before, Gámez Losada [36] applies the methodology followed in this work to other orbits, showing that, for those orbits where the e-related perturbation causes large deviations from the reference orbits, the controls obtained with the OsMSDC yield smaller errors than the analytic control. Therefore, neither approach (i.e., control law computed with the OsMSDC or analytically) outperforms the other in every situation, where the choice has to be made considering the relative magnitude of the different perturbations and their effect on the analyzed reference orbits.Fig. 14 SgE→HF migration: a) view along the negative p^ axis of the acceleration bubble (gray) and required solar-sail acceleration (black arrows), and b) ODC-RS analytical control law.VI. Transfers Between Distant-Circular OrbitsBecause of the out-of-plane symmetry in the Earth–moon system and the availability of a solar-sail induced acceleration, an opportunity exists to transfer between orbits above and below the Earth–moon orbital plane during a single mission. Such an orbital transfer may significantly increase the mission scientific return. In this section, such transfers are investigated using the weighted OsMSDC algorithm, thereby also demonstrating the versatility of the methodology adopted in this work. Figure 6 suggests that transfers from the northern DC orbits to their southern counterparts could be possible by reducing the angle γ. For instance, consider the northern ODC orbit depicted in black in Fig. 6a with a reference value for γ of 33 deg. If γ is reduced, the orbits of the family tend to move toward the (x, y) plane, following the outer face of the toroid-shaped family (see the red orbits in Fig. 6a). Once in the (x, y) plane, further reduction of γ (i.e., γ becomes negative) yields increasingly displaced southern orbits until the southern ODC orbit with an angle γ of −33  deg is reached. This behavior hints at possible transfer trajectories between northern and southern optimal orbits and vice versa. To compute such transfers, we must employ the SgC dynamic framework, because it is the most high-fidelity framework to respect the symmetry with respect to the (x, y) plane. This property furthermore allows for a convenient simplification, namely, that only one half of the transfer needs to be computed (i.e., the final node PN is located halfway of the complete transfer rather than at the end). The boundary constraints in Eqs. (17) and (19) are therefore modified as follows: g0(P1)≡[X1⊺u1⊺t1]⊺=[X0⊺u0⊺t0]⊺(35)gf(PN)≡[yNzNx˙NuN⊺tN]⊺=[000uτ/2⊺τ/2]⊺(36)where τ is the total transfer time, uτ/2 are the controls at τ/2, and the subindexes 1 and N denote the initial and final nodes of the trajectory, respectively. The initial conditions in Eq. (35) must match those of the northern ODC orbits (i.e., the initial state X0, the control law u0=[γ00a0]⊺, and the initial time t0=0), whereas the final conditions in Eq. (36) force the trajectory to cross the x^ axis perpendicularly; by leaving xN, y˙N, and z˙N free, the algorithm is allowed to iteratively adjust the value for x at the crossing until it reaches convergence. Finally, considering that the reference control law of the southern orbit is uf=[−γ00a0]⊺ and that the control law along the trajectory must be symmetric as well, uτ/2=[00a0]⊺.For the initial guess of the transfer that initializes the OsMSDC algorithm, we assume a linearly varying control law between u0 and uf over a time-space of τ, which is constrained to be a multiple of the synodic month (2π/Ω4). This is to ensure a correct sun-sail configuration upon arrival at the southern orbit. Because propagation of X0 with the latter control law does not yield a feasible guess, we introduce z˙0<0, where the exact value for z˙0 is determined through trial and error until the propagation crosses the x^ axis after a time τ/2. Furthermore, we first compute a transfer between two almost coplanar DC orbits (i.e., the blue orbits in Fig. 6 with large values for γ) and then apply a continuation in γ to construct transfers between DC orbits displaced ever-further out of the (x, y) plane. This process leads to the transfers in Fig. 15, in which subplots (a) (dashed cyan line) and (b) depict details of a transfer with τ=4(2π/Ω4) between the left ODC orbits of Fig. 6a, whereas subplots (c) (dashed cyan line) and (d) provide details of a transfer with τ=3(2π/Ω4) between the right ODC orbits of Fig. 6b. Note that the transfer is initiated after four orbital revolutions and that no variations in a0 are required.The smaller out-of-plane distance of the right ODC orbits allows for the faster transfer. However, the required control law is less smooth, because the rapid change in sail attitude at the start of the transfer causes an overshoot. A further reduction of τ requires even more sudden attitude changes, ultimately leading to a surpassing of the imposed maximum rate of 24  deg/day. The transfers shown here are the fastest transfers possible without surpassing this limit. The control laws present a double-symmetry; the accelerations induced during the first half of the transfers have to be exactly reverted during the second half to inject in the southern orbits (recall that the northern and southern orbits employ the same value for γ but with opposite sign). It is important to point out that both transfers can be executed without varying the characteristic acceleration (see the constant value for a0 in Figs. 15b and 15d); a simple fixed-shape sail can thus perform the transfer without RCDs or the need to change to the more complex heliogyro architecture.Fig. 15 Transfers between ODC orbits in the SgC (dashed cyan) and HF (solid dark blue) frameworks and the required control histories: a,b) between the left ODC orbits; c,d) between the right ODC orbits.Finally, note that Figs. 15a and 15c actually depict two almost superimposed trajectories. As mentioned, the dashed cyan lines are the reference transfers computed in the SgC framework. When migrating these transfers to the HF framework, the trajectories in dark blue are obtained. Indeed, the transfers are also valid in the HF framework; no significant deviations with respect to the reference transfers can be discerned. Note that, when performing the migration to the HF framework, the original initial conditions (red circles in Fig. 15) that hold in the SgC framework are allowed to vary to facilitate the convergence of the OsMSDC.VII. ConclusionsIn this paper, a new family of solar-sail periodic orbits, termed “distant-circular orbits” (DC orbits), has been developed for the particular application of polar observation of the Earth and moon. The orbits exist under the dynamics of the solar-sail CR3BP augmented with the sun’s gravitational perturbation (referred to as the reference dynamic framework). Depending on the initial sun-sail configuration, the family is further divided into the left and right subfamilies. Moreover, each subfamily is composed of northern and southern orbits (i.e., above and below the EM orbital plane, respectively). All DC orbits employ a simple sun-facing steering law in which the solar sail is tilted at a constant angle with respect to the direction of sunlight in the out-of-plane direction. The various DC orbits in the family are parameterized by this angle.From each subfamily, two ODC orbits (northern and southern) have been selected. These ODC orbits are optimal in the sense that they have the best properties for polar observation of the Earth and moon. Note that, due to the symmetry of the dynamics with respect to the orbital plane of the EM system, the following discussion, which focuses on the northern orbits and observation of the Earth and lunar north poles, is also valid for their southern counterparts. One single sailcraft in the left northern ODC orbit is capable of providing continuous coverage of both the Earth and lunar north poles throughout the year at a minimum elevation of 14 deg with respect to the lunar north pole and at six EM distances for both north poles. For the right northern ODC orbit, continuous coverage of the Earth’s north pole is not achieved, but the sailcraft would be closer to both poles at approximately three EM distances.The ODC orbits have been migrated to a higher-fidelity dynamic framework, which includes perturbations by the eccentricity of the moon’s orbit, the offset between the plane of the EM system and the ecliptic, and the heliocentric eccentricity of the EM system’s barycenter. The migration has been performed by means of a multiple-shooter differential corrector adapted to the nonautonomous property of the solar-sail EM three-body problem. Two types of migration have been considered: with and without active control. Both types of control allow seemingly quasi-periodic trajectories that remain bounded to the reference orbits without loss in the coverage capabilities. As a case study, the control of the right southern ODC orbit over a time period of one year was analyzed. It was found that it is possible to maintain a bounded quasi-periodic trajectory with a maximum offset of 2560 km from the reference orbit for an increase of the reference sail’s performance of 40%.Finally, transfer trajectories were developed between the northern and southern ODC orbits with transfer times of three to four months. These transfers allow a single sailcraft to observe both the northern and southern latitudes of the Earth and/or moon during a single mission and as such may increase the mission scientific return.\r            References\r        [1] Tsuda Y., Mori O., Funase R., Sawada H., Yamamoto T., Saiki T., Endo T., Yonekura K., Hoshino H. and Kawaguchi J., “Achievement of IKAROS—Japanese Deep Space Solar Sail Demonstration Mission,” Acta Astronautica, Vol. 82, No. 2, 2013, pp. 183–188. https://doi.org/10.1016/j.actaastro.2012.03.032 CrossrefGoogle Scholar[2] Johnson L., Whorton M., Heaton A., Pinson R., Laue G. and Adams C., “NanoSail-D: A Solar Sail Demonstration Mission,” Acta Astronautica, Vol. 68, Nos. 5–6, 2011, pp. 571–575. https://doi.org/10.1016/j.actaastro.2010.02.008 CrossrefGoogle Scholar[3] Biddy C. and Svitek T., “LightSail-1 Solar Sail Design and Qualification,” Proceedings of the 41st Aerospace Mechanisms Symposium, NASA CP-2012-217653, 2012, pp. 451–463. Google Scholar[4] Betts B., Spencer D. A., Nye B., Munakata R., Bellardo J. M., Wong S. D., Diaz A., Ridenoure R. W., Plante B. A. and Foley J. D., “Lightsail 2: Controlled Solar Sailing Using a CubeSat,” 4th International Symposium on Solar Sailing, Paper 17053, Jan. 2017. Google Scholar[5] McNutt L., Johnson L., Kahn P., Castillo-Rogez J. and Frick A., “Near-Earth Asteroid (NEA) Scout,” AIAA Space 2014 Conference and Exposition, AIAA Paper  2014-4435, Aug. 2014. https://doi.org/10.2514/6.2014-4435 Google Scholar[6] Pezent J., Sood R., Heaton A., Miller K. and Johnson L., “Preliminary Trajectory Design for NASA’s Solar Cruiser: A Technology Demonstration Mission,” Acta Astronautica, Vol. 183, June 2021, pp. 134–140. https://doi.org/10.1016/j.actaastro.2021.03.006 CrossrefGoogle Scholar[7] Macdonald M. and McInnes C. R., “Solar Sail Science Mission Applications and Advancement,” Advances in Space Research, Vol. 48, No. 11, 2011, pp. 1702–1716. https://doi.org/10.1016/j.asr.2011.03.018 CrossrefGoogle Scholar[8] McInnes C. R., Solar Sailing: Technology, Dynamics and Mission Applications, Springer-Praxis Books in Astronautical Engineering, Springer-Verlag, Berlin, 1999, pp. 1–31, 38–39, 116. CrossrefGoogle Scholar[9] Quarta A. A. and Mengali G., “Electric Sail Mission Analysis for Outer Solar System Exploration,” Journal of Guidance, Control, and Dynamics, Vol. 33, No. 3, 2010, pp. 740–755. https://doi.org/10.2514/1.47006 LinkGoogle Scholar[10] Dachwald B. and Wie B., “Solar Sail Kinetic Energy Impactor Trajectory Optimization for an Asteroid-Deflection Mission,” Journal of Spacecraft and Rockets, Vol. 44, No. 4, 2007, pp. 755–764. https://doi.org/10.2514/1.22586 LinkGoogle Scholar[11] Dachwald B., Mengali G., Quarta A. A. and Macdonald M., “Parametric Model and Optimal Control of Solar Sails with Optical Degradation,” Journal of Guidance, Control, and Dynamics, Vol. 29, No. 5, 2006, pp. 1170–1178. https://doi.org/10.2514/1.20313 LinkGoogle Scholar[12] Heiligers J., van den Oever T. D., Ceriotti M., Mulligan P. and McInnes C., “Continuous Planetary Polar Observation from Hybrid Pole-Sitters at Venus, Earth, and Mars,” 4th International Symposium on Solar Sailing, Paper 17077, Jan. 2017. Google Scholar[13] Heiligers J., Vergaaij M. and Ceriotti M., “End-to-End Trajectory Design for a Solar-Sail-Only Pole-Sitter at Venus, Earth, and Mars,” Advances in Space Research, Vol. 67, No. 9, 2021, pp. 2995–3011. https://doi.org/10.1016/j.asr.2020.06.011 Google Scholar[14] Heiligers J., Macdonald M. and Parker J. S., “Extension of Earth-Moon Libration Point Orbits with Solar-Sail Propulsion,” Astrophysics and Space Sciences, Vol. 361, No. 7, 2016, pp. 1–20, Paper 241. https://doi.org/10.1007/s10509-016-2783-3 Google Scholar[15] Heiligers J., Parker J. and Macdonald M., “Novel Solar Sail Mission Concepts for High-Latitude Earth and Lunar Observation,” Journal of Guidance, Control, and Dynamics, Vol. 41, No. 1, 2018, pp. 212–230. https://doi.org/10.2514/1.g002919 LinkGoogle Scholar[16] Wawrzyniak G. G. and Howell K. C., “Generating Solar Sail Trajectories in the Earth-Moon System Using Augmented Finite-Difference Methods,” International Journal of Aerospace Engineering, Vol. 2011, May 2011, Paper 476197. https://doi.org/10.1155/2011/476197 Google Scholar[17] Ozimek M. T., Grebow D. J. and Howell K. C., “Design of Solar Sail Trajectories with Applications to Lunar South Pole Coverage,” Journal of Guidance, Control, and Dynamics, Vol. 32, No. 6, 2009, pp. 1884–1897. https://doi.org/10.2514/1.41963 LinkGoogle Scholar[18] Wakker K. F., Fundamentals of Astrodynamics, TU Delft Library, Delft, The Netherlands, 2015, pp. 671–681. Google Scholar[19] Szebehely V., Theory of Orbits. The Restricted Problem of Three Bodies, Academic Press, New York, 1967, pp. 587–595. https://doi.org/10.1119/1.1974535 Google Scholar[20] Battin R. H., An Introduction to the Mathematics and Methods of Astrodynamics, rev. ed., AIAA, Reston, VA, 1999, Chap. 3. https://doi.org/10.2514/4.861543 LinkGoogle Scholar[21] Heiligers J., Diedrich B., Derbes W. and McInnes C. R., “Sunjammer: Preliminary End-to-End Mission Design,” AIAA/AAS Astrodynamics Specialist Conference, AIAA Paper  2014-4127, Aug. 2014. https://doi.org/10.2514/6.2014-4127 Google Scholar[22] Dachwald B., “Solar Sail Dynamics and Control,” Encyclopedia of Aerospace Engineering, Wiley, Hoboken, NJ, 2010. https://doi.org/10.1002/9780470686652.eae292 Google Scholar[23] Heiligers J., Guerrant D. and Lawrence D., “Exploring the Heliogyro’s Orbital Control Capabilities for Solar Sail Halo Orbits,” Journal of Guidance, Control, and Dynamics, Vol. 40, No. 1, 2017, pp. 1–18. https://doi.org/10.2514/1.g002184 Google Scholar[24] Ma D., Murray J. and Munday J. N., “Controllable Propulsion by Light: Steering a Solar Sail via Tunable Radiation Pressure,” Advanced Optical Materials, Vol. 5, No. 4, 2017, Paper 1600668. https://doi.org/10.1002/adom.201600668 Google Scholar[25] Gong S., Li J. and Simo J., “Orbital Motions of a Solar Sail Around the L2 Earth–Moon Libration Point,” Journal of Guidance, Control, and Dynamics, Vol. 37, No. 4, 2014, pp. 1349–1356. https://doi.org/10.2514/1.G000063 LinkGoogle Scholar[26] Miele A., “Revisit of the Theorem of Image Trajectories in the Earth-Moon Space,” Journal of Optimization Theory and Applications, Vol. 147, No. 12, 2010, pp. 483–490. https://doi.org/10.1007/s10957-010-9734-x Google Scholar[27] Grebow D., “Generating Periodic Orbits in the Circular Restricted Three-Body Problem with Applications to Lunar South Pole Coverage,” Master’s Thesis, School of Aeronautics and Astronautics,  Purdue Univ., West Lafayette, IN, 2006. Google Scholar[28] Boroson D. M. and Robinson B. S., “The Lunar Laser Communication Demonstration: NASA’s First Step Toward Very High Data Rate Support of Science and Exploration Missions,” Space Science Reviews, Vol. 185, Nos. 1–4, 2014, pp. 115–128. https://doi.org/10.1007/s11214-014-0122-y CrossrefGoogle Scholar[29] Ward R. L., Fleddermann R., Francis S., Mow-Lowry C., Wuchenich D., Elliot M., Gilles F., Herding M., Nicklaus K., Brown J., Burke J., Dligatch S., Farrant D., Green K., Seckold J., Blundell M., Brister R., Smith C., Danzmann K., Heinzel G., Schütze D., Sheard B. S., Klipstein W., McClelland D. E. and Shaddock D. A., “The Design and Construction of a Prototype Lateral-Transfer Retro-Reflector for Inter-Satellite Laser Ranging,” Classical and Quantum Gravity, Vol. 31, No. 9, 2014, Paper 095015. https://doi.org/10.1088/0264-9381/31/9/095015 Google Scholar[30] Sood R. and Howell K. C., “Solar Sail Transfers and Trajectory Design to Sun-Earth L4, L5: Solar Observations and Potential Earth Trojan Exploration,” Journal of the Astronautical Sciences, Vol. 66, No. 3, 2019, pp. 247–281. https://doi.org/10.1007/s40295-018-00141-4 CrossrefGoogle Scholar[31] Fernandez A., Heiligers J. and Heaton A. F., “Solar Sail Transfers from Invariant Objects to L5 Periodic Orbits,” 7th International Conference on Astrodynamics Tools and Techniques, Nov. 2018. Google Scholar[32] Marchand B. G., Howell K. C. and Wilson R. S., “Improved Corrections Process for Constrained Trajectory Design in the n-Body Problem,” Journal of Spacecraft and Rockets, Vol. 44, No. 4, 2007, pp. 884–897. https://doi.org/10.2514/1.27205 LinkGoogle Scholar[33] McInnes A. I. S., “Strategies for Solar Sail Mission Design in the Circular Restricted Three-Body Problem,” Master’s Thesis, School of Aeronautics and Astronautics,  Purdue Univ., West Lafayette, IN, 2000. Google Scholar[34] Biggs J., McInnes C. R. and Waters T., “Control of Solar Sail Periodic Orbits in the Elliptic Three-Body Problem,” Journal of Guidance, Control, and Dynamics, Vol. 32, No. 1, 2009, pp. 318–320. https://doi.org/10.2514/1.38362 LinkGoogle Scholar[35] Hu G., Ong C. and Teo C., “Direct Collocation and Nonlinear Programming for Optimal Control Problem Using an Enhanced Transcribing Scheme,” Proceedings of the 1999 IEEE International Symposium on Computer Aided Control System Design, IEEE, New York, 1999, pp. 369–374. https://doi.org/10.1109/CACSD.1999.808613 Google Scholar[36] Gámez Losada F., “Controllability of Solar-Sail Orbits in the Earth-Moon System,” Master’s Thesis,  Delft Univ. of Technology, Delft, The Netherlands, 2019, http://resolver.tudelft.nl/uuid:3aa2c8bc-010d-4450-9ce7-04b0e2f40cfb. Google Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Analytical Estimation of the Velocity Increment in ",
        "url": "https://arc.aiaa.org/doi/10.2514/1.G005827",
        "date": "20210916",
        "content": "AbstractIt is essential when planning multitarget missions to rapidly and accurately estimate the velocity increments of target-to-target transfers. An analytical method is proposed to estimate the optimal velocity increment of a multirevolution impulsive transfer, taking account of the J2 perturbation. First, for a phasing problem where the differences in semimajor axis, inclination, ascending node, and argument of latitude at the termination of the transfer are eliminated, two linear equations derived from the first-order necessary conditions are solved to determine the normal components of the impulses. Then, the radial and tangential components of the impulses are determined by solving another two linear equations, thereby eliminating the difference in the eccentricity vector. In a classical debris removal scenario, the proposed method shows better accuracy than previous analytical methods and even a method based on a deep neural network. The computational efficiency of the method is also much higher than that of the existing semi-analytical method. In addition, the estimated transfer process is in good agreement with the exact one in some cases, and so the method shows potential for preliminary designs of impulsive trajectories.I. IntroductionMultitarget missions in low Earth orbits (LEOs) such as active debris removal [1–5] and in-orbit refueling [6,7] missions have been widely discussed in recent studies. In such missions, a spacecraft rendezvouses with a sequence of targets, and the rendezvous sequence largely determines the total cost of the mission. When constructing a rendezvous sequence, the optimal velocity increment cost from the current orbit to the target is an important criterion in target selection. Under the assumption that multiple impulses are implemented during the target-to-target transfer, the velocity increment is obtained by solving a parameter optimization problem. Because the flattening perturbation of the Earth has a significant effect on long-term motion in LEO, the perturbed Lambert problem needs to be solved first in the case of double-impulse transfer. The Keplerian solution is generally used as a warm start to solve the perturbed Lambert problem [8–10], but time-consuming numerical computations are inevitable. In multi-impulse transfer, there exist many local optima, especially when the transfer is multirevolution. Stochastic algorithms such as particle swarm optimization (PSO) algorithm [11] and genetic algorithm [12] have been applied to globally search for the optimal transfer with different numbers of impulses, which lead to a huge computation. These numerical methods can provide the near-optimal velocity increment of a perturbed impulsive transfer but consume too much computation time. For example, the homotopic method in [8] takes thousands of seconds to solve a perturbed Lambert problem, and the PSO method in [11] takes 40 s to optimize a transfer with multiple impulses. When the number of targets and the search space of the rendezvous sequence are very large, the procedure to calculate the velocity increment of transfers needs to be executed frequently when searching the sequence, and thus the computational burden makes these numerical methods unsuitable.To obtain an optimal sequence within an acceptable computation time, the optimal velocity increment of transfers should be calculated both rapidly and accurately. A widely used approach is to generate a database of feasible target-to-target transfers using numerical optimization for the velocity increment, storing the target pair, initial time, duration, and velocity increment of each transfer, and then look up the database when searching the sequences to obtain the velocity increment of a given transfer [13]. The initial time and duration of the transfers are discretized in given intervals, and smaller discrete steps lead to larger amounts of data. Cerf [14] performed a bilinear interpolation on the initial time and duration when looking up the database for the velocity increment. In this case, smaller discrete steps make the interpolated velocity increment more accurate. Bang and Ahn [15] combined the transfers in the database to obtain a feasible rendezvous sequence such that the velocity increment of each transfer was accurately given, but the search space was restricted in the database. The database performs better if it contains more transfers, but the computational cost of data generation is then higher. It cost 112 h to generate a database with 40,000 transfers in [14], and 37 h with 20,000 transfers in [15]. In the 9th Global Trajectory Optimization Competition (GTOC9), 123 pieces of debris were removed by a succession of missions [16]. The Jet Propulsion Laboratory (JPL) Team won the competition using a database with 290 million transfers [17], which required a huge amount of computation and a large memory to store the data. Recently, deep neural networks (DNNs) have been applied to estimate the velocity increment. Li et al. [11] and Zhu and Luo [18] trained neural networks using the initial and final orbital elements and the transfer duration. A mean relative estimation error that is smaller than 4% can be obtained with tens of thousands of training samples, which still takes days to generate.Analytical estimation is another way to calculate the velocity increment. Edelbaum [19] derived an analytical approximation of the velocity increment to match the semimajor axis, eccentricity, and inclination between near-circular orbits, but he did not consider the flattening perturbation that results in precession of the ascending node. Shen et al. [20] and Li et al. [21] applied Edelbaum’s formulas, combined with a correction of the right ascension ascending node (RAAN), to rapidly estimate the velocity increment. Similarly, Luo et al. [22] presented an analytical estimation method based on Gauss’s form of the variational equations, taking account of adjustment of the semimajor axis, eccentricity, inclination, and RAAN. However, these methods do not exploit the precession of the RAAN to reduce the velocity increment, and the mean relative error is about 20% according to [18]. Shen and Casalino [23] approximated the optimal velocity increment by analytically minimizing the sum of squared impulses. Their method makes a full use of the RAAN precession and achieves higher accuracy than previous analytical methods, but the eccentricity correction is empirical and the difference in phase is ignored. Some semi-analytical methods have also been investigated. Riggi and D’Amico [24] proposed a series of analytical closed-form impulsive maneuvers for formation reconfiguration, but the locations of impulses were calculated numerically. Huang et al. [25] derived the Kuhn–Tucker condition for the velocity increment optimization problem and transformed it into several nonlinear equations, which were solved numerically. Zuiani and Vasile [2] and Di Carlo et al. [3] derived formulas to approximately express the variation of the orbital elements due to a low thrust acceleration and orbit perturbations, so that orbital propagation can be calculated analytically, and then the velocity increment was obtained by numerically solving a parametric optimization problem. These methods are more accurate than purely analytical methods for estimating the velocity increment, but they involve numerical iterative algorithms, which are time-consuming.In this paper, a new analytical method is proposed to estimate the velocity increments of impulsive transfers, taking account of the flattening perturbation. It is assumed that the transfer is multirevolution and that the considered orbits are near-circular, which means that the eccentricities of the orbits are near-zero. Two impulses are applied near the start and the termination of the transfer, and so full use is made of the perturbation to adjust the orbital plane through the whole duration of the transfer. The differences in the orbital elements are eliminated by two steps. First, the differences in semimajor axis, inclination, RAAN, and argument of latitude are eliminated by solving a phasing problem in which the total velocity increment is optimized. Then, by introducing the radial components of the impulses, the difference in eccentricity vector is eliminated based on solution of the phasing problem, and the velocity increment is optimized again. The first-order necessary conditions (FONCs) for the optimization problem are linearized and solved analytically, and thus numerical solutions are avoided.The remainder of the paper is organized as follows. In Sec. II, the basic assumptions and the dynamic model are given, and velocity increments to eliminate the differences in semimajor axis, inclination, and RAAN are formulated. In Sec. III, the differences in phase and eccentricity vector are eliminated successively by solving four linear equations derived from the FONC. In Sec. IV, the method is validated by the debris removal scenario from GTOC9. Finally, Sec. V presents the conclusions.II. Formulation of the Impulsive TransferIn the transfers considered, the chaser spacecraft and the target are both in near-circular orbits, and the variations of the semimajor axis and inclination are not too large. For example, in the debris removal problem from GTOC9, the eccentricities of the debris orbits are below 0.02, and so the orbits can be considered near-circular. The semimajor axes and inclinations of the debris orbits are distributed in [6996.104, 7273.982] km and [96.236, 101.067] deg, respectively. When transferring from one piece of debris to another, the relative variations of the semimajor axis and inclination are within 5%, which are regarded as small enough. In addition, the transfer duration is much longer than the orbital period, and so the transfer is multirevolution. Based on these assumptions, perturbed transfer processes are formulated in this section.A. Dynamic ModelThe exact dynamic equation for the chaser and the target, taking account of the flattening perturbation of the Earth, are described in terms of the position vector R=[X,Y,Z]T and the velocity vector V=[Vx,Vy,Vz]T: {dRdt=VdVxdt=−μX‖R‖3(1+32J2(Re‖R‖)2(1−5Z2‖R‖2))dVydt=−μY‖R‖3(1+32J2(Re‖R‖)2(1−5Z2‖R‖2))dVzdt=−μZ‖R‖3(1+32J2(Re‖R‖)2(3−5Z2‖R‖2))(1)where J2=1.08262668×10−3 is the coefficient of the flattening perturbation, μ=3.986004418×1014  m3/s2 is the gravitational constant of the central body, and Re=6378137  m is the mean equatorial radius.Neglecting the short-term effect of the J2 perturbation, the states of the chaser and the target can be expressed by the mean orbit elements S=[a,e,i,Ω,ω,M]T, where the six elements denote semimajor axis, eccentricity, inclination, right ascension of ascending node, argument of perigee, and mean anomaly, respectively. The differential equations for S are {dadt=dedt=didt=0dΩdt=−32J2μ(Re1−e2)2a−72cos(i)dωdt=32J2μ(Re1−e2)2a−72(2−52sin2(i))dMdt=μa−32+32J2μ(Re1−e2)2a−72(1−32sin2(i))1−e2(2)Considering that the eccentricities of near-circular orbits are approximately zero, these differential equations can be simplified as {dadt=dedt=didt=0dΩdt=Ka−72cos(i)dωdt=−Ka−72(2−52sin2(i))dMdt=μa−32−Ka−72(1−32sin2(i))(3)where K=−1.5J2μRe2. From Eq. (3), the natural drift rate of the RAAN can be set to a desired value by changing a and i, and thus it can be used to adjust the orbital plane of the chaser.B. Formulation of the Velocity IncrementGiven the initial time t0, final time tf, initial state of the chaser S0=[a0,e0,i0,Ω0,ω0,M0]T, and target state Sf=[af,ef,if,Ωf,ωf,Mf]T, the transfer process can be accomplished by applying two impulsive maneuvers. The first impulse ΔV1 is applied within an orbital period after the initial time, and the second ΔV2 within an orbital period before the final time. The orbital period is much shorter than the transfer duration, and so the flight time between the two impulses is approximately Δt=tf−t0. It is assumed that each impulse is composed of a tangential component ΔVt,i and a normal component ΔVh,I(I=1,2). The tangential component changesa and the normal one adjusts the orbital plane by changing i and Ω. The variations in a, i, and Ω caused by the impulses, which are assumed to be small, are given by [26] ΔaI=2aI−1ΔVt,IVI−1,ΔiI=cos(uI)ΔVh,IVI−1,ΔΩI=sin(uI)sin(iI−1)ΔVh,IVI−1(I=1,2)(4)uI=ωI+MI,VI−1=μaI−1(I=1,2)(5)a1=a0+Δa1,i1=i0+Δi1(6)where ωI, MI, uI, and VI−1 are the argument of perigee, mean anomaly, argument of latitude, and orbital velocity when ΔVI is applied, respectively. Therefore, the velocity increment of ΔVI can be calculated by ΔVI=ΔVt,I2+ΔVh,I2=VI−1(ΔaI2aI−1)2+ΔiI2+ΔΩI2sin2(iI−1)(I=1,2)(7)Given Δa1, Δi1, and ΔΩ1, the velocity increment of the first impulse ΔV1 is determined directly. After ΔV1 has been applied, the semimajor axis and inclination are updated by Eq. (6) and the drift rate of the RAAN is also updated by substituting a1 and i1 into Eq. (3). The drift rates of the RAAN before and after updating are given by Ω˙0=Ka0−(7/2)cos(i0) and Ω˙1=Ka1−(7/2)cos(i1), respectively. The RAAN drifts with the adjusted rate until ΔV2 is applied to eliminate the remaining differences in semimajor axis, inclination, and RAAN. Thus, Δa2, Δi2, and ΔΩ2 are calculated by Δa2=Δa−Δa1Δi2=Δi−Δi1ΔΩ2=ΔΩ−ΔΩ1−(Ω˙1−Ω˙0)Δt(8)where Δa=af−a0Δi=if−i0ΔΩ¯=mod(Ωf−Ω0−Ω˙0Δt,2π)ΔΩ={ΔΩ¯−2π(ΔΩ¯>π)ΔΩ¯(ΔΩ¯≤π)(9)Then ΔV2 is obtained by substituting Δa2, Δi2, and ΔΩ2 into Eq. (7).Thus, the total velocity increment ΔV=ΔV1+ΔV2 is determined once Δa1, Δi1, and ΔΩ1 are given. The normalized optimization variables x1=Δa1/a0, x2=Δi1, and x3=ΔΩ1 are introduced, and ΔV can be expressed as ΔV=V0(x124+x22+x32sin2(i0)+11+x1((Δa/a0−x1)24(1+x1)2+(Δi−x2)2+ΔΩ22sin2(i0+x2)))(10)where ΔΩ2=ΔΩ−x3−(Ka0−72(1+x1)−72cos(i0+x2)−Ω˙0)Δt(11)The optimal ΔV can be found by satisfying the FONC: ∂ΔV∂x1=0,∂ΔV∂x2=0,∂ΔV∂x3=0(12)It is very difficult to deduce the analytical solution to Eq. (12) directly, and so some approximations and simplifications need to be introduced. In addition, only the differences in a, i, and Ω are eliminated using the impulses formulated in this section, whereas the differences in e, ω, and M are not considered.III. Analytical Approximation of the Optimal Velocity IncrementIn this section, an analytical method is proposed to approximate the optimal velocity increment. The differences in e, ω, and M are transformed to differences in phase and eccentricity vector and eliminated by two steps.A. Solution of the Phasing ProblemThe argument of latitude u=ω+M represents the phase angle in the orbit. The difference in u at tf if no impulse is applied, denoted by Δu, is calculated by ω˙0=−Ka0−72(2−52sin2(i0))M˙0=μa0−32−Ka0−72(1−32sin2(i0))u˙0=ω˙0+M˙0=μa0−32−Ka0−72(3–4sin2(i0))Δu¯=mod(uf−u0−u˙0Δt,2π)Δu={Δu¯−2π(Δu¯>π)Δu¯(Δu¯≤π)(13)A phasing problem needs to be solved in which the first impulse adjusts the drift rate of u by changing a and i. To eliminate Δu, the variation in the drift rate of u should be Δu˙=Δu+2NπΔt≈a0∂u˙0∂a0x1+∂u˙0∂i0x2(14)where N is the number of the additional revolutions. When the magnitudes of x1 and x2 are similar, the magnitude of the first term on the right of the approximate equality sign is generally 103 times larger than that of the second one, and so we only consider the variation in a to change the drift rate of u. Therefore, Δa1 can be obtained by Δa1=Δu+2Nπ(∂u˙0/∂a0)Δt=Δu+2Nπ(−(3/2)μa0−52+72Ka0−92(3–4sin2(i0)))Δt(15)From Eqs. (4) and (15), Δa1 can be written as Δa1=2a0ΔVt,1V0=Δu+2Nπ∂u˙0∂a0Δt(16)Thus, ΔVt,1 is determined by N: ΔVt,1=Δu+2Nπ2a0(∂u˙0/∂a0)ΔtV0(17)Assuming |ΔVt,1|≤ΔVt__max, the maximum of N, denoted by Nmax, can be derived from Eq. (17): Nmax=⌊12π(2a0|∂u˙0∂a0|ΔVt_maxV0Δt−|Δu|)⌋(18)Where ⌊⋅⌋ represents rounding down. Given N in the set {−Nmax,−Nmax+1,…,Nmax}, Δa1 is determined, as well as a1, Δa2, and V1. Therefore, x1 is fixed, and the total velocity increment to be minimized is expressed as ΔV=V0(ΔV˜1+ΔV˜2)(19)where ΔV˜1=ΔV1V0=Δa124a02+x22+x32sin2(i0)ΔV˜2=ΔV2V0=a0a1(Δa224a12+(Δi−x2)2+ΔΩ22sin2(i0+x2))(20)Let the objective function f=ΔV/V0, then the optimal solution should satisfy the FONC: ∂f∂x2=x2ΔV˜1+a0a1ΔV˜2(x2−Δi+ΔΩ2Ka1−72Δtsin3(i0+x2)+ΔΩ22sin(i0+x2)cos(i0+x2))=0∂f∂x3=x3ΔV˜1sin2(i0)−a0a1ΔV˜2ΔΩ2sin2(i0+x2)=0(21)where ΔΩ2=ΔΩ−x3−(Ka1−72cos(i0+x2)−Ω˙0)Δt(22)The approximate analytical solution to Eq. (21) is obtained by successively solving two subproblems: Problems 1 and 2.Problem 1:Inspired by [23], a new objective function is introduced as f=ΔV˜12+ΔV˜22=Δa124a02+x22+x32sin2(i0)+a0a1(Δa224a12+(Δi−x2)2+ΔΩ22sin2(i0+x2))(23)Then the FONC is ∂f∂x2=2x2+2a0a1(x2−Δi+ΔΩ2Ka1−72Δtsin3(i0+x2)+ΔΩ22sin(i0+x2)cos(i0+x2))=0∂f∂x3=2x3sin2(i0)−2a0a1ΔΩ2sin2(i0+x2)=0(24)Note that the magnitudes of x2 and x3 are small, and so Eq. (24) can be linearized by the first-order approximation of the Taylor expansion. The linear equation deduced from Eq. (24) is, in matrix form, [1+a0a1T1−a0a1T2−a0a1T2(1+a0a1)sin2(i0)][x2x3]=[a0a1T3a0a1sin2(i0)ξ](25)where T1=1+5Ka1−72sin2(i0)cos(i0)ξΔt+K2a1−7sin4(i0)Δt2+cos(2i0)ξ2T2=Ka1−72sin3(i0)Δt+sin(2i0)ξT3=Δi−Ka1−72sin3(i0)Δtξ−sin(i0)cos(i0)ξ2ξ=ΔΩ−Ka1−72cos(i0)Δt+Ω˙0Δt(26)Approximations of the normalized velocity increment ΔV˜1 and ΔV˜2 are obtained by substituting the solutions for x2 and x3 into Eq. (20).Problem 2:The objective function is set to f=ΔV/V0 again. Then Eq. (21) is linearized, with ΔV˜1 and ΔV˜2 being fixed to the values obtained in Problem 1. The linear equation deduced from Eq. (21) is [1ΔV˜1+a0a1ΔV˜2T1−a0a1ΔV˜2T2−a0a1ΔV˜2T2(1ΔV˜1+a0a1ΔV˜2)sin2(i0)][x2x3]=[a0a1ΔV˜2T3a0a1ΔV˜2sin2(i0)ξ](27)Equation (27) provides an approximate solution to Eq. (21).B. Correction of the Eccentricity VectorBased on the solution of the phasing problem, the adjustment of the eccentricity vector e=[ex,ey]T=[ecos(ω),esin(ω)]T is considered here to eliminate the differences in e and ω. Assuming e to be approximately zero, the variation in e after an impulse can be derived from Gauss’s variational equation [26]: Δex=1V(2cos(u)ΔVt+sin(u)ΔVr)Δey=1V(2sin(u)ΔVt−cos(u)ΔVr)(28)where V and u are, respectively, the orbital velocity and argument of latitude when the impulse is applied, ΔVt is the tangential velocity increment, and ΔVr is the radial velocity increment. Thus, in-plane vertical components ΔVr,1 and ΔVr,2 are added to ΔV1 and ΔV2, respectively. Considering the drift of ω, the eccentricity vector rotates for Δt between the two impulses, and so the following constraints should be satisfied to eliminate the difference in eccentricity vector at tf. {Δex,I=1VI−1(2cos(uI)ΔVt,I+sin(uI)ΔVr,I)Δey,I=1VI−1(2sin(uI)ΔVt,I−cos(uI)ΔVr,I)(I=1,2)[cos(ω˙1Δt)−sin(ω˙1Δt)sin(ω˙1Δt)cos(ω˙1Δt)]([e0cos(ω0)e0sin(ω0)]+[Δex,1Δey,1])+[Δex,2Δey,2]=[efcos(ωf)efsin(ωf)](29)where ω˙1 is the drift rate of ω after the first impulse, which is calculated by substituting the previously obtained a1 and i1 into Eq. (3), and uI can be obtained by uI=arctan(ΔΩIsin(iI−1)/ΔiI) according to Eq. (4) (I=1,2). The variations in eccentricity caused by ΔVt,I and ΔVr,I, denoted by Δet,I and Δer,I, respectively, are expressed as (I=1,2) Δet,I=2ΔVt,IVI−1Δer,I=ΔVr,IVI−1(30)Thus, the constraints (29) can be rewritten as cos(u1′)Δet,1+sin(u1′)Δer,1+cos(u2)Δet,2+sin(u2)Δer,2=efcos(ωf)−e0cos(ω0′)=Δexfsin(u1′)Δet,1−cos(u1′)Δer,1+sin(u2)Δet,2−cos(u2)Δer,2=efsin(ωf)−e0sin(ω0′)=Δeyf(31)where u1′=u1+ω˙1Δt,ω0′=ω0+ω˙1Δt(32)The impulse ΔVI is considered to be divided into two impulses ΔVI(1)=[ΔVt,I(1),ΔVh,I(1),ΔVr,I(1)]T and ΔVI(2)=[ΔVt,I(2),ΔVh,I(2),ΔVr,I(2)]T that are applied at uI and uI+π, respectively. The components of ΔVI(1) and ΔVI(2) satisfy |ΔVt,I(1)|/|ΔVt,I(2)|=−ΔVh,I(1)/ΔVh,I(2)=−ΔVr,I(1)/ΔVr,I(2)|ΔVt,I(1)|+|ΔVt,I(2)|=|ΔVt,I|,ΔVh,I(1)−ΔVh,I(2)=ΔVh,I,ΔVr,I(1)−ΔVr,I(2)=ΔVr,I(33)and so the velocity increment is still ΔVI and the variations of the orbital elements caused by ΔVh,I and ΔVr,I do not change. If ΔVt,I(1) and ΔVt,I(2) are of the same (opposite) sign, they will reinforce (offset) each other in changinga while offsetting (reinforcing) each other in changing ex and ey. Thus, Δet,I and Δer,I can be approximately expressed by Eq. (34), whereas the variation in semimajor axis is expressed by Eq. (35). Δet,I=2ΔVt,I(1)−ΔVt,I(2)VI−1Δer,I=ΔVr,I(1)−ΔVr,I(2)VI−1=ΔVr,IVI−1(34)ΔaI=2aI−1ΔVt,I(1)+ΔVt,I(2)VI−1(35)Therefore, ΔVt,I is given as follows: ΔVt,I={Δet,I2VI−1(|Δet,I|>|ΔaI/aI−1|)ΔaI2aI−1VI−1(|Δet,I|≤|ΔaI/aI−1|)(36)Four new optimization variables are introduced as y1=Δet,1, y2=Δer,1, y3=Δet,2, and y4=Δer,2. Assuming |y1|>|Δa1/a0||y3|>|Δa2/a1|(37)the normalized velocity increments ΔV˜1 and ΔV˜2 are reformulated as ΔV˜1=y124+Δi12+ΔΩ12sin2(i0)+y22ΔV˜2=a0a1(y324+Δi22+ΔΩ22sin2(i1)+y42)(38)From Eq. (31), it can be deduced that y1=Δe1−cos(υ)y3−sin(υ)y4y2=Δe2+sin(υ)y3−cos(υ)y4(39)where υ=u2−u1′(40)Δe1=Δexfcos(u1′)+Δeyfsin(u1′)Δe2=Δexfsin(u1′)−Δeyfcos(u1′)(41)By substituting Eq. (39) into Eq. (38), the objective function to be minimized is expressed as f=ΔV˜1+ΔV˜2ΔV˜1=(Δe1−cos(υ)y3−sin(υ)y4)24+Δi12+ΔΩ12sin2(i0)+(Δe2+sin(υ)y3−cos(υ)y4)2ΔV˜2=a0a1(y324+Δi22+ΔΩ22sin2(i1)+y42)(42)The FONCs are ∂f∂y3=1ΔV˜1((14+3sin2(υ)4+a0ΔV˜14a1ΔV˜2)y3−3sin(υ)cos(υ)4y4−Δe14cos(υ)+Δe2sin(υ))=0∂f∂y4=1ΔV˜1(−3sin(υ)cos(υ)4y3+(14+3cos2(υ)4+a0ΔV˜1a1ΔV˜2)y4−Δe14sin(υ)−Δe2cos(υ))=0(43)Analytical solution of Eq. (43) is difficult owing to the nonlinearity of ΔV˜1 and ΔV˜2, and so an approximate analytical solution is obtained by successively solving two subproblems: Problems 3 and 4. Problem 3:First, a new objective function is introduced by summing the squares of ΔV˜1 and ΔV˜2 and discarding the constant terms: f=(Δe1−cos(υ)y3−sin(υ)y4)24+(Δe2+sin(υ)y3−cos(υ)y4)2+a0a1(y324+y42)(44)A linear equation is derived from the FONC: [12+a02a1+32sin2(υ)−32sin(υ)cos(υ)−32sin(υ)cos(υ)12+2a0a1+32cos2(υ)][y3y4]=[Δe12cos(υ)−2Δe2sin(υ)Δe12sin(υ)+2Δe2cos(υ)](45)By substituting y3 and y4 obtained from Eq. (45) into Eq. (42), ΔV˜1, and ΔV˜2 are obtained.Problem 4:The objective function is set to that given by Eq. (42). Fixing ΔV˜1 and ΔV˜2 to the values obtained in Problem 3, the FONC (43) is transformed into a linear equation: [12+a0ΔV˜12a1ΔV˜2+32sin2(υ)−32sin(υ)cos(υ)−32sin(υ)cos(υ)12+2a0ΔV˜1a1ΔV˜2+32cos2(υ)][y3y4]=[Δe12cos(υ)−2Δe2sin(υ)Δe12sin(υ)+2Δe2cos(υ)](46)Eq. (46) provides an approximate solution to Eq. (43). By substituting y3 and y4 from Eq. (39), y1 and y2 can be obtained. Note that y1 and y3 may not satisfy the assumption Eq. (37), and so the total velocity increment is calculated by ΔV1={V0y124+Δi12+ΔΩ12sin2(i0)+y22(|y1|>|Δa1/a0|)V0Δa124a02+Δi12+ΔΩ12sin2(i0)+y22(|y1|≤|Δa1/a0|)ΔV2={V1y324+Δi22+ΔΩ22sin2(i1)+y42(|y3|>|Δa2/a1|)V1Δa224a12+Δi22+ΔΩ22sin2(i1)+y42(|y3|≤|Δa2/a1|)ΔV=ΔV1+ΔV2(47)C. Summary of the Solution MethodThe method to analytically estimate the optimal velocity increment of an impulsive transfer is summarized in Algorithm 1. Given t0, tf, S0, and Sf, Nmax is determined by Eq. (18). For each N in the set−Nmax,−Nmax+1,n,Nmax, the variations of the semimajor axis caused by the two impulses are calculated first. Next, Problems 1 and 2 are solved successively to obtain the variations of the inclination and RAAN in the phasing problem. Then, Problems 3 and 4 are solved successively to obtain the velocity increment ΔV. The solutions of Problems 1–4 are obtained by solving four linear equations. Finally, among the values of ΔV for all available N, the minimum one is output as the estimation result. The whole procedure is totally analytical.IV. Simulation and ResultsIn this section, the method proposed to estimate the velocity increment of impulsive transfers is validated by the GTOC9 problem, where 123 debris targets are removed by a series of missions. In each mission, a spacecraft is placed on a target at the beginning and then rendezvouses with several targets sequentially. The spacecraft stays on each target for at least 5 days to remove it, and the duration between two neighboring rendezvous should be no more than 30 days. The champion solution with 10 missions found by the JPL Team is presented in detail in [17]. The velocity increments of all the 113 transfers in this solution are optimized using SNOPT [17], a software package for solving linear and nonlinear programs, and have been taken as a reference to verify the ΔV estimation methods in many previous works [18,23,25]. In [25], four transfers in this solution are improved and the corresponding ΔV values are updated. In this paper, the trajectory optimization method used in [9] is applied to further optimize the ΔV values of all the transfers. This method uses a PSO algorithm to solve the parametric optimization problem. The optimization variables include the impulsive vectors and the moments of maneuvers, and the optimization index is the total velocity increment ΔV of the transfer. The cases where the number of impulses is 2, 3, 4, or 5 are optimized separately, and the one with the smallest ΔV is taken as the optimal solution. If a smaller optimized ΔV is obtained, the previous optimized ΔV of the corresponding transfer is replaced with the new one. In addition to the four transfers improved in [25], another eight transfers are improved in this paper. The final optimized ΔV values are listed in Table 1, where the 12 shown in bold are the new optimized values and those in parentheses are the replaced previous ones. Because only 12 out of 113 transfers are further improved, it is reasonable to deem the ΔV values in Table 1 near-optimal. In the following discussion, the ΔV values in Table 1 are regarded as exact values to be taken as references for calculating estimation errors.This section consists of three parts. First, the estimated ΔV values of the 113 transfers are presented, as well as the estimation errors obtained by comparing the estimated ΔV values with the exact values in Table 1. Then, to demonstrate the efficiency of the proposed method, the estimated results and the computational burden are compared with those of other estimation methods. Finally, typical cases of a single transfer are studied in detail to validate the proposed method in approximating the exact transfer process.A. Estimated ΔV of the Transfers in the JPL’s SolutionThe ΔV estimation procedure is implemented on all the transfers. First, the value of ΔVt__max is set to 200  m/s, which is enough in the considered debris removal scenario, to determine Nmax. Then, Problems 1–4 are solved for each N in the loop of the ΔV estimation procedure. The effectiveness of the ΔV estimation result is evaluated by the absolute error Ea=ΔV−ΔVex and the relative error Er=(ΔV−ΔVex)/ΔVex×100%, where ΔV is the estimated value and ΔVex is the exact value shown in Table 1. The mean absolute error (MAE) and mean relative error (MRE) for all the transfers are calculated by MAE=(1/m)∑i=1m|Ea(i)| and MRE=(1/m)∑i=1m|Er(i)|, respectively, where m=113 is the total number of transfers and the superscript (i) denotes the ith transfer.Numbering the transfers in the JPL’s solution from 1 to 113, the absolute and relative errors of the estimation result in Table 2 are depicted in Fig. 1, where each circle corresponds to a single transfer. The MAE and MRE are 5.3  m/s and 3.7%, respectively. For the 113 transfers, the absolute errors are in [−8.4,34.9]  m/s and the relative errors are in [−7.9%, 26.7%]. The estimated ΔV is slightly larger than the exact one in general.Fig. 1 a) Absolute and b) relative errors of all the transfers.B. Comparison with Other Estimation MethodsTo the authors’ knowledge, the method presented in [23] is the most accurate among the previous analytical ΔV estimation methods considering the J2 perturbation. The estimation results with eccentricity correction given in [23] are compared with the results obtained in this paper. Table 3 compares the errors in the estimated ΔV from Table 2 with those of the results from [23]. The absolute and relative errors for each transfer are plotted in Fig. 2.From Table 3, it can be seen that the MAE and MRE of the results in this paper are smaller than those in [23]. The distribution ranges of the estimation errors in this paper are also smaller. Thus, the estimation method proposed here is more accurate than that given in [23]. Figure 2 plots the errors of the estimated ΔV obtained both here and in [23], where each point represents a transfer. The exact velocity increment is shown on the horizontal axis and the estimation error on the vertical axis. For the transfers with a velocity increment that is less than 300  m/s, the present results and those in [23] show similar estimation errors. For the transfers with a larger velocity increment, the absolute errors of the results in [23] increase with the exact velocity increment, whereas the present results have smaller errors. Thus, our method is more robust than that in [23].Fig. 2 a) Absolute and b) relative errors of the estimated ΔV in [23] and this paper.In addition to analytical methods, DNNs have been applied to ΔV estimation in previous researches and have shown a high accuracy. In [18], the estimated velocity increments of the transfers in missions 1 and 9 were obtained using a DNN-based method. The absolute and relative errors of the results in [18] and in this paper are compared as follows.As Table 4 shows, in both missions 1 and 9, the MAE and MRE of our estimation results are smaller than those of the DNN results. The absolute errors and relative errors for all the transfers in missions 1 and 9 are plotted in Fig. 3. It can be seen that the maximum absolute errors of the results obtained by the two methods are similar, although the mean errors of our method are smaller. In addition, the maximum relative error of our results is smaller than that of the DNN results. This is because our method leads to smaller absolute errors for the transfers with small ΔV in this example.Finally, the computational burden of the proposed method is compared with a semi-analytical method. The proposed estimation procedure is coded in C++ and run on a personal computer (CPU: Intel i7-8700 3.2 GHz; memory: 16 GB), taking 0.015 ms on average to calculate the estimated ΔV of a single transfer. On the same hardware, the semi-analytical method in [25] took 2.1 ms for a single transfer. Therefore, the proposed method has a great advantage in computation time and is more suitable for target sequence searching in multirendezvous optimization problems.Fig. 3 Absolute and relative errors of the estimation results in [18] and this paper.C. Analysis of a Single TransferThe proposed method provides not only the estimated ΔV but also the variations in the mean orbital elements caused by the impulses, and so the details of the transfer process can be approximately obtained. The approximate transfer process is compared with the exact one, which should be near-optimal, to validate the proposed method. As mentioned before, the PSO method used in [11] is applied to obtain the exact solutions of the 113 transfers. Only eight transfers are further improved and considered near-optimal: the 5th transfer in mission 1, the 9th transfer in mission 2, the 2nd transfer in mission 3, the 3rd transfer in mission 3, the 16th transfer in mission 3, the 6th transfer in mission 6, the 4th transfer in mission 8, and the 4th transfer in mission 9. For simplicity, two of the eight transfers are chosen as typical cases: the 9th transfer in mission 2 (from debris 7 to 2) and the 4th transfer in mission 8 (from debris 30 to 92).The optimized ΔV values of the transfer from debris 7 to 2 obtained in this paper and in [17] are 103.7 and 105.3  m/s, respectively, and the estimated ΔV is 105.2  m/s. Although the optimized and estimated ΔV are similar, there exist big differences between the exact and approximate transfers. In the approximate transfer, the two impulses are applied at the initial and final times, respectively. However, in the exact transfer, two dominant impulses are applied in the middle of the transfer.The time histories of a, i, Ω, and Ω˙ are depicted in Fig. 4. In both the exact and approximate transfers, a and i are adjusted to values intermediate that is between the initial and target values, as is the drift rate of the RAAN. This is because the RAANs of the initial and the target orbits intersect at 23,968.914 MJD2000, which means that the natural drift of the RAAN is enough to make a rendezvous. The two dominant impulses in the exact transfer are applied near the intersection of the RAAN, and so the velocity increment to adjust Ω is very small, whereas the two impulses in the approximate transfer are applied at the initial and the final times, which is not the optimal maneuver scheme. Thus, the ΔV of the exact transfer is smaller than that of the approximate transfer.The transfer from debris 30 to 92 is quite a different case. The optimized ΔV values obtained in this paper and in [17] are 144.4 and 144.5  m/s, respectively, and the estimated value is 142.4  m/s. In the exact transfer, two impulses are applied near the initial time and a third impulse at the final time.Fig. 4 Time histories of a, i, Ω, and Ω˙ through the transfer from debris 7 to 2.As show in Fig. 5, the time histories of a, i, Ω, and Ω˙ in the exact and approximate transfers are in a good agreement. The difference between the RAANs of the initial and the target orbits gradually increases according to the history of Ω. That is, the natural drift of the RAAN is not enough to make a rendezvous in the transfer duration. Thus,a is lifted and i is lowered at first to make the RAAN of the chaser drift more slowly than that of the target, and so the RAAN difference decreases as time goes by. These changes in a and i are implemented at the initial time to ensure that the whole transfer duration is used to adjust the RAAN using the drift. This is the optimal scheme to eliminate the RAAN difference in those cases where no intersection of the RAAN occurs in the transfer duration. Therefore, in such cases, the approximate transfers are mostly identical to the exact ones.Fig. 5 Time histories of a, i, Ω, and Ω˙ through the transfer from debris 30 to 92.V. ConclusionsAn analytical method is proposed to estimate the optimal velocity increment of a multirevolution impulsive transfer with the J2 perturbation. The velocity increment is obtained by solving a series of optimization problems, in which the differences of the semimajor axis, inclination, and RAAN are eliminated, as are those in the phase and the eccentricity vector. The first-order necessary conditions of the optimization problems are linearized, and so an approximate solution of the original problem can be obtained by solving linear equations.The simulation results reveal the high accuracy of the proposed estimation method. For the transfers in the JPL’s solution of the 9th Global Trajectory Optimization Competition, the MAE and MRE of the estimated velocity increments are 5.3  m/s and 3.7%, respectively, which are smaller than those obtained by the existing analytical estimation method. In two multitarget missions, the proposed method shows higher accuracy than a DNN-based method. Compared with the semi-analytical method in the literature, the proposed method has an advantage in computation time because the estimation procedure is totally analytical. In addition to the estimated velocity increment, the method provides an approximate optimal transfer process. The approximate transfer coincides well with the optimized one when the RAANs of the initial and target orbits do not intersect through the transfer. Therefore, the method can be applied not only to target selection in multirendezvous problems but also to preliminary designs for impulsive trajectories.AcknowledgmentThis research was supported by the National Key R&D Program of China (2019YFA0706500).\r            References\r        [1] Casalino L., “Active Debris Removal Missions with Multiple Targets,” AIAA/AAS Astrodynamics Specialist Conference, AIAA Paper  2014-4226, Aug. 2014. https://doi.org/10.2514/6.2014-4226 Google Scholar[2] Zuiani F. and Vasile M., “Preliminary Design of Debris Removal Missions by Means of Simplified Models for Low-Thrust, Many-Revolution Transfers,” International Journal of Aerospace Engineering, Vol. 2012, May 2012, Paper 836250. https://doi.org/10.1155/2012/836250 CrossrefGoogle Scholar[3] Di Carlo M., Martin J. M. R. and Vasile M., “Automatic Trajectory Planning for Low-Thrust Active Removal Mission in Low-Earth Orbit,” Advances in Space Research, Vol. 59, No. 5, 2017, pp. 1234–1258. https://doi.org/10.1016/j.asr.2016.11.033 CrossrefGoogle Scholar[4] Zhao S., Zhang J., Xiang K. and Qi R., “Target Sequence Optimization for Multiple Debris Rendezvous Using Low Thrust Based on Characteristics of SSO,” Astrodynamics, Vol. 1, No. 1, 2017, pp. 85–99. https://doi.org/10.1007/s42064-017-0007-4 CrossrefGoogle Scholar[5] Bang J. and Ahn J., “Multitarget Rendezvous for Active Debris Removal Using Multiple Spacecraft,” Journal of Spacecraft and Rockets, Vol. 56, No. 4, 2019, pp. 1237–1247. https://doi.org/10.2514/1.A34344 LinkGoogle Scholar[6] Li C. and Bo X., “Optimal Scheduling of Multiple Sun-Synchronous Orbit Satellites Refueling,” Advances in Space Research, Vol. 66, No. 2, 2020, pp. 345–358. https://doi.org/10.1016/j.asr.2020.03.049 CrossrefGoogle Scholar[7] Zhu X., Zhang C., Sun R., Chen J. and Wan X., “Orbit Determination for Fuel Station in Multiple SSO Spacecraft Refueling Considering the J2 Perturbation,” Aerospace Science and Technology, Vol. 105, Oct. 2020, Paper 105994. https://doi.org/10.1016/j.ast.2020.105994 Google Scholar[8] Yang Z., Luo Y., Zhang J. and Tang G., “Homotopic Perturbed Lambert Algorithm for Long-Duration Rendezvous Optimization,” Journal of Guidance, Control, and Dynamics, Vol. 38, No. 11, 2015, pp. 2215–2223. https://doi.org/10.2514/1.G001198 LinkGoogle Scholar[9] Woollands R. M., Bani Y. A. and Junkins J. L., “New Solutions for the Perturbed Lambert Problem Using Regularization and Picard Iteration,” Journal of Guidance, Control, and Dynamics, Vol. 38, No. 9, 2015, pp. 1548–1562. https://doi.org/10.2514/1.G001028 LinkGoogle Scholar[10] Armellin R., Gondelach D. and San Juan J. F., “Multiple Revolution Perturbed Lambert Problem Solvers,” Journal of Guidance, Control, and Dynamics, Vol. 41, No. 9, 2018, pp. 2019–2032. https://doi.org/10.2514/1.g003531 LinkGoogle Scholar[11] Li H., Chen S., Izzo D. and Baoyin H., “Deep Networks as Approximators of Optimal Low-Thrust and Multi-Impulse Cost in Multitarget Missions,” Acta Astronautica, Vol. 166, Jan. 2020, pp. 469–481. https://doi.org/10.1016/j.actaastro.2019.09.023 CrossrefGoogle Scholar[12] Zhang J., Tang G. and Luo Y., “Optimization of an Orbital Long-Duration Rendezvous Mission,” Aerospace Science and Technology, Vol. 58, Nov. 2016, pp. 482–489. https://doi.org/10.1016/j.ast.2016.09.011 CrossrefGoogle Scholar[13] Petrov A. and Noomen R., “Optimizing Multi-Rendezvous Spacecraft Trajectories: ΔV Matrices and Sequence Selection,” arXiv preprint, 2020, arXiv: 2011.06617. Google Scholar[14] Cerf M., “Multiple Space Debris Collecting Mission: Optimal Mission Planning,” Journal of Optimization Theory and Applications, Vol. 167, Oct. 2015, pp. 195–218. https://doi.org/10.1007/s10957-015-0705-0 CrossrefGoogle Scholar[15] Bang J. and Ahn J., “Multitarget Rendezvous for Active Debris Removal Using Multiple Spacecraft,” Journal of Spacecraft and Rockets, Vol. 56, No. 4, 2019, pp. 1237–1247. https://doi.org/10.2514/1.A34344 LinkGoogle Scholar[16] Izzo D. and Märtens M., “The Kessler Run: On the Design of the GTOC9 Challenge,” Acta Futura, No. 11, 2018, pp. 11–24. https://doi.org/10.5281/zenodo.1142857 Google Scholar[17] Anastassios P., Daniel G., Drew J., Gregory L., Austin N., Javier R., Juan S., Jeffrey S., Nitin A., Thomas P., Try L., Timothy M., Ralph R., David G., Nicholas B., Damon L., Zahi T., Frank L., Eugene B., Mark W. and Jon S., “GTOC9: Results from the Jet Propulsion Laboratory (Team JPL),” Acta Futura, No. 11, Jan. 2018, pp. 25–35. https://doi.org/10.5281/zenodo.1139152 Google Scholar[18] Zhu Y. and Luo Y., “Fast Approximation of Optimal Perturbed Many-Revolution Multiple-Impulse Transfers via Deep Neural Networks,” arXiv preprint, 2019, arXiv: 1902.03741. Google Scholar[19] Edelbaum T. N., “Propulsion Requirements for Controllable Satellites,” ARS Journal, Vol. 31, No. 8, 1961, pp. 1079–1089. https://doi.org/10.2514/8.5723 LinkGoogle Scholar[20] Shen H., Zhang T., Casalino L. and Pastrone D., “Optimization of Active Debris Removal Missions with Multiple Targets,” Journal of Spacecraft and Rockets, Vol. 55, No. 1, 2018, pp. 181–189. https://doi.org/10.2514/1.A33883 LinkGoogle Scholar[21] Li H., Chen S. and Baoyin H., “J2-Perturbed Multitarget Rendezvous Optimization with Low Thrust,” Journal of Guidance, Control, and Dynamics, Vol. 41, No. 3, 2018, pp. 802–808. https://doi.org/10.2514/1.G002889 LinkGoogle Scholar[22] Luo Y., Zhu Y., Zhu H., Yang Z., Sun Z. and Zhang J., “GTOC9: Results from the National University of Defense Technology (Team NUDT),” Acta Futura, Vol. 11, Jan. 2018, pp. 37–47. https://doi.org/10.5281/zenodo.1139226 Google Scholar[23] Shen H. and Casalino L., “Simple ΔV Approximation for Optimization of Debris-to-Debris Transfers,” arXiv preprint, 2020, arXiv: 2004.02225. Google Scholar[24] Riggi L. and D’Amico S., “Optimal Impulsive Closed-Form Control for Spacecraft Formation Flying and Rendezvous,” 2016 American Control Conference (ACC), Inst. of Electrical and Electronics Engineers, New York, 2016, pp. 5854–5861. https://doi.org/10.1109/ACC.2016.7526587 Google Scholar[25] Huang A., Luo Y. and Li H., “Fast Estimation of Perturbed Impulsive Rendezvous via Semi-Analytical Equality-Constrained Optimization,” Journal of Guidance, Control, and Dynamics, Vol. 43, No. 12, 2020, pp. 2383–2390. https://doi.org/10.2514/1.G005220 LinkGoogle Scholar[26] Vallado D. A., Fundamentals of Astrodynamics and Applications, 3rd ed., Microcosm Press, El Segundo, CA, 2007, pp. 624–633. Google Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Multiple-Aircraft-Conflict Resolution Under Uncertainties",
        "url": "https://arc.aiaa.org/doi/10.2514/1.G005825",
        "date": "20210906",
        "content": "AbstractA new method for efficient trajectory planning to resolve potential conflicts among multiple aircraft is proposed. A brief review of aircraft trajectory planning and conflict resolution methods is given first. Next, a new method is proposed that is based on a probabilistic conflict risk map using the predicted probability of conflict with the intention information of the intruders. The risk-map-based method allows the path planning algorithm to simultaneously account for many uncertainties affecting safety, such as positioning error, wind variability, and human errors. Following this, A* algorithm is used to find the cost-minimized trajectory for a single aircraft by considering all other aircraft as intruders. Search heuristic method is implemented to iterate the A* algorithm for all aircraft to optimize the trajectory planning. Convergence and computation efficiency of the proposed method are investigated in detail. Numerical examples are used to illustrate the effectiveness of the proposed method under several important scenarios for air traffic control, such as wind effects, non-cooperative aircraft, minimum disturbance of pilots, and deconflict with flight intent information. Several conclusions are drawn based on the proposed method.NomenclatureDspecified safe separationdi,tobserved distance between the own aircraft and the ith intruderp¯i,tposition of the ith intruderstvector consisting of relative distances between the own aircraft and the intrudersttimeαfixed angle valueΔvspeed changeΔθheading angle changeσi,tstandard deviation of the relative distance measuring error with respect to the ith intruderI. IntroductionSeveral systems to assist air traffic controllers and pilots have been developed and used, for example, the Tactical Separation-Assisted Flight Environment (TSAFE) system developed by NASA Ames; Traffic Collision Avoidance System (TCAS), which is currently in use; and the Airborne Collision Avoidance System (ACAS), which is under development. Pressures on these systems and the controllers’ workload are increasing with the density of airspace, especially when urban air mobility (UAM) is emerging in the foreseeable future with a large number of unmanned aerial vehicles (UAVs) in the same airspace [1]. Operations of UAVs in a heterogeneous environment (mix of manned and unmanned aircraft, controlled airspace) could impose increased risk to manned aircraft due to the higher criticality of collision/conflict [2]. This trend requires advancements of aircraft conflict resolution system to handle multiple-aircraft conflict in a complex environment efficiently for in-time safety assurance. Several methods have been proposed in recent years to resolve the multiple-conflict issue [3]. New technologies use advanced technologies of satellite navigation and communication systems to resolve conflict safely and quickly. The main benefit is that an aircraft can be aware of the position and intent information of other aircraft in the vicinity, which greatly facilitates the decision-making process for resolving potential conflicts.Many studies have been proposed for aircraft conflict detection and resolution [4]. In general, existing methods can be grouped into the following five categories depending on their unique formulation assumptions and algorithms: heuristic search methods, force field methods, optimization methods, graph-based methods, and learning-based methods.Heuristic Search Methods: Conflict detection and resolution algorithms are investigated by NASA Ames Research Center to meet the Advanced Airspace Concept (AAC) described in [5]. These algorithms resolve conflict by iterating the generated maneuvers that are ranked by priorities. A specific rule of selecting maneuver identifies a different method. A path-stretch algorithm is proposed [6,7] to avoid a conflict in its present course with a turn back to a downstream waypoint. An algorithm for computing horizontal resolution trajectories with a constraint on the bank angle is described in [8], where a set of maneuvers are generated to achieve or exceed the specified minimum separation. Conflict detection and resolution tools have been developed based on these algorithms. The Tactical Separation-Assisted Flight Environment (TSAFE) is designed [9] to alert air traffic controllers of imminent conflicts. An updated version [10] is presented to unify the resolution to three types of separation assurance problems that includes separation conflicts, arrival sequencing, and weather-cell avoidance. A similar encounter-based simulation architecture is presented in [11] for conflict detect-and-avoid modeling. Integration of detection and resolution in the autoresolver makes it difficult to compare the algorithm’s performance with others; thus a generic framework is presented in [12] to separate the trajectory and conflict models from resolution. A new path planning method based on heuristic search is proposed in [13], where sequential negotiation processes are iterated to search for cost-minimized conflict-free trajectory for each aircraft.Force Field Methods: A force field (also known as voltage potential) method to solve the multiple-aircraft-conflict problem is proposed in [14], where aircraft are modeled as positively charged particles. Repulsion forces between the positive particles are used to push away the aircraft from each other. Based on closest point of approach, an improved force field method is proposed to increase the minimum distance between aircraft [15].Geometric Methods: A graph/display-based method was proposed in [16] to assist the operator for conflict resolution. This method is subsequently known as solution space diagram (SSD) method, which has been further extended for many similar algorithms [17,18]. A secondary SSD constructed from nominally propagated positions and velocities was proposed in [19] to improve the dynamic behavior of the SSD method. These methods can provide a visualized way for operators to read the conflict resolution method from display and need them to perform few maneuvers. However, these methods are deterministic methods that do not account for uncertainties. To solve this problem, the authors of [20] presented a conflict resolution method based on the conflict probability prediction and coordinate transformation method. The aircraft and maneuver are modeled as a hybrid control system in [21] to calculate the maximum set of safe initial conditions so that separation between aircraft is assured in the presence of uncertainties. A protocol-based multiple-aircraft-conflict resolution for a finite information horizon is proposed in [22] using graph theory. An optimal reciprocal collision avoidance (ORCA) was proposed in [23] using a simple geometric approach to guarantee conflict resolution for robot conflict resolution in an autonomous manner, which has been well used in practice. This method was modified to improve its performance for speed constrained aircraft [24]. The objective of these methods is to calculate an escaping velocity (including direction and magnitude) that will lead the aircraft to avoid the potential conflict, but these methods cannot guarantee conflict resolution for air traffic, especially in dense area.Optimization-Based Methods: This group of algorithms models the conflict resolution as an optimization problem. A sequential method was proposed in [25], where the authors presented an optimized path planning to minimize the total flight time in conflict resolution problem using mixed-integer linear program (MILP). This method is extended to a decentralized formulation in [26]. A strategy combining heading angle change and speed control is proposed in [27] based on mixed-integer nonlinear program (MINLP) method. A mixed 0-1 linear optimization model based on geometric transformations is proposed [28] to resolve conflict between an arbitrary number of aircraft. To reduce the air traffic controllers’ workload in conflict resolution, the problem is formulated as nonlinear optimization problem seeking resolution using minor speed adjustments as maneuvers, which is solved by implementing mixed integer programs on a continental size air traffic network [29]. In [30], the authors incorporate uncertainties into an existing deterministic model and formulate the conflict resolution problem as a maximum clique of minimum weight problem, solving it based on MILP method. The MILP and MINLP models have also been used for conflict resolution problem in [31–34]. In [35], the authors employed a simulated annealing metaheuristic approach to tackle the problem of minimizing the number of aircraft potential conflicts via speed regulations and taking into account uncertainties on aircraft position due to wind and temperature. The conflict resolution considering wind uncertainty is obtained by solving a parametric optimization problem subject to constraints in [36].Learning-Based Methods: Many machine learning methods have been proposed for conflict resolution. For example, reinforcement learning method is used to learn the conflict resolution policy [37]. Another method was proposed to solve the Markov decision process by tree search [38]. A game theory method is also explored to solve the deconflict problem [39]. In [40], the authors use a genetic fuzzy logic approach to solve the aircraft conflict resolution problem considering uncertainty in the velocity and the maneuver parameters. The SSD method described in [19] was used as visual input to the supervised learning algorithm to predict individual decisions in [41]. A value-based reinforcement learning approach that is based on decomposing a large multi-agent Markov decision process and fusing their solutions was proposed in [42]. These methods cannot guarantee conflict resolution.The advanced autoresolver tools based on heuristic search methods for conflict detection and resolution are reliable and efficient to resolve the conflict happens between aircraft pairs, which is the most common case in current practice. However, multiple-aircraft conflict is not very suitable for this method, especially when the airspace is crowded. Generated feasible deconflicting paths may be rejected due to secondary conflict. The force field methods resolve the multiple-aircraft conflict by taking the analogy with a particle system. It has difficulties in handling flight intent information as aircraft trajectories are determined by the air traffic control system. The geometric methods greatly assist the conflict resolution with visualization, but the resulting solution is a feasible one and may not always be the optimized one considering fuel consumption and flight delay. The optimization-based methods use the minimum separation between aircraft as a constraint of the optimization problem whose objective is to optimize the fuel consumption or time delay. Most existing optimization methods do not scale well with the dimensions (e.g., numbers of aircraft) and rarely consider the uncertainties for resolution. The learning methods cannot guarantee safety in complex environment that is not encountered in training (e.g., when the number of aircraft in the airspace is larger than the training case).In view of the above-mentioned gaps, this paper proposes a novelfast multiple-aircraft-conflict resolution method. The proposed method is a centralized method that uses the implementation of Automatic Dependent Surveillance - Broadcast (ADS-B) systems, assisting the controllers to assign conflict-free paths to each aircraft in the dense airspace. This algorithm will also benefit the unmanned aerial system (UAS) traffic management (UTM) in autonomous conflict resolution. The proposed model offers several advantages:1) The uncertainties are explicitly included in the probabilistic risk map in the optimization algorithms.2) The model decouples the high-dimensional optimization problem using the integrated A* algorithm and search heuristic method for enhanced scalability.3) The proposed model is flexible to handle many practical scenarios in the same framework, such as non-cooperative aircraft and minimum disturbance preference for pilots.The organization of this paper is as follows: Section II discusses the formulation of the proposed method and algorithm. Following this, Sec. III demonstrates the application of the proposed algorithm with several numerical examples. Section IV is discussion, and Sec. V presents the conclusions and future work based on the current study.II. Proposed Method and AlgorithmThis section discusses the basic formulation of the proposed method. The proposed study is based on the following assumptions: ADS-B system is available for all aircraft, and their position and velocity information is known with uncertainties. This assumption is appropriate for all future commercial aircraft as ADS-B will be mandated.Aircraft are assumed to cruise within a fixed altitude layer. Actions to resolve conflict is limited to horizontal dimensions only.Conflict is defined as the loss of separation between arbitrary aircraft pairs. Potential conflict is detected either by direct extrapolation of the current heading angle and velocity or with the flight intention information (i.e., the next waypoint in the flight plan).Based on these assumptions, a risk map can be defined that serves as the basis for the proposed methodology. Details are shown below.A. Probabilistic Risk MapThe ADS-B system implementation in air traffic management facilitates the situation awareness of an aircraft by sharing the position and intention information of the aircraft in the vicinity airspace. The position information is provided using the GPS satellite navigation system, which improves accuracy compared with radar in the trajectory prediction and conflict detection. The position information and trajectory prediction are not deterministic due to various uncertainties associated term. For example, positioning error can come from the GPS system, and trajectory prediction has randomness from the wind field. Thus, the potential conflict is not deterministic. Aprobabilistic risk map is proposed to describe the probability that an aircraft will encounter another aircraft in the foreseen future (e.g., 2–20 min). The key idea is to construct a risk map (image) that makes the conflict resolution problem equivalent to the problem of finding a path to avoid risks.This work constrains the conflict resolution in the horizontal direction. At time t, the predicted position of the ith intruder is denoted as p¯i,t, which is a vector containing two entries, for example, latitude and longitude. This predicted position is stochastic in nature. One major source of uncertainty is from wind, which leads to prediction error. Another source of uncertainty is tracking, navigation, and control error. These errors can be combined together and modeled as normally distributed, with zero mean and with a covariance that has eigenvectors in the along-track and cross-track directions [43]. The covariance matrix is diagonal in a coordinate system aligned with the aircraft heading. If qa and qc, respectively, denote the along-track axis and the cross-track axis of the heading aligned coordinate system with the origin at the position of the aircraft, then the probability density function of the position error is expressed as f(qa,qc)∝exp(−qa22σa2−qc22σc2)(1)where σa and σc, respectively, represent the standard deviation of the position error in along-track and cross-track directions. When translated to the map coordinates (e.g., WGS84) used in the real world, the above formulation becomes f(x,y|p¯i,t,θi,t)∝exp(−((x−xi,t)cos(θi,t)+(y−yi,t)sin(θi,t)2σc(i))2−(−(x−xi,t)sin(θi,t)+(y−yi,t)cos(θi,t)2σc(i))2)(2)where p¯i,t=(xi,t,yi,t) is the position of intruder i in the map at time t, and θi,t is the heading angle of intruder i.The conflict risk of the own aircraft in any position of the map can be related to the probability density function of the intruder position error, which penalizes the high likelihood of closing to the intruder. Therefore, the risk-map-associated cost function is proposed as the following to describe the conflict risk by scaling the above probability density function: cp,i(x,y,t)={exp(−1γ2(((x−xi,t)cos(θi,t)+(y−yi,t)sin(θi,t)2σa(i))2+(−(x−xi,t)sin(θi,t)+(y−yi,t)cos(θi,t)2σc(i))2))if  di,t>D+∞if  di,t≤D(3)where di,t=(x−xi,t)2+(y−yi,t)2 is the distance with the intruder i; D is the safe separation distance specified by the regulation, for example, 5 nautical miles for en-route operation phase; and γ is a model parameter that can be tuned to reflect different decision strategies. Cost is set to +∞ when the observed relative distance is less than D, which prohibits the aircraft pair to be too close to each other. This setting serves as the hard constraint for the safety concern.For multiple intruders, the total cost of the own aircraft is obtained by summing the cost functions with respect to all intruders, which is expressed as cp(x,y,t)=∑i=1Ncp,i(x,y,t)(4)where i=(1,…,N) represents every affected intruders in the airspace.Three illustration examples are presented in Fig. 1. The first two panels give the risk maps of two single intruders with different directions. The third panel shows the risk map of multiple intruders.Equation (4) can be easily extended to consider the other threats of safety, for example, severe weather condition and restricted airspace. Based on the awareness of the position and intention of the threats, a risk map is constructed considering the predicted distances with uncertainties between the own aircraft and the intruders/threats.Fig. 1 Probabilistic risk map associated with position error of intruder.B. Action SpaceThe above discussion is related to the cost for the state at the current time. The next state can be obtained using the current state and the actions that will be taken. Most conflict resolution strategies leverage heading angle change or speed change as actions. Taking both the actions simultaneously is very challenging for pilot operation in practice. In this work, the action space is only associated with heading angle change.We assume that the aircraft changes its heading angle by a fixed value in one interval, which is expressed as Δθ∈{−α,0,α}(5)where α is a fixed angle that can be determined according to the aircraft turn rate and the time interval of one step, the sign denotes the direction of the change (e.g., positive value indicates that the aircraft turns to left), and 0 is maintaining the current heading angle. If α and the time interval are set to small values, the heading angle can be regarded as continuous in the space of (0∼2π).C. Risk Minimized Path Planning for Single AircraftOnce the cost map is constructed, the conflict resolution can be treated as a shortest path problem that can find the cost-minimized path to move across the map. The most popular shortest path algorithms includes Dijkstra algorithm [44] and A* algorithm [45]. The Dijkstra algorithm has been demonstrated in many other studies to give the optimal solution, but it is time-consuming. The A* algorithm leverages heuristic information to improve the efficiency. In the problem tackled in this work, the heuristic information can be provided by the ADS-B system, including aircraft position, heading angle, and flight plan/intent. Thus, the A* algorithm is used to find the cost-minimized path across the cost map. The A* algorithm is iterated to select the path that minimizes J(n)=g(n)+h(n)(6)where n is the next node on the path, g(n) is the cost from the start node to node n, and h(n) is a heuristic function that estimates the cost of the shortest path from n to the final target node. The iteration terminates when the path it chooses to extend is the path from start to the final target.In this work, the g(n) is expressed as g(n)=g(n−1)+cp(x,y,t)(7)where g(n−1) is the cost from the start to n−1 on the extended path, and cp(x,y,t) is the state cost defined in Eq. (4). The heuristic function is defined as h(n)=h(n−1)+k1−k2cos(θ−θh)(8)where θ is the current velocity direction, and θh is the angle from the current position to the intended point, which is illustrated in Fig. 2. It should be noted that θ and θh are defined in the interval [−π,π), where the angle is negative when the vector is on the right side of the horizontal axis and positive on the left side. For example, θh is negative in Fig. 2, whereas θ is positive. Parameters k1≥k2>0 are used to tune the heuristic function; k1 is a parameter used to penalize long traveling distance, and k2 is a parameter to reward the action that makes the agent approaching its intention.The function g(n) is related to the risk of conflict with intruders and other threats. The heuristic function reflects the deviation of the current heading angle and the intention. Deviation from the current heading to the intention leads to a nonlinear cost in the cost function, which will prevent the aircraft from deviating too much from the initial flight plan.Fig. 2 Illustration of Heuristic function.Figure 3 illustrates the network for path-finding using the A* algorithm. The algorithm is performed by maintaining a tree of paths originating at the start node (current position) and extending those paths one edge at a time until a node close to the waypoint is reached. The edges of the network represent the actions demonstrated in the last part, where the heading angle change is used as the action space. The nodes with different colors illustrate the positions reachable by the aircraft at different time steps. The nodes are weighted by cp(x,y,t)+k1−k2cos(θ−θh), which is associated with the relative distances with intruders and the angles between heading direction and waypoint direction. It is noted that Cp(x,y,t) is the risk-map-associated cost function [see Eq. (3)] and the probabilistic risk map is included in the network via this weight function. Thus, the path obtained by searching the path of minimum cumulative cost using the A* algorithm considers the probabilistic risk map.Note that the nodes are generated by exploring the possible reachable positions on the map using the discrete action space. Therefore, the space is not discretized. The time is discretized by a specific time interval, which will be specified in the case study.Fig. 3  Illustration of network for path-finding using A* algorithm.The aircraft executes heading change with a constant angle (left or right) at one time step. In this manner, the path and space of heading angle will approximate to be continuous if both the angle and the time interval are relatively small. The A* algorithm has space complexity of O(bd), where b is the branching factor (the average number of successors per state), and d is the depth of solution (the shortest path). Therefore, the settings of b and d should be compromised between path optimization and computational complexity.D. Wind Impact on Path PlanningThe ground speed of aircraft is affected by the wind in practical flight. In the conflict resolution process, we assume that the aircraft keeps a constant airspeed and the ground speed varies with different relative angles with the wind direction, which is expressed as vg=va+vwcos(θ−θw)(9)where va is the airspeed, vw is the wind speed, and θw is the wind direction.Flight in headwind is penalized because the reduced ground speed increases the number of time steps and the total cost due to each of the time step costs k2 as defined in Eq. (8). Tail wind flight will be rewarded as the number of time steps is decreased.E. Multiple-Aircraft-Conflict ResolutionThe above discussion focuses on single-aircraft-conflict resolution based on the proposed risk map. In the multiple-conflict scenario, the ideal resolution is that the paths will lead to the lowest cost for the entire system. However, such an optimization problem for multiple aircraft is very difficult in general [46], especially when the number of aircraft is large.To simplify the computational complexity, a search heuristic method is proposed together with the A* algorithm described in the previous section for the multiple-aircraft-conflict resolution. The search heuristic method reformulates the multi-agent optimization as an iterative optimization process. The method implemented in this paper computes the path planning of a single aircraft in a fixed priority order. This order is determined using the following indexing method: The aircraft pair with the earliest time to the loss of separation should be resolved first.If the aircraft have same remaining time to the potential conflict, the aircraft that have lower cost to change flight path should be calculated lastly to accommodate the others.Repeat step 2 and step 3 until there are no eligible aircraft.After the above steps, if the priority still cannot be determined for some aircraft, the order between them can be determined randomly.Once the order is determined, the iteration will take place in this order.The above steps ensure the robustness of ordering. The earliest encountering aircraft pair has the highest priority to resolve, and the other aircraft should reroute based on the calculated path plannings of these two aircraft. This step of ordering can be determined by the conflict prediction. Among all the aircraft that will encounter in the same remaining time, the relatively inflexible aircraft (e.g., heavy aircraft) should be calculated first so that the following agile aircraft will reroute to accommodate to it. This step of ordering is determined according to the types of aircraft. Step 3 ensures that the aircraft of the same priority can be ordered.F. Algorithm ProcedureThe proposed algorithm is illustrated in the following pseudocode. The position and intention information from the associated aircraft is received via the airborne ADS-B systems. If at least one conflict is detected, the conflict resolution algorithm is activated. First, the priority order is determined using the method described previously. Then, the airspace is initialized by the environment constraints (e.g., restricted airspace or convective weather cells). Following this, risk map and cost function are constructed and the shortest path is calculated for the first aircraft with the highest priority rank. Then, this path planning is added to the risk map and the shortest path of the second aircraft is calculated. This process continues until all the aircraft’s path plannings are calculated. The set of path plannings of all aircraft denoted as πac is updated. In the second and latter iteration, aircraft path planning is calculated and updated in order of priority. One aircraft path planning is calculated assuming the other aircraft are flying along with their updated path plannings in πac. This process continues until the πac converges. The convergence is defined by the following equation: Cπac−Cπac(−1)≤δ(10)where Cπac is the total cost of the calculated trajectories in the current iteration and Cπac(−1) is the total cost in the last iteration, and δ is a small value.G. Convergence AnalysisThe aforementioned iterated process can optimize the total cost. Although this process is proved under the simple aircraft pair scenario illustrated in Fig. 4, it can be easily extended to a multiple-aircraft situation analogously. Assume that, after the n th iteration, the algorithm achieves paths r1 and r2 for aircraft 1 and aircraft 2, respectively. In the N+1 iteration, according to the optimization process demonstrated, a new path r1* of aircraft 1 is calculated using the A* algorithm to minimize the cost of the path on the basis of fixing r2. Therefore, we have f(r1*|r2)≤f(r1|r2)(11)where f(⋅|⋅) is the cost of the path of the current calculating aircraft given the path of other aircraft; for example, f(r1|r2) is the cost of r1 given r2. In the next step, r1* is fixed to calculate the cost-minimized path r2* of aircraft 2. At this step, the following relationship is developed with the cost of path r2*: f(r2*|r1*)≤f(r2|r1*)(12)Summing the preceding two inequations, f(r1*|r1)+f(r2*|r1)≤f(r1|r2)+f(r2|r1*)(13)which indicates that the total cost in the (n+1)th iteration is less than that in the nth iteration. Therefore, the total cost is monotonically decreasing with the iteration steps. In addition, according to the definition of the cost function, the total cost must be greater than zero. Therefore, it is necessarily convergent.Fig. 4 Illustration of convergence process.III. Numerical ExamplesIn this section, several numerical examples are presented to illustrate the proposed method for aircraft conflict resolution. The first example is an aircraft-pair-encounter scenario, which is used to illustrate the convergence process of the deconflict result. The second example shows conflict resolution for 10 aircraft. The third example discusses the random flight conflict resolution using the proposed method, where the original flight plans for all aircraft are randomly chosen. Then the scenarios with non-cooperative aircraft are investigated. Next, the path planning considering weather conditions (wind and severe weather) is studied. Finally, an example is presented to investigate the non-line-of-sight deconflicting using the proposed method.A. Conflict Resolution for an Aircraft PairAn example is used to present conflict resolution using the proposed method in an aircraft-pair-encounter scenario as shown in Fig. 5, where the two aircraft will encounter at the center of the map. The dashed line indicates the initial flight plan, and the circles are the protection zones (typically 5 nautical miles in en-route phase) of the aircraft. In this example, we assume the standard deviations of position error [see Eq. (2)] as σa=σc=1, and set the parameter γ=30, which is used to define the cost function associated with the risk map. The parameter α=3 indicates that the angle change in each time step is 3 deg. This small angle change will lead to a smooth path planning. The parameter related to the heuristic function in Eq. (8) is set as k1=k2=30. This parameter is linked to the cost of deviation from the intention. The air speed is assumed to be 450 knots, and the time interval of one step is set to be 40 s. This setting corresponds to 5 nautical miles per time step. During the interval of each time step, the aircraft flies in straight line. Then it changes its heading angle at the end of the time interval. Note that the other examples in this section use the same parameters as the above unless changes are specified; we will not repeat these parameter settings for each example.The results are presented in Fig. 6, where each row represents different iterations and the column represents different aircraft trajectory calculation results. For example, the second row shows the results of the second iteration and the first column shows the calculation results of aircraft 1. As shown in the figure, the algorithm begins by calculating the trajectory of aircraft 1 and by assuming that aircraft 2 flies along its original flight plan. Then, using the calculated results of aircraft 1, the path planning of aircraft 2 is updated, which is shown in the figure at row 1 column 2. The algorithm repeats in this way until the results converge, that is, no path changes with new iteration. The figures describe the process of the convergence. In this example, the result converges in the third iteration. The final result indicates that the algorithm can properly make path planning for an aircraft pair for conflict resolution.Fig. 5 Illustration of aircraft-pair-encounter scenario.Fig. 6 Processes of path planning for conflict resolution in two-aircraft-encounter scenario.B. Conflict Resolution for Multiple AircraftAirspace of civil aviation becomes increasingly crowded, especially near the major hubs. Conflict occurring among more than two aircraft will likely to happen more often. Figure 7a illustrates a very specific multiple-aircraft-encounter scenario, where all the aircraft will have collisions with other aircraft at the center of the map according to the initial flight plan. Although this specific scenario is impossible in practice, we still use it for stress test of the proposed method.The deconflict result is presented in Fig. 7b. It is shown that aircraft can avoid the conflict and arrive at their destinations with small deviations from the initial flight plans. This symmetric problem and the results as expected are studied to show the symmetric patterns. This indicates that the proposed method is feasible to tackle the above-illustrated conflict problem.Fig. 7 Path planning for conflict resolution in 10-aircraft-encounter scenario.C. Random Flight Conflict Resolution ScenarioA random flight case is studied to demonstrate the feasibility of the proposed method in a complex scenario, where flight plans of 10 aircraft are randomly set in the airspace illustrated in Fig. 8a. The original flight plans are plotted as dashed lines in Fig. 8a; some potential conflicts can be seen from the figure. The dots in the dashed lines are waypoints that the corresponding aircraft have to pass. All the aircraft are assumed to have the same speed and only allow the action of heading angle change. The conflict resolution calculated by the proposed method is presented in Fig. 8b, indicating that the proposed method can cooperatively perform path changing to resolve the potential conflict.Fig. 8 Conflict resolution for 10 random aircraft flight.D. Resolve Conflict with Non-Cooperative AircraftIn practice, aircraft may not resolve conflict cooperatively with others due to communication failures or human errors. In this condition, the cooperative aircraft have the responsibility to avoid conflict with the non-cooperative one. The non-cooperative aircraft is identified if it does not respond to requests of controller and/or other aircraft for conflict resolution. In this situation, the non-cooperative aircraft is supposed to keep its current direction, and the cooperative aircraft is responsible to resolve conflicts. In the bench mark scenarios, all the aircraft will have collisions with other aircraft at the center of the map according to the initial flight plan, more than one non-cooperative aircraft exist in this scenario, and it clearly leads to infeasible configurations where conflicts cannot be avoided. This rare situation is not considered in this work. Instead, a randomly generated scenario with 2 non-cooperative aircraft out of 10 aircraft is studied in this section.Figure 9 presents the results of the two-aircraft-encounter scenario, where the red aircraft is non-cooperative. The black aircraft’s flight plan is rearranged using the proposed method, which turns out to be a relative aggressive path to leave the threatened original flight plan in the first phase, and go back to the next waypoint in a straight path.Figure 10a illustrates the original flight plans of five aircraft that have conflicts with others in the center of the map. The red aircraft represents the non-cooperative aircraft, and the black aircraft are cooperative ones. Figure 10b shows the results, where the black aircraft have updated their flight plans to avoid conflict.Fig. 9 Path planning results for resolving two-aircraft conflict with one of them being non-cooperative.In Fig. 11a, the 10-aircraft-encounter scenario is illustrated. The red one is the non-cooperative aircraft that keeps its original flight plan. The path planning results using the proposed method are presented in Fig. 11b, where the black aircraft resolve the conflict in a proper way.Fig. 10 Path planning results for resolving five-aircraft conflict with one of them being non-cooperative.Figure 12 represents a 10-aircraft scenario where 2 of them are non-cooperative and the others are set randomly. The red lines show the trajectories of the non-cooperative aircraft. The black lines are the calculated path plannings of the cooperative aircraft. The dashed lines represent their original flight plans. These results show that the proposed method can effectively cope with the non-cooperative aircraft in a practical scenario.Fig. 11 Path planning for resolving 10-aircraft conflict with one of them being non-cooperative.Fig. 12 Path planning for resolving conflict considering severe weather.E. Path Planning Considering WindIn practice, an aircraft always keeps a constant airspeed in the cruise phase. Wind speed and direction will affect the ground speed. Reduced ground speed by wind increases the total cost of the proposed algorithm because more time is needed to reach the destination. The proposed algorithm assumes that the wind speed and direction are constant over the airspace where the conflict resolution is performed. As depicted in Fig. 13, path planning for eight aircraft without considering wind and with considering wind are studied, respectively. The red arrows of the right figure indicate the direction of wind in this area, which is 0.25π. The comparison indicates that the algorithm can be extended to adapt to the wind environment to find a cost-minimized path for conflict resolution.Fig. 13 Path planning for resolving eight-aircraft conflict considering wind.F. Path Planning in Sever Weather ConditionThe proposed algorithm can be easily extended to account for severe weather conditions. The severe weather is included in the path planning by assigning +∞ to the weather-affected area of the risk map in order to deny the aircraft access. For example, in the scenario depicted in Fig. 14, two aircraft resolve a potential conflict in the airspace including a severe weather area. The proposed method can be applied to other similar conditions with restricted airspace.Fig. 14 Path planning for resolving conflict considering severe weather.G. Non-Line-of-Sight Deconflict with Intent InformationA complex conflict scenario that happens in non-line-of-sight is studied in this section. Most of the existing methods assume that conflict happens in line of sight, which may lead to a potential risk as described in Fig. 15. In practice, conflict may happen after the turning waypoint in the near future. Figure 15 shows an example of this scenario, where the black dashed line denotes the original flight plan of the black aircraft. The red aircraft will have a conflict with the black one if they follow their original flight plans. Because this conflict happens in a very short time after the turning of the black aircraft, the two aircraft may have no sufficient time to solve this conflict or may have to take aggressive actions that are unsafe. Therefore, this conflict should be predicted and actions for resolving conflict should be taken in non-line-of-sight.The solid lines in the figure present the path planning results using the proposed method. As shown, the two aircraft cooperatively take actions in the first phase (before black aircraft turning) of their flight plans to resolve the potential conflict in the second phase. The result indicates that the proposed method can properly resolve the conflict with information from the flight intent or aircraft’s original flight plans. In some cases (as shown in the demonstrated one), this will lead to a safer path planning with small deviations from the original flight plans.Fig. 15 Results of two-aircraft path planning for resolving conflict happening in non-line-of-sight flight plan.IV. DiscussionA. Parametric StudyThe key parameters that impact the path planning are γ in Eq. (3), and k1 and k2 in Eq. (8), which, respectively, reflect the cost associated with the risk map and the cost associated with the deviation from the initial flight plan. For the sake of simplicity, we use a specific case where k=k1=k2 to study the effect of the two category parameters γ and k on the final path planning results. Note that we still assume the standard deviations of position error as σa=σc=1.We first study the parameter γ by fixing the parameter k=30. The path planning for aircraft pair using parameter values of γ=0.2, 2, 10, 20, 50, 200 are studied, whose results are presented in Fig. 16. As shown, when γ is extremely small (γ=0.2) or extremely large (γ=200), aircraft 2 keeps its initial flight plan while aircraft 1 takes actions. Aircraft 1 calculates its path planning in the first iteration assuming that aircraft 2 keeps its original flight plan. This path planning prevents aircraft 1 from flying into the protection zone of aircraft 2. Then, when aircraft 2 calculates its path, the heuristic cost increases for deviating from the initial flight plan, and the cost associated with the risk map is almost constant as γ is extremely small or extremely large. Therefore, aircraft 2 keeps its original flight plan to avoid cost increase due to deviation from its original plan. If we increase γ (e.g., γ=2,10,20,50), neither the cost associated with the risk map nor the cost associated with the deviation dominates the total cost in the iterations. Thus, both aircraft cooperatively change their paths for conflict resolution. As the γ increases, the separation of the two planning paths decreases in general.The parameter k is studied by fixing γ=30. Six values of k are used to calculate the path planning in an aircraft-pair-encounter scenario. As shown in Fig. 17, with increasing the k value, the deviation of each aircraft path planning from the initial flight plan decreases until the k value is greater than 40. When k is larger than 40, no apparent change is observed, which shows the saturation effect of k in determining the path planning.Fig. 16 Sensitivity study for parameter γ.Fig. 17 Sensitivity study for parameter k.B. Comparison of Path Planning in Different Initiation TimeIn this section, we use the scenario of two-aircraft encounter to discuss the impact of initiation time in deconflict path planning using the proposed method. As the dashed line in Fig. 18 illustrates, the original flight plans of the two aircraft lead to a potential conflict in the map center. We assume that both the aircraft have a constant ground speed of 450 knots, and four different initial time cases are investigated, which are 10, 8, 6, and 4 min, respectively. As presented in Fig. 18, although all these cases are properly resolved, the path planning with smaller initiation time has more aggressive action. Therefore, earlier initiation time before the potential conflict is needed to ensure safety and avoid aggressive action.Theoretically, the start time is already a variable in the proposed methodology implicitly. This is because the action space has the option for zero angle change. For example, if the algorithm selects zero angle change until time t, the start time will be naturally t in this case. Thus, we did not set the start time as a variable in the action space. The parametric study was performed to see the impact if we explicitly set the start time to ensure that the aircraft will stick to the original plan as much as possible. This usually corresponds to the practical situation in the current air traffic management system, where the controller–pilot interaction will decide the time to initiate the deconflict. In practice, controllers do not initiate the deconflict very earlier due to the increased workload, impact to other aircraft in the airspace, and future operational uncertainties.Fig. 18 Path planning with different initial time.C. Resolve Aircraft with Minimum Pilot DisturbanceIn practice, not all aircraft need to take actions to resolve the conflict. This strategy can be beneficial as it reduces the usage of limited communication resource, reduces the fuel consumption, and reduces the pilot workload. Thus, conflict resolution with minimum pilot distance is investigated in this example. The proposed method can be easily extended to achieve this objective. First, a subset of aircraft is identified in which each of the aircraft has no conflict with others. This can be obtained by iterating all affected aircraft to find their no-conflict sets. The subset with the maximum number of aircraft is used for efficiency. Following this, aircraft in this subset will keep their original flight plans and the others calculate path plannings for conflict resolution. This logic has the minimum disturbance for pilots to have a safe conflict resolution.Figure 19 illustrates an example where three aircraft encounter. In this example, the green aircraft has conflicts with the other two aircraft according to its initial flight plan, whereas the other two have no conflict with each other. Results with path planning for all aircraft are shown in Fig. 20.Fig. 19 Illustration of three-aircraft-encounter example.Fig. 20 Resolving conflict with all aircraft’s flight plans rearranged.Figure 21 shows the result of conflict resolution with minimum pilot disturbance. In this example, the maximum set of nonconflict is {′red′,′blue′} aircraft. Keeping the original flight plans of the red and blue aircraft, the path planning of the green aircraft is calculated using the proposed method. Different resolution paths for the green aircraft are observed, which makes sense. The green aircraft is the only aircraft to take actions for conflict resolution, and the deviation is expected to be large for itself.Fig. 21 Resolving conflict with minimum number of aircraft’s flight plans rearranged.D. Three-Dimensional Conflict ResolutionControllers and pilots usually do not simultaneously perform horizontal and vertical maneuvers [47]. In practice, horizontal maneuvers are taken several minutes before the potential conflict, and vertical maneuvers are performed for the immediate conflict that is occurring within 2 min [48].The above discussions focus only on the horizontal maneuvers. To make it more comprehensive, we will discuss the mechanism of combining horizontal and vertical maneuvers. A conflict resolution method with vertical maneuvers has been developed in our previous work [49]. The proposed horizontal deconflict can be integrated with vertical deconflict [49] using a meta-controller. The flowchart in Fig. 22 shows the conflict avoidance process using the combination of horizontal and vertical maneuvers. The information of the airspace is collected by the surveillance system for conflict detection. Once a potential conflict is detected, the system will predict the remaining time to the potential conflict. If it is smaller than the initial time for the horizontal maneuvers and smaller than the initial time for the vertical maneuvers, the conflict resolution method with vertical actions (refers to [49]) is taken. Otherwise, if the remaining time to the potential conflict is smaller than the horizontal initial time but beyond the vertical initial time, the horizontal conflict resolution method should be used.Figure 23 presents an example where aircraft B encounters aircraft A after resolving a conflict with aircraft C. Aircraft A and aircraft B are assumed to have insufficient time to resolve this conflict in horizontal. The two aircraft implement the vertical conflict resolution method that is described in [49] when the remaining time to conflict is within the vertical initial time. The results are shown in Fig. 23b, where thex axis denotes the time passed since the vertical maneuvers were triggered, they axis gives the altitude of climbing or descending.Fig. 22 Flowchart of combining horizontal and vertical conflict resolution methods.Fig. 23 Path planning for 3D conflict resolution.E. Time EfficiencyThe computation complexity is studied using the symmetric examples illustrated in Sec. III.B. These examples are studied as benchmark in many other papers. The runtime for obtaining the convergent results with a different number of aircraft is shown in Table 1, comparing with the constant speed optimal reciprocal collision avoidance (CS-ORCA) method. The simulations are conducted using Python on a computer with 32G RAM and 3.5G×8 core CPU. In practical implementation, much more efficient runtime performance can be achieved by using a compiled language (e.g., C++) and better hardware. The results demonstrate that the proposed method is efficient for solving these benchmark problems and better than the existing CS-ORCA method.In these bench-mark examples, the algorithm can find the path for conflict resolution in several seconds. The practical scenario is much easier than these examples; that is, the possibility of more than five simultaneous conflicts is extremely low. As presented in Table 1, even 20 simultaneous conflicts can be resolved in seconds level. We can reasonably infer that the path plannings can be calculated in few seconds in practical implementations. This time efficiency can meet the requirement of conflict resolution in practice.F. Failure RateThe conflict rate versus number of aircraft is studied, comparing with the existing CS-ORCA method [24] and value-based method [42]. One hundred experiments are conducted for a different number of aircraft with random flight plans in a 100×100 nautical miles area. As shown in Fig. 24, the conflict rate of the proposed method keeps a low level with the increase in the number of aircraft. This can be explained by the setting of the cost, which is set to infinity if conflict happens. The shortest path algorithm will find a path avoiding passing through this area that costs infinity. Therefore, the proposed method can guarantee the aircraft conflict resolution.Fig. 24 Conflict rate comparison.V. ConclusionsA novel multiple-aircraft-conflict resolution method is proposed in this study. Based on the construction of cost map that represents the risk of conflict and environment threat, the risk avoiding paths are found using the A* algorithm. The search heuristic method is implemented to iterate path plannings for all effected aircraft to optimize the result of the entire system. This process considers the intention information of the aircraft, that is, flight plan and waypoint. Several numerical examples are used to verify the feasibility of the proposed method. Modification of the proposed method is also discussed to consider some practical scenarios, such as non-cooperative aircraft and the minimum pilot disturbance preference.Several conclusions can be drawn based on the proposed study: Efficient multiple conflict resolution is shown to be feasible with a centralized logic.Combining the A* algorithm and search heuristic method provides an optimized solution of the entire system to achieve the cost-minimized path plannings.The cost function formulation allows considering uncertainty of conflict detection. Parameters of the cost function can be adjusted to tune the safe separation between aircraft.The proposed method can be easily modified to consider the non-cooperative aircraft and minimum pilot disturbance by applying the method to an identified subset of aircraft.The proposed method can simultaneously include wind effect and restricted airspace during path planning.Both horizontal deconflict and vertical deconflict can be implemented using a meta-controller that determines the appropriate maneuver based on the predicted conflict time.Several future research directions are also identified. The current study does not consider the uncertainties from the action. Future studies should investigate deconflict with both state and action uncertainties, such as the Markov decision process problems using reinforcement learning. The current investigation focuses on the scale of 10–20 aircrafts. The scalability to future dense airspace, such as UAS, needs further investigation. The proposed study aims for the en-route deconflict, research on simultaneous sequencing and deconflict in the near-terminal region is much more complex and needs further investigation, especially for the hybrid horizontal–vertical planning.AcknowledgmentsThe work related to this research was performed at the Prognostic Analysis and Reliability Assessment Lab at Arizona State University. The research reported in this paper was supported by funds from NASA University Leadership Initiative program (Contract No. NNX17AJ86A; project officer: Anupa Bajwa; principal investigator: Yongming Liu). The support is gratefully acknowledged.\r            References\r        [1] “Policy and Plans: FAA Aerospace Forecast Fiscal Years 2016–2036,”  Federal Aviation Administration Rept.  TC16-002, Washington, D.C., 2016, https://www.faa.gov/data_research/aviation/aerospace_forecasts/media/FY2016-36_FAA_Aerospace_Forecast.pdf. Google Scholar[2] “Unmanned Aircraft System Traffic Management (UTM) Concept of Operations Version 2.0,”  Federal Aviation Administration, Washington, DC, March 2020, https://www.faa.gov/uas/research_development/traffic_management/media/UTM_ConOps_v2.pdf. Google Scholar[3] Cafieri S., “MINLP in Air Traffic Management: Aircraft Conflict Avoidance,” Advances and Trends in Optimization with Engineering Applications, edited by Tamás Terlaky E., Anjos M. F. and Ahmed S., MOS-SIAM Series on Optimization, Soc. for Industrial and Applied Mathematics, Philadelphia, 2017, pp. 293–301. https://doi.org/10.1137/1.9781611974683.ch22 Google Scholar[4] Kuchar J. K. and Yang L. C., “A Review of Conflict Detection and Resolution Modeling Methods,” IEEE Transactions on Intelligent Transportation Systems, Vol. 1, No. 4, 2000, pp. 179–189. https://doi.org/10.1109/6979.898217 CrossrefGoogle Scholar[5] Erzberger H., “Automated Conflict Resolution for Air Traffic Control,”  NASA TR  20050242942, Jan. 2005. Google Scholar[6] Bach R., Chu Y.-C. and Erzberger H., “A Path-Stretch Algorithm for Conflict Resolution,”  NASA  CR-2009-214574, Aug. 2009. Google Scholar[7] Bach R., Farrell C. and Erzberger H., “An Algorithm for Level-Aircraft Conflict Resolution,”  NASA  CR-2009-214573, 2009. Google Scholar[8] Erzberger H. and Heere K., “Algorithm and Operational Concept for Resolving Short-Range Conflicts,” Proceedings of the Institution of Mechanical Engineers, Part G: Journal of Aerospace Engineering, Vol. 224, No. 2, 2010, pp. 225–243.  10.1243/09544100 JAERO546 CrossrefGoogle Scholar[9] Paielli R. A., Erzberger H., Chiu D. and Heere K. R., “Tactical Conflict Alerting Aid for Air Traffic Controllers,” Journal of Guidance, Control, and Dynamics, Vol. 32, No. 1, 2009, pp. 184–193. https://doi.org/10.2514/1.36449 LinkGoogle Scholar[10] Erzberger H., Lauderdale T. A. and Chu Y.-C., “Automated Conflict Resolution, Arrival Management, and Weather Avoidance for Air Traffic Management,” Proceedings of the Institution of Mechanical Engineers, Part G: Journal of Aerospace Engineering, Vol. 226, No. 8, 2012, pp. 930–949. https://doi.org/10.1177/0954410011417347 CrossrefGoogle Scholar[11] Refai M., Abramson M., Lee S. and Wu G., “Encounter-Based Simulation Architecture for Detect-and-Avoid Modeling,” AIAA Paper  2019-1476, Jan. 2019. https://doi.org/10.2514/6.2019-1476 Google Scholar[12] Wang R., Alligier R., Allignol C., Barnier N., Durand N. and Gondran A., “Cooperation of Combinatorial Solvers for En-Route Conflict Resolution,” Transportation Research Part C: Emerging Technologies, Vol. 114, May 2020, pp. 36–58. https://doi.org/10.1016/j.trc.2020.01.004 Google Scholar[13] Pritchett A. R. and Genton A., “Negotiated Decentralized Aircraft Conflict Resolution,” IEEE Transactions on Intelligent Transportation Systems, Vol. 19, No. 1, 2018, pp. 81–91. https://doi.org/10.1109/TITS.2017.2693820 CrossrefGoogle Scholar[14] Eby M. S., “A Self-Organizational Approach for Resolving Air Traffic Conflicts,” Lincoln Laboratory Journal, Vol. 7, No. 2, 1994, pp. 239–254, https://archive.ll.mit.edu/publications/journal/pdf/vol07_no2/7.2.6.selforganizing.pdf. Google Scholar[15] Zeghal K., “A Review of Different Approaches Based on Force Fields for Airborne Conflict Resolution,” Guidance, Navigation, and Control Conference and Exhibit, AIAA Paper  1998-4240, 1998. https://doi.org/10.2514/6.1998-4240 Google Scholar[16] Ellerbroek J., Visser M., van Dam S. B. J., Mulder M. and van Paassen M. M., “Design of an Airborne Three-Dimensional Separation Assistance Display,” IEEE Transactions on Systems, Man, and Cybernetics—Part A: Systems and Humans, Vol. 41, No. 5, 2011, pp. 863–875. https://doi.org/10.1109/TSMCA.2010.2093890 CrossrefGoogle Scholar[17] Rahman S. M. A., Mulder M. and van Paassen R., “Using the Solution Space Diagram in Measuring the Effect of Sector Complexity During Merging Scenarios,” AIAA Guidance, Navigation, and Control Conference, AIAA Paper  2011-6693, 2011. https://doi.org/10.2514/6.2011-6693 Google Scholar[18] d’Engelbronner J. G., Borst C., Ellerbroek J., van Paassen M. M. and Mulder M., “Solution-Space–Based Analysis of Dynamic Air Traffic Controller Workload,” Journal of Aircraft, Vol. 52, No. 4, 2015, pp. 1146–1160. https://doi.org/10.2514/1.C032847 LinkGoogle Scholar[19] Balasooriyan S., “Multi-Aircraft Conflict Resolution Using Velocity Obstacles,” Master Thesis,  Delft Univ. of Technology, Delft, The Netherlands, 2017, https://repository.tudelft.nl/islandora/object/uuid%3Acf361aff-a7ec-444c-940a-d711e076d108. Google Scholar[20] Paielli R. A. and Erzberger H., “Conflict Probability Estimation for Free Flight,” Journal of Guidance, Control, and Dynamics, Vol. 20, No. 3, 1997, pp. 588–596. https://doi.org/10.2514/2.4081 LinkGoogle Scholar[21] Tomlin C., Pappas G. J. and Sastry S., “Conflict Resolution for Air Traffic Management: A Study in Multiagent Hybrid Systems,” IEEE Transactions on Automatic Control, Vol. 43, No. 4, 1998, pp. 509–521. https://doi.org/10.1109/9.664154 CrossrefGoogle Scholar[22] Hwang I., Kim J. and Tomlin C., “Protocol-Based Conflict Resolution for Air Traffic Control,” Air Traffic Control Quarterly, Vol. 15, No. 1, 2007, pp. 1–34. https://doi.org/10.2514/atcq.15.1.1 LinkGoogle Scholar[23] van den Berg J., Guy S. J., Lin M. and Manocha D., “Reciprocal n-Body Collision Avoidance,” Robotics Research, edited by Pradalier C., Siegwart R. and Hirzinger G., Springer, Berlin, 2011, pp. 3–0. https://doi.org/10.1007/978-3-642-19457-3_1 CrossrefGoogle Scholar[24] Durand N., “Constant Speed Optimal Reciprocal Collision Avoidance,” Transportation Research Part C: Emerging Technologies, Vol. 96, Nov. 2018, pp. 366–379. https://doi.org/10.1016/j.trc.2018.10.004 CrossrefGoogle Scholar[25] Pallottino L., Feron E. M. and Bicchi A., “Conflict Resolution Problems for Air Traffic Management Systems Solved with Mixed Integer Programming,” IEEE Transactions on Intelligent Transportation Systems, Vol. 3, No. 1, 2002, pp. 3–11. https://doi.org/10.1109/6979.994791 CrossrefGoogle Scholar[26] Schouwenaars T., How J. and Feron E., “Decentralized Cooperative Trajectory Planning of Multiple Aircraft with Hard Safety Guarantees,” AIAA Guidance, Navigation, and Control Conference and Exhibit, AIAA Paper  2004-5141, 2004. https://doi.org/10.2514/6.2004-5141 LinkGoogle Scholar[27] Christodoulou M. and Costoulakis C., “Nonlinear Mixed Integer Programming for Aircraft Collision Avoidance in Free Flight,” Proceedings of the 12th IEEE Mediterranean Electrotechnical Conference (IEEE Cat. No. 04CH37521), Vol. 1, Inst. of Electrical and Electronics Engineers, New York, 2004, pp. 327–330. https://doi.org/10.1109/MELCON.2004.1346858 CrossrefGoogle Scholar[28] Alonso-Ayuso A., Escudero L. F. and Martín-Campo F. J., “Collision Avoidance in Air Traffic Management: A Mixed-Integer Linear Optimization Approach,” IEEE Transactions on Intelligent Transportation Systems, Vol. 12, No. 1, 2011, pp. 47–57. https://doi.org/10.1109/TITS.2010.2061971 CrossrefGoogle Scholar[29] Rey D., Rapine C., Fondacci R. and El Faouzi N.-E., “Subliminal Speed Control in Air Traffic Management: Optimization and Simulation,” Transportation Science, Vol. 50, No. 1, 2016, pp. 240–262. https://doi.org/10.1287/trsc.2015.0602 CrossrefGoogle Scholar[30] Lehouillier T., Nasri M. I., Omer J., Soumis F. and Desaulniers G., “Solving the Air Conflict Resolution Problem Under Uncertainty Using an Iterative Bi-Objective Mixed Integer Programming Approach,” Transportation Science, Vol. 51, No. 4, 2017, pp. 1242–1258. https://doi.org/10.1287/trsc.2016.0714 CrossrefGoogle Scholar[31] Alonso-Ayuso A., Escudero L. F. and Martín-Campo F. J., “Exact and Approximate Solving of the Aircraft Collision Resolution Problem via Turn Changes,” Transportation Science, Vol. 50, No. 1, 2016, pp. 263–274. https://doi.org/10.1287/trsc.2014.0557 CrossrefGoogle Scholar[32] Cafieri S. and Durand N., “Aircraft Deconfliction with Speed Regulation: New Models from Mixed-Integer Optimization,” Journal of Global Optimization, Vol. 58, No. 4, 2014, pp. 613–629. https://doi.org/10.1007/s10898-013-0070-1 CrossrefGoogle Scholar[33] Cafieri S., “Maximizing the Number of Solved Aircraft Conflicts Through Velocity Regulation,” Proceedings of the XII Global Optimization Workshop, Mathematical and Applied Global Optimization MAGO 2014, International Soc. of Global Optimization (iSoGO), Málaga, Spain, Sept. 2014, pp. 128–132. Google Scholar[34] Cafieri S. and Omheni R., “Mixed-Integer Nonlinear Programming for Aircraft Conflict Avoidance by Sequentially Applying Velocity and Heading Angle Changes,” European Journal of Operational Research, Vol. 260, No. 1, 2017, pp. 283–290. https://doi.org/10.1016/j.ejor.2016.12.010 CrossrefGoogle Scholar[35] Courchelle V., Soler M., González-Arribas D. and Delahaye D., “A Simulated Annealing Approach to 3D Strategic Aircraft Deconfliction Based on En-Route Speed Changes Under Wind and Temperature Uncertainties,” Transportation Research Part C: Emerging Technologies, Vol. 103, June 2019, pp. 194–210. https://doi.org/10.1016/j.trc.2019.03.024 CrossrefGoogle Scholar[36] Hernández Romero E., Valenzuela Romero A. and Rivas Rivas D., “Probabilistic Aircraft Conflict Detection and Resolution Considering Wind Uncertainty,” 7th SESAR Innovation Days (2017), Sebia, SIDs, Portugal, Nov. 2017, pp. 1–8. Google Scholar[37] Tumer K. and Agogino A., “Improving Air Traffic Management with a Learning Multiagent System,” IEEE Intelligent Systems, Vol. 24, No. 1, 2009, pp. 18–21. https://doi.org/10.1109/MIS.2009.10 CrossrefGoogle Scholar[38] Yang X. and Wei P., “Autonomous On-Demand Free Flight Operations in Urban Air Mobility Using Monte Carlo Tree Search,” International Conference on Research in Air Transportation (ICRAT), Barcelona, Spain, June 2018, http://www.icrat.org/ICRAT/seminarContent/2018/papers/ICRAT_2018_paper_3.pdf. Google Scholar[39] Archibald J. K., Hill J. C., Jepsen N. A., Stirling W. C. and Frost R. L., “A Satisficing Approach to Aircraft Conflict Resolution,” IEEE Transactions on Systems, Man, and Cybernetics, Part C (Applications and Reviews), Vol. 38, No. 4, 2008, pp. 510–521. https://doi.org/10.1109/TSMCC.2008.919162 CrossrefGoogle Scholar[40] Sathyan A., Ernest N., Lavigne L., Cazaurang F., Kumar M. and Cohen K., “A Genetic Fuzzy Logic Based Approach to Solving the Aircraft Conflict Resolution Problem,” AIAA Information Systems-AIAA Infotech Aerospace, AIAA Paper  2017-1751, 2017. https://doi.org/10.2514/6.2017-1751 Google Scholar[41] van Rooijen S. J., Ellerbroek J., Borst C. and van Kampen E., “Toward Individual-Sensitive Automation for Air Traffic Control Using Convolutional Neural Networks,” Journal of Air Transportation, Vol. 28, No. 3, 2020, pp. 105–113. https://doi.org/10.2514/1.D0180 LinkGoogle Scholar[42] Ong H. Y. and Kochenderfer M. J., “Markov Decision Process-Based Distributed Conflict Resolution for Drone Air Traffic Management,” Journal of Guidance, Control, and Dynamics, Vol. 40, No. 1, 2017, pp. 69–80. https://doi.org/10.2514/1.G001822 LinkGoogle Scholar[43] Erzberger H., Paielli R. A., Isaacson D. R. and Eshow M. M., “Conflict Detection and Resolution in the Presence of Prediction Error,” 1st USA/Europe Air Traffic Management R&D Seminar, Saclay, France, June 1997, pp. 17–20, 10.1.1.34.4761&rep=rep1&type=pdf. Google Scholar[44] Dijkstra E. W., “A Note on Two Problems in Connexion with Graphs,” Numerische mathematik, Vol. 1, No. 1, 1959, pp. 269–271. https://doi.org/10.1007/BF01386390 CrossrefGoogle Scholar[45] Hart P. E., Nilsson N. J. and Raphael B., “A Formal Basis for the Heuristic Determination of Minimum Cost Paths,” IEEE Transactions on Systems Science and Cybernetics, Vol. 4, No. 2, 1968, pp. 100–107. https://doi.org/10.1109/TSSC.1968.300136 CrossrefGoogle Scholar[46] Hopcroft J., Schwartz J. and Sharir M., “On the Complexity of Motion Planning for Multiple Independent Objects; PSPACE- Hardness of the ‘Warehouseman’s Problem’,” International Journal of Robotics Research, Vol. 3, No. 4, 1984, pp. 76–88. https://doi.org/10.1177/027836498400300405 CrossrefGoogle Scholar[47] Durand N., Gotteland J.-B., Matton N., Bortolotti L. and Sandt M., “Understanding and Overcoming Horizontal Separation Complexity in Air Traffic Control: An Expert/Novice Comparison,” Cognition, Technology and Work, Vol. 23, Aug. 2021, pp. 481–496. https://doi.org/10.1007/s10111-020-00634-z CrossrefGoogle Scholar[48] Paielli R. A., “Tactical Conflict Resolution Using Vertical Maneuvers in En Route Airspace,” Journal of Aircraft, Vol. 45, No. 6, 2008, pp. 2111–2119. https://doi.org/10.2514/1.39427 LinkGoogle Scholar[49] Zhao P., Wang W., Ying L., Sridhar B. and Liu Y., “Online Multiple-Aircraft Collision Avoidance Method,” Journal of Guidance, Control, and Dynamics, Vol. 43, No. 8, 2020, pp. 1456–1472. https://doi.org/10.2514/1.G005161 LinkGoogle Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Frozen Orbits Under Radiation Pressure and Zonal Gravity Perturbations",
        "url": "https://arc.aiaa.org/doi/10.2514/1.G005564",
        "date": "20210906",
        "content": "AbstractThe orbital motion of spacecraft around asteroids is strongly disturbed primarily because of solar radiation pressure (SRP) and higher-order gravitational forces. To achieve stable orbits in such an environment, the implementation of frozen orbits is a promising approach. This research derives semi-analytical solutions of frozen orbits subject to SRP and zonal gravity up to the fourth order based on singly averaged Lagrange planetary equations. Moreover, the stability of frozen orbits is characterized analytically by introducing linearized variational equations, revealing the complex eigenstructures of the proposed frozen orbits. These analytical theories identify several different types of stable frozen orbits, which are further validated via high-fidelity numerical simulations. Consequently, this paper demonstrates the feasibility and intriguing dynamic characteristics of frozen orbits around asteroids.I. IntroductionAsteroids are occasionally compared with time capsules because they are expected to retain information about the dynamic evolution of the solar system. Asteroid explorations might, therefore, give us a clue to the origins of our solar system and life. Understanding asteroids is also important from the perspective of planetary defense. To avoid a catastrophic impact on Earth by mitigating the threat of hazardous asteroids, knowledge about the physical characteristics of asteroids is indispensable. For these reasons, the increasing number of discovered asteroids has led to a growing interest in rendezvous missions. Recent examples are the Hayabusa2 mission to the asteroid Ryugu and the OSIRIS-REx mission to the asteroid Bennu, both of which arrived at the target asteroid and began proximity observations in 2018 [1,2].Rendezvous missions to asteroids face dynamic challenges in the proximity operation phase. First, in the low-gravity environment of asteroids, the effects of perturbations are relatively strong. In particular, solar radiation pressure (SRP) becomes the dominant perturbing source in the vicinity of asteroids with small solar distances (e.g., near-Earth asteroids). Second, asteroids have irregular shapes in general due to their weak self-gravity, forming irregular gravitational fields around them. Because of the SRP and gravity-field perturbations, the orbital motion of a spacecraft in the vicinity of an asteroid is strongly disturbed [3–6].A conventional solution to this problem is to implement frozen orbits, in which one or more orbital elements remain constant even under perturbing forces [7]. Frozen orbits have been intensively investigated for more than a half-century to compensate for secular perturbations exerted on Earth-orbiting satellites due to higher-order gravitational forces, particularly J2 perturbations (i.e., oblateness effect). The critical inclination problem is one example; it identifies the inclination that diminishes the variations in eccentricity and the argument of perigee [8,9]. The resultant frozen orbits with constant apse lines, such as Molniya orbits, can achieve favorable geometric conditions for some types of Earth-orbiting missions. Another example is sun-synchronous orbits, where the precession rate of the orbital plane coincides with the mean motion of Earth, yielding constant orbital geometries with respect to the sun [10]. These frozen-orbit theories have also been applied to lunar and planetary missions [11,12].In later years, frozen orbits subject to SRP perturbations have also been explored, particularly for small-body missions. Examples include terminator orbits, whose orbital planes lie near the terminator plane. This type of periodic orbit exhibits long-term stability even under strong SRP [4,13]. Because of its feasibility and applicability, terminator orbits were implemented in the OSIRIS-REx mission for station keeping around Bennu [14,15]. In subsequent research, the joint perturbation effect of the SRP and gravity irregularity on terminator orbits was formulated and evaluated [16]. Moreover, recent studies extended the terminator orbit family by incorporating both SRP and J2 perturbations [17]. This extension yields another type of promising frozen orbit, which is referred to as an equatorial heliotropic orbit [17,18]. The previously mentioned studies analytically investigated frozen obits based on Lagrange planetary equations (LPEs), allowing a fundamental understanding of strongly perturbed dynamics.In real asteroid-proximity environments, however, higher-order gravitational perturbations other than the J2 perturbation can significantly disturb the orbital motion of spacecraft. For instance, Ryugu exhibits a strong zonal gravitational force associated with the J4 term, owing to its spinning-top shape. To alleviate disturbances caused by the combination of higher-order gravity and SRP, several strategies have been proposed in recent years. One direct approach is to correct the initial conditions of terminator orbits around asteroids by taking into account the J3 perturbation based on the averaged LPE [19]. Other studies have incorporated higher-order, even zonal gravity harmonics, successfully obtaining modified frozen orbit conditions; nevertheless, the solutions were derived based on a doubly averaged LPE, and thus they are not necessarily valid for large perturbations [20,21].For the reasons described above, this research derives singly averaged LPEs considering the SRP, J2, J3, and J4 perturbations to identify semi-analytical solutions of frozen orbits subject to these perturbations. Subsequent continuation analyses demonstrate that several different families of frozen orbits exist, including terminator orbits and equatorial heliotropic orbits. A further important contribution of this study is the analytical characterization of the stability of the derived frozen orbits. The stability of frozen orbits under the SRP and J2 perturbations was evaluated in [17] and then analytically discussed in detail in [22]. This paper extends the previous stability analysis methodologies for the newly derived frozen orbit solutions, revealing distinctive eigenstructures behind the orbital dynamics subject to SRP and higher-order zonal gravity perturbations.This paper begins with a description of the perturbation models used in this study. In Sec. II, zonal gravitational perturbations are formulated based on a shape model of Ryugu. Section III derives LPEs that incorporate the SRP and zonal gravities up to the fourth order. Based on the developed LPEs, semi-analytical solutions of frozen orbits are derived in Sec. IV. Subsequently, Sec. V describes the methodology of analytical stability analysis for the proposed frozen orbits and provides some analysis results. These analytical theories of frozen orbits are validated in Sec. VI via high-fidelity numerical simulations based on a polyhedral gravity model. Consequently, this study expands the possible applications of frozen orbits for asteroid missions and describes the intriguing dynamic structures behind them.II. Perturbation ModelsA. Coordinate System and Orbital ElementsTo describe the orbital motion of a spacecraft around an asteroid, the Hill coordinate frame is used in this paper. The Hill coordinate system is an asteroid-centered rotating frame, where the x axis points in the anti-sun direction, the z axis is aligned with the angular velocity vector of the asteroid orbit around the sun, and the y axis completes a right-handed Cartesian coordinate system. A spacecraft orbit is described with six orbital elements relative to the Hill coordinate frame: the semimajor axis a, eccentricity e, inclination i, longitude of the ascending node Ω, argument of periapsis ω, and true anomaly ν. The position vector of the spacecraft with respect to the center of the asteroid is denoted by r, and its norm is defined as r≡|r|. The radial distance and orbital elements satisfy the following equation: r=a(1−e2)1+ecosν(1)The geometrical relationship between the Hill coordinate frame and the associated orbital elements is sketched in Fig. 1.As this research investigates orbital motion subject to higher-order gravity perturbations, it is also essential to describe the orbital geometry in an asteroid-fixed coordinate system. The position of the spacecraft with respect to the asteroid-centered, asteroid-fixed frame can be expressed with the radial distance r, planetocentric longitude θ, and planetocentric latitude ϕ. In addition, the inclination and argument of periapsis with respect to the equatorial plane are denoted by i˜ and ω˜, respectively, as illustrated in Fig. 1. From the definitions, the latitude and equatorial orbital elements satisfy the following equation: sinϕ=sini˜sin(ω˜+ν)(2)Fig. 1 Hill coordinate frame and associated orbital elements.Let ε be the asteroid obliquity, which is defined as the angle between the spin axis of the asteroid and the z axis of the Hill coordinate frame. Because of the obliquity and orbital motion of an asteroid, the relationship between the Hill orbital elements and the equatorial orbital elements is time dependent in general. However, the geometrical relationship can be simplified when the spin axis is perpendicular to the asteroid orbital plane. Let us assume that the obliquity satisfies either ε=0 or ε=π, resulting in a situation where the asteroid orbital and equatorial planes are identical. In this case, the asteroid spin direction can be expressed by the following binary variable: δε≡cosε={+1(ε=0)−1(ε=π)(3)The perpendicular-spin assumption yields the following relationship from the definitions of the orbital elements: i˜={i(δε=+1)π−i(δε=−1),ω˜={ω(δε=+1)ω+π(δε=−1)(4)Consequently, the trigonometric functions for the equatorial orbital elements can be converted to those of the Hill orbital elements by using the following equations: sini˜=sini,cosi˜=δεcosi(5)sinω˜=δεsinω,cosω˜=δεcosω(6)The assumption that the rotation axis of an asteroid is perpendicular to its orbital plane is not necessarily applicable to all asteroids; however, it is a reasonable approximation for some asteroids. The spin axes of near-Earth and main-belt asteroids with sizes of less than several tens of kilometers are not isotropically distributed and are less likely to lie close to the ecliptic plane [23,24]. For instance, the asteroids Ryugu and Bennu have obliquities of ε=171.6  deg and ε=177.6  deg, respectively, which can be approximated as δε=−1 for first-step analytical analyses [2,25]. The validity of the perpendicular-rotation assumption is demonstrated via high-fidelity numerical simulations that incorporate the actual obliquity of Ryugu in Sec. VI.B. Perturbing Forces1. Solar Radiation PressureWhen the SRP acceleration acting on a spacecraft is modeled as a conservative force, it can be expressed by using a potential function as follows: aSRP=∂USRP∂r(7)where USRP denotes a perturbation function of the SRP. In this research, the SRP force is represented with the cannonball model as follows [26]: USRP=p(r⋅x^)(8)Here, x^ is a unit vector along the x axis of the Hill coordinate frame and p denotes the magnitude of the SRP obtained from the following equation: p≡(1+γ)P0Ad2M(9)where P0≃1.02×1017  kg⋅m/s2 is the solar flux constant, γ is the reflectivity of the spacecraft, A is the projected area of the spacecraft, M is the mass of the spacecraft, and d is the distance between the asteroid and the sun. Note that the shadowing effect is not taken into account in this study.2. Gravity IrregularityThis research employs spherical-harmonic and polyhedral gravity models to express the irregular gravity field of an asteroid. The former model is primarily used for analytical orbital analyses, whereas the latter model is introduced for high-fidelity numerical simulations. The gravitational acceleration applied to a spacecraft is computed from the gravitational potential UG as follows: aG=∂UG∂r(10)The spherical-harmonic gravitational potential is given by the following equation: UG,SH=μr∑l=0lmax∑m=0l(Rr)lPlm(sinϕ)(Clmcosmθ+Slmsinmθ)(11)where μ is the standard gravitational parameter of the asteroid, R is a reference asteroid radius, Plm is the Legendre polynomial, Clm and Slm are the Stokes coefficients, and lmax is the maximum degree and order of the spherical harmonics. Note that ϕ and θ denote the latitude and longitude, respectively. Equation (11) provides a closed-form expression for the irregular gravity field of an asteroid. Among the spherical harmonic coefficients described in the equation, the Jk≡−Ck0 terms, which are referred to as zonal coefficients, are of particular interest because of their predominant impact on spacecraft dynamics. In addition, the gravitational perturbations that correspond to Jk terms are independent of the longitude of the spacecraft position and thus of the asteroid spin phase. For this reason, analyses of zonal gravitational perturbations provide insight into the fundamental structure of the complex orbital motion around asteroids. From Eq. (11), the perturbation function associated with the Jk term can be defined by the following equation: UJk=−μJkr(Rr)k×Pk0(sinϕ)(12)By using this notation, the explicit forms of the perturbation functions for the J2, J3, and J4 terms are obtained as follows: UJ2=−μJ2r(Rr)2×12(3sin2ϕ−1)(13)UJ3=−μJ3r(Rr)3×12(5sin3ϕ−3sinϕ)(14)UJ4=−μJ4r(Rr)4×18(35sin4ϕ−30sin2ϕ+3)(15)The other form of a gravity-field model is constructed based on a constant-density polyhedral shape model. The polyhedral gravity field of an asteroid is computed from the following gravitational potential [27,28]: UG,PH=μV∭VdVρ(16)where V is the volume of the asteroid, dV is a volume element, and ρ is the distance between the volume element and the spacecraft. It is assumed in this study that the gravitational parameter is given; it has the same value as that in the spherical-harmonic model presented in Eq. (11). The spherical harmonic coefficients for Eq. (11) can be converted directly from the constant-density polyhedral potential presented in Eq. (16) by applying the algorithm proposed in [28].3. Solar TideAnother possible perturbing source is solar gravity, which provides the solar tidal force on a spacecraft around an asteroid. The acceleration caused by the solar tide can be expressed as aST=∂UST∂r(17)where UST represents the potential of the solar tidal perturbation, which is given by the following equation [26,29]: UST=N22{3(r⋅x^)2−r2}(18)where N denotes the mean motion of the asteroid. Equation (18) is derived by applying the Hill approximation, which is valid under the following two conditions: the spacecraft–asteroid distance is sufficiently smaller than the sun–asteroid distance, and the mass of the asteroid is sufficiently smaller than that of the sun. The acceleration given by Eq. (17) is combined with a centrifugal force caused by the asteroid orbital motion, which perturbs the spacecraft trajectory in the vicinity of an asteroid.C. Spacecraft and Asteroid ModelsThe physical parameters for a spacecraft and asteroid that are needed to compute the perturbation potentials are provided here. Table 1 lists the spacecraft and asteroid parameters used in this paper, which are primarily based on the Hayabusa2 and Ryugu models. The mass, projected area, and reflectivity of the spacecraft presented in the table are used for the Hayabusa2 landing trajectory design [30]. The SRP potential given in Eq. (8) is dependent on these spacecraft parameters.On the other hand, the physical parameters of Ryugu shown in Table 1 were obtained via proximity observations of Hayabusa2 [25]. The volume, mean radius, and maximum radius are computed from a shape model of the asteroid. The mean radius R¯ is defined as the radius of a sphere with a volume equivalent to that of the asteroid, which satisfies V=4/3πR¯3. The maximum radius is introduced to define the region where the spacecraft can potentially impact the asteroid. The major difference between Ryugu and the hypothetical asteroid assumed in the current research is their orbits about the sun. The orbit of the hypothetical asteroid is assumed to be circular with a radius of 1 AU for simplicity. This assumption immediately yields the mean motion given in Table 1.To analyze the orbital motion of the spacecraft, three different gravity models are employed, as provided in Table 2. Model 1 is the simplest model and is introduced for an analytical derivation of the frozen orbit solutions. This model is formulated based on the spherical harmonic model, which is given by Eq. (11), with only zonal coefficients up to the fourth order. Although this gravity model represents the fundamental characteristics of the gravitational field around the asteroid, it cannot simulate the longitudinal dependence due to sectoral and tesseral coefficients. Hence, model 2 is defined for numerical simulations as a more realistic gravitational model with fourth-order full harmonic coefficients (i.e., zonal, sectoral, and tesseral terms). Both models 1 and 2 have an obliquity of 180 deg and therefore exhibit no seasonal variation in the spin-axis direction with respect to the Hill coordinate frame. Model 2 is expressed as a function of the spin phase, and the adopted rotation period is identical to that of Ryugu.This study also employs a polyhedral gravity model given by Eq. (16) for further detailed orbit simulations. The polyhedral gravity field, which is referred to as model 3, is constructed from the shape model of Ryugu with 49,152 facets [25]. The polyhedral shape model is depicted in Fig. 2. The number of facets is reduced from the original shape model with 3 million facets for the sake of saving computational cost; nevertheless, the reduced version of the shape model retains the major global topographic features, as shown in Fig. 2. Detailed descriptions of the original shape model and the gravitational field analyses can be found in [25,30]. Another important difference between model 3 and models 1 and 2 is the direction of the spin axis of an asteroid; the rotation axis of model 3 is tilted by 8.36 deg compared with a complete retrograde rotation about the asteroid orbital plane, that is, ε=171.64  deg.Fig. 2 Shape model of Ryugu expressed in the asteroid-fixed coordinate frame.D. Magnitudes of PerturbationsThis section discusses the magnitudes of perturbations in the spacecraft–asteroid system. Figure 3 compares the magnitudes of the point-mass gravity and perturbing forces, namely, the SRP, higher-order gravities, and solar tide, for different radial distances from the center of the asteroid. The SRP acceleration is obtained from Eqs. (7–9), and its norm is independent of the radial distance, as illustrated in the figure. Figure 3 also shows the zonal gravitational accelerations that correspond to the J2–J5 terms, whose potentials are given by Eq. (12). The reference asteroid radius is defined as R=526  m, and the spherical harmonic coefficients are provided in Table 3. As previously mentioned, the coefficients are derived directly from the asteroid shape model shown in Fig. 2. The zonal gravity accelerations depicted in Fig. 3 are averaged with respect to latitude. The solar tidal force is calculated from Eqs. (17) and (18) along the x axis of the Hill coordinate frame.Figure 3 indicates that the SRP and higher-order gravities are the major perturbing sources within a distance of 10 km. The SRP acceleration is approximately comparable to the point-mass gravity at a distance of 10 km, whereas the higher-order gravitational forces become predominant when the spacecraft approaches the surface. One intriguing feature of the gravitational field investigated in this research, which is based on the Ryugu model, is that not only the J2 term but also the J4 term exerts a relatively strong gravitational perturbation. This distinctive feature of the zonal gravitational effect is discussed in detail in the next section.Fig. 3 Magnitudes of perturbing forces for different radial distances.The relative magnitudes of perturbing forces are dominated by physical parameters of spacecraft–asteroid systems. For instance, the SRP perturbation is less dominant than higher-order gravitational perturbations around asteroids with large solar distances and/or large gravitational parameters. A parametric study on perturbing accelerations for different systems is beyond the scope of this research; the readers can refer to [4,31] for the relevant sensitivity analysis.E. Zonal Gravity FieldFigure 4 shows the global distributions of gravitational acceleration evaluated at a distance of r=2R¯≃897  m. Figure 4a illustrates the gravitational field computed from the polyhedral gravitational potential, whereas the gravitational field depicted in Fig. 4b is based on a spherical harmonic model with lmax=10. In these figures, the norm of gravitational acceleration is displayed as contour maps in the latitude-longitude coordinate frame. It is evident that these high-fidelity gravity models coincide with each other.On the other hand, Fig. 5 shows the gravitational fields represented with only lower-order harmonic coefficients up to the fourth order. The gravitational accelerations presented in this figure are evaluated at the same distance as those of Fig. 4. The gravitational maps shown in Figs. 5a, 5c, and 5e are computed with lmax=2, 3, and 4, respectively, using all orders of coefficients (i.e., zonal, sectoral, and tesseral terms); in contrast, Figs. 5b, 5d, and 5f are created with only zonal terms, namely, J2, J3, and J4. Because zonal gravitational terms do not depend on longitude, the acceleration maps provided in Figs. 5b, 5d, and 5f show axisymmetric profiles. Figure 5e exhibits an acceleration profile similar to those shown in Figs. 4a and 4b, which is not completely modeled in Figs. 5a and 5c. Moreover, Fig. 5f demonstrates that latitudinal anisotropy in the gravitational field is modeled well with only zonal terms. From these observations, it is reasonable to take into account zonal gravitational perturbations up to the fourth order to understand the fundamental orbital dynamics around nearly axisymmetric asteroids, such as Ryugu.Fig. 4 High-fidelity gravity models of Ryugu.Fig. 5 Lower-order gravity models of Ryugu.III. Equations of MotionThe equations of motion used to describe the orbital motion of a spacecraft under the perturbing forces presented in the previous section are introduced here. This research uses two types of equations of motion for different purposes: Hill’s equation for numerical analyses and LPEs for analytical analyses.A. Hill’s EquationThis study employs the Hill three-body problem (H3BP) for numerical analyses of the orbital motion of a spacecraft around a target asteroid. The H3BP serves as a reasonable approximation for orbital dynamics in the vicinity of an asteroid moving in a circular orbit about the sun. The motion subject to the asteroid gravity, SRP, and solar tide is described by the following equation [26]: r¨+2ω×r˙+ω×(ω×r)=aSRP+aG+aST(19)where ω=[0,0,N]T denotes the angular velocity vector of the asteroid orbit. Equation (19) describes the orbital motion expressed in the Hill coordinate frame introduced in Sec. II.A. Because the H3BP model given by Eq. (19) incorporates the effect of SRP perturbation, it is often referred to as the augmented H3BP [32]. The first, second, and third terms on the right-hand side of Eq. (19) are given by Eqs. (7), (10), and (17), respectively. The gravitational potential is computed based on either the spherical harmonic model, Eq. (11), or the polyhedral model, Eq. (16). As described in Eq. (19), the tidal perturbation that the spacecraft feels can be expressed as aST−ω×(ω×r).B. Lagrange Planetary EquationsThe orbit of a spacecraft around an asteroid is disturbed by SRP and gravity-field perturbations. The variation in orbital elements can be described by LPEs averaged over one orbital period of the spacecraft. To derive the equations, this section introduces the averaged perturbation functions. The SRP potential given by Eq. (8) can be rewritten using orbital elements as follows [4]: USRP=pr{cosΩcos(ω+ν)−cosisinΩsin(ω+ν)}(20)The perturbation functions for the J2, J3, and J4 perturbations can also be expressed with the equatorial orbital elements by substituting Eq. (2) into Eqs. (13–15), respectively: UJ2=−μJ2r(Rr)2×12{3sin2i˜sin2(ω˜+ν)−1}(21)UJ3=−μJ3r(Rr)3×12{5sin3i˜sin3(ω˜+ν)−3sini˜sin(ω˜+ν)}(22)UJ4=−μJ4r(Rr)4×18{35sin4i˜sin4(ω˜+ν)−30sin2i˜sin2(ω˜+ν)+3}(23)Perturbation functions can be averaged over one orbital period by integrating with respect to a true anomaly as follows [26]: U¯=(1−e2)322π∫02πU(ν)(1+ecosν)2 dν(24)By applying this averaging method to Eqs. (20–23), the following equations are obtained: U¯SRP=−32pae(cosΩcosω−cosisinΩsinω)(25)U¯J2=μJ2R2×14a3(1−e2)32(3cos2i−1)(26)U¯J3=μδεJ3R3×3e8a4(1−e2)52sini(5cos2i−1)sinω(27)U¯J4=μJ4R4×3128a5(1−e2)72{−10e2sin2i(7cos2i−1)cos2ω−(2+3e2)(35cos4i−30cos2i+3)}(28)Note that Eqs. (26–28) are expressed with the Hill orbital elements by substituting Eqs. (5) and (6), which is valid only when the asteroid obliquity is either ε=0  deg or ε=180  deg. Because the J3 potential is not symmetric about the equatorial plane, Eq. (27) is dependent on the spin axis orientation δε.The Keplerian orbital motion of a spacecraft subject to perturbations is described by the following averaged LPEs [33]: dadt=2na∂U¯∂σ(29a)dedt=1−e2na2e∂U¯∂σ−1−e2na2e∂U¯∂ω(29b)didt=cotina21−e2∂U¯∂ω−cscina21−e2∂U¯∂Ω(29c)dΩdt=cscina21−e2∂U¯∂i−N(29d)dωdt=1−e2na2e∂U¯∂e−cotina21−e2∂U¯∂i(29e)where n=μ/a3 is the mean motion of a spacecraft, and the angle σ is defined as σ≡−Nt0, where t0 is the time of periapsis passage. The longitude of the ascending node, Ω, is defined with respect to the sun–asteroid line in this study and is thus subject to a variation corresponding to the mean motion of an asteroid, N, as shown in Eq. (29d) [16].The averaged perturbation function U¯ is given by the following equation: U¯=U¯SRP+U¯J2+U¯J3+U¯J4(30)Consequently, Eqs. (25–30) yield the following explicit form of the singly averaged LPEs [34–36]: dadt=0(31a)dedt=−KSRP1−e2(cosΩsinω+cosisinΩcosω)−KJ31(1−e2)2sini(5cos2i−1)cosω−KJ4e(1−e2)3sin2i(7cos2i−1)sin2ω(31b)didt=−KSRPe1−e2sinisinΩcosω+KJ3e(1−e2)3cosi(5cos2i−1)cosω+KJ4e2(1−e2)4sinicosi(7cos2i−1)sin2ω(31c)dΩdt=−KSRPe1−e2sinΩsinω−KJ21(1−e2)2cosi+KJ3e(1−e2)3coti(15cos2i−11)sinω−KJ41(1−e2)4cosi{2e2(7cos2i−4)cos2ω−(2+3e2)(7cos2i−3)}−N(31d)dωdt=−KSRP1e1−e2{(1−e2)cosΩcosω−cosisinΩsinω}+KJ212(1−e2)2(5cos2i−1)+KJ31e(1−e2)3csci{e2(35sin2icos2i−4)+sin2i(5cos2i−1)}sinω+KJ414(1−e2)4[2{e2(63cos4i−56cos2i+5)−2sin2i(7cos2i−1)}cos2ω−9e2(21cos4i−14cos2i+1)−4(49cos4i−36cos2i+3)](31e)Here, KSRP, KJ2, KJ3, and KJ4 are functions of the semimajor axis, which are given by the following equations: KSRP(a)=32pna(32a)KJ2(a)=32nJ2(Ra)2(32b)KJ3(a)=38nδεJ3(Ra)3(32c)KJ4(a)=1532nJ4(Ra)4(32d)Equation (31) describes the orbital motion around an asteroid under the SRP and zonal gravity perturbations.IV. Sun-Synchronous Frozen OrbitsA. Frozen Orbit ConditionsThis section derives the semi-analytical solutions of sun-synchronous frozen orbits based on the LPEs introduced in Sec. III.B. Frozen orbits are obtained when the following condition is satisfied: dadt=dedt=didt=dΩdt=dωdt=0(33)Given Eqs. (31b) and (31c), the following equation is a sufficient condition for satisfying the frozen requirements on the derivatives of eccentricity and inclination [17,22]: cosΩ=0∧cosω=0(34)Let us assume that Eq. (34) is satisfied and introduce the following two binary variables: δΩ≡sinΩ={+1(Ω=π2)−1(Ω=−π2),δω≡sinω={+1(ω=π2)−1(ω=−π2)(35)By solving Eq. (33) under the constraint of Eq. (34), the orbital elements of frozen orbits can be obtained as follows: [a,e,i,Ω,ω]T=[free,F1(a),F2(a),±π2,±π2]T(36)where F1(a) and F2(a) are implicit functions of the semimajor axis. Let Ω* and ω* denote the longitude of the ascending node and the argument of periapsis, respectively, that satisfy Eq. (36). By using these two orbital elements, the derivatives of Ω and ω can be expressed as functions of the semimajor axis, eccentricity, and inclination as follows: G1(a,e,i)≡dΩ(Ω*,ω*)dt=−KSRPe1−e2δΩδω−KJ21(1−e2)2cosi+KJ3e(1−e2)3coti(15cos2i−11)δω+KJ41(1−e2)4cosi{e2(35cos2i−17)+2(7cos2i−3)}−N(37a)G2(a,e,i)≡dω(Ω*,ω*)dt=KSRP1e1−e2cosi⋅δΩδω+KJ212(1−e2)2(5cos2i−1)+KJ31e(1−e2)3csci{e2(35sin2icos2i−4)+sin2i(5cos2i−1)}δω+KJ414(1−e2)4{e2(315cos4i−238cos2i+19)+16(14cos4i−11cos2i+1)}(37b)The eccentricity e=F1(a) and inclination i=F2(a) of frozen orbits are obtained by solving G1(a,e,i)=G2(a,e,i)=0.B. Frozen Orbit SolutionsThe solutions of frozen orbits under irregular-gravity and SRP perturbations can be obtained by numerically solving Eq. (36). Because the solution search does not involve numerical propagation, the proposed orbit design method provides semi-analytical solutions of sun-synchronous frozen orbits. When a semimajor axis is given, an eccentricity e=F1(a) and inclination i=F2(a) that satisfy the frozen orbit conditions can be computed. The solution is not necessarily unique, and therefore this section visually explores frozen orbit solutions.Figure 6 depicts the contour maps of dΩ/dt and dω/dt, which are given by Eqs. (37a) and (37b), for different inclinations and eccentricities. These maps are calculated with a=1.4  km, Ω=−90  deg (δΩ=−1), and ω=90  deg (δω=+1). The dotted lines represent the zero levels, where G1(a,e,i)=0 or G2(a,e,i)=0 is satisfied. Hence, the intersections of the dotted lines in the left and right panels of Fig. 6 correspond to frozen orbit solutions.Figure 7 depicts the solution space of frozen orbits on the left-hand side and examples of frozen orbit solutions expressed in the Hill coordinates on the right-hand side. The dashed and solid lines in the i-e map represent G1(a,e,i)=0 and G2(a,e,i)=0, respectively, which correspond to the dotted lines in Fig. 6, and the filled markers represent the intersections of these lines. By using this map, the conditions for achieving frozen orbits can be visually identified as the intersections of the dashed and solid lines. Similar graphical approaches for frozen-orbit design were also introduced in past studies [19,36].Fig. 6 Variations in longitude of the ascending node (left) and argument of periapsis (right).It is evident that there are three orbit solutions for this case, as shown on the right-hand side of Fig. 7: an ecliptic orbit (top), inclined elliptic orbit (middle), and terminator orbit (bottom). The ecliptic and terminator orbits can be regarded as the extensions of the families identified in past research on SRP- and J2-perturbed dynamics [17,18]. Note that the equatorial and ecliptic planes are identical under the current assumption. On the other hand, the inclined elliptic orbit has yet to be investigated in detail although similar frozen solutions have been  identified in previous studies [17,19]. Because of its large eccentricity, the inclined elliptic orbit impacts the asteroid in the current spacecraft–asteroid system, as shown in the next section; however, it might be a feasible option for other systems with different dynamic parameters.Fig. 7 Examples of frozen orbit solutions under zonal gravity and SRP perturbations.Figure 7 is computed for δΩ=−1 and δω=+1. On the other hand, Fig. 8 depicts the zero-variation conditions for the other possible δΩ-δω combinations with a=1.4  km. As depicted in Figs. 7 and 8, these maps exhibit nearly symmetric profiles about the sign of δΩδω. However, neither of these pairs is completely identical or symmetric owing to the J3 perturbation, which causes gravitational asymmetry in the north–south direction. Figure 9 compares the frozen-orbit conditions for different semimajor axes of spacecraft orbits with δΩ=−1 and δΩ=+1. It is intriguing that the locations and number of frozen orbit solutions (intersections of the curves) are significantly dependent on the distance from the asteroid.The authors reiterate that the proposed frozen orbits are solved under the assumption that the obliquity angle takes a value near 0 or 180 deg. This assumption is valid for asteroids with nearly perpendicular spin axes (refer to Sec. VI). However, when the rotation axis is tilted, the proposed frozen obit solutions can exhibit significant temporal variations depending on the obliquity angles. One possible approach to this problem, which would be an intriguing topic for future research, is the implementation of initially or yearly frozen orbits, as recently demonstrated for the J2-perturbed dynamics [31].Fig. 8 Frozen-orbit conditions for different longitudes of the ascending node and arguments of periapsis.Fig. 9 Frozen-orbit conditions for different semimajor axes.C. Continuation of Frozen OrbitsThis section explores families of frozen orbits by applying the continuation method. As shown in Fig. 7, several types of frozen orbits can be calculated for a specific semimajor axis. Thus, the families of these frozen orbits can be identified via the continuation approach by treating the semimajor axis as a continuation parameter. The pseudo-arclength continuation is applied for this analysis [37].Figure 10 illustrates the transitions of frozen orbit families for four different combinations of δΩ and δω. As previously mentioned, the graphical approach found that there exist three types of frozen orbits in this system, namely, terminator orbits, ecliptic orbits, and inclined elliptic orbits. The transitions of these three families are depicted in the a-e and a-i planes, which is a similar approach to that developed in [17]. The shaded area in the a-e plane shown in each panel of Fig. 10 represents the zone where orbits can potentially impact the asteroid, which is defined by the following condition: a(1−e)<Rmax(38)where Rmax denotes the maximum radius of the asteroid provided in Table 1.Figures 10a–10d indicate that inclined elliptic orbits impact the asteroid in the current system because of their large eccentricities. On the other hand, feasible terminator orbit families appear in Figs. 10b and 10c, and feasible ecliptic orbit families are found in Figs. 10a and 10c. The terminator orbits can be classified into the northern and southern families, whereas the ecliptic orbits are categorized into the prograde and retrograde families. In this paper, the prograde/retrograde direction is defined with respect to the asteroid orbit around the sun but not with respect to the asteroid rotation. The geometries of these families are summarized in Table 4. Note that the δΩ and δω values of the prograde/retrograde orbits are dependent on the higher-order gravitational terms. The ecliptic orbit families depicted in Figs. 10a and 10c are similar to the equatorial heliotropic orbit families investigated in [17]. However, unlike the equatorial heliotropic orbits, the inclinations of the ecliptic frozen orbits proposed in this research are not exactly 0 or 180 deg because of the J3 term. In addition, when semimajor axes are relatively large (a⪆2  km), this type of frozen orbit is inclined up to approximately 30 deg with respect to the equatorial plane, which is referred to as a nonequatorial orbit in the previous study.Fig. 10 Families of frozen orbits obtained by the continuation analysis.As an example, Fig. 11 illustrates the families of northern terminator orbits (δΩ=+1, δω=−1), prograde ecliptic orbits (δΩ=−1, δω=+1), and northern inclined elliptic orbits (δΩ=+1, δω=−1) with different semimajor axes. In this figure, the frozen orbits are depicted in the Hill coordinate frame and color-coded based on their semimajor axes. The inclined elliptic orbits shown in Fig. 11c impact the asteroid, as predicted in Fig. 10b. Figure 11 indicates that the continuation method successfully produces a series of orbits of various sizes. These results demonstrate that frozen orbits can actually be achieved even under the predominant SRP and gravity-field perturbations. It should be noted that the solution space of frozen orbits is significantly dependent on physical parameters of spacecraft–asteroid systems, such as the solar distance, gravitational parameter, and spacecraft area-to-mass ratio. Although detailed discussions on the applicability of the proposed method to different systems are beyond the scope of this paper, it should be considered in future studies.Fig. 11 Orbit diagrams of the families of frozen orbits.D. Numerical Simulation ResultsThis section provides some numerical simulations for the obtained frozen orbits to demonstrate their efficacy. In the simulations, spacecraft trajectories are propagated for 80 days based on the equation of motion given by Eq. (19). The gravitational potential is calculated with zonal coefficients up to the fourth order, which is defined as model 1 in Table 2.Figure 12 provides simulation results for conventional and proposed northern terminator orbits. The initial condition of the conventional terminator orbit depicted in Fig. 12a is calculated considering only SRP as a perturbing force [13], whereas zonal gravity perturbations are taken into account for designing the terminator orbit shown in Fig. 12b, as described in the previous sections. The semimajor axes of these orbits are given as a=1.1  km. It is evident that the former orbit diverges because of unmodeled gravitational perturbations. In contrast, the orbital geometry of the terminator orbit depicted in Fig. 12b remains approximately constant, demonstrating the validity of the proposed approach.In the same manner, Fig. 13 compares the conventional and proposed prograde ecliptic orbits with a=1.4  km. Note that this type of orbit is referred to as an equatorial heliotropic orbit in previous research [17]. The ecliptic orbit shown in Fig. 13a is designed to compensate for SRP and J2 perturbations. On the other hand, as introduced in this paper, the analytical model for calculating the frozen orbit presented in Fig. 13b also incorporates the J3 and J4 terms. As clearly shown in Fig. 13b, the proposed orbit exhibits more stationary behavior than the conventional orbit. This result indicates the importance of the inclusion of higher-order zonal gravities in calculating frozen orbits around small bodies.Fig. 12 Numerical propagations of conventional and proposed terminator orbits.Fig. 13 Numerical propagations of conventional and proposed ecliptic orbits.V. Stability AnalysisThe previous section described the design methodology of frozen orbits around asteroids. It was found that several types of frozen orbits exist, which can be useful for station keeping around asteroids. However, the orbital-period averaging and zonal-gravity approximation applied to solve the frozen-orbit solutions can cause substantial errors in actual asteroid environments. Therefore, to apply frozen orbits in actual missions, orbital stability is one of the critical parameters. This section analytically derives stability conditions and stability metrics for frozen orbits and provides some analysis results.A. Stability ConditionsThe linear stability of frozen orbits can be evaluated based on linearized LPEs [17]. The methodology for analytical stability analysis considering the SRP and J2 perturbations is discussed in detail in our previous research [22]. This study extends the stability analysis scheme for a system incorporating the J3 and J4 gravitational perturbations.Let X≡[a,e,i,Ω,ω]T be a set of orbital elements. By using this notation, the LPEs described in Eq. (31) can be rewritten in vector form as X˙=f(X). Frozen orbits are equilibrium solutions in which the derivatives of the orbital elements are zero. Hence, X˙=f(X) can be linearized around the equilibrium states. Let X* denote a frozen orbit solution, which satisfies f(X*)=0, and let δX≡X−X* be a small deviation from the equilibrium. Then, the variational equation is given as follows: δX˙=∂f∂X|X*δX(39)The 5×5 Jacobian matrix on the right-hand side of Eq. (39) is obtained from the following equation: ∂f∂X=[∂fa∂a∂fa∂e∂fa∂i∂fa∂Ω∂fa∂ω∂fe∂a∂fe∂e∂fe∂i∂fe∂Ω∂fe∂ω∂fi∂a∂fi∂e∂fi∂i∂fi∂Ω∂fi∂ω∂fΩ∂a∂fΩ∂e∂fΩ∂i∂fΩ∂Ω∂fΩ∂ω∂fω∂a∂fω∂e∂fω∂i∂fω∂Ω∂fω∂ω](40)where fa, fe, fi, fΩ, and fω denote the right-hand sides of Eqs. (31a–31e), respectively. The explicit forms of the partial derivatives shown on the right-hand side of Eq. (40) are presented in the Appendix. The frozen orbits investigated in this research satisfy Eq. (34), and therefore the Jacobian matrix can be simplified to the following form: ∂f∂X|X*=[00000000JAJB0000JCJDJEJF00JGJHJI00](41)The nonzero terms in the Jacobian matrix are calculated from the following equations: JA=KSRP1−e2δΩδω(42a)JB=KSRP1−e2cosi⋅δΩδω+KJ31(1−e2)2sini(5cos2i−1)δω+KJ42e(1−e2)3sin2i(7cos2i−1)(42b)JC=KSRPe1−e2sini⋅δΩδω−KJ3e(1−e2)3cosi(5cos2i−1)δω−KJ42e2(1−e2)4sinicosi(7cos2i−1)(42c)JD=−KSRPe2a1−e2δΩδω+KJ272a(1−e2)2cosi−KJ39e2a(1−e2)3coti(15cos2i−11)δω−KJ4112a(1−e2)4cosi{e2(35cos2i−17)+2(7cos2i−3)}(42d)JE=−KSRP1(1−e2)32δΩδω−KJ24e(1−e2)3cosi+KJ31+5e2(1−e2)4coti(15cos2i−11)δω+KJ42e(1−e2)5cosi{3e2(35cos2i−17)+91cos2i−41}(42e)JF=KJ21(1−e2)2sini−KJ3e(1−e2)3(4csc2i+15cos2i)δω−KJ41(1−e2)4sini{e2(105cos2i−17)+6(7cos2i−1)}(42f)JG=KSRP12ae1−e2cosi⋅δΩδω−KJ274a(1−e2)2(5cos2i−1)−KJ392ae(1−e2)3csci{e2(35sin2icos2i−4)+sin2i(5cos2i−1)}δω+KJ4118a(1−e2)4{e2(315cos4i−238cos2i+19)+16(14cos4i−11cos2i+1)}(42g)JH=−KSRP1–2e2e2(1−e2)32cosi⋅δΩδω+KJ22e(1−e2)3(5cos2i−1)+KJ31e2(1−e2)4csci{5e4(35sin2icos2i−4)+e2(70sin2icos2i+7cos2i−11)−sin2i(5cos2i−1)}δω−KJ4e2(1−e2)5{3e2(315cos4i−238cos2i+19)+1211cos4i−942cos2i+83}(42h)JI=−KSRP1e1−e2sini⋅δΩδω−KJ25(1−e2)2sinicosi−KJ31e(1−e2)3coticsci{e2(105cos4i−175cos2i+66)−sin2i(15cos2i−11)}δω+KJ41(1−e2)4sinicosi{7e2(45cos2i−17)+8(28cos2i−11)}(42i)The stability information of a frozen orbit solution, X*, is encoded in the five eigenvalues of the Jacobian matrix presented in Eq. (41). The characteristic equation for eigenvalues λ associated with the variational equation has the following form: λ(λ4+αλ2+β)=0(43)where α=−(JAJE+JBJH+JCJI)(44a)β=JAJC(JEJI−JFJH)(44b)An intriguing feature of the characteristic equation is that it possesses a biquadratic form, thereby yielding analytical solutions of the eigenvalues. For the orbital motion to exhibit Lyapunov stability, all of the eigenvalues must have nonpositive real parts. The stability condition is expressed by the following equation: Re(λk)≤0(∀k∈{1,…,5})(45)Given the biquadratic form of Eq. (43), the frozen orbits become stable only when the eigenvalues have a single zero root and two conjugate pairs of pure-imaginary values. Thus, the necessary and sufficient condition for Eq. (45) is given by the following equation: α2−4β≥0∧α≥0∧β≥0(46)When this stability condition is satisfied, the eigenvalues are solved as follows: λ=0,±iq1,±iq2(47)where q1=α−α2−4β2,q2=α+α2−4β2(48)In the special case where the gravity-field perturbation is negligible, the following equation holds true: KSRP≠0,KJ2=KJ3=KJ4=0⇒JF=0,JAJE<0,JBJH≤0,JCJI≤0⇒α>0,β=0(49)On the other hand, the J2-perturbed dynamics without any other perturbations satisfies the following equation: KJ2≠0,KSRP=KJ3=KJ4=0⇒JA=JB=JC=0⇒α=β=0(50)Equations (49) and (50) indicate that when either SRP or J2 perturbation is the only perturbing force, which is often assumed in the conventional frozen-orbit design, the stability condition [Eq. (46)] is always satisfied. In contrast, frozen orbits can be unstable when both SRP and gravity-field perturbations are predominant, as discussed in the next section. This finding indicates that the coupling effect of SRP and gravity irregularity destabilizes the orbital motion.B. Stability Modes and BifurcationsThe stability behaviors of frozen orbits subject to SRP and zonal gravity perturbations can be comprehensively assessed based on their eigenstructures. Equation (43) indicates that this system has one trivial zero root and two conjugate pairs of eigenvalues. Each pair of eigenvalues are real numbers, pure imaginary numbers, or complex numbers. The eigenvalue configuration can be categorized into one of several groups depending on the α and β values defined in Eqs. (44a) and (44b). As stated in previous research on general dynamic systems, a fourth-order reversible system, which is expressed as a biquadratic equation, has four different stability modes [38,39]. The classification can be visualized in the two-dimensional α-β plane, which is divided into four regions with α=0, β=0, and α2−4β=0. In each region, the four eigenvalues have different modes, as illustrated in Fig. 14.Among the four regions sketched in Fig. 14, region 1 is the case where the frozen orbits satisfy Eq. (46) and thus achieve stability. In contrast, there exists at least one unstable node in each of the other regions. The types of eigenvalues in each region are described as follows: in region 1, four pure imaginary values; in region 2, two real values and two pure imaginary values; in region 3, four real values; and in region 4, four complex values. In addition, the boundaries between these regions correspond to transitions from one eigenvalue state to another, which involve bifurcations of eigenvalues. The characteristics of the four regions and transitions are summarized in Table 5. The naming of the bifurcations follows the pattern proposed in [38]. Note that the trivial zero eigenvalue is not listed in the third column. By using the α-β diagram, the stability transitions of the frozen orbits can be visually identified.Fig. 14 Classification of orbital stability based on eigenvalue configurations.To systematically quantify the stability of frozen orbits, this research also introduces a stability index, which is defined by the following equation: ζ=max(Re(λk))(k∈{1,…,5})(51)Stable frozen orbits possess a stability index of ζ=0. A larger stability index value represents stronger instability, as the eigenvalue dominates the expansion rate of the state error. The virtue of this metric is that it can be calculated analytically without performing orbit propagation.C. Stability Analysis ResultsThis section provides some analysis results for the stability of frozen orbits disturbed by SRP and zonal gravity perturbations. Figure 15 shows the stability modes of the three different types of frozen orbits depicted in Fig. 11. The orbit transitions are presented in the a-e plane, and the stability modes are indicated by color. The shaded regions in Fig. 15 represent infeasible cases defined by Eq. (38), where the spacecraft orbit can intersect the asteroid.Figure 15a indicates that the northern terminator orbits can exhibit any of the four stability modes sketched in Fig. 14. This distinctive feature was not observed in our previous study, which incorporates only the SRP and J2 perturbations [22]. It can be inferred from this finding that the joint effect of SRP and higher-order zonal gravities forms the complicated eigenstructure of frozen orbits. Figure 15b shows that feasible (nonshaded) prograde ecliptic orbits are classified into region 1. This means that these orbits are linearly stable and thus might be feasible options for actual asteroid missions. The stability mode of the inclined elliptic orbits is displayed in Fig. 15c, although this type of orbit is infeasible in the current system because of small periapsides. As shown in this figure, most of the inclined elliptic orbits correspond to either region 3 or region 4 and thus are unstable.Fig. 15 Stability modes of frozen orbits.The complex stability behaviors of the terminator orbits are analyzed in detail in subsequent paragraphs. Figure 16a depicts the root locus expressed in the complex plane. Five eigenvalues calculated from Eq. (43) for each terminator orbit are plotted in this figure. The colors of the plots represent the semimajor axes of the orbits. On the other hand, Fig. 16b shows the transitions of terminator orbits in the α-β plane. The α and β values are obtained from Eqs. (44a) and (44b). This figure indicates that the orbit family crosses the borders of the stability modes multiple times, at the points where bifurcations occur. Figures 16a and 16b both demonstrate that the eigenstructure of the dynamic system investigated in this research exhibits complex profiles.The analytical analyses provided in this paper are further validated by numerical simulations. Figures 17–19, respectively, depict the stability indices of the northern terminator orbits, prograde ecliptic orbits, and northern inclined elliptic orbits. In addition, some examples of numerically propagated orbits are included in Figs. 17 and 18. The propagation results are expressed in orbit diagrams (Hill coordinate frame) and in the time histories of eccentricity, inclination, and the longitude of the ascending node. To avoid singularity for inclination, the longitude of periapsis, Π≡Ω+ω, is depicted instead of the longitude of the ascending node for the ecliptic orbits shown in Fig. 18 [7,40]. The orbital motions are propagated based on Hill’s equation, given by Eq. (19), and the gravitational acceleration is computed based on model 2, defined in Table 2. In the numerical simulations, the initial Ω and i values are perturbed by 3 deg to compare orbital evolutions. The trajectories are propagated for 160 days unless the calculation is terminated when a spacecraft trajectory intersects with a spherical asteroid with a radius of R¯. Note that the shaded areas in the a-e plane shown in Figs. 17–19 correspond to the cases where Eq. (38) is satisfied. The primary parameters of the propagated frozen orbits are summarized in Table 6.Fig. 16 Eigenstructure of northern terminator orbits.Figure 17 indicates that the stability index profile of the northern terminator orbits is non-monotonous and that orbits with larger stability indices tend to involve stronger disturbances. For instance, the unstable orbit with ζ=1.2×10−6 depicted in Fig. 17a diverges and eventually collides with the asteroid. In contrast, the stable orbit with ζ=0 illustrated in Fig. 17b does not experience collision within 160 days, even though the orbital size is similar to that of the orbit shown in Fig. 17a. A comparison among Figs. 17c–17e indicates that a frozen orbit exhibits weaker instability as the stability index decreases. The difference in the growth rates of perturbations is observed in the temporal variations of the orbital elements. One intriguing notion is that a stability index has a local maximum at a≃1  km, presumably because the coupling of SRP and gravity irregularity significantly perturbs the orbital motion in the intermediate-altitude region. The terminator orbits at large distances, such as the orbit shown in Fig. 17e, are approximately identical to the conventional SRP-perturbed terminator orbit. Hence, the stability index converges to zero in accordance with the increase in the semimajor axis, as indicated by Eq. (49).Fig. 17 Analytical stability analysis and numerical simulations for northern terminator orbits.Fig. 18 Analytical stability analysis and numerical simulations for prograde ecliptic orbits.Fig. 19 Analytical stability analysis for northern inclined elliptic orbits.The prograde ecliptic frozen orbits depicted in Fig. 18 all achieve long-term stability, as predicted by the analytical stability analyses provided in Fig. 15b. Figures 18a–18c show that these ecliptic orbits are bounded within some regions without collisions during the propagation period. However, the inclination history presented in Fig. 18c exhibits slightly irregular behavior. This observation implies that when a periapsis is too close to the asteroid, gravitational perturbations can destabilize frozen orbits.From these observations, Figs. 17 and 18 demonstrate that the numerical simulations agree with the analytical analyses, therefore validating the introduced dynamic theories on frozen orbits subject to zonal gravity and SRP perturbations. Although the dynamic asymmetries exist between the northern and southern terminator orbits and between the prograde and retrograde ecliptic orbits, they are expected to be minor given the similarity in the solution spaces depicted in Fig. 10.Unlike the terminator and ecliptic frozen orbits, there is no feasible solution of the inclined elliptic orbits that can avoid an impact on the asteroid surface; nevertheless, the orbit stability can be analytically evaluated in the same manner. As depicted in Fig. 19, the stability indices of the inclined orbits are larger than those of the other orbit families shown in Figs. 17 and 18. This result implies that inclined elliptic orbits exhibit relatively strong instability presumably because of their large eccentricities; however, it does not rule out the possibility that this type of orbit can serve as a viable option in different systems.VI. High-Fidelity Numerical SimulationTo evaluate the feasibility of frozen orbits for actual asteroid missions, numerical simulations based on a high-fidelity gravity model are presented in this section. The terminator and ecliptic orbits shown in Table 6 are propagated using Hill’s equation [Eq. (19)] and the polyhedral gravity model of Ryugu, which is defined as model 3 in Table 2. The direction of the spin axis exhibits seasonal variation due to the orbital motion of the asteroid, and its initial direction vector with respect to the Hill coordinate frame is set to be [0,−0.1454,−0.9894]T. Note that the orbit of the asteroid around the sun is assumed to be circular to simplify the comparison between the analytical theories and the numerical simulations. The numerical propagation is terminated when a spacecraft trajectory intersects with the polyhedral shape model of the asteroid.The numerical simulation results for the northern terminator orbits and prograde ecliptic orbits are illustrated in Figs. 20 and 21, respectively. These figures depict the orbit diagrams and time histories of the orbital elements in the same manner as in Figs. 17 and 18. The asteroid is rotating with respect to the Hill coordinate frame, and thus Figs. 20 and 21 show the initial state of the asteroid. The initial state vectors of the spacecraft are the same as those provided in Figs. 17 and 18.The orbit profiles depicted in Figs. 20c–20e are similar to the corresponding diagrams provided in Fig. 17. The growth rates of perturbations agree with those predicted in the analytical theories discussed in Sec. V. This result demonstrates the validity of the semi-analytical solutions of frozen orbits and their stability characterizations. As shown in Figs. 20d and 20e, a spacecraft can naturally orbit around an asteroid for more than 150 days even under SRP and gravity-field perturbations. On the other hand, the orbits illustrated in Figs. 20a and 20b collide with the asteroid in 33 and 107 days, respectively, although the latter orbit is linearly stable according to the result shown in Fig. 17. This observation implies that when a spacecraft is located too close to an asteroid, the perpendicular-spin assumption, zonal-gravity approximation, and orbital-period averaging used to derive the frozen solutions lose validity, leading to significant variations in the orbital elements.Fig. 20 Numerical propagations of northern terminator orbits based on the polyhedral gravity model.Fig. 21 Numerical propagations of prograde ecliptic orbits based on the polyhedral gravity model.Among the three prograde ecliptic orbits illustrated in Fig. 21, the left two orbits are bounded within certain spatial regions. The orbital elements of these two orbits exhibit simple harmonic oscillations, which agrees with the linear stability analysis. Although the variations in inclination are larger than those shown in Figs. 18a and 18b, the orbital geometries remain approximately constant even in a polyhedral gravity field, demonstrating the feasibility of ecliptic frozen orbits. In contrast, the ecliptic orbit shown in Fig. 21c, which has a smaller periapsis than the other two ecliptic orbits, gradually diverges and eventually collides with the asteroid in approximately 89 days. It can be inferred from this finding that ecliptic orbits with a small periapsis can be destabilized due to predominant gravity-field perturbations, as is also observed for the terminator orbits presented in Fig. 20.The high-fidelity numerical simulations described in this section imply that the frozen orbit solutions derived analytically based on the zonal gravity approximation are valid for Ryugu-like asteroids. It can therefore be concluded that the proposed frozen orbits are promising options for asteroid missions under gravity-field and SRP perturbations, particularly for target bodies with nearly perpendicular rotation axes and axisymmetric shapes.VII. ConclusionsThis paper investigated frozen orbits around asteroids under strong SRP and zonal gravity perturbations. First, perturbation models were introduced, and the accelerations due to the SRP, higher-order gravity, and solar tide were computed. This analysis clarified that the adopted Ryugu-based gravity model exhibits strong zonal acceleration corresponding to the J4 term as well as the J2 term. In the subsequent section, singly averaged LPEs that incorporate the SRP, J2, J3, and J4 perturbations were successfully derived. Based on this model, semi-analytical solutions for frozen orbits were obtained, in which the optimal eccentricity and inclination were visually identified using a two-dimensional variation map. The continuation of frozen orbits clarified that three types of frozen orbits exist, namely, terminator orbits, ecliptic orbits, and inclined elliptic orbits. The first two orbits are extensions of previously identified solutions. In contrast, inclined elliptic orbits are not feasible in the current system because of their large eccentricities. One of the major contributions of this research is its analytical characterization of the stability behavior of the derived frozen orbits. It was clarified that the frozen orbits exhibit four different stability modes depending on their characteristic eigenvalues, which was not observed in our previous study that focuses only on the SRP and J2 perturbations. Furthermore, a stability index was introduced to analytically quantify the orbital stability, demonstrating the existence of stable frozen orbits. The developed stability analysis scheme provides essential information for the design of frozen orbits in actual missions. In the last section, the obtained frozen orbits were propagated based on a polyhedral-gravity model to validate the aforementioned analytical theories. The high-fidelity numerical simulations showed that a spacecraft can naturally orbit an asteroid for more than 150 days in relatively stable terminator and ecliptic orbits. From these observations, it can be concluded that the proposed frozen orbits serve as feasible options for asteroid missions and involve complex yet intriguing dynamic structures.Appendix: Derivatives of the Terms in the LPEsThe partial derivatives of the right-hand sides of Eq. (31) are derived here. Let fa, fe, fi, fΩ, and fω be the right-hand sides of Eqs. (31a–31e), respectively. Note that the parameters KSRP, KJ2, KJ3, and KJ4 are functions of semimajor axis a.From Eq. (31a), the following equations are derived: ∂fa∂a=∂fa∂e=∂fa∂i=∂fa∂Ω=∂fa∂ω=0(A1)From Eq. (31b), the following equations are derived: ∂fe∂a=−KSRP1−e22a(cosΩsinω+cosisinΩcosω)+KJ392a(1−e2)2sini(5cos2i−1)cosω+KJ411e2a(1−e2)3sin2i(7cos2i−1)sin2ω(A2a)∂fe∂e=KSRPe1−e2(cosΩsinω+cosisinΩcosω)−KJ34e(1−e2)3sini(5cos2i−1)cosω−KJ41+5e2(1−e2)4sin2i(7cos2i−1)sin2ω(A2b)∂fe∂i=KSRP1−e2sinisinΩcosω−KJ31(1−e2)2cosi(15cos2i−11)cosω−KJ44e(1−e2)3sinicosi(7cos2i−4)sin2ω(A2c)∂fe∂Ω=KSRP1−e2(sinΩsinω−cosicosΩcosω)(A2d)∂fe∂ω=KSRP1−e2(−cosΩcosω+cosisinΩsinω)+KJ31(1−e2)2sini(5cos2i−1)sinω−KJ42e(1−e2)3sin2i(7cos2i−1)cos2ω(A2e)From Eq. (31c), the following equations are derived: ∂fi∂a=−KSRPe2a1−e2sinisinΩcosω−KJ39e2a(1−e2)3cosi(5cos2i−1)cosω−KJ411e22a(1−e2)4sinicosi(7cos2i−1)sin2ω(A3a)∂fi∂e=−KSRP1(1−e2)32sinisinΩcosω+KJ31+5e2(1−e2)4cosi(5cos2i−1)cosω+KJ42e(1+3e2)(1−e2)5sinicosi(7cos2i−1)sin2ω(A3b)∂fi∂i=−KSRPe1−e2cosisinΩcosω−KJ3e(1−e2)3sini(15cos2i−1)cosω+KJ4e2(1−e2)4(28cos4i−23cos2i+1)sin2ω(A3c)∂fi∂Ω=−KSRPe1−e2sinicosΩcosω(A3d)∂fi∂ω=KSRPe1−e2sinisinΩsinω−KJ3e(1−e2)3cosi(5cos2i−1)sinω+KJ42e2(1−e2)4sinicosi(7cos2i−1)cos2ω(A3e)From Eq. (31d), the following equations are derived: ∂fΩ∂a=−KSRPe2a1−e2sinΩsinω+KJ272a(1−e2)2cosi−KJ39e2a(1−e2)3coti(15cos2i−11)sinω+KJ4112a(1−e2)4cosi{2e2(7cos2i−4)cos2ω−(2+3e2)(7cos2i−3)}(A4a)∂fΩ∂e=−KSRP1(1−e2)32sinΩsinω−KJ24e(1−e2)3cosi+KJ31+5e2(1−e2)4coti(15cos2i−11)sinω−KJ42e(1−e2)5cosi{2(1+3e2)(7cos2i−4)cos2ω−(11+9e2)(7cos2i−3)}(A4b)∂fΩ∂i=KJ21(1−e2)2sini−KJ3e(1−e2)3(4csc2i+15cos2i)sinω+KJ41(1−e2)4sini{2e2(21cos2i−4)cos2ω−3(2+3e2)(7cos2i−1)}(A4c)∂fΩ∂Ω=−KSRPe1−e2cosΩsinω(A4d)∂fΩ∂ω=−KSRPe1−e2sinΩcosω+KJ3e(1−e2)3coti(15cos2i−11)cosω+KJ44e2(1−e2)4cosi(7cos2i−4)sin2ω(A4e)From Eq. (31e), the following equations are derived: ∂fω∂a=−KSRP12ae1−e2{(1−e2)cosΩcosω−cosisinΩsinω}−KJ274a(1−e2)2(5cos2i−1)−KJ392ae(1−e2)3csci{e2(35sin2icos2i−4)+sin2i(5cos2i−1)}sinω−KJ4118a(1−e2)4[2{e2(63cos4i−56cos2i+5)−2sin2i(7cos2i−1)}cos2ω−9e2(21cos4i−14cos2i+1)−4(49cos4i−36cos2i+3)](A5a)∂fω∂e=KSRP1e2(1−e2)32{(1−e2)cosΩcosω−(1–2e2)cosisinΩsinω}+KJ22e(1−e2)3(5cos2i−1)+KJ31e2(1−e2)4csci{5e4(35sin2icos2i−4)+e2(70sin2icos2i+7cos2i−11)−sin2i(5cos2i−1)}sinω+KJ4e2(1−e2)5[2{3e2(63cos4i−56cos2i+5)+119cos4i−120cos2i+13}cos2ω−27e2(21cos4i−14cos2i+1)−973cos4i+702cos2i−57](A5b)∂fω∂i=−KSRP1e1−e2sinisinΩsinω−KJ25(1−e2)2sinicosi−KJ31e(1−e2)3coticsci{e2(105cos4i−175cos2i+66)−sin2i(15cos2i−11)}sinω−KJ41(1−e2)4sinicosi[2{7e2(9cos2i−4)+2(7cos2i−4)}cos2ω−63e2(3cos2i−1)−4(49cos2i−18)](A5c)∂fω∂Ω=KSRP1e1−e2{(1−e2)sinΩcosω+cosicosΩsinω}(A5d)∂fω∂ω=KSRP1e1−e2{(1−e2)cosΩsinω+cosisinΩcosω}+KJ31e(1−e2)3csci{e2(35sin2icos2i−4)+sin2i(5cos2i−1)}cosω−KJ41(1−e2)4{e2(63cos4i−56cos2i+5)−2sin2i(7cos2i−1)}sin2ω(A5e)AcknowledgmentThis work was supported by Grants-in-Aid for Scientific Research (19K21075 and 20K14952) from the Japan Society for the Promotion of Science.\r            References\r        [1] Tsuda Y., Saiki T., Terui F., Nakazawa S., Yoshikawa M. and Watanabe S., and Hayabusa2 Project Team, “Hayabusa2 Mission Status: Landing, Roving and Cratering on Asteroid Ryugu,” Acta Astronautica, Vol. 171, June 2020, pp. 42–54. https://doi.org/10.1016/j.actaastro.2020.02.035 CrossrefGoogle Scholar[2] Lauretta D. S., DellaGiustina D. N., Bennett C. A., Golish D. R., Becker K. J., Balram-Knutson S. S., Barnouin O. S., Becker T. L., Bottke W. F., Boynton W. V., Campins H., Clark B. E., Connolly H. C., d’Aubigny C. Y. D., Dworkin J. P., Emery J. P., Enos H. L., Hamilton V. E., Hergenrother C. W., Howell E. S., Izawa M. R. M., Kaplan H. H., Nolan M. C., Rizk B., Roper H. L., Scheeres D. J., Smith P. H., Walsh K. J. and Wolner C. W. V., and The OSIRIS-REx Team, “The Unexpected Surface of Asteroid (101955) Bennu,” Nature, Vol. 568, No. 7750, 2019, pp. 55–60. https://doi.org/10.1038/s41586-019-1033-6 CrossrefGoogle Scholar[3] Dankowicz H., “Some Special Orbits in the Two-Body Problem with Radiation Pressure,” Celestial Mechanics and Dynamical Astronomy, Vol. 58, No. 4, 1994, pp. 353–370. https://doi.org/10.1007/BF00692010 CrossrefGoogle Scholar[4] Scheeres D. J., “Satellite Dynamics About Asteroids,” Advances in the Astronautical Sciences, Vol. 87, Feb. 1994, pp. 275–292. Google Scholar[5] Scheeres D. J., Ostro S. J., Hudson R. S., DeJong E. M. and Suzuki S., “Dynamics of Orbits Close to Asteroid 4179 Toutatis,” Icarus, Vol. 132, No. 1, 1998, pp. 53–79. https://doi.org/10.1006/icar.1997.5870 CrossrefGoogle Scholar[6] Scheeres D., Williams B. G. and Miller J. K., “Evaluation of the Dynamic Environment of an Asteroid: Applications to 433 Eros,” Journal of Guidance, Control, and Dynamics, Vol. 23, No. 3, 2000, pp. 466–475. https://doi.org/10.2514/2.4552 LinkGoogle Scholar[7] Vallado D. A., Fundamentals of Astrodynamics and Applications, Springer Science & Business Media, New York, 2001, Chaps. 2, 12. Google Scholar[8] Jupp A., “The Critical Inclination Problem—30 Years of Progress,” Celestial mechanics, Vol. 43, Nos. 1–4, 1987, pp. 127–138. https://doi.org/10.1007/BF01234560 CrossrefGoogle Scholar[9] Coffey S. L., Deprit A. and Deprit E., “Frozen Orbits for Satellites Close to an Earth-Like Planet,” Celestial Mechanics and Dynamical Astronomy, Vol. 59, No. 1, 1994, pp. 37–72. https://doi.org/10.1007/BF00691970 CrossrefGoogle Scholar[10] Boain R. J., “A-B-Cs of Sun-Synchronous Orbit Mission Design,” 14th AAS/AIAA Space Flight Mechanics Conference, American Astronautical Soc. Paper  04-108, San Diego, CA, 2004. Google Scholar[11] Folta D. and Quinn D., “Lunar Frozen Orbits,” AIAA/AAS Astrodynamics Specialist Conference and Exhibit, AIAA Paper  2006-6749, 2006. Google Scholar[12] Delsate N., Robutel P., Lemaitre A. and Carletti T., “Frozen Orbits at High Eccentricity and Inclination: Application to Mercury Orbiter,” Celestial Mechanics and Dynamical Astronomy, Vol. 108, No. 3, 2010, pp. 275–300. https://doi.org/10.1007/s10569-010-9306-2 CrossrefGoogle Scholar[13] Scheeres D. J., “Satellite Dynamics About Small Bodies: Averaged Solar Radiation Pressure Effects,” Journal of the Astronautical Sciences, Vol. 47, No. 1, 1999, pp. 25–46. https://doi.org/10.1007/BF03546208 CrossrefGoogle Scholar[14] Scheeres D., Sutter B. and Rosengren A., “Design, Dynamics and Stability of the OSIRIS-REx Sun-Terminator Orbits,” Advances in the Astronautical Sciences, Vol. 148, Feb. 2013, pp. 3263–3282. Google Scholar[15] Wibben D. R., Levine A., Rieger S., McAdams J. V., Antreasian P. G., Leonard J. M., Moreau M. C. and Lauretta D. S., “OSIRIS-REx Frozen Orbit Design and Flight Experience,” 2019 AAS/AIAA Astrodynamics Specialist Conference, American Astronautical Soc. Paper  19-677, San Diego, CA, 2019. Google Scholar[16] Scheeres D. J., “Orbit Mechanics About Asteroids and Comets,” Journal of Guidance, Control, and Dynamics, Vol. 35, No. 3, 2012, pp. 987–997. https://doi.org/10.2514/1.57247 LinkGoogle Scholar[17] Lantukh D., Russell R. P. and Broschart S., “Heliotropic Orbits at Oblate Asteroids: Balancing Solar Radiation Pressure and J2 Perturbations,” Celestial Mechanics and Dynamical Astronomy, Vol. 121, No. 2, 2015, pp. 171–190. https://doi.org/10.1007/s10569-014-9596-x CrossrefGoogle Scholar[18] Colombo C., Lücking C. and McInnes C. R., “Orbital Dynamics of High Area-to-Mass Ratio Spacecraft with J2 and Solar Radiation Pressure for Novel Earth Observation and Communication Services,” Acta Astronautica, Vol. 81, No. 1, 2012, pp. 137–150. https://doi.org/10.1016/j.actaastro.2012.07.009 CrossrefGoogle Scholar[19] Takahashi S. and Scheeres D. J., “Higher-Order Corrections for Frozen Terminator Orbit Design,” Journal of Guidance, Control, and Dynamics, Vol. 43, No. 9, 2020, pp. 1642–1655. https://doi.org/10.2514/1.G004901 LinkGoogle Scholar[20] Lantukh D., Russell R. P. and Broschart S. B., “Heliotropic Orbits at Asteroids: Zonal Gravity Perturbations and Application at Bennu,” Advances in the Astronautical Sciences, Vol. 155, Jan. 2015, pp. 1981–1992. Google Scholar[21] Russell R. P., Lantukh D. and Broschart S. B., “Heliotropic Orbits with Zonal Gravity and Shadow Perturbations: Application at Bennu,” Journal of Guidance, Control, and Dynamics, Vol. 39, No. 9, 2016, pp. 1925–1933. https://doi.org/10.2514/1.G001279 LinkGoogle Scholar[22] Kikuchi S., Tsuda Y., Yoshikawa M. and Kawaguchi J., “Stability Analysis of Coupled Orbit–Attitude Dynamics Around Asteroids Using Finite-Time Lyapunov Exponents,” Journal of Guidance, Control, and Dynamics, Vol. 42, No. 6, 2019, pp. 1289–1305. https://doi.org/10.2514/1.G003879 LinkGoogle Scholar[23] Pravec P., Harris A. W. and Michalowski T., “Asteroid Rotations,” Asteroids III, The Univ. of Arizona Press, Tucson, 2002, pp. 113–122. Google Scholar[24] Kryszczyñska A., La Spina A., Paolicchi P., Harris A., Breiter S. and Pravec P., “New Findings on Asteroid Spin-Vector Distributions,” Icarus, Vol. 192, No. 1, 2007, pp. 223–237. https://doi.org/10.1016/j.icarus.2007.06.008 CrossrefGoogle Scholar[25] Watanabe S., Hirabayashi M., Hirata N., Hirata N., Noguchi R., Shimaki Y., Ikeda H., Tatsumi E., Yoshikawa M., Kikuchi S., Yabuta H., Nakamura T., Tachibana S., Ishiara Y., Morota T., Kitazato K., Sakatani N., Matsumoto K., Wada K., Senshu H., Honda C., Michikami T., Takeuchi H., Kouyama T., Honda R., Kameda S., Fuse T., Miyamoto H., Komatsu G., Sugita S., Okada T., Namiki N., Arakawa M., Ishiguro M., Abe M., Gaskell R., Palmer E., Barnouin O. S., Michel P., French A. S., McMahon J. W., Scheeres D. J., Abell P. A., Yamamoto Y., Tanaka S., Shirai K., Matsuoka M., Yamada M., Yokota Y., Suzuki H., Yoshioka K., Cho Y., Tanaka S., Nishikawa N., Sugiyama T., Kikuchi H. R., Yamaguchi T., Ogawa N., Ono G., Mimasu Y., Yoshikawa K., Takahasi T., Takei Y., Fujii A., Hirose C., Iwata T., Hayakawa M., Hosoda S., Mori O., Sawada S. T., Soldini S., Yano H., Tsukizaki R., Ozaki M., Iijima Y., Ogawa K., Fujimoto M., Ho T.-M., Moussi A., Jaumann R., Bibring J.-P., Krause C., Terui F., Saiki T., Nakazawa S. and Tsuda Y., “Hayabusa2 Arrives at the Carbonaceous Asteroid 162173 Ryugu—A Spinning Top–Shaped Rubble Pile,” Science, Vol. 364, No. 6437, 2019, pp. 268–272. https://doi.org/10.1126/science.aav8032 Google Scholar[26] Scheeres D. J., Orbital Motion in Strongly Perturbed Environments, 1st ed., Springer Praxis, Chichester, England, U.K., 2012, Chaps. 2, 4, 6. CrossrefGoogle Scholar[27] Werner R. A., “The Gravitational Potential of a Homogeneous Polyhedron or Don’t Cut Corners,” Celestial Mechanics and Dynamical Astronomy, Vol. 59, No. 3, 1994, pp. 253–278. https://doi.org/10.1007/BF00692875 CrossrefGoogle Scholar[28] Werner R. A. and Scheeres D. J., “Exterior Gravitation of a Polyhedron Derived and Compared with Harmonic and Mascon Gravitation Representations of Asteroid 4769 Castalia,” Celestial Mechanics and Dynamical Astronomy, Vol. 65, No. 3, 1996, pp. 313–344. https://doi.org/10.1007/BF00053511 Google Scholar[29] Scheeres D., Guman M. and Villac B., “Stability Analysis of Planetary Satellite Orbiters: Application to the Europa Orbiter,” Journal of Guidance, Control, and Dynamics, Vol. 24, No. 4, 2001, pp. 778–787. https://doi.org/10.2514/2.4778 LinkGoogle Scholar[30] Kikuchi S., Terui F., Ogawa N., Saiki T., Ono G., Yoshikawa K., Takei Y., Mimasu Y., Ikeda H., Sawada H., Van Wal S., Sugita S., Watanabe S. and Tsuda Y., “Design and Reconstruction of the Hayabusa2 Precision Landing on Ryugu,” Journal of Spacecraft and Rockets, Vol. 57, No. 5, 2020, pp. 1033–1060. https://doi.org/10.2514/1.A34683 LinkGoogle Scholar[31] Oguri K., Lantoine G., Hart W. and McMahon J., “Science Orbit Design with a Quasi-Frozen Beta Angle: Effects of Body Obliquity on J2-Perturbed Dynamics,” Celestial Mechanics and Dynamical Astronomy, Vol. 132, No. 10, 2020, pp. 1–33. https://doi.org/10.1007/s10569-020-09987-z Google Scholar[32] Broschart S. B., Scheeres D. J. and Villac B. F., “New Families of Multi-Revolution Terminator Orbits Near Small Bodies,” Advances in the Astronautical Sciences, Vol. 135, No. 3, 2009, pp. 1685–1702. Google Scholar[33] Brouwer D. and Clemence G. M., Methods of Celestial Mechanics, Academic Press, New York, 1961, Chap. 11. CrossrefGoogle Scholar[34] Kozai Y., “The Motion of a Close Earth Satellite,” Astronomical Journal, Vol. 64, Nov. 1959, p. 367. https://doi.org/10.1086/107957 CrossrefGoogle Scholar[35] Kiedron K. and Cook R., “Frozen Orbits in the J2+J3 Problem,” Astrodynamics 1991, Aug. 1992, pp. 1273–1289. Google Scholar[36] Tresaco E., Carvalho J. P. S., Prado A. F., Elipe A. and de Moraes R. V., “Averaged Model to Study Long-Term Dynamics of a Probe About Mercury,” Celestial Mechanics and Dynamical Astronomy, Vol. 130, No. 2, 2018, p. 9. https://doi.org/10.1007/s10569-017-9801-9 CrossrefGoogle Scholar[37] Seydel R., Practical Bifurcation and Stability Analysis, Vol. 5, Springer Science & Business Media, New York, 2009, Chap. 4. Google Scholar[38] Champneys A. R., “Homoclinic Orbits in Reversible Systems and Their Applications in Mechanics, Fluids and Optics,” Physica D: Nonlinear Phenomena, Vol. 112, Nos. 1–2, 1998, pp. 158–186. https://doi.org/10.1016/S0167-2789(97)00209-1 CrossrefGoogle Scholar[39] Parra-Rivas P., Gomila D., Matas M. A., Coen S. and Gelens L., “Dynamics of Localized and Patterned Structures in the Lugiato-Lefever Equation Determine the Stability and Shape of Optical Frequency Combs,” Physical Review A, Vol. 89, No. 4, 2014, Paper 043813. https://doi.org/10.1103/PhysRevA.89.043813 Google Scholar[40] Cefola P., “Equinoctial Orbit Elements-Application to Artificial Satellite Orbits,” AIAA/AAS Astrodynamics Conference, AIAA Paper  1972-0937, 1972. Google Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Kinematics Control of Electromagnetic Formation Flight Using Angular-Momentum Conservation Constraint",
        "url": "https://arc.aiaa.org/doi/10.2514/1.G005873",
        "date": "20210925",
        "content": "AbstractElectromagnetic formation flight (EMFF) uses the electromagnetic force to control the relative positions of multiple satellites without using conventional fuel-based propulsion. To compensate for the electromagnetic torque generated alongside the electromagnetic force, in most previous studies, all satellites were assumed to have reaction wheels (RWs) besides electromagnetic coils. However, the RW-loaded angular momentum becomes nonuniformly distributed among the satellites, because the electromagnetic torque usually differs between satellites. Without a proper control scheme, this deviation increases over time, and the RWs become saturated quickly, preventing the attitudes of the satellites from being controlled. In this study, a new controller is proposed that enables the electromagnetic force and torque to be controlled simultaneously. The EMFF kinematics derived from the conservation of angular momentum are used for the controller design. This controller can control n satellites without saturating the RWs, and only one set of RWs is required among all satellites. The combination of the proposed controller with a simple unloading control exclusive to the chief satellite results in the elimination of the accumulation of angular momentum in the entire system. The effectiveness of the proposed controller is demonstrated through numerical simulations of the formation maintenance and formation reconfiguration of a five-satellite system.Nomenclaturea˜cross-product matrix related to an arbitrary vector a{a}basis vector of an arbitrary frame (A), {axT,ayT,azT}Taxcomponent of an arbitrary vector a in an arbitrary frame (X)a˙time derivative of an arbitrary component aCY/Xcoordinate transformation matrix from an arbitrary frame (X) to an arbitrary frame (Y)(dX/dt)atime derivative of an arbitrary vector a in an arbitrary frame (X)Exx×x unit matricesfEMjelectromagnetic force imparted by the system to the jth satellite, Nhjreaction wheel angular momentum of the jth satellite, N⋅m⋅shjdtarget reaction wheel angular momentum of the jth satellite, N⋅m⋅shbreaction wheel angular momentum of the system, [h1T,…,hnbnT]T∈R3nIjinertial dyadic of the jth satellite, kg⋅m2Jjinertia of the jth satellite in the body-fixed frame, kg⋅m2Langular momentum of the system, N⋅m⋅sLdtarget angular momentum of the system, N⋅m⋅smnumber of reaction wheels in the systemmjmass of the jth satellite, kgnnumber of satellitesq˙time derivative of the generalized coordinates, [r˙iT,σ˙T,hbT]T∈R6n+3m−3rjposition vector of the jth satellite with respect to the center of mass of the formation, mrjkposition vector of the jth satellite viewed from the kth satellite, rj−rk, mriposition vectors of the system with respect to the center of mass of the formation, [ri2T,…,rinT]T∈R3n−3ζEMFF states, ζ=[r˙iT,ωbT,ξbT]T∈R(6n+3  m−3)×1μgEarth’s gravitational parameter, 3.986×1014  m3/s2μjdipole moment of the jth satellite, A⋅m2μ0permeability constant, 4π×10−7  T⋅m/Avcontrolled states of the electromagnetic formation flight states ζ, [r˙iT,ωTb,ξb11T,⋯,ξbm−1m−1T]T∈R6n+3m−6ξjvariables that are related to hjd and Ld, (hj−[1/m]L), N⋅m⋅sξbvariables of the system, [ξb11T,…,ξbmmT]T∈R3mσmodified Rodrigues parameters of the system, [σ1T,⋯,σnT]T∈R3nσjmodified Rodrigues parameters of the jth satelliteτEMjelectromagnetic torque imparted by the system to the jth satellite, N⋅mωfjalternating current frequency of the jth dipole moment, s−1ωjangular velocity vector of the jth satellite with respect to an inertial frame, s−1ωbangular velocity vector of the system, [ωb11T,…,ωbnnT]T∈R3nI. IntroductionMaintaining the stability and control of satellite formations for long periods without consuming fuel creates the potential for more flexible and functional future space missions. Satellite formation flying involves controlling the relative positions and absolute attitudes of multiple satellites. This technology provides many advantages for prospective space missions, including increased flexibility, scalability, accuracy, feasibility, fault tolerance, and cost reduction. Furthermore, it enables new space developments, which cannot be realized using monolithic satellites [1]. Such examples include space interferometers [2,3], space-based solar power systems [4], and distributed antenna arrays [5]. However, owing to the many variables involved in maintaining satellite formation in orbit, continuous control is required to maintain the desired formation. Therefore, the mission period is often limited by fuel consumption. Increasing the initial fuel reserve increases the fuel mass and, therefore, the rocket launch cost. Moreover, the plume impingement from the thruster can cause disturbances and particle contamination [3], which adversely affects the formation stability and performance of satellite optical systems. Therefore, the development of a system that can operate independently of fuel is one of the top targets in satellite flight research.Electromagnetic formation flight (EMFF) is considered one of the most mature and promising propellant-free satellite formation-flying methods [6–23]. It operates on the principle that multiple satellites can be controlled by the electromagnetic forces and torques between the satellites that result from the interactions between coil-generated electromagnetic fields. Previous research has proposed both the direct current (DC) [6–14] and alternating current (AC) methods [15–23] for the electromagnetic coil current. The DC method has the advantage of low power consumption, whereas the AC method provides higher functionality than the DC method by adjusting both the phase [15–17] and frequency [15,20–23]. For example, the coupling between the AC method control and Earth’s magnetic field can be neglected compared with the control of EMFF [8,15–18], and the strong coupling of the EMFF dynamics can be separated [8,15–18]. Further, many variables can be used to optimize the angular momentum and thermal build-up [15], and the relative position and relative attitude between satellites can be determined by measuring the magnetic fields of the satellites [21]. Multiple experiments have been conducted to test the performance of the DC method by ground test beds using high-temperature superconducting (HTS) wire [6], whereas the validity of the AC method has been examined using experimental equipment on the ground and in space using test beds [16,17,19–22].However, despite multiple demonstrations of EMFF technology, several persisting problems have prevented its practical application. One major problem is the uncontrollability of the electromagnetic torque generated by the electromagnetic force. EMFF using the DC method cannot control the electromagnetic force and torque simultaneously owing to the lack of variables of the dipole moment [11]. Moreover, both the electromagnetic force and torque can only take values that do not change the linear and angular momentum of the system. Owing to these constraints, most previous studies on the AC method have used only the electromagnetic force to control the relative position and regarded the electromagnetic torque as a disturbance. In the account of the electromagnetic torque, most previous studies assumed that all satellites have an additional attitude actuator, typically three-axis reaction wheels (RWs). Although the total electromagnetic effects do not change the angular momentum of the entire system, the value of the electromagnetic torque acting on each satellite is different. Therefore, the angular momentum values loaded in the RWs (RW angular momentum) are distributed nonuniformly among the satellites. Without a proper control scheme, this deviation grows with time. After that, the RWs saturate relatively quickly; as a result, the attitudes of each satellite cannot be controlled [6]. Unloading via a fuel-based thruster [10] usually consumes a significant amount of fuel. Moreover, unloading via Earth’s magnetic field is not easy because simultaneous unloading by all satellites generates disturbances caused by interaction between the magnetic fields of the satellites. For the same reason, removing the RW angular momentum accumulated by external torque from the space environment is also difficult.To solve these nonuniform distribution and accumulation problems, the electromagnetic torque minimizing [11–15], polarity switch of all dipoles [8], torque-free formation [14], desaturation using Earth’s magnetic field [10–12,15,18], and sinusoidal excitation to remove angular momentum build-up due to Earth’s magnetic field [8,15–18] have been studied. Nevertheless, these problems have only been mitigated, potentially saturating the attitude actuators during long-term operation. In addition, some of the corresponding solutions are unsuitable for certain scientific programs because they limit the formation shapes and are based on the existence of the Earth’s magnetic field. In fact, the state of RWs depends on input history because the electromagnetic torque absorbed by RWs could not be controlled. This suggests that controlling the electromagnetic torque prevents the nonuniform distribution of the RW angular momentum. Therefore, this study proposes a new control law for EMFF systems that simultaneously controls the electromagnetic force and torque based on the AC method to address the nonuniform distribution and accumulation problems fundamentally. The contributions of the proposed control law are as follows. First, the proposed control law theoretically eliminates the nonuniform distribution of the RW angular momentum for each satellite. Second, the relative positions, absolute attitudes, and RW angular momentum of n satellites are controlled assuming that the system has only one set of RWs. Third, combining this control law with a simple unloading control in the chief satellite theoretically eliminates the accumulation of angular momentum throughout the entire system without previously using complicated algorithms [15,18]. The effectiveness of the proposed control law is demonstrated through three simulations. It should be noted that complete knowledge of the relative positions and attitude of all satellites along with their linear and angular velocities is assumed in this study to investigate the effectiveness of the proposed control law.The remainder of the paper is organized as follows. In Sec. II, the relative translational and absolute attitude dynamics for the controller design are formulated. After the EMFF system description of the DC method and two constraints of EMFF, the AC modulation technique used in the latter half of this paper is introduced. Section III presents the conditions for achieving simultaneous control and EMFF kinematics that is derived from the angular momentum conservation constraint. Specifically, the polynomial representation of the AC method shows its extensibility for generating an arbitrary electromagnetic force and torque. “Redundant EMFF” (EMFF with more than one RWs in the system) is defined, and then the control objectives to guarantee the existence of smooth state feedback while avoiding the nonuniform distribution problem are introduced. Subsequently, the kinematics of EMFF is derived from the conservation of angular momentum. Finally, the averaged dynamics of AC-based EMFF are computed. Section IV explains a new kinematic control law based on the EMFF kinematics for enabling the simultaneous control of the electromagnetic force and torque. In Sec. V, the validity of the proposed control law is confirmed via the formation maintenance and formation reconfiguration for five satellites. Our conclusions are presented in Sec. VI.II. Basic Formulations for Electromagnetic Formation Flight ControlThis section outlines the relative translational and absolute attitude dynamics for the controller design of satellite formation flying. After the system description and introduction of two constraints of EMFF, the AC modulation technique used in the latter half of this paper is introduced. In the last section, the AC modulation technique used in the latter half of this paper is introduced.A. Relative Translational DynamicsThis subsection outlines the coordinate systems (see Fig. 1) and relative translational dynamics of satellite formation flying. In particular, “the invariant orientation frame (I),” which is mainly used in this paper, is determined. It should be noted that the Earth-centered inertial (ECI) frame [8] is defined as an inertial frame, for simplicity.Fig. 1 Coordinate systems mainly used in this paper.The first coordinate system is the body-fixed frame of the jth satellite (Bj), which is located at the center of mass of the jth satellite; its basis vector is defined as {bj}. The second and third coordinate systems are the orbital reference frame (O) and the invariant orientation frame (I). Both frames are located at the center of mass of the formation, and their basis vectors are denoted as {o} and {i}, respectively. The difference between the two frames lies in the definition of the x axes. The x-axis ox in (O) points in the orbit radial direction, whereas the x-axis ix in (I) points to an invariant orientation within the orbital plane, such as the radial direction of the orbit at the initial time. In both (O) and (I) frames, the z axes correspond to the orbit normal vector, and the y axes complete a right-handed orthogonal frame. Therefore, the frame (I) is defined as a frame that does not rotate to the frame (ECI). As a result, the time derivative at frame (I) coincides with that at the inertial frame [(dECI/dt)=(dI/dt)]. This property is useful for formulating the angular momentum of the system.Next, the relative translational dynamics for circular and elliptical orbits around the Earth is dI2dt2rj=1mjfjc+μg‖R‖3(3oxox⋅rj−rj)(1)assuming that ‖rj‖≪‖R‖, where R is the position vector from the center of the Earth to the reference position. Unlike exact nonlinear models [24], this study does not include the perturbations of the center of mass of the system. Because EMFF can only output internal forces, the absolute position control in orbit requires additional actuators, such as thrusters. To simplify the derivation of the conservation of angular momentum, this study represents the relative translational dynamics, as shown in Eq. (1), as components of the invariant orientation frame (I).B. Absolute Attitude Dynamics of Rigid Spacecraft with Reaction WheelsIn this subsection, the attitude representation and dynamics of monolithic rigid satellites are outlined. The modified Rodrigues parameters (MRPs) vector σ={σ1,σ2,σ3}T is used to represent the attitude of the satellite [25]. The absolute attitude of the jth satellite frame (Bj) and its target frame (Bjd) with respect to the invariant orientation frame (I) are expressed by σj and σjd as the MRPs, respectively. Based on the definitions, the relative attitude δσj and the relative angular velocity δbjωj of the jth satellite with respect to the target are expressed as δσj=(1−‖σjd‖2)σj−(1−‖σj‖2)σjd+2σj×σjd1+‖σj‖2‖σjd‖2+2σjTσjd,δbjωj=ωbjj−CBj/Bjdbjdωjd(2)Then, the MRPs kinematic differential equation for the jth satellite is expressed as σ˙j=Z(σj)bjωj,Z(σj)=14[(1−σjTσj)E3+2σ˜j+2σjσjT](3)Note that the relative attitude variable pair (δσ˙j, δbjωj) also satisfies this MRP kinematics [26]. Although the MRPs vector takes a singular value when the principal rotation angle Φ is ±360  deg, this geometric singularity can be avoided by the shadow set of MRPs σs=−σ/(σTσ). As σs takes a singular value at Φ=0, switching σ with σs eliminates the singularity. Therefore, matrix Z in Eq. (3) is definite in any attitude and globally regular matrix. Similarly, using the following regular matrix [Z]∈R3n×3n, the MRPs kinematic differential equation of the system is expressed as σ˙=[σ˙1⋮σ˙n]=[Z][ωb11⋮ωbnn],[Z]=[Z(σ1)0⋱0Z(σn)](4)Subsequently, the attitude dynamics of a rigid spacecraft with RWs [25] is expressed as Ij⋅dBjdtωj+ωj×(Ij⋅ωj+hj)=τjc−τj(RW)+τjd,dBjdthj=τj(RW)(5)where τjd is the disturbance torque of jth satellite. In this study, the gravity gradient torque τg and Earth’s magnetic field Be are considered as the sources of disturbances to the attitude of the satellite. The gravity gradient torque is one of the most important external effects in orbit. They can be approximated accurately as follows [25]: τg=3μgR5(R×I⋅R)(6)The dipolar approximation model of Earth’s magnetic field that can provide a sufficient estimate of geomagnetism is Be(μe,R)=μ04π(3R(μe⋅R)‖R‖5−μe‖R‖3)(7)This approximates the magnetic properties of Earth as those of a magnetic dipole with a moment of μe≈8.1×1022  A⋅m2 and tilted by approximately 11° from the geographic poles [27]:C. Direct Current Method for Electromagnetic Formation Flight SystemThis subsection describes the generation of the electromagnetic force and torque between electromagnetic coils. In an EMFF system, each satellite is equipped with three-axis electromagnetic coils and controlled by adjusting the value of the “dipole moment,” which is proportional to the current c. For a circular coil, the relationship between the dipole moment μ and the current c is given by μ=NtcAn(8)where Nt is the number of coil turns, c is the current strength, A is the area enclosed by the coil, and n is the unit vector perpendicular to the plane of the coil. The dipole moment of the jth satellite μj is defined by the sum of three different orthogonal circular coils in the satellite. It should be noted that the magnetic dipole is assumed to be located precisely at the center of the mass of the satellites. Therefore, disturbing torques caused by the lever arm between the coil and their centers of mass are not taken into account, unlike in previous study [10]. Following the DC approach for EMFF, the magnetic field B(μk,rjk), electromagnetic force f(μk,μj,rjk)=μj⋅∇B(μk,rjk), and electromagnetic torque τ(μk,μj,rjk)=μj×B(μk,rjk) exerted on the jth dipole by the kth dipole are expressed as [11] B(μk,rjk)=μ04π(3rjk(μk⋅rjk)‖rjk‖5−μk‖rjk‖3)(9)f(μk,μj,rjk)=3μ04π(μk⋅μj‖rjk‖5rjk+μk⋅rjk‖rjk‖5μj+μj⋅rjk‖rjk‖5μi−5(μk⋅rjk)(μj⋅rjk)‖rjk‖7rjk)(10)and τ(μk,μj,rjk)=μ04πμj×(3rjk(μk⋅rjk)‖rjk‖5−μk‖rjk‖3)(11)where rjk=rj−rk is the position vector of the jth satellite viewed from the kth satellite. The magnetic field B(μk,rjk) in Eq. (9) is given by a far-field approximation [11], which is accurate only when the distance between the satellites exceeds two times the radius of the coil [7]. Numerical calculations in this study are conducted to the extent that this approximation condition is satisfied. Otherwise, the ratios of exact to far-field forces [7] and the exact model [11], which is computationally expensive, can be used. It should be noted that the electromagnetic force and torque satisfy the equality and inequality in Eq. (12): f(μk,μj,rjk)+f(μj,μk,rji)=0,τ(μk,μj,rjk)+τ(μj,μk,rji)≠0(12)Finally, the electromagnetic force fEMj and torque τEMj imparted by the system to the jth satellite can be derived by the summation of the electromagnetic force and torque on the jth satellite. fEMj=∑i=1nf(μk,μj,rjk),τEMj=∑i=1nτ(μk,μj,rjk)(13)At each time step, EMFF derives dipole moments μ, known as “dipole solutions,” to realize the target outputs calculated by the controller. Then, the derived values of μ are assigned to all the electromagnetic coils available in the system. This derivation process is called “dipole inversion.” A calculation example of this process is as follows: {Minimize: J=τbEMTτbEMSubject  to: ficj=fiEMj(14)This equation describes the nonlinear nonconvex optimization problem with evaluation function J=τbEMTτbEM to minimize the generated τEM [11–15]. Note that the derived dipole moment (not control values) can take discontinuous values because the solution can move from one local optimum to another. Although this dipole inversion is processed at each time step, initializing the nonlinear solver with the solution of the previous time step significantly reduces the convergence time, facilitating real-time implementation [15]. In addition to general nonlinear programming algorithms, the calculation using the homotopy (continuation) method [28] is proposed for DC-based EMFF, to find all possible solutions for deriving optimal τEM [11] or to find the evolution of the one viable guidance solution in time [10].D. Dipole Modulation of Alternating Current MethodThis subsection outlines the modulation technique of the AC method [15]. The AC-driven dipole moments of the sine wave μa(t) and μb(t) are expressed in Eq. (15): μa(t)=μ(sin)asin(ωfat+θ),μb(t)=μ(sin)bsin(ωfbt)(15)where μ(sin)a and μ(sin)b are the amplitudes of the sine wave for the ath and bth dipoles, respectively, and θ is the phase difference between two dipole moments. Using the periodic dipole moment, the time-varying electromagnetic force f(μa(t),μb(t),rba) and torque τ(μa(t),μb(t),rba) are derived. {f(μa(t),μb(t),rba)=(κ1+κ2)f(μ(sin)a,μ(sin)b,rba)τ(μa(t),μb(t),rba)=(κ1+κ2)τ(μ(sin)a,μ(sin)b,rba)κ1,κ2=±12cos((ωfa∓ωfb)t+θ)(16)Because the discussion of the stability of the time-varying systems is complex, they are usually approximated based on first-order averaging [29] as described in previous AC EMFF studies [15–22]. Note that the following discussion solely refers to the electromagnetic force, but similar averaging can be applied to the electromagnetic torque. The average electromagnetic force favg during the period T=2N±π/(ωfa±ωfb)(N+,N−∈Z) is expressed by Eq. (17). favg(μa(t),μb(t),rba)=(1T∫0T(κ1+κ2) dt)f(μ(sin)a,μ(sin)b,rba)(17)This approximation holds when either the AC frequency or the dynamic frequency is sufficiently large for each. Equation (17) implies that, on average, the AC-driven magnetic fields do not interact with each other for different AC frequencies ωf or AC phases θ that are offset by 90°. Following the same principle, the coupling between the AC control and Earth’s magnetic field, which is a constant value for short intervals, can be neglected compared with the control of EMFF [8,18]. Therefore, if the two dipoles are driven at the same value of frequency ωf with no phase difference, the averaged electromagnetic force during T=Nπ/ωf(N∈Z) can be expressed as favg(μa(t),μb(t),rba)=12f(μ(sin)a,μ(sin)b,rba)⏟average  term−12cos(2ωft)f(μ(sin)a,μ(sin)b,rba)⏟oscillatory  term≈0≈12f(μ(sin)a,μ(sin)b,rba)(18)Herein, the oscillation term in Eq. (18) is set to zero by averaging during T; however, it appears as a control error. This error is shown to be tolerable by setting the value of the AC frequency ωf based on the frequency response analysis [16,17].III. Simultaneous Control Conditions and Electromagnetic Formation Flight KinematicsTo achieve simultaneous control of the electromagnetic force and torque, this section details the required conditions, and the EMFF kinematics are derived from the angular momentum conservation constraint. In particular, this study considers the EMFF as a monolithic system, such as a redundant manipulator, where all satellites are connected via the conservation of angular momentum. Then, the EMFF with more than one RWs in the system is called the “Redundant EMFF.”A. Electromagnetic Formation Flight ConstraintsTo understand the EMFF structure, EMFF constraints are described using the holonomic and nonholonomic constraints. In particular, properties of nonholonomic constraints for smooth stabilization are presented.EMFF is a system with the conservation of linear and angular momentum. The values of fEMj and τEMj in Eq. (13) cannot change the linear momentum P and angular momentum L of the system. Hence, using Eqs. (10) and (11), the relationships shown in ∑j=1nfEMj=dIdtP=0,∑j=1n(rj×fEMj+τEMj)=dIdtL=0(19)are automatically satisfied. Therefore, in the absence of external forces, EMFF holds the linear and angular momentum conservation constraints ∑i=1nmjdIdtrj=const,∑i=1nIj⋅ωj+mjrj×dIdtrj=const(20)Note that the angular momentum of the system includes the angular momentum caused by the motion of each satellite around the center of mass of the system.In general, the constraints are classified into two types, and these constraints have properties that are relevant to control system design. The first constraints can be expressed as C(q)=0(21)which, for the generalized coordinate vector q, are commonly called “holonomic constraints.” These can be removed from the dynamics by eliminating specific values of q. However, certain states in holonomic systems cannot be reached irrespective of the control method used. In the case of EMFF, the conservation of linear momentum corresponds to the holonomic constraint, and the center of mass of the system cannot always be changed by EMFF control.All constraints that cannot expressed as holonomic constraints, such as C(q,q˙)=0(22)and are called “nonholonomic constraints,” which includes the conservation of angular momentum [30]. To remove nonholonomic constraint terms in the dynamics, kinematics are derived from nonholonomic constraints [31,32]. Unlike holonomic constraints, arbitrary states can possibly be reached using specific control inputs depending on the system.However, nonholonomic systems cannot be asymptotically stabilized to a single equilibrium point via smooth state feedback [33]. In the case of EMFF, all states cannot be asymptotically stabilized at once via smooth state feedback. Control systems with x-nonholonomic constraints can be smoothly stabilized only for smooth manifolds of an x-dimensional smooth manifold [31].B. Control Objectives for “Redundant Electromagnetic Formation Flight” to Avoid Saturation of RWsThis subsection clarifies the cause of the nonuniform distribution problem and the appropriate control objectives to avoid this problem. Previous studies on EMFF [6–23] guaranteed the existence of smooth state feedback by not considering the nonuniform distribution problem. Finally, EMFF, which uses more than one set of RWs, is defined as “Redundant EMFF.”Control objectives of typical space systems, which have the conservation of angular momentum as well as EMFF, have been stabilized to an appropriate equilibrium manifold to avoid the nonexistence of smooth state feedback. For example, the monolithic satellites of a satellite formation-flying system are equipped with attitude actuators, such as RWs, to control ωj via smooth state feedback. It should be noted that the RW angular momentum hj is considered as an uncontrolled value and eventually absorbs the excess angular momentum hjdlimt→∞ωj=ωid(j=1,…,n)⇒limt→∞hj=hid(j=1,…,n)(23)because the conservation of angular momentum holds “in each satellite.” In other words, typical space systems that have three-nonholonomic constraints are smoothly stabilized for a three-dimensional equilibrium manifold Ne={(ωj,hj)|ωj=ωjd}(24)to guarantee the existence of smooth state feedback.Previous studies of EMFF did not consider the conservation of angular momenta in control design by all hj as uncontrolled values such as typical space systems [6–19] or treating the control objectives as relative attitudes of the satellite instead of absolute attitudes [20–23]. Unlike typical space systems, EMFF holds the conservation of angular momentum in “the entire system.” Therefore, if all hj are regarded as uncontrolled values, the total value of the RW angular momentum ∑i=0nhj is guaranteed to converge the excess angular momentum Ldlimt→∞ωj=ωid(j=1,…,n)⇒limt→∞∑i=0nhj=Ld(25)and each value of hj depends on input history of uncontrolled electromagnetic torque. This is the source of the nonuniform distribution problem in previous EMFF studies. In this case, the control objectives are a 3n-dimensional equilibrium manifold: Ne={(ωj,hj)(j=1,…,n)|ωj=ωjd}(26)Based on above discussion, considering the RW angular momentum hj as controlled states except for one RWs is essential to prevent the nonuniform distribution problem. For example, if m satellites (from a total of n) have RWs (1≤m≤n), h1∼h(m−1) are controlled, and only hm is not controlled. In this case, hm eventually absorbs the excess angular momentum hmd by controlling ωj(j=1,…,n) and hj(j=1,…,(m−1)) using smooth state feedback limt→∞ωj=ωid(j=1,…,n),limt→∞hj=hid(j=1,…,(m−1))⇒limt→∞hm=hmd(27)and the appropriate control objectives to prevent the nonuniform distribution problem are implied to be a three-dimensional equilibrium manifold: Ne={(ωj,hj)(j=1,…,n)|ωj=ωid(j=1,…,n),hj=hid(j=1,…,(m−1))}(28)This subsection showed that EMFF can guarantee the existence of smooth state feedback while avoiding the nonuniform distribution problem if EMFF uses at least one set of RWs (the proof is presented in Sec. IV). In contrast, most previous studies [6–19] assumed that all satellites use RWs in addition to electromagnetic coils. Then, the EMFF with more than one RWs in the system is called the “Redundant EMFF.”C. Extensibility of Alternating Current Method for Outputting Arbitrary Electromagnetic Force and TorqueBy using the polynomial representation of the AC method, this subsection demonstrates how the AC-based EMFF can generate an arbitrary electromagnetic force and torque for multiple satellites, unlike the DC-based EMFF. The dipole modulation of the AC method using sine and cosine wave currents is derived.To realize simultaneous control of the electromagnetic force and torque, an arbitrary electromagnetic force and torque calculated by the controller are generated. In this case, the “dipole solution,” i.e., the amplitude value of the AC, can be derived from a nonlinear nonconvex optimization problem using an arbitrary cost function J based on Eq. (29): {Minimize: JSubject to: fjc=f(avg)j(μ),τjc=τ(avg)j(μ)(29)Suppose that each satellite presumably generates the sine and cosine waves with angular frequencies ωf and no phase difference. In this case, μj(t), fEM(avg)j, and τEM(avg)j, which are obtained by the system to the jth dipole, are {μj(t)=μ(sin)jsin(ωft)+μ(cos)jcos(ωft)fEM(avg)j=12∑j=1n(f(μ(sin)k,μ(sin)j,rjk)+f(μ(cos)k,μ(cos)j,rjk))τEM(avg)j=12∑j=1n(τ(μ(sin)k,μ(sin)j,rjk)+τ(μ(cos)k,μ(cos)j,rjk))(30)The EMFF outputs can be simplified to a multivariate bilinear system of the polynomial equations. With μj={i}T[μij1,μij2,μij3]T as the variable, the DC-based EMFF outputs of fEMj={i}T[fiEMj1,fiEMj2,fiEMj3]T and τEMj={i}T[τiEMj1,τiEMj2,τiEMj3]T [see Eq. (13)] can be described [11]: fiEMjw∼τiEMjw(w=1,2,3)=∑k=13∑l=1(l≠j)n∑m=13iμjkCiμlm(31)where the constant C with different values depends on the state of the system, and the symbol ∼ indicates that these constants are represented by the same type of polynomial. After these notations, the AC-based EMFF outputs of fEM(avg)j and τEM(avg)j of Eq. (30) can also be simplified as fiEM(avg)jw∼τiEM(avg)jw(w=1,2,3)=∑k=13∑l=1(l≠j)n∑m=13(μi(sin)jkCiμ(sin)lm+μi(cos)jkCiμ(cos)lm)(32)The relationship between the number of dipole moment variables and the degree of freedom of the control values is useful to investigate the existence of dipole moments in AC-based EMFF for simultaneous control. As shown in Eqs. (31) and (32), the DC-based and AC-based EMFF outputs have 3n and 6n variables, respectively. By contrast, these EMFF outputs have 6n−6  deg rees of freedom according to EMFF constraints in Eq. (20). Therefore, the dipole inversion of DC-based EMFF in Eq. (14) has “dipole solution” to generate arbitrary electromagnetic forces for n satellites. In this case, simultaneous control can only be realized for a maximum of two satellites. As a result, most previous studies [6–19], which included AC-based EMFF, used only fEM for relative position control and considered the generated τEM as a disturbance torque. Contrarily, simultaneous control in AC-based EMFF can be realized even for formations comprising n satellites because there are more variables than equations. Therefore, AC-based control demonstrates greater versatility than the DC method.Moreover, the arbitrary evaluation function J can be optimized while realizing simultaneous control. In general, the number of solutions of k polynomial equations containing k variables is equal to the degree d of the entire polynomial as follows: d=∏l=1kdl(33)where dl is the maximum degree of the lth polynomial equation. As shown in Eq. (32), the maximum degree dl of each polynomial equation of EMFF is 2. Therefore, Eq. (29) has infinite solutions or 2(6n−6) solutions with 6 “free dipoles” that can be determined arbitrarily. Nevertheless, it should be noted that these solutions contain “solutions at infinity” [28], which cannot be used for real applications. Using this property, the following nonlinear nonconvex optimization problem with evaluation function to optimize power consumption while achieving simultaneous control is used: {Minimize: J=μi(sin)Tμi(sin)+μi(cos)Tμi(cos)Subject  to: fijc=fi(avg)j,τijc=τi(avg)j(34)D. Electromagnetic Formation Flight Kinematics Based on Nonholonomic ConstraintsIn this subsection, the kinematics of EMFF is derived using the nonholonomic constraint of the EMFF system to develop the control design (see Sec. IV). The term kinematics refers to the tangent space of manifold satisfying the conservation of angular momentum. In addition, a new EMFF state is defined for “Redundant EMFF.” Note that, in this study, the linear momentum constraint is not implemented by eliminating r1 from the position vector r as follows: ri=[ri2T,…,rinT]T∈R3n−3(35)The kinematics of EMFF are derived using the conservation of angular momentum. Assuming that m satellites (from a total of n) are equipped with RWs (1≤m≤n), the angular momentum L is expressed as ∑j=1n(mj(rj−r1)×dIdtrj+Ij⋅ωj)+∑j=1mhj=L(36)Then, the components of L in the invariant orientation frame (I) can be expressed as ∑j=1n(mj(r˜ji−r˜1i)r˙ji+CI/BjJjbjωj)+∑j=1m(CI/Bj(hjbj−1mLbj))=0(37)Let ξb=[ξb11T,⋯,ξbmmT]T∈R3m be defined as new variables related to hj and L, as expressed in Eq. (38). ξb=[(hb11−1mLb1)T,⋯,(hbmm−1mLbm)T]T(38)As mentioned in Sec. III.B, the RW angular momentum is considered to be a controlled state in this study to overcome the nonuniform distribution problem. Therefore, the new EMFF states ζ are defined in Eq. (39): ζ=[r˙Ti,ωTb,ξTb]T∈R6n+3m−3(39)However, not all states can be controlled from the viewpoint of a nonholonomic system. As explained in Sec. III.B, EMFF requires uncontrolled RWs with the same degree of freedom as the angular momentum of the system. Let ξm define the uncontrolled states. In this case, the controlled states v of the EMFF state ζ are defined as v=[r˙iT,ωbT,ξb11T,⋯,ξbm−1m−1T]T∈R6n+3m−6(40)Now, the kinematics of EMFF satisfying the constraints of the system can be derived using the relationship between ζ and v. By using the new EMFF states ζ, the angular momentum of the system [see Eq. (37)] is expressed as {Aζ=0A=[m2ir˜21,⋯,mnir˜n1,CI/B1J1,⋯,CI/BnJn,CI/B1,⋯,CI/Bm]∈R3×(6n+3m−3)(41)Let S∈R(6n+3m−3)×(6n+3m−6) be defined as a smooth and linearly independent vector field full rank matrix corresponding to the null space of matrix A, i.e., {S=[E(6n+3m−6)−CBm/IAs]∈Null Space(A)As=[m2ir˜21,⋯,mnir˜n1,CI/B1J1,⋯,CI/BnJn,CI/B1,⋯,CI/Bm−1]∈R3×(6n+3m−6)(42)where S denotes tangent space of the manifold in which the angular momentum of the system does not change. In these definitions, the relationship between ζ and v, ζ=Sv∈R6n+3m−3(43)is established. Using this relationship and the matrix [Z]∈R3n×3n of MRP’s kinematic differential equation [see Eq. (3)], the kinematics of the EMFF system are given by {q˙s=[Z^s](σ)0(6n+3m−6)×3]ζ=[^Zs](σ)v[Z^s](σ)=[E3n−3000[Z](σ)0000(3m−3)×(3m−3)](44)where qs=[riT,σT,03m−3T]T∈R6n+3m−6 is the subvector of the generalized coordinates q.In summary, the newly defined states q˙s∈R6n+3m−6,ζ∈R6n+3m−3, and ξbmm∈R3 for the “Redundant EMFF,” and their kinematics are listed in Table 1 using the controlled states v=[r˙iT,ωbT,ξb11T,⋯,ξbm−1m−1T]T∈R6n+3m−6.E. Averaged Dynamics of Redundant Electromagnetic Formation FlightThis subsection describes the dynamics of “Redundant EMFF” that averaged by dipole modulation of Sec. II.D for AC-based controller design in Sec. IV. Note that the stability of the averaged system into an equilibrium point indicates the stability of the original system not averaged by dipole modulation into the corresponding periodic orbit [29]. For these errors, the AC frequency is set appropriately to achieve the control performance determined in the operational plan [16,17].The equation of motion describing the averaged EMFF system is [M]ζ˙+[C]ζ=[B]uc+ud−ATη(45)by combining the relative translational dynamics in Eq. (1) with the attitude dynamics of an RW-equipped rigid spacecraft in Eq. (5). In Eq. (45), uc=[ficT,τbcT,h˙bT]T∈R6n+3m−3 is the control input, ud=[figT,τbgT,−1mL˙b]T∈R6n+3m−3 is an external force input, and −ATη is the constraint term with η∈R3 that represents the vector of constraint forces. L˙b is the time-differentiated angular momentum vector of the system in the body-fixed frame of each satellite: L˙b=[L˙Tb1,⋯,L˙Tbm]T∈R3m=[CB1/I(L˙i−ω˜i1iL)T,⋯,CBm/I(L˙i−ω˜imiL)T]T(46)where L˙i is the component of time-differentiated L in the frame (I) as follows: L˙i=R(uc+ud)∈R3,R=[r˜i21,⋯,r˜in1,CI/B1,⋯,CI/Bn,03×3m]∈R3×(6n+3m−3)(47)The (6n+3m−3)×(6n+3m−3) matrices [M], [C], and [B] are expressed as [M]=[[Mp]0[Ma]0E3m],[C]=[03n−30[Ca]003m],[B]=[E3n−30E3n−E3n×3m0E3m]∈R(6n+3m−3)×(6n+3m−3)(48)where [M] and [B] has full rank. As mentioned in Sec. III.D, the position of the first satellite r1 is removed from the generalized coordinates. Therefore, the mass matrices [Mp]∈R(3n−3)×(3n−3) of all satellites except the first satellite can be expressed as [Mp]=[m2E30⋱0mnE3]∈R(3n−3)×(3n−3)(49)Using Eq. (5), the matrices [Ma]∈R3n×3n and [Ca]∈R3n×3n are defined with respect to the attitude motion of the entire system. [Ma]=[J10⋱0Jn],[Ca]=[−(J1b1ω1+b1h1)∼0⋱0−(Jnbnωn+bnhn)∼]∈R3n×3n(50)Substituting ζ=Sv and ζ˙=S˙v+Sv˙ into Eq. (45) and multiplying by the matrix ST from right yields M¯(qs)v˙+C¯(qs,v)v=B¯(qs)uc+u¯d(51)where M¯(qs)=ST[M]S∈R(6n+3m−6)×(6n+3m−6) is a symmetric and positive definite matrix, C¯(qs,v)=ST([M]S˙+[C]S)∈R(6n+3m−6)×(6n+3m−6), B¯(qs)=ST[B]∈R(6n+3m−6)×(6n+3m−3), and u¯d=STud∈R6n+3m−6. It should be noted that M¯−2C¯ is skew symmetric.IV. Kinematics Controller Design for Simultaneous ControlTo overcome the nonuniform distribution of the RW angular momentum, a new control law enabling the simultaneous control of the electromagnetic force and torque is introduced. First, the properties of the proposed control law and the definition of the target states are summarized. Then, the EMFF kinematics described in Sec. III.D derive a smooth feedback control law that satisfies the conservation of angular momentum. The Lyapunov stability theory [34] is used to show that the state of the averaged system asymptotically stabilizes at the control target. Subsequently, this section demonstrates that EMFF requires only one set of RWs as an additional attitude actuator to control EMFF for n satellites.Figure 2 shows the conventional system diagram of Fig. 2a [6–19] and the proposed system diagram of Fig. 2b.Fig. 2 Electromagnetic formation flight system diagram.The derived EMFF kinematics include a matrix S that corresponds to the tangent space of the manifold in which the angular momentum of the system remains constant. As shown in Fig. 2b, the control law corresponding to a block of “EM’s Position & Attitude Controller, RW’s Attitude Controller” uses the target error of the RW angular momentum of each satellite. Then, the command values of the electromagnetic force fc and torque τc that the EMFF system can output as well as the RW torques h˙b; are calculated. Theorem 1 describes the characteristics of control laws that allow EMFF to achieve simultaneous control.Theorem 1:The control law uc=[ficT,τbcT,h˙bT]T that is multiplied by ([B]−1[M]S) from the left and contains an arbitrary vector X∈R6n+3m−6, such as uc=[B]−1[M]SX, will not change the angular momentum of the whole system, and can be output by the EMFF system.Proof of Theorem 1:See Appendix A.For simplicity of the following control system design, let δqs and δζ be the error variables of qs and EMFF states ζ from the target value, as follows: {δqs=[ri−irdδσ03m−3],δζ=[δir˙δbωδbξ]=[δvδbmξm](52)When the system has angular momentum other than RW angular momentum in the target state, such as nadir-pointed formations, the target angular momentum Ld is ∑j=1n(mj(rjd−r1d)×dIdtrjd+Ijd⋅ωjd)=Ld(53)where rjd, ωjd, and Ijd are the target relative position vectors, angular velocity vectors, and inertial dyadic of the jth satellite, respectively. Based on the definition of L provided by Eq. (36), the total of target RW angular momentum hjd and that of ξjd are ∑j=1mhjd=L−Ld,∑j=1mξjd=−Ld(54)Now, to avoid the nonuniform distribution of RW angular momentum, the target values of hj and ξj [see Eq. (38)] are set as hbjjd=1m(Lbj−Lbjd),ξljdbj=−1mLdbj(55)by making hjd equivalent. Note that hjd can be nonzero values when the satellite has spin stiffness to ensure robustness and can be periodic when the satellite performs Earth-pointed formations without unloading control. Finally, this subsection describes the derivation of a kinematics control law for “Redundant EMFF” that can stabilize the relative position, absolute attitude, and RW-loaded angular momentum of n satellites to a constant or time-varying state without the nonuniform distribution and accumulation of RW angular momentum. This control law controls the electromagnetic force and torque simultaneously and needs only one set of three-axis RWs for all satellites. Combining the results of Sec. III, Theorem 1, and the above target states results in Theorem 2, which summarizes the main results of this study.Theorem 2:Given n satellites with averaged EMFF kinematics and dynamics {δq˙s=[Z^s](δσ)δvM¯(qs)v˙+C¯(qs,v)v=B¯(qs)uc+u¯dξbmm=−CBm/IAs(qs)v(56)based on Eqs. (44), (51), and (52); thus, the following control law uc=[ficT,τbcT,h˙bT]T=B¯r−1(−K1δqs−K2δv−u¯d+M¯(qs)v˙d+C¯(qs,v)vd)(57)can be output by EMFF and is applied to the system of Eq. (56), where B¯r−1=[B]−1[M]S(ST[M]S)−1 is a smooth right inverse matrix of B¯, and K1 and K2 are positive definite gain matrices. Then, the state of the system converges to a three-dimensional equilibrium manifold M={(δqs,δv,bmδξm)|δqs=0,δv=0}(58)which is submanifold of manifold satisfying the conservation of angular momentum, asymptotically as t→∞. Subsequently, when at least one satellite in the system has RWs, e.g., (1≤m≤n), the system states qs and ζ converge to the target values qsd and ζd asymptotically as t→∞.Proof of Theorem 2:See Appendix B.V. Numerical Calculations with Proposed Kinematics ControlTo identify the advantages of the proposed control law, three numerical calculations on stabilization to time-invariant formations (see Fig. 3) are performed using the five-satellite system. Section V.A discusses the removability of the nonuniform distribution of the RW angular momentum for each satellite based on formation maintenance simulation. Section V.B presents the formation reconfiguration simulation, and the achievability of convergence to the target state when only some satellites are equipped with RWs is verified. Section V.C demonstrates the removability of the accumulation of angular momentum throughout the system by incorporating a simple unloading control in the chief satellite (e.g., the fifth satellite). These imitate the space interferometer project used by tethered satellite formation flying [2,3], and the trajectory of the satellites in Fig. 3 is useful for data collection. Tables 2 and 3 summarize the characteristics of each satellite in the formation and activated actuators on each simulation. Note that EMFF satellites are assumed to comprise HTS wires [6,15] to realize high current, and the nature of the hardware is irrelevant for the proposed control law.Fig. 3 Conceptual diagram of numerical calculation imitating situation of space interferometer project.The target system state described in this section is based on formation maintenance in an inertial frame, which means that the formation of satellites is stationary with respect to the invariant orientation frame (I). Therefore, the target relative positions rijd=[rijdx,rijdy,rijdz] are the constant values shown in Table 4. Moreover, the target attitude of the jth satellite σjd and the target angular momentum Ld in Eq. (53) are set to 0. In this case, the target RW angular momentum hbjjd and the target values ξbjdj of the states ξbj are expressed as hbjjd=1mbjL,ξbjdj=0(3,1)(59)following the definition provided in Eq. (55). These conditions establish {v˙d=0ωbd=0⇔{M¯(qs)v˙d=0C¯(qs,v)vd=0(60)Therefore, the control law uc and nonlinear programming of the EMFF used in this section are uc=B¯r−1(−K1δqs−K2δv−u¯d),K1=[150E3n−3000620E3n0000(3m−3)×(3m−3)],  K2=[130E3n−3000530E3n0000.01E3m−3],{Minimize: J=μi(sin)Tμi(sin)+μi(cos)Tμi(cos)Subject to:fijc=fi(avg)j,τijc=τi(avg)j(61)The formation controls are assumed at an altitude of 700 km above the Earth. Equations (1) and (5) are used to determine the relative translational dynamics and attitude dynamics of an RW-equipped rigid spacecraft, respectively. Moreover, the gravity gradient torques τg for each satellite are considered. In these conditions, the angular momentum of the system L is, ideally, a periodic value with a period of approximately 6000 s. Table 5 summarizes the disturbance torque τd in orbit and AC frequency ωf of electromagnetic coils. In Sec. V.A, τd due to the interaction between the EMFF control and Earth’s magnetic field μj×Be are not considered for simplicity. Considering the frequency of these dynamics, the AC frequency ωf is set to 8π rad/s in Sec. V.A and 16π rad/s in Secs. V.B and V.C.A. Formation Maintenance Using Five Satellites with Five Sets of RWsIn this numerical calculation, the nonuniform distribution of the RW angular momentum among satellites should be eliminated. The temporal variations of the RW angular momentum are shown for two cases: the conventional control scheme (see Fig. 2a) and the proposed kinematics control scheme (see Fig. 2b). It is assumed that the RWs of all satellites are activated, as shown in Table 2. The conventional control law, compared with the proposed control law of Eq. (61), and the nonlinear programming of the EMFF are expressed as fojc=−fojg+mj(dI2dt2roj+dO2dt2(orjd−orj)+λp1dOdt(rojd−roj)+λp2Uj),Uj=dOdt(rojd−roi)+λp1(rojd−roi),h˙bjj=τbjjEM−ωbj(Jjbjωj+hbj)−Jjbjω˙j+λa1σj+λa2bjωj,λp1=0.0125,λp2=0.0125,λa1=10,λa2=15,{Minimize: J=τbcTτbcSubject  to  fijc=fi(avg)j(62)The target electromagnetic force foc and the target RW control torque h˙b are derived using the terminal sliding mode controller [8] and Lyapunov’s direct method [34], respectively. The nonlinear programming of the conventional control law is often set to minimize the magnitude of the electromagnetic torque τc because the conventional control law cannot control τc. The AC frequency ωf is set to 4π rad/s, which is the same as that of the proposed control law.First, the results corresponding to the control of Li and hbi are shown in Fig. 4. The blue and red lines in Figs. 4b–4e show the RW angular momentum for the compared and proposed control laws, respectively. The total values of the RW angular momentum have almost same periodic values, as shown in Fig. 4a. However, each RW angular momentum corresponding to the compared control law shows a nonuniform distribution after one completion of the orbit because the electromagnetic torques are not controlled. Conversely, for the proposed control law, the angular momentum of each RW shows uniform values; these values are obtained by dividing L evenly between all the satellites. These results indicate that the proposed kinematics control law theoretically eliminates the nonuniform distribution of the RW angular momentum among satellites.Fig. 4 Simulated results (Sec. V.A) with respect to angular momentum for the a) entire system Li, b) first satellite hb11, c) second satellite hb22, d) third satellite hb33, e) fourth satellite hb44, and f) fifth satellite hb55.Next, the formation maintenance results of the fifth satellite via the compared and proposed control law are shown in Fig. 5. Although this subsection only describes the results of the fifth satellite for brevity, it can be shown that the satellite system maintains the formation and attitude of each satellite. Figure 5 shows that the results of the absolute attitude for the proposed control method have larger errors compared with the results of the compared control method. This is because the attitude control of conventional control law is performed only by RW, where the attitude control law based on the proposed control has the oscillation term in Eq. (18) that reduces the control performance. The relative position control results include the effect of the oscillation term and therefore contain errors from the target value.Fig. 5 Simulated results of the fifth satellite (Sec. V.A) via the compared control and the proposed control law.Finally, the dipole moment for generating the desired electromagnetic force and torque is shown in Fig. 6. This figure compares the case without optimization (J=0) and the case with optimization for the objective function J of Eq. (61). Numerical calculations show that there is a “dipole solution” that minimizes the power consumption while outputting calculated electromagnetic force and torque. In the case without optimization, initialization of dipole solution is needed because it tends to be extremely large, even though the computation time is short. Therefore, initialization is conducted when the maximum values of the case with optimization are reached. In AC-based EMFF control, the states are disturbed by vibration components. As a result, the target control value also has an oscillatory component. This component causes the value of the dipole moment to move from one local minimum to another in the process of dipole inversion.Fig. 6 Simulated results (Sec. V.A) with respect to the dipole moment magnitude for the a) entire system ‖μ‖, b) first satellite ‖μ1‖, c) second satellite ‖μ2‖, d) third satellite ‖μ3‖, e) fourth satellite ‖μ4‖, and f) fifth satellite ‖μ5‖.B. Formation Reconfiguration Using Five Satellites with Three Sets of RWsThis subsection verify that the proposed kinematics control law can control more than three satellites without all the satellites being equipped with RWs. As shown in Table 2, only the RWs belonging to the first, second, and third satellites are activated. For this numerical calculation, the initial conditions of ro and σ are assigned at random.The results corresponding to the control of ro and σ are shown in Figs. 7 and 8, respectively, with black lines and lines of other colors showing the reference trajectory and the simulation results, respectively. These figures show that the relative position and absolute attitude of each satellite converge from the random initial values to the target values.Fig. 7 Simulated results (Sec. V.B) with respect to the relative position for the a) first satellite ro1, b) second satellite ro2, c) third satellite ro3, d) fourth satellite ro4, and e) fifth satellite ro5.Fig. 8 Simulated results (Sec. V.B) with respect to the absolute attitude for the a) first satellite σ1, b) second satellite σ2, c) third satellite σ3, d) fourth satellite σ4, and e) fifth satellite σ5.Figure 9 shows the formation reconfiguration simulation results for Li and hbj. Although Li exhibits a bias owing to the initial random values of ro and σ, hbj converges to values that divide the biased periodic Li into three equal parts related to the number of active RWs. Therefore, a nonuniform distribution of the RW angular momentum does not occur. It should be noted that the uncontrolled RW angular momentum of the third satellite tends to overshoot, which necessitates the introduction of a saturation prevention function. In addition, compared with formation maintenance, formation reconstruction results in more significant fluctuations in the control input values due to the randomness of the initial values. Therefore, a smaller gain and a more significant AC frequency ωf are needed to stabilize the dipole inversion process.Fig. 9 Simulated results (Sec. V.B) with respect to angular momentum without the unloading control for the a) entire system Li, b) first satellite hb11, c) second satellite hb22, and d) third satellite hb33.C. Formation Maintenance Using Five Satellites with Five Sets of RWs and Single Three-Axis Magnetic TorqueThe numerical calculation described in this section demonstrates that the proposed control law with three-axis magnetic torques (MTQs) mitigates the accumulation of angular momentum in the entire system. As shown in Table 2, the RWs of all satellites are activated and the chief satellite uses MTQs to interact with Earth’s magnetic field for the unloading control in a similar manner as monolithic satellites. From the general unloading control law for the chief satellite, the dipole moment of the chief satellite μ5 is expressed as μ5(t)=μ(DC)5+μ(sin)5sin(ωft)+μ(cos)5cos(ωft),μ(DC)5=kDCBe⋅Be(h5×Be),kDC=0.02(63)Here, the current to excite MTQs is equivalent to the DC component μ(DC)5 of the electromagnetic coil.First, the results corresponding to the MTQ-based unloading control described in Eq. (63) are presented. As the z-axis target values of the second and third satellites are switched, as shown in Table 4, the torques that make the z axis of the formation symmetric with respect to the Earth are always applied to the system. This leads to the accumulation of L and hj over time, as shown in Fig. 10.Fig. 10 Simulated results (Sec. V.C) with respect to angular momentum with the unloading control for the a) entire system Li, b) first satellite hb11, c) second satellite hb22, d) third satellite hb33, e) fourth satellite hb44, and f) fifth satellite hb55.In contrast, Fig. 11 shows that the combination of the proposed controller with a simple unloading control suppresses the increases in L and hj, and hj is uniform. It should be noted that MTQ-based unloading control can only mitigate the angular momentum of the system because the electromagnetic torque generated via the Earth’s magnetic field cannot be output in a specific direction. For the same reason, the unloading control is not considered in the model; RW angular momenta do not converge asymptotically to the target values. By using the actuators that can output force in any direction, such as thrusters, these accumulations can be theoretically eliminated.Fig. 11 Simulated results (Sec. V.C) with respect to angular momentum for the a) entire system Li, b) first satellite hb11, c) second satellite hb22, d) third satellite hb33, e) fourth satellite hb44, and f) fifth satellite hb55.As illustrated in Figs. 12 and 13, the satellite system maintains the shape and attitude of each satellite. Although the coupling between AC-based control and the Earth’s magnetic field is smaller than the control, the disturbance affects the control performance and is comparable to the results presented in Sec. V.A. Furthermore, the oscillation term in Eq. (18) of the AC EMFF control also contributes to the decrease in the control performance. Therefore, the AC frequency ωf must also be considered in the control system’s design to improve the control performance.Fig. 12 Simulated results (Sec. V.C) with respect to the relative position for the a) first satellite ro1, b) second satellite ro2, c) third satellite ro3, d) fourth satellite ro4, and e) fifth satellite ro5.Fig. 13 Simulated results (Sec. V.C) with respect to the absolute attitude for the a) first satellite σ1, b) second satellite σ2, c) third satellite σ3, d) fourth satellite σ4, and e) fifth satellite σ5.VI. ConclusionsThis study presented a new kinematics control law based on the EMFF system to increase the flexibility and functionality of future space missions. This control law theoretically realizes a completely uniform distribution of RW-loaded angular momentum among the satellites. Combined with a simple unloading control governed by the chief satellite, the proposed control law theoretically eliminates the accumulation of angular momentum for the entire system. Moreover, it enables the control of the relative position, absolute attitude, and RW-loaded angular momentum of n satellites while using only one set of three-axis RWs for all satellites. The extensibility of the AC method for outputting an arbitrary electromagnetic force and torque was shown via the polynomial representation of the AC method. The RW conditions required for smooth feedback stabilizability and the control target for avoiding the nonuniform distribution of RW angular momentum were summarized from the viewpoint of nonholonomic mechanical systems. Then, the kinematics of EMFF and averaged dynamics for “Redundant EMFF” were derived from a nonholonomic system constraint. A kinematics controller capable of controlling the electromagnetic force and torque was designed simultaneously using EMFF kinematics. Finally, three numerical calculations were performed for a system comprising five satellites, which demonstrates the validity of the proposed kinematics controller.Appendix A: Proof of Theorem 1Proof:The matrix R holds the relation of R[B]−1[M]S=AS=0(∵S∈Null Space(A))(A1)Based on Eqs. (47) and (64), L˙i caused by the proposed control law is always 0, as shown in Eq. (65). L˙i=R(uc+ud)=Rud(A2)Thus, Theorem 1 is proved.Appendix B: Proof of Theorem 2Proof:First, it is shown that the EMFF system can output the values of uc. However, it is necessary that B¯r−1=[B]−1[M]S(ST[M]S)−1 is always defined in any states. This can be confirmed by showing that ST[M]S has full rank. ST[M]S can be decomposed as ST[M]S=[M^]+AsTAs=[M^]+A^sTA^s(B1)where [M^] is a (6n+3m−6)×(6n+3m−6) positive definite matrix and A^s is the square matrix A^s as follows: [M^]=[[Mp]0[Ma]0E3m−3],A^s=[As0((6n+3m−9)×(6n+3m−6))](B2)In this case, AsTAs is a semipositive definite matrix, because AsTAs can be represented as A^sTA^s using the square matrix. Therefore, ST[M]S is a positive definite matrix and is always regular. Combining this fact with Theorem 1 shows that the EMFF system can output the values of the control law uc.Next, we consider the following Lyapunov function candidate V(δv,δqs): V(δqs,δv)=Vs1+Vs2=(12δvTM¯(qs)δv)+(12δirTK1δir+2Ka∑j=1nIn(1+δσjTδσj))(B3)where V(δv,δqs) is a scalar function with continuous first partial derivatives and V(δv,δqs)→∞ as: ‖δv‖,‖δqs‖→∞. Moreover, V≥0 and V=0 if and only if δv=0 and δqs=0. Note that the state qs contain all of the relative positions ri and absolute attitudes σ of the n satellites when m satellites (from a total of n) are equipped with RWs (1≤m≤n). Taking the derivative of Vs1, and using Eqs. (56) and (57), we obtain V˙s1(δqs,δv)=12δvTM¯δv+δvTM¯δv˙=−δqsTK1δq˙s−δvTK2δv(B4)Furthermore, the derivative of Vs2 [35] is V˙s2(δqs,δv)=δirTK1δir˙+δσTKabδω.(B5)From Eqs. (69) and (70), the time derivative of V(δqs,δv) is V˙(δqs,δv)=V˙s1(δqs,δv)+V˙s2(δqs,δv)=−δvTK2δv(B6)Clearly, V˙(δqs,δv)<0 as long as δv≠0, so that manifold R={(δqs,δv,δbmξm)|(M¯(qs)δv˙+C¯(qs,v)δv=−K1δqs−K2δv),δv=0}(B7)satisfying V(δqs,δv)=0 is a globally asymptotically stable equilibrium manifold by combining Eqs. (51) and (57). Then, the global invariant set theorem [34] concludes that all solutions globally asymptotically converge to a three-dimensional equilibrium manifold M={(δqs,δv,δbmξm)|δqs=0,δv=0}(B8)that is the largest invariant set in R. Subsequently, since EMFF holds the conservation of angular momentum in the entire system (see the kinematics of the EMFF system in Eq. (44)), the following equation is established. limt→∞bmξm=−CBm/IAs(qsd)vd⇔limt→∞bmξm=ξbmmd(B9)In conclusion, the states converge to the target values qsd and ζd asymptotically as t→∞. Thus, Theorem 2 is proved.\r            References\r        [1] Skinner G. K., Dennis B. R., Krizmanic J. F. and Kontar E. P., “Science Enabled by High Precision Inertial Formation Flying,” International Journal of Space Science and Engineering, Vol. 1, No. 4, 2013, pp. 331–348. https://doi.org/10.1504/IJSPACESE.2013.059271 CrossrefGoogle Scholar[2] Quadrelli B. M., “Modeling and Dynamics Analysis of Tethered Formations for Space Interferometry,” Proceedings of the 11th AAS/AIAA Space Flight Mechanics Meeting, Santa Barbara, CA, Feb. 2000, http://hdl.handle.net/2014/16379. Google Scholar[3] Lawson P. and Dooley J., “Technology Plan for the Terrestrial Planet Finder Interferometer,”  NASA Jet Propulsion Lab. TR  05-5, June 2005, http://hdl.handle.net/2014/37428. Google Scholar[4] Arya M., Lee N. and Pellegrino S., “Ultralight Structures for Space Solar Power Satellites,” 3rd AIAA Spacecraft Structures Conference, AIAA Paper  2016-1950, 2016. https://doi.org/10.2514/6.2016-1950 LinkGoogle Scholar[5] Quadrelli M. B., Hodges R., Vilnrotter V., Bandyopadhyay S., Tassi F. and Bevilacqua S., “Distributed Swarm Antenna Arrays for Deep Space Applications,” Proceedings of the IEEE Aerospace Conference, Big Sky, Montana, 2019, pp. 1–15. https://doi.org/10.1109/AERO.2019.8742019 Google Scholar[6] Kwon D. W., Sedwick R. J., Lee S. I. and Riberos J. R., “Electromagnetic Formation Flight Testbed Using Superconducting Coils,” Journal of Spacecraft and Rockets, Vol. 48, No. 1, 2011, pp. 124–134. https://doi.org/10.2514/1.45017 LinkGoogle Scholar[7] Sakaguchi A., “Micro-Electromagnetic Formation Flight of Satellite Systems,” Ph.D. Thesis,  Massachusetts Inst. of Technology, Cambridge, MA, 2007, https://dspace.mit.edu/handle/1721.1/39708. Google Scholar[8] Ahsun U., “Dynamics and Control of Electromagnetic Satellite Formations,” Ph.D. Thesis,  Massachusetts Inst. of Technology, Cambridge, MA, 2007, https://dspace.mit.edu/handle/1721.1/40894. Google Scholar[9] Elias L., Kwon D., Sedwick R. and Miller D., “Electromagnetic Formation Flight Dynamics Including Reaction Wheel Gyroscopic Stiffening Effects,” Journal of Guidance, Control, and Dynamics, Vol. 30, No. 2, 2007, pp. 499–511. https://doi.org/10.2514/1.18679 LinkGoogle Scholar[10] Fabacher E., Lizy-Destrez S., Alazard D., Ankersen F. and Profizi A., “Guidance of Magnetic Space Tug,” Advances in Space Research, Vol. 60, No. 1, 2017, pp. 14–27. https://doi.org/10.1016/j.asr.2017.03.042 CrossrefGoogle Scholar[11] Schweighart S. A., “Electromagnetic Formation Flight Dipole Solution Planning,” Ph.D. Thesis,  Massachusetts Inst. of Technology, Cambridge, MA, 2005, https://dspace.mit.edu/handle/1721.1/32464. Google Scholar[12] Fan L., Hu M. and Yang M., “Rotational and Relative Translational Control for Satellite Electromagnetic Formation Flying in Low Earth Orbit,” Aircraft Engineering and Aerospace Technology, Vol. 89, No. 6, 2017, pp. 815–825. https://doi.org/10.1108/AEAT-01-2016-0007 CrossrefGoogle Scholar[13] Ramirez-Riberos J. L., “New Decentralized Algorithms for Spacecraft Formation Control Based on a Cyclic Approach,” Ph.D. Thesis,  Massachusetts Inst. of Technology, Cambridge, MA, 2010, https://dspace.mit.edu/handle/1721.1/59666. Google Scholar[14] Huang X., Zhang C. and Ban X., “Dipole Solution and Angular-Momentum Minimization for Two-Satellite Electromagnetic Formation Flight,” Acta Astronautica, Vol. 119, Feb.–March 2016, pp. 79–86. https://doi.org/10.1016/j.actaastro.2015.11.009 CrossrefGoogle Scholar[15] Ayyad A., “Optimal Guidance and Control for Electromagnetic Formation Flying,” Master’s Thesis,  Univ. of Tokyo, Tokyo, 2019, http://hdl.handle.net/2261/00078563. Google Scholar[16] Kaneda R., Yazaki F., Sakai S., Hashimoto T. and Saito H., “The Relative Position Control in Formation Flying Satellites Using Super-Conducting Magnets,” Proceedings of the 2nd International Symposium on Formation Flying Missions and Technologies, Washington, D.C., Sept. 2004. Google Scholar[17] Sakai S., Kaneda R., Maeda K., Saitoh T., Saito H. and Hashimoto T., “Electromagnetic Formation Flight for LEO Satellites,” International Symposium on Formation Flying, Proceedings of the 3rd International Symposium on Formation Flying Missions and Technologies, Noordwijk, The Netherlands, April 2008. Google Scholar[18] Zhang C. and Huang X., “Angular-Momentum Management of Electromagnetic Formation Flight Using Alternating Magnetic Fields,” Journal of Guidance, Control, Dynamics, Vol. 39, No. 6, 2016, pp. 1292–1302. https://doi.org/10.2514/1.G001529 LinkGoogle Scholar[19] Porter A., Alinger D., Sedwick R., Merk J., Opperman R., Buck A., Eslinger G., Fisher P., Miller D. and Bou E., “Demonstration of Electromagnetic Formation Flight and Wireless Power Transfer,” Journal of Spacecraft and Rockets, Vol. 51, No. 6, 2014, pp. 1914–1923. https://doi.org/10.2514/1.A32940 LinkGoogle Scholar[20] Youngquist R. C., Nurge M. A. and Starr S. O., “Alternating Magnetic Field Forces for Satellite Formation Flying,” Acta Astronautica, Vol. 84, March–April 2013, pp. 197–205. https://doi.org/10.1016/j.actaastro.2012.11.012 CrossrefGoogle Scholar[21] Nurge M. A., Youngquist R. C. and Starr S. O., “A Satellite Formation Flying Approach Providing Both Positioning and Tracking,” Acta Astronautica, Vol. 122, May–June 2016, pp. 1–9. https://doi.org/10.1016/j.actaastro.2016.01.010 CrossrefGoogle Scholar[22] Sunny A., “Single-Degree-of-Freedom Experiments Demonstrating Electromagnetic Formation Flying for Small Satellite Swarms Using Piecewise Sinusoidal Controls,” M.S. Thesis,  Univ. of Kentucky, Lexington, 2019. https://doi.org/10.13023/etd.2019.466 Google Scholar[23] Abbasi Z., Sunny A., Hoagg J. and Seigler T. M., “Relative-Position Formation Control of Satellites Using Electromagnetic Actuation with Piecewise-Sinusoidal Controls,” Proceedings of the American Control Conference, Denver, CO, 2020, pp. 4951–4956. https://doi.org/10.23919/ACC45564.2020.9147724 Google Scholar[24] Morgan D., Chung S.-J., Blackmore L., Acikmese B., Bayard D. and Hadaegh F. Y., “Swarm-Keeping Strategies for Spacecraft Under J2 and Atmospheric Drag Perturbations,” Journal of Guidance, Control, and Dynamics, Vol. 35, No. 5, 2012, pp. 1492–1506. https://doi.org/10.2514/1.55705 LinkGoogle Scholar[25] Schaub H. and Junkins J., Analytical Mechanics of Space Systems, AIAA, Reston, VA, 2012, pp. 96, 109, 110, 147, 258, 484. https://doi.org/10.2514/4.867231 Google Scholar[26] Wen J. T.-Y. and Kreutz-Delgado K., “The Attitude Control Problem,” IEEE Transactions on Automatic Control, Vol. 36, No. 10, 1991, pp. 1148–1162. https://doi.org/10.1109/9.90228 CrossrefGoogle Scholar[27] Poedts S. and Goedbloed H., Principles of Magnetohydrodynamics: With Applications to Laboratory and Astrophysical Plasmas, Cambridge Univ. Press, Cambridge, England, U.K., 2004, Chap. 8-3. https://doi.org/10.1017/CBO9780511616945 Google Scholar[28] Morgan A., Solving Polynomial Systems Using Continuation for Engineering and Scientific Problems, Prentice-Hall, Englewood Cliffs, NJ, 1987, Chap. 3-3. https://doi.org/10.1137/1.9780898719031 Google Scholar[29] Sanders J. A., Verhulst F. and Murdock J. A., Averaging Methods in Nonlinear Dynamical Systems, Vol. 2, Springer, New York, 2007, Chap. 2. https://doi.org/10.1007/978-0-387-48918-6 Google Scholar[30] Nakamura Y. and Mukherjee R., “Nonholonomic Path Planning of Space Robots via a Bidirectional Approach,” IEEE Transactions on Robotics and Automation, Vol. 7, No. 4, 1991, pp. 500–514. https://doi.org/10.1109/70.86080 CrossrefGoogle Scholar[31] Bloch A. and McClamroch N. H., “Control of Mechanical Systems with Classical Nonholonomic Constraints,” Proceedings of the 28th Conference on Decision and Control, Tampa, FL, 1989, pp. 201–205. https://doi.org/10.1109/CDC.1989.70103 Google Scholar[32] Fierro R. and Lewis F. L., “Control of a Nonholomic Mobile Robot: Backstepping Kinematics into Dynamics,” Journal of Robotic Systems, Vol. 14, No. 3, 1997, pp. 149–163. https://doi.org/10.1109/CDC.1995.479190 CrossrefGoogle Scholar[33] Brockett R. W., “Asymptotic Stability and Feedback Stabilization,” Differential Geometric Control Theory, Birkhauser Boston Inc., Cambridge, MA, 1983, pp. 181–191. Google Scholar[34] Slotine J.-J. E. and Li W., Applied Nonlinear Control, Prentice-Hall, Hoboken, NJ, 1991, Chaps. 3, 4-5-2. Google Scholar[35] Tsiotras P., “Stabilization and Optimality Results for the Attitude Control Problem,” Journal of Guidance, Control, and Dynamics, Vol. 19, No. 4, 1996, pp. 772–779. https://doi.org/10.2514/3.21698 LinkGoogle Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Stochastic Primer Vector for Robust Low-Thrust Trajectory Design Under Uncertainty",
        "url": "https://arc.aiaa.org/doi/10.2514/1.G005970",
        "date": "20210924",
        "content": "AbstractAny space trajectories are subject to state uncertainty due to imperfect state knowledge, random disturbances, and partially known dynamical environments. Ideally, such uncertainty and associated risks must be properly quantified and taken into account in the process of trajectory design, ensuring a sufficiently low risk of causing hazardous events. To bridge the gap between the ideal goal and current practice in mission design, this paper extends Lawden’s primer vector theory and develops a solution method to solve the problem of low-thrust trajectory optimization under state uncertainty. The new primer vector, termed stochastic primer vector, provides an analytical open-loop optimal control law that respects a probabilistic path constraint with a user-specified confidence level (chance constraint). A numerical aspect of the indirect method is also extended by introducing a smoothing approach across constraint corner discontinuities, enabling efficient solution methods for constrained optimal control problems. The validity and effectiveness of the theoretical development are demonstrated with two numerical examples, which clarify the behavior of chance-constrained optimal low-thrust trajectories and confirm through Monte Carlo simulations that the designed trajectories indeed satisfy the imposed constraints under uncertainty with the prescribed confidence level.I. IntroductionDesigning optimal low-thrust trajectories has been a central problem of space mission design since 1950s. Over the past several decades, many researchers have devoted their efforts to developing methods to solve the low-thrust trajectory optimization problem in a more efficient, reliable manner. These extensive efforts have led to remarkable advancement in analytical and computational techniques for trajectory optimization, including those based on Lawden’s primer vector theory (indirect methods) [1–4], on differential dynamic programming (DDP) [5–7], and on direct transcription via multiple shooting or collocation (direct methods) [8,9] solved by nonlinear programming (NLP).Meanwhile, any space trajectories are subject to state uncertainty due to various possible causes, such as imperfect state knowledge, random disturbances, and partially known dynamical environments. Guaranteeing performance (e.g., safety and cost) under uncertainty is a major concern in any space mission design. Such performance guarantees are particularly important for missions that need to operate in uncertain environments, that are sensitive to uncertain errors, or that require autonomous on-board decision making for an extended duration due to long communication delays. For example, considering an orbit transfer in the vicinity of an asteroid, the mission designer would need to find an optimal transfer trajectory that has a sufficiently low risk of causing hazardous events such as collision with the asteroid. Ideally, such risks under uncertainty must be properly evaluated and taken into account of the process of trajectory design. However, the current practice in mission design usually mitigates such risks in a rather heuristic manner, such as by adding extra deterministic margins to the original constraints (e.g., propellant mass and planetary flyby impact radius) and by enforcing coasting arcs in the reference trajectory design process [10–12].Therefore, this work develops a new theory that serves as a building block to bridge the gap between the ideal goal and the current practice in mission design. In particular, this paper extends Lawden’s primer vector theory for constrained optimal orbit transfers under state uncertainty by combining techniques from the fields of astrodynamics, optimal control theory, and stochastic systems. The new primer vector, termed stochastic primer vector, provides an open-loop optimal control law that respects a probabilistic path constraint with a user-specified confidence level.There are an increasing number of approaches being proposed to address the problem of low-thrust trajectory optimization under uncertainty [13–19]. These approaches may be grouped into the traditional categories: indirect methods [13,14], DDP-based methods [15,16], and direct methods [17–19]. Note that there exist another group of studies [20–23] to increase the robustness of trajectories against unfavorable stochastic events (e.g., engine failures). While this latter problem also stands equally crucial in space mission design, as discussed earlier, this paper focuses on the problem of trajectory optimization under state uncertainty.Although these studies demonstrate successful applications of various approaches to low-thrust trajectory optimization under state uncertainty, they have their own advantages and disadvantages. Even though indirect approaches mentioned above successfully compute trajectories that minimize the state knowledge error [13] and the terminal state error [14], their developments do not consider imposing path constraints over the trajectories. Likewise, DDP-based approaches developed in Refs. [15,16] do not impose path constraints on the stochastic state, although demonstrating the potential of DDP-based approaches for solving this type of problems. Direct approaches proposed in Refs. [17,18] apply intrusive polynomial algebra [24] to perform the nonlinear uncertainty propagation task and use the direct Mote Carlo method to evaluate the objective and constraints, providing a greater flexibility in the uncertainty modeling, at the expense of increased computational complexity. Reference [19] takes advantage of the recent advancement in the areas of linear covariance control and successive convex optimization, and demonstrates the approach in a planar orbit transfer problem, exhibiting an initial yet promising result for further research. Although these recent efforts illustrate the gaining momentum of this area of research, they also highlight a lack of analytical understanding about how low-thrust trajectories under state uncertainty should behave in the presence of path constraints.This paper proposes another approach based on the indirect method by incorporating uncertainty and probabilistic path constraints into the primer vector framework. One of the main motivations behind this approach is to clarify the behavior of optimal trajectories under uncertainty and path constraints from the perspective of the classical principles of calculus of variations. This approach also brings a practical benefit that the resulting solution method enjoys the fewer dimensionality of the indirect formulation, particularly in contrast to direct approaches that optimize a large number of time-discretized variables, whose dimension rapidly increases when dealing with uncertainty. For instance, even if we express the distribution of a state vector x(tk)∈R6 via its first two moments only (i.e., mean and covariance), the dimension of the state variables at tk will be 42 because the mean and covariance of x(tk) are in R6 and R6×6, respectively.This paper develops the theory of stochastic primer vector as follows. First, a generic form of equations of motion is introduced in Sec. II to describe low-thrust orbital dynamics. Based on this dynamical system, we derive an extension of the classical primer vector to incorporate a deterministic state inequality path constraint by applying calculus of variations [25] (Sec. III). We call this extended primer vector constrained primer vector. This is a necessary intermediate step to further extend the primer vector for stochastic problems. Next, we formulate the original problem into a class of stochastic optimal control problems and convert it into a deterministic form (Sec. IV). We then derive the stochastic primer vector by applying the constrained primer vector solution to the stochastic problem (in its converted deterministic form). The process of converting the stochastic problem introduces a semi-analytical uncertainty quantification (UQ) approach, which takes advantage of the proven performance of unscented transform (UT) and the dynamical properties of orbital mechanics by expressing the dynamics in an orbital element coordinate system. The semi-analytical approach greatly simplifies the nonlinear UQ process, contributing to the simpler implementation and tractability of the solution method. Note that this paper focuses on deriving primer vector solutions for time-optimal transfers (minimum time of flight) for brevity, and the derivations with other cost functions (e.g., energy and fuel) are left for future work.This paper also extends a numerical aspect of the indirect method in order to efficiently solve the optimization problems resulted from the application of stochastic primer vector theory. Traditionally, the indirect method is mostly used for solving unconstrained optimal control problems due to its limitations in dealing with state inequality constraints. When a trajectory enters onto a (state inequality) constrained arc, a discontinuity may occur in the costate and control Hamiltonian, called corners [26–28]. The existence of such corner discontinuities leads to a smaller radius of convergence and the inflexibility in formulating solution methods. (This aspect is discussed in more detail in Sec. V.A.) To address these traditional limitations, Sec. V.B presents a smoothing approach enabled by introducing activation functions with sharpness parameters. We also show that the approach does not compromise the feasibility of constraints (while sacrificing the optimality) and converges to the optimal trajectory as the sharpness parameters decrease.The developed theory and solution method are demonstrated with two illustrative numerical examples in Sec. VI. The two examples include a transfer between two terminator orbits (TOs) under the two-body dynamics and a transfer from a TO to a non-Keplerian orbit called resonant TO under perturbed two-body dynamics, both in a dynamical environment around an asteroid. Nonlinear Monte Carlo (MC) simulations confirm that the designed trajectories indeed satisfy the imposed constraints under uncertainty with a prescribed (=99.9%) confidence level.II. DynamicsA. Low-Thrust Engine ModelWe assume a constant specific impulse (CSI) engine as our low-thrust propulsion system, and express its acceleration term as a=ΓaTa^. Γ∈[0,1] represents the engine throttle, aT the magnitude of the thrust acceleration, and a^∈R3 a unit vector aligned with the acceleration, i.e., ‖a^‖2=1, where ‖⋅‖2 denotes the 2-norm of a vector. Denote the maximum thrust level of our low-thrust engine by Tmax, the spacecraft mass by m, and the mass-flow rate at the maximum throttle by −m˙max. As we consider a CSI engine, m˙max is constant and computed as m˙max=Tmax/(g0Isp), where g0(≈9.81×10−3  km/s2) is the standard gravitational acceleration; Isp is the specific impulse of our low-thrust engine. Thus, the thrust acceleration magnitude aT and the mass-flow rate m˙ are calculated as aT(m)=Tmaxm,m˙(Γ)=−Γm˙max(1)B. Generic System EquationsLet x∈Rnx and u≜[a^⊤,Γ]⊤∈R4 be the orbital state and control of our system, respectively. Our system equations are expressed in a generic form as follows: x˙=f(x,m,u,t)=f0(x,t)+ΓaT(m)F(x)a^(2)where f0(⋅):Rnx×R↦Rnx represents natural dynamics; F(⋅)∈Rnx×3 maps the acceleration to the rate of the orbital state change. Natural dynamics are expressed as f0(x,t)=fkep(x)+F(x)apert(x,t), where fkep(⋅) represents the Keplerian dynamics and apert(⋅) the perturbing acceleration. Equation (2) encompasses equations of motion describing low-thrust orbital dynamics in various coordinate systems. For instance, in an orbital element coordinate system, fkep(⋅) and F(⋅) represent the fast variable evolution and Gauss variational equations, respectively [e.g., Eq. (5)], whereas fkep(⋅)=[v⊤,−(μbody/‖r‖23)r⊤]⊤ and F=[03×3,I3]⊤ in the Cartesian coordinate system.C. Stochastic System EquationsTo model astrodynamics systems under uncertainty, this paper considers the sources of uncertainty in the initial orbit and unmodeled disturbing acceleration. We assume that the initial mass does not have uncertainty, that the initial orbital state is Gaussian-distributed as x0∼N(x¯0,P0), and that the disturbing acceleration is modeled as a continuous-time white noise. We express such stochastic systems by using the following nonlinear stochastic differential equation (SDE): dx=f(x,m,u,t)dt+Gx(x,m,t)dw(t)(3)where f(⋅) is defined in Eq. (2); dw(t)∈Rnw is a standard Brownian motion, i.e., E[dw(t)dw⊤(t)]=Inwdt; and Gx(⋅)∈Rnx×nw maps dw(t) to a state disturbance.D. System Equations in Modified Equinoctial CoordinatesThis paper chooses the modified equinoctial orbital elements (MEEs) [29] to represent the orbital state x, defined as x=[pfghkL]⊤,{p=a(1−e2),h=tani2cosΩ,f=ecos(ω+Ω),k=tani2sinΩ,g=esin(ω+Ω),L=ν+ω+Ω(4)where L is the true longitude and {a,e,i,Ω,ω,ν} is a set of classical orbital elements, ν being the true anomaly. This coordinate system is chosen for the following two reasons: 1) like other sets of orbital elements, five out of the six elements of MEEs are constant under the Keplerian dynamics, whereas the sixth element monotonically increases in time in a quasi-linear fashion; 2) unlike the classical set of orbital elements, MEEs do not have singularities except at 180 deg inclination and can describe circular, elliptic, and hyperbolic orbits.In the MEE coordinates, fkep(⋅) and F(⋅) are expressed as follows: fkep(x)=[00000pμbody(qp)2],F(x)=pμbody[02pq0sinL(q+1)cosL+fq−g(hsinL−kcosL)q−cosL(q+1)sinL+gqf(hsinL−kcosL)q00s22qcosL00s22qsinL00hsinL−kcosLq](5)where μbody is the gravitational parameter of the primary body, q=1+fcosL+gsinL, and s2=1+h2+k2.III. Primer Vector with State Inequality ConstraintsIn this section, we extend the classical primer vector to incorporate state inequality constraints in a deterministic setting. Hence, x is deterministic throughout in this section, and the results derived in this section form an important basis to develop stochastic primer vector in Sec. IV.A. Deterministic Optimal Transfer Problem with Path ConstraintConsider a deterministic optimal orbit transfer with an inequality state path constraint. The transfer departs the initial orbital state x0 and arrives at the final state xf while satisfying the terminal state constraints at the initial and final time, ψ0(x0,t0)=0 and ψf(xf,tf)=0. This paper assumes that the path constraint is expressed as a scalar function in terms of the time and orbital state, i.e., ψc(x,t)≤0∈R. It would be straightforward to extend the result in this paper to consider vector constraints; in such an extended case, ψc(⋅) must satisfy the constraint qualification [e.g., Ref. [26], Eq. (2.11)]. We also assume that ψc is twice differentiable with respect to x and t, which are necessary to compute the costate dynamics, as will be apparent in Eq. (16). Thus, the optimal transfer problems with a state inequality constraint is formulated as minx,m,u,t0,tfJ=∫t0tfL dts.t.x˙=f(x,m,u,t),m˙=−Γm˙max,ψc(x,t)≤0,ψ0(x0,t0)=0,ψf(xf,tf)=0(6)where m0 is fixed while other terminal state variables (mf, x0, xf) are allowed to vary. L denotes the Lagrangian cost of the problem, and can take the form L=Γ for fuel-optimal transfers while L=1 for time-optimal transfers. As stated in Sec. I, this paper focuses on deriving new primer vector solutions for time-optimal transfers (i.e., L=1), but L is kept in the derivation as long as possible in order to ease future extensions of this work.As discussed in a number of literature on optimal control theory (e.g., Refs. [25–28,30,31]), solving nonlinear optimal control problems with state inequality constraints is not trivial. A variety of approaches are proposed to deal with state inequality constraints in optimal control (e.g., indirect adjoining approach [27,32–34], direct adjoining approach [35,36], and inequality transformation with introduction of slack variables [37]; see Ref. [26] for a comprehensive review). The present paper takes the indirect adjoining approach.B. Optimality Necessary ConditionBased on the indirect adjoining approach, this subsection derives necessary conditions of optimality for orbit transfer problems with state inequality constraints. This approach first establishes the explicit dependency of the constraints on u by differentiating ψc(⋅) with respect t, and then adjoints the control-dependent constraint to the cost functional.The explicit dependency of constraints on u is first established. In orbit transfer problems, differentiating ψc(⋅) once suffices to establish the dependency, yielding ψ˙c(⋅)=∂ψc∂t+∂ψc∂xx˙=∂ψc∂t+∂ψc∂xf(x,m,u,t)(7)On the constraint surface defined by ψc(⋅)=0, u must be chosen to satisfy ψ˙c(⋅)=0, in order to respect the inequality constraint ψc(⋅)≤0. Thus, the following equalities must hold on the constraint surface: ψc(x,t)=0,ψ˙c(x,m,u,t)=0(8)The constrained problem is converted to an unconstrained one by adjoining the dynamical constraints, terminal constraints, and control-dependent path constraint [ψ˙c(⋅)=0], with the introduction of Lagrange multipliers. Denote the Lagrange multipliers associated with these constraints by λ(≜[λx⊤,λm]⊤)∈Rnx+1, ν0∈Rnx, νf∈Rnx, and μc∈R, respectively. The Lagrange multipliers associated with the dynamics, λ, are also called costate. Note that μc must satisfy μc≥0 if ψc=0, whereas μc=0 if ψc<0, where the positivity of μc when ψc=0 is to penalize the violation of Eq. (8). Thus, Eq. (6) is converted to an unconstrained one as minx,m,u,t0,tfJtc(⋅)+∫t0tfLA dt(9)where Jtc and LA represent the terminal cost and augmented Lagrangian, defined as Jtc≜ν0⊤ψ0+νf⊤ψf,LA≜L+λx⊤(f−x˙)−λm(Γm˙max+m˙)+μcψ˙c(10)The trajectory arcs with ψc=0 are called constrained arcs, whereas those with ψc<0 as unconstrained arcs following the convention in Ref. [25].‡ The Hamiltonian associated with this problem is defined as Hc(x,m,u,λx,μc,t)=L+λx⊤f(x,m,u,t)−λmΓm˙max+μcψ˙c(x,m,u,t)(11)where the subscript c denotes the quantities associated with the constrained optimal transfer problems. The application of Pontryagin’s optimality principle leads to the following set of Euler–Lagrange equations (e.g., Refs. [25,26,30]): Optimal control:  {u*,μc*}∈{u,μc|μcψ˙c=0∧minHc},Costate dynamics:  λ˙x⊤=−∂Hc∂x,λ˙m=−∂Hc∂m,State dynamics:  x˙=f,m˙=−Γm˙max(12)The transversality conditions are derived based on a classical derivation procedure of the classical primer vector, yielding {ν0⊤∂ψ0∂x0+λx⊤(t0)=0 or δx0=0},{νf⊤∂ψf∂xf−λx⊤(tf)=0 or δxf=0},λm(tf)=0,{ψ0=0 or δν0=0},{ψf=0 or δνf=0},{ν0⊤∂ψ0∂t0−H*(⋅,t0)=0 or δt0=0},{νf⊤∂ψf∂tf+H*(⋅,tf)=0 or δtf=0}(13)Equation (12) leads to different forms of optimal control depending on whether the trajectory is on a constrained arc or on an unconstrained arc, which are separately discussed in Secs. III.B.1 and III.B.2, respectively. The entry points onto constrained arcs are defined by the following two conditions: ψc(x,t)=0∧ψ˙c(x,m,uo,t)>0(14)that is, the inequality constraint ψc is increasing and crossing the zero under unconstrained optimal control, uo (determined by the classical primer vector po). On the other hand, if ψc(x,t)=0 and ψ˙c(x,m,uo,t)≤0, then the trajectory is leaving the constrained arc (i.e., exit corner).1. Necessary Conditions on Constrained ArcsWhen the trajectory is on a constrained arc, μc≥0. The costate dynamics are calculated from Eqs. (11) and (12) as [λ˙xλ˙m]=[−(∂f0∂x+ΓaT∂(Fa^)∂x)⊤λx−μc(∂ψ˙c∂x)⊤ΓaTm(Fa^)⊤λx−μc∂ψ˙c∂m](15)where the partial derivatives of ψ˙c(⋅) are given by ∂ψ˙c∂x=∂2ψc∂t∂x+∂2ψc∂x∂xf+∂ψc∂x∂f∂x,∂ψ˙c∂m=∂ψc∂x∂f∂m(16)where the identities ∂2ψc/∂t∂m=0 and ∂2ψc/∂x∂m=0 are used [∵ψc(⋅) is not an explicit function of m].To derive the optimal control direction, let us first expand f(⋅) and ψ˙c(⋅) of the Hamiltonian Eq. (11), as follows: Hc=L+μc∂ψc∂t+(λx⊤+μc∂ψc∂x)f0+(λx⊤+μc∂ψc∂x)ΓaTFa^−λmΓm˙max(17)which clarifies that Hc is bilinear in Γ, μc, and a^. Then it is straightforward to verify that Hc is minimized when a^ is aligned with the vector −F⊤{λx+μc[∂ψc/∂x]⊤}, i.e., a^*=pc‖pc‖2,pc(x,λx,μc)=−F⊤(x){λx+μc[∂ψc∂x]⊤}(18)Due to Eq. (12), it is also necessary that the optimal control {u*,μc*} satisfies ψ˙c(⋅)=0. Recalling Eq. (7), the equation ψ˙c(⋅)=0 can be rewritten as ψ˙c(⋅)=αc+ΓaTβc⊤a^=0(19)where αc∈R and βc∈R3 are defined as αc≜∂ψc∂t+∂ψc∂xf0,βc≜[∂ψc∂xF]⊤(20)With βc, the constrained primer vector in Eq. (18) is expressed as pc(x,λx,μc)=−(F⊤λx+μcβc)(21)Noting the optimal acceleration direction of the form a^*=pc/‖pc‖2, Eq. (19) becomes ψ˙c(⋅)=αc+ΓaTβc⊤pc(x,λx,μc)‖pc(x,λx,μc)‖2=0(22)which must hold under the optimal throttle and constraint multiplier, Γ* and μc*, so that Eq. (19) holds. Necessary conditions for Eq. (22) to hold are discussed after deriving Γ*.The optimal throttle Γ* is determined to minimize Hc with a^* and μc* (assuming the existence of μc* for now). Since μc* can be nonlinear in Γ, Hc is not necessarily linear in Γ, and hence we examine the structure of Hc as a function of Γ, i.e., its partial derivatives with respect to Γ. Using the equations αc+ΓaTβc⊤a^*=0 and pc=−(F⊤λx+μc*βc) from Eqs. (19) and (21), ∂Hc/∂Γ|a^*,μc* are calculated as ∂Hc∂Γ|a^*,μc*=∂L∂Γ+∂μc*∂Γ(αc+ΓaTβc⊤a^*)+μc*aTβc⊤a^*+aTλx⊤Fa^*−λmm˙max=∂L∂Γ−aT‖pc‖2−λmm˙max(23)which takes −(aT‖pc‖2+λmm˙max) since L=1 (time-optimal transfers). Substituting Eq. (18) into Eq. (15) yields λ˙m=−Γ(aT/m)‖pc‖2≤0, which, combined with λm(tf)=0, implies that λm≥0 on optimal trajectories. As such, the sign of ∂Hc/∂Γ|a^*,μc* is always negative for time-optimal transfers, implying that Γ minimizes Hc at its upper bound of the domain, i.e., Γ*=1.Finally, necessary conditions for Eq. (22) to hold under the optimal control a^* and Γ* are derived, which are summarized in Lemma 1. As stated in Lemma 1, it is necessary that aT‖βc‖2>|αc| in order for {u*,μc*} to satisfy ψ˙c(⋅)=0. On the other hand, if aT‖βc‖2≤|αc|, the low-thrust engine does not have enough control authority to prevent the natural dynamics (represented by αc) from driving the system to violate the constraint. Therefore, this paper assumes that aT‖βc‖2>|αc| holds on optimal trajectories.Lemma 1:If aT‖βc‖2>|αc|, then there exists μc∈[0,+∞) that satisfies Eq. (22). Such μc, denoted by μc*, is expressed in a closed form as μc*=(βc⊤po)‖βc‖22+αc‖βc‖22(‖βc‖2‖po‖2)2−(βc⊤po)2(aT‖βc‖2)2−αc2(24)If aT‖βc‖2≤|αc|, then there exists no such μc∈[0,+∞) that satisfies Eq. (22).Proof:See Appendix A.1.   □2. Necessary Conditions on Unconstrained ArcsWhen the trajectory is on an unconstrained arc, by definition μc=0, which yields the same Hamiltonian as that of the classical primer vector. Thus, the time-optimal transfers on unconstrained arcs are determined by the classical primer vector solution, i.e., Γ*=1,a^*=po‖po‖2,po(x,λx)=−F⊤(x)λx(25)where po denotes the classical primer vector. The costate dynamics are equivalent to Eq. (15) with μc=0.3. Constraint Multiplier Additional Necessary ConditionsAlthough numerous papers and textbooks on optimal control, including Ref. [25], conclude that μc≥0 on constrained arcs is the necessary condition of optimality in terms of μc, there are in fact additional necessary conditions derived in some studies, such as Refs. [26,28]. Assuming a constrained arc on t∈[t1,t2], the additional conditions are μ˙c(t)≤0,∀  t∈[t1,t2],∧μc(t2−)=0(26)which imply μc(t)≥0,∀t∈[t1,t2], whereas its converse is not true. Indeed, we can show that our constrained primer vector solution [Eq. (24)] satisfies the first condition μc(t2−)=0 by substituting ψ˙c(x,m,uo,t)=0 into Eq. (A4), an equation that is equivalent to Eq. (24). Although the second condition is not explicitly imposed in this paper, the numerical examples in Sec. VI empirically confirm its satisfaction (at least for the particular transfer problems).These additional necessary conditions imply an important property of μc(t). Noting that μc(t1−)=0 (∵ the trajectory is on an unconstrained arc at t1−), the conditions in Eq. (26) imply that μc has to experience a discontinuous increase at t1, i.e., μc(t1−)≠μc(t1+). This can lead to a discontinuous change in u at t1, as u is a function of μc. The next subsection discusses how these discontinuous changes affect the costate and Hamiltonian.C. Jump Conditions at Constrained Arc Entry PointsThe control variables may have discontinuous changes at junction points of constrained and unconstrained arcs, called corners. Since u (and hence x˙) may be discontinuous at corners, the cost functional in Eq. (9) is rewritten as Jtc(⋅)+∫t0tfLA dt=Jtc+∫t0t1−LA dt+∫t1+t2−LA dt+⋯+∫tm+tfLA dt(27)where superscripts “−” and “+” indicate quantities right before and after a corner discontinuity, respectively. A number of papers derive a set of conditions, called jump conditions, which the costate and Hamiltonian have to obey at such corners (e.g., Refs. [26–28]). For a constrained arc on t∈[t1,t2], such jump conditions at t1 (entry) are expressed as λx(t1+)=λx(t1−)−μc(t1+)[∂ψc∂x]t1⊤,Hc(t1+)=Hc(t1−)+μc(t1+)∂ψc∂t|t1(28)while no such discontinuities need occur at the exit point, t=t2.§IV. Stochastic Primer VectorIn this section, we derive a further extension of the classical primer vector, termed stochastic primer vector. Throughout in this section, x is treated as a random vector and obeys the SDE in Eq. (3).This section extensively uses the Einstein summation convention for concise notation. With the Einstein notation, repeated indices indicate summation, e.g., aijbj=∑jaijbj. Superscripts i denote the ith component of a vector, ij the {i,j}th component of a matrix, and ijk the {i,j,k}th component of a three-rank tensor. Use of this notation helps to maintain the following derivation concise, especially when involving differentiation of (and with respect to) matrices.A. Stochastic Optimal Transfer Problem with Path ConstraintWe consider a stochastic version of the constrained optimal orbit transfer problem. Like the derivation of the constraint primer vector, the minimum-time problem is considered here, i.e., L=1. As a stochastic analog of deterministic path inequality constraints, we impose a probabilistic path constraint to guarantee the performance of dispersed trajectories under uncertainty with a user-defined confidence bound, i.e., chance constraints. We consider the following form of chance constraints: Pr[h(x,t)≤0]≥1−ε(29)where Pr[⋅] denotes the probability operator, h(⋅)∈R is a twice differentiable function expressing inequality constraints, and ε∈R represents the risk bound, typically taken as a small number. Clearly, the output of h(⋅) is stochastic due to the stochasticity of x. For terminal constraints, we consider the same form as the deterministic problems, while replacing the deterministic terminal states with the expected values of the stochastic states x0 and xf; that is, ψ0(E[x0],t0)=0 and ψf(E[xf],tf)=0, where E[⋅] denotes the expectation operator. Thus, the stochastic optimal orbit transfer problems with a state chance constraint are formulated as: minx,m,u,t0,tfJ=∫t0tfL dt(30a)s.t.  dx=f(x,m,u,t)dt+Gx(x,m,t)dw(t),m˙=−Γm˙max(30b)Pr[h(x,t)≤0]≥1−ε(30c)ψ0(E[x0],t0)=0,ψf(E[xf],tf)=0(30d)This optimal control problem involves the integration of SDEs and the evaluation of chance constraints, which we call collectively uncertainty quantification (UQ) processes. UQ processes are generally expensive, if not intractable, to perform for nonlinear functions. A numerical solution to an optimal control problem typically requires iteratively performing such expensive UQ processes for hundreds to thousands of times until convergence. The next subsection presents an approach taken in this paper to perform UQ in a computationally efficient manner.B. Uncertainty QuantificationAs mentioned above, performing UQ processes in a tractable manner is vital to numerically solve nonlinear optimal control problems under uncertainty. Because there is no such a method that exactly models the behavior of generic uncertain systems, UQ often seeks an approximate representation of complex behaviors via simpler models.To numerically solve optimal orbit transfer problems under uncertainty, this paper takes a semi-analytical approach to make the UQ processes amenable to being carried out within computational routines. Specifically, our semi-analytical UQ approach uses the first and second moments (i.e., mean and covariance) to represent the distributions of x(t) and y=h(⋅) [where y represents the output of h(⋅)]. As discussed in Sec. II.D, the use of an orbital element coordinate system enables to formulate the perturbed two-body dynamics in a quasi-linear form, contributing to retaining reasonable accuracy of the representation of the state distribution via the first two moments. UQ processes to quantify the statistics (i.e., mean and covariance) of x(t) and y=h(⋅) are presented separately in the following.1. State Statistics PropagationWe denote the mean and covariance of x(t) by x¯(t) and Px(t). For the mean propagation, we use the original nonlinear dynamics evaluated at the mean state, as expressed in Eq. (33a). For the covariance propagation, we approximate the SDE in Eq. (30b) by the first-order Taylor series expansion about the mean trajectory as follows: dx≈f¯dt+A¯(x−x¯)dt+G¯xdw(t)(31)where f¯≜f(x¯,m,u,t); G¯x≜Gx(x¯,m,t); and A¯∈Rnx×nx is the partial derivative of f(⋅) with respect to x evaluated at x¯. Using the Einstein notation, A¯ is expressed as A¯ij=∂fi∂xj|x¯=∂f0i∂xj|x¯+ΓaT∂Fik∂xj|x¯a^k(32)With this approximation, the equations of motion for the mean and covariance evolution can be derived by applying Itô’s lemma (see, e.g., Ref. [38]), yielding x¯˙=f¯=f0(x¯,t)+ΓaT(m)F¯a^(33a)P˙x=A¯Px+PxA¯⊤+G¯xG¯x⊤(33b)where F¯≜F(x¯). We can rewrite the covariance equation Eq. (33b) as P˙x=P˙0(x¯,Px,t)+P˙OL(x¯,m,Px,u)(34)where P˙0(⋅) and P˙OL(⋅) are defined in Eqs. (35a) and (35b), respectively. P˙0 and P˙OL represent the evolution of state covariance due to the perturbed two-body dynamics under natural perturbations and to the dynamics under open-loop control, respectively (and therefore the latter is a function of control). P˙0(x¯,Px,t)≜A¯0Px+PxA¯0⊤+G¯xG¯x⊤(35a)P˙OLij(x¯,m,Px,u)≜ΓaT(A¯1ijka^k+A¯1jika^k)(35b)where A¯0∈Rnx×nx and A¯1∈Rnx×nx×3 are defined as A¯0ij≜∂f0i∂xj|x¯,A¯1ijk≜Pxil∂Fjk∂xl|x¯(36)2. Chance Constraint EvaluationThe exact evaluation of chance constraints is intractable in general. Denoting the probability density function of x by fpdf(x), Eq. (30c) can be calculated as Pr[h(x,t)≤0]=E[Ih≤0(x,t)]=∫Ih≤0(x,t)fpdf(x) dx≥1−ε(37)where the indicator function Ih≤0(⋅) takes 1 if h(⋅)≤0 and takes 0 otherwise. Clearly, the integral in Eq. (37) does not have a closed-form expression unless a particular property is assumed on the distribution of x or y=h(⋅).This paper approximates the evaluation of Eq. (37) by assuming that the distribution of y=h(⋅) is sufficiently close to Gaussian, expressed as y∼N(h¯,Ph). Under this assumption, the chance constraint is computed as h¯+cdfn−1(1−ε)Ph≤0(38)where cdfn−1(⋅) is the inverse function of the cumulative distribution function of the standard normal distribution. The derivation of Eq. (38) from Eq. (37) under the Gaussian assumption is found in literature (e.g., Sec. 3.6 of Ref. [39]). This inequality encompasses a path constraint in expectation too; it is easy to verify that setting ε=0.5 corresponds to h¯≤0 because cdfn−1(0.5)=0.Computing h¯ and Ph requires a nonlinear UQ method as h(⋅) is typically a nonlinear function of a random vector x. This paper uses unscented transform (UT) [40,41] to perform the nonlinear UQ through h(⋅). Appendix B briefly reviews UT and introduces the UT operator UT(⋅). Using UT(⋅), the computation of h¯ and Ph via UT is expressed as [h,Ph]=UT(x¯,Px;h(x,t))(39)In the rest of the paper, by h¯(x¯,Px,t) and Ph(x¯,Px,t), we imply the UT operation expressed in Eq. (39). Thus, the chance constraint Eq. (30c) is replaced with a deterministic inequality ψs(⋅)≤0, where ψs(⋅) is defined as ψs(x¯,Px,t)=h¯(x¯,Px,t)+cdfn−1(1−ε)Ph(x¯,Px,t)(40)The subscript s indicates quantities associated with the stochastic problem. This UT-based approach to computing chance constraints is successfully employed in some space applications, including low-thrust trajectory design [15,16]¶ and spacecraft orbit guidance around asteroids [42].Of course, it is possible (and sometimes may be desirable) to evaluate chance constraints taking into account higher-order moments of y=h(⋅) [43]. It is also possible to employ higher-fidelity UQ methods for the state uncertainty propagation, such as Gaussian mixture model [44], polynomial chaos expansion [45], their hybrid [46], and state transition tensor [47]. Also, using Gauss–Hermite or high-degree cubature rules (e.g., Refs. [48,49]) would be straightforward to extend our UT-based approach without significant modifications. It is important to note that, regardless of the choice of UQ methods, one needs to make sure that the chosen method allows the gradient calculation of the chance constraint evaluation with respect to the input (e.g., state statistics and control). Indeed, the gradient of the UT output with respect to the input is available in an analytical form, as derived in Ref. [50].3. Deterministic Form of the Original ProblemBased on the UQ approaches discussed above, the original stochastic optimal control problem with path chance constraints Eq. (30) is converted to the following deterministic constrained optimal control problem: minx,m,u,t0,tfJ=∫t0tfL dt(41a)s.t.x¯˙=f(x¯,m,u,t),m˙=−Γm˙max(41b)P˙x=P˙0(x¯,Px,t)+P˙OL(x¯,m,Px,u)(41c)ψs(x¯,Px,t)≤0(41d)ψ0(x¯0,t0)=0,ψf(x¯f,tf)=0(41e)where Eqs. (41b–41d) correspond to Eqs. (33a), (34), and (40), respectively.C. Optimality Necessary ConditionAs the problem in Eq. (41) is now essentially a deterministic constrained optimal control problem, its necessary conditions of optimality are derived below in an analogous fashion to the constrained primer vector in Sec. III.1. Explicit Dependency on ControlThe explicit dependency of the state chance constraint [Eq. (41d)] on u is first established by differentiating ψs with respect to time (recall Sec. III.B). The time differentiation of Eq. (40) is calculated as ψ˙s=Dt+Dxix¯˙i+DPijP˙xij(42)where Dt∈R, Dx∈Rnx, and DP∈Rnx×nx represent the partial derivatives of ψs(⋅) with respect to t, x¯, and Px, respectively, given by Dt=∂h¯∂t+cdfn−1(1−ε)2Ph∂Ph∂t,Dxi=∂h¯∂xi+cdfn−1(1−ε)2Ph∂Ph∂xi,DPij=∂h¯∂Pxij+cdfn−1(1−ε)2Ph∂Ph∂Pxij(43)The gradient of the UT output {h¯,Ph} with respect to the input {x¯,Px,t} is available in an analytical form (see Ref. [50]). Substituting Eqs. (33a) and (34) into Eq. (42) and rearranging the terms, we have ψ˙s(x¯,Px,m,t,u)=αs+ΓaTβs⊤a^(44)where αs∈R and βs∈R3 are analogous to αc and βc in Eq. (20) and are given by αs(x¯,Px,t)=Dt+Dxif0i(x¯,t)+DPijP˙0ij(x¯,Px),βsi(x¯,Px,t)=DxjF¯ji+DPjk(A¯1jki+A¯1kji)(45)For the same reason as the deterministic constrained problems, u must satisfy ψ˙s(⋅)=0 on constrained arcs. Therefore, the following equalities must hold on the constrained arcs: ψs(x¯,Px,t)=0,ψ˙s(x¯,Px,m,u,t)=0(46)2. Control HamiltonianSimilar to the development in Sec. III, we convert the constrained problem Eq. (41) into an unconstrained one by adjoining the mean dynamics, terminal constraints, and control-dependent path constraint [ψ˙s(⋅)=0]. We use μs∈R to denote the Lagrange multiplier associated with ψ˙s, where μs must satisfy μs≥0 if ψs=0, whereas μs=0 if ψs<0 (recall Sec. III.B). Here we do not adjoin the covariance dynamics P˙x; although adjoining the covariance dynamics is not necessary in our current formulation, it may become necessary in a future extension of this work if we consider closed-loop control policies and impose terminal constraints that depend on the state covariance.Thus, the control Hamiltonian that incorporates the control-dependent constraint can be defined as Hs(x¯,m,Px,u,λx,μs,t)≜L+λx⊤f(x¯,m,u,t)+μsψ˙s(x¯,m,Px,u,t)−λmΓm˙max(47)In the same manner as the constrained primer vector derivation, the following necessary conditions of optimality are derived by applying Pontryagin’s optimality principle: Optimal control:  {u*,μs*}∈{u,μs|μsψ˙s=0∧minHs},Costate dynamics:  λ˙x⊤=−∂Hs∂x¯,λ˙m=−∂Hs∂m,State dynamics:  x¯˙=f(x¯,m,u,t),P˙x=P˙0+P˙OL,m˙=−Γm˙max(48)which lead to different forms of optimal control depending on whether the trajectory is on an unconstrained arc or on a constrained arc.3. Necessary Conditions on Constrained ArcsThe derivation of necessary conditions on constrained arcs is analogous to the one for the constrained primer vector. The following derivation is parallel with that of constrained primer vector necessary conditions (see Sec. III.B for step-by-step derivation).First, the costate dynamics on constrained arcs are calculated from Eqs. (47) and (48) as [λ˙xλ˙m]=[−(∂f0∂x+ΓaT∂(Fa^)∂x)⊤λx−μs(∂ψ˙s∂x)⊤ΓaTm(Fa^)⊤λx−μs∂ψ˙s∂m](49)where the partial derivatives of ψ˙s are given by ∂ψ˙s∂x=∂αs∂x+ΓaT∂xs∂xa^,∂ψ˙s∂m=−ΓaTmxsa^(50)The partial derivatives of αs and βs are expressed by using the Einstein notation as ∂αs∂xi=∂Dt∂xi+∂Dxj∂xif0j+DxjA¯0ji+∂DPjk∂xiP˙0jk+DPjk∂P˙0jk∂xi,∂βsi∂xj=∂Dxk∂xjF¯ki+Dxk∂Fki∂xj|x¯+∂DPkl∂xj(A¯1kli+A¯1lki)+DPkl[∂A1kli∂xj+∂A1lki∂xj]x¯(51)Next, necessary conditions for the optimal control are derived. By expanding f(⋅) and ψ˙s(⋅), the Hamiltonian Eq. (47) can be rewritten as Hs=L+λx⊤f¯0+μsαs+ΓaT(λx⊤F¯+μsβs)a^−λmΓm˙max(52)which clarifies that Hs is bilinear in Γ, μs, and a^. To minimize Hs, the optimal acceleration direction is determined by a^*=ps‖ps‖2,ps(x,Px,λx,μs)=−(F¯⊤λx+μsβs)(53)To determine Γ*, the partial derivative of Hs with respect to Γ, evaluated at a^ and μs*, is calculated as ∂Hs∂Γ|a^*,μs*=∂L∂Γ−aT‖ps‖2−λmm˙max(54)which is equal to −(aT‖ps‖2+λmm˙max) for time-optimal transfers. It can be shown in the same manner as the constrained primer vector derivation that −(aT‖ps‖2+λmm˙max)<0. Thus, Γ*=1 for time-optimal transfers.From the condition ψ˙s(⋅)=0, μs* takes the following form (recall Lemma 1): μs*=(βs⊤po)‖βs‖22+αs‖βs‖22(‖βs‖2‖po‖2)2−(βs⊤po)2(aT‖βs‖2)2−αs2(55)4. Necessary Conditions on Unconstrained ArcsOn unconstrained arcs, the Hamiltonian takes the same form as the classical primer vector, aside from the replacement of x with x¯. Thus, the optimal trajectories are determined by Eq. (25) while replacing x with x.5. Constraint Multiplier Additional Necessary ConditionsThe same discussion in Sec. III.B.3 also applies to the stochastic primer vector solution. That is, there is a set of additional necessary conditions of optimality for μs on a constrained arc on t∈[t1,t2] as follows: μ˙s(t)≤0,∀  t∈[t1,t2],∧μs(t2−)=0(56)We can also show that the stochastic primer vector solution [Eq. (55)] satisfies the first condition μs(t2−)=0. The numerical examples in Sec. VI empirically confirm the satisfaction of the second condition μ˙s(t)≤0,∀t∈[t1,t2].D. Jump Conditions at Constrained Arc Entry PointsFor the same reason as the deterministic problems (see Sec. III.C), the costate jumps occur at the entry corners in this case too. Assuming a constrained arc on t∈[t1,t2], the jump conditions at t1 are given by Eq. (28) with the replacement of μc, ψc, and Hc by μs, ψs, and Hs, respectively.V. Solution MethodA. Indirect MethodWe use the indirect method to solve constrained orbit transfer problems under uncertainty. The indirect method is a classical approach to solve optimal control problems, which essentially converts the originally infinite-dimensional optimization problems into two-point boundary value problems (TPBVPs) while satisfying the first-order necessary conditions of optimality derived from Pontryagin’s optimality principle.Figure 1 illustrates a schematic of the indirect method for constrained optimal control problems. Although this schematic represents chance-constrained transfer problems [Eq. (41)], the following discussion applies to deterministic constrained problems [Eq. (6)], as they are fundamentally within the same category of constrained optimal control problems.Traditionally, the indirect method is mostly used for solving unconstrained optimal control problems. To obtain the solutions of constrained optimal control problems, indirect methods usually divide the entire trajectory into subarcs consisting of unconstrained and constrained arcs (Fig. 1 has three subarcs on t0−t1, t1−t2, and t2−tf) and solve each subarc as separate TPBVPs while satisfying the transversality conditions at each corner (e.g., Refs. [25,26,36,51]). While this traditional approach is a straightforward application of constrained optimal control theory, often it is not suited for numerical solution procedures, virtually limiting its applications to mostly analytic examples (Examples 1 and 2 in Ref. [25] and the examples in Refs. [26,27]).** The major limitations that make the approach ineffective to numerically solve constrained problems include the following: It has to deal with costate discontinuities at (entry) corners, leading to a smaller radius of convergence.It requires a priori information about the structure of subarcs (e.g., number of constrained arcs).Fig. 1 Indirect method for constrained optimal control problems under uncertainty.These limitations led many researchers to turn their attention to direct methods as promising solution methods for constrained optimal control problems. These approaches typically incorporate inequality constraints based on the penalty function method [52–54] and are often combined with techniques in numerical optimization, such as the interior point method [55] and the augmented Lagrangian method [56,57]. Whether explicitly or implicitly, these techniques are embedded in many of the state-of-the-art algorithms for space trajectory optimization, including DDP-based algorithms (e.g., Mystic [6] and hybrid DDP [7]) and NLP-based algorithms (e.g., direct collocation [9] and Sims–Flanagan transcription [58]) where NLP solvers (such as SNOPT [59]) typically handle inequality constraints using the augmented Lagrangian method. In comparison with indirect methods, although these algorithms provide greater flexibility and robust convergence in solving large-scale problems, they often compromise the feasibility and/or optimality of the solution, mainly due to the time discretization of trajectories and the approximation of equations of motion.In this paper, we stick to the indirect method to solve the constrained optimal control problems while addressing the two limitations listed above. We modify the discontinuous problems to be amenable to indirect method procedures by approximating the costate discontinuities with smooth functions. The smoothing approach enables us to directly apply the standard indirect method to solve TPBVPs without dividing a trajectory into subarcs, which eliminates the need for assuming the subarc structure a priori.B. Smooth Approximation Across Corner DiscontinuitiesAs discussed in Secs. III.C and IV.D, the costate trajectories may have discontinuities at entry corners. For simpler notation, the discussion in this section uses ψ to represent ψc or ψs; likewise, μ is used to represent μc or μs. Recalling Eq. (14), the constraint multiplier μ switches its value between μ* and 0 triggered by the constraint activation as follows: μ={μ*≥0(ψ(⋅,t)=0∧ψ˙(⋅,m,uo,t)>0)0(otherwise)(57)where μ* is computed according to Eq. (24) (deterministic) or Eq. (55) (stochastic).We use two activation functions ϕtanh(⋅) and ϕELU(⋅) to smoothly approximate Eq. (57) as μ˜=ϕtanh(ψ)ϕELU(μ*)(58)where both of ϕtanh(⋅) and ϕELU(⋅) are continuously differentiable functions defined in Eq. (59); ρ1 and ρ2 in Eq. (59) are given positive scalars that control the sharpness of the approximation (smaller ρ1 and ρ2 lead to sharper approximations). ϕtanh(ψ)=e2+12e2(1+tanhψ+ρ1ρ1)(59a)ϕELU(μ*)={μ*(μ*>0)ρ2(expμ*ρ2−1)(μ*≤0)(59b)Equation (59a) is a hyperbolic tangent activation function, and Eq. (59b) is a variant of exponential linear unit (ELU) [60] called continuously differentiable ELU (CELU) [61]. Hyperbolic tangent and ELU are among the activation functions widely used in the field of machine learning; hyperbolic tangent also finds its applications in smooth approximation of the bang-bang optimal control for low-thrust orbit transfers [62,63]. Equation (59a) is defined to take ϕtanh(⋅)=1 at ψ=0 (∵(e2+1/2e2)=(1/1+tanh1)) while ϕtanh(⋅)→0 as ψ→−∞. Equation (59b) returns μ* if μ*>0 while ϕELU(⋅)→−ρ2 as μ*→−∞.This smooth approximation approach has three important properties as summarized in Lemma 2. The first property (1) is crucial in facilitating the numerical convergence of the solution method. This property implies the smoothness of u and x˙, eliminating the need to divide the trajectory into subarcs like Eq. (27). The second property (2) is vital when dealing with safety-critical systems where the mission designer does not want to compromise the feasibility of the inequality constraint for any ρ. The third property (3) ensures the convergence to the local optimum of the original problem. Figure 2 illustrates the behavior of the activation functions with different values of the sharpness parameter ρ.Fig. 2 Activation functions for corner smooth approximation with various values of sharpness parameter ρ.Lemma 2:The smooth approximation μ˜ as defined in Eqs. (58) and (59) has the following properties: μ˜ is continuously differentiable over an optimal trajectory including at corners.μ˜ respects the inequality constraint regardless of the values of ρ1 and ρ2.μ˜ approaches μ defined in Eq. (57) as ρ1, ρ2→+0.Proof:See Appendix A.2.   □In particular, this paper uses the same value for the two sharpness parameters, i.e., ρ≜ρ1=ρ2. Taking advantage of the third property in Lemma 2, this paper performs numerical continuation over ρ to obtain a sequence of solutions that asymptotically approach the optimal trajectory. The continuation successively solves the TPBVP summarized in Eq. (60) (which is written for stochastic problems) by a nonlinear root-finding algorithm for a decreasing sequence of ρ. For a given sharpness parameter ρ,Find{(λt0),tf} s.t.{Eq.(13)(transversality conditions)Eqs.(41b)  and  (41c)(state dynamics)Eq.(49)(costate dynamics)Eqs.(55),(58)  and  (59)(constraint multiplier)(60)Note that, as typical in most of other solution methods for space trajectory optimization, it is not straightforward to detect the problem infeasibility before attempting to numerically solve the problem.VI. Numerical ExamplesThe theoretical development on stochastic primer vector in Sec. IV is numerically demonstrated by solving two illustrative example problems. The optimal trajectories are obtained by using the solution method presented in Sec. V, where the numerical continuation over ρ is performed for the sequence {1.0×10−2,5.0×10−3,1.0×10−3}. A nonlinear root-finding algorithm fsolve in MATLAB with finite differentiation is used for solving the TPBVP in Eq. (60). As an initial guess of λ(t0), we use the solution to the unconstrained problem [same as Eq. (30) but the state chance constraint Eq. (30c)]; the initial guesses for the unconstrained problems are generated by using a costate initialization method presented in Refs. [64,65].A. ParametersTable 1 summarizes a set of dynamical parameters, which are used in both of the examples. This parameter set is chosen to be roughly consistent with the dynamical environment around asteroid Bennu experienced by the OSIRIS-REx spacecraft (asteroid parameters: Ref. [66]; spacecraft parameters: Ref. [67]). The assumed parameters of the low-thrust engine (i.e., Tmax and Isp) are chosen to be within the capability of commercially available ion engines for small spacecraft. The solar radiation pressure (SRP) parameter B encapsulates the spacecraft’s effective projected area-to-mass ratio and surface properties, and it is used to compute the magnitude of SRP acceleration as aSRP=G0Bdsun−body2(61)where G0(≈1.02×1014  kg⋅km/s2) is the solar flux constant. The sun–body distance dsun−body is assumed constant because the duration of transfers (<1  day) is sufficiently short compared with the period of one asteroid revolution around the sun (∼1.2  year). The normalization units {distant unit (DU), time unit (TU), mass unit (MU)} of this system are defined as follows: {DU,TU,MU}={1  km,1.430×104  s,1000  kg}, where TU is determined to make μbody=1  DU3/TU2.Table 2 summarizes the osculating classical orbital elements for the transfers considered in this paper. These classical orbital elements are converted to MEE via Eq. (4), and denoted by xdep (departure) and xarr (arrival).In the numerical examples, the mapping from dw(t) to stochastic state disturbances is expressed as follows: Gx=F(x)Ga, where Ga∈R3×3 (hence nw=3). As F(x) represents the stacked Gauss equations for MEE coordinates, this expression assumes that the disturbances are caused by stochastic acceleration whose intensity is defined by Ga.Table 3 summarizes the uncertainty parameters used in the numerical examples. {σa,1,σa,2,σa,3} represent the standard deviation of the intensity of stochastic acceleration, forming Ga as Ga=diag([σa,1,σa,2,σa,3]). Ppos0 and Pvel0 form the covariance of the initial state uncertainty in the Cartesian as PCart0=blkdiag(Ppos0,Pvel0). PCart0 is converted to the covariance in the MEE coordinates by using UT through a Cartesian-MEE transformation with αUT=0.75. Thus converted covariance P0 is used as the covariance of the initial Gaussian state distribution. UT for chance constraint evaluation via Eq. (40) also uses αUT=0.75 unless otherwise stated.B. Example I: Transfer Between Terminator Orbits1. Problem SettingsThe first example is an orbit-orbit transfer under the two-body dynamics (apert=0). The departure and arrival orbits are 2.1 and 0.5 km frozen terminator orbits (TOs) with their eccentricity vectors pointing the +z direction. The frozen orbits can be designed for a given orbit semimajor axis a, making the orbital elements naturally frozen on average in the sun–asteroid rotating frame under strong SRP (see Ref. [68]).In this scenario, a chance constraint on the orbit eccentricity is imposed. The chance constraint is expressed as Pr[h(x)≤0]≥1−ε,h(x)=e(x)−emax=f2+g2−emax(62)where the risk bound ε is set ε=0.001, i.e., the inequality h≤0 is to be satisfied with 99.9% confidence. The maximum eccentricity emax is set emax=0.6. Since the arrival phase is free, the boundary conditions are expressed as ψ0(⋅)=x¯0−xdep=06 and ψf(⋅)=Ψf(x¯f−xarr)=05, where Ψf=[I5,05×1]. Thus, fixing x¯0 as x¯0=xdep, it is clear from Eq. (13) that the transversality conditions are [[Ψf(x¯f−xarr)]⊤λLλmHs]t=tf⊤=08(63)for eight unknowns λ(t0)∈R7 and tf, where λL denotes the costate associated with L. Here Hs is constant over time as it does not have an explicit dependency on time t (i.e., autonomous system).2. Optimal TrajectoryEquation (60) is solved for λ(t0) and tf with the transversality condition in Eq. (63), and the result is visualized in Fig. 3. Figures 3a and 3b show the optimal trajectory and control history under the chance constraint, respectively (showing the final solution of the numerical continuation over ρ, i.e., solution at ρ=0.001). The constrained arc is highlighted by the green thrust vectors [Fig. 3a] and by the shaded regions [Fig. 3b], indicating that the constraint is active around 1.8–2.4 TU. For comparison, the solution without a chance constraint is included in Fig. 3c (trajectory) and Fig. 3d (control). In the control history plots, {a1,a2,a3} denote the components of the low-thrust acceleration vector, i.e., [a1,a2,a3]⊤=ΓaTa^, plotted in [DU/TU2]. It is noteworthy that the control history on the constrained arc takes largely different values from the unconstrained one, whereas they behave in a similar manner on unconstrained arcs (note the scale difference of a3). The time-of-flight (ToF) values of the two trajectories are 5.60 TU (chance-constrained) and 5.56 TU (unconstrained), whose difference in the physical system is ∼0.16  h.Figure 4 compares the time histories of μs [Fig. 4a] and dψs/dt [Fig. 4b] of the optimal trajectories with various ρ. The constrained arc is indicated by the arc on which μs>0 in Fig. 4a, or dψs/dt=0 for a finite duration in Fig. 4b. In these figures, the small dots on the solid lines indicate the integration steps determined by a variable-step ordinary differential equation (ODE) solver (MATLAB’s ode113 is used), which confirm that μs is indeed continuous and smooth, being consistent with the first argument of Lemma 2. Figure 4 also shows that the behaviors of μs and dψs/dt at the entry corner (∼1.8  TU) become sharper as ρ decreases, illustrating the third argument of Lemma 2. In addition, we could project from Fig. 4a that, as ρ→+0, the trajectory of μs would eventually satisfy the additional necessary conditions discussed in Sec. IV.C.5, i.e., μ˙s(t)≤0,∀t∈[t1,t2] (t1: entry, t2: exit).Fig. 3 Example I: Transfer between terminator orbits, showing chance-constrained and unconstrained optimal trajectories. Constrained arcs highlighted by the green vector in (a) and by the shaded region in (b).Fig. 4 Numerical continuation over the sharpness parameter ρ (Example I): smooth approximation across corner discontinuities.3. Monte Carlo SimulationsNonlinear MC simulations are performed to confirm the validity of the solutions under the original nonlinear stochastic dynamics. Five hundred dispersed trajectories are simulated by sampling the initial state according to x0∼N(xdep,P0) and propagating each sample under the action of the open-loop control history in Fig. 3b. In the propagation, the Brownian motion dw(t) in Eq. (3) is approximated by discrete-time white noise wk with a zero-order hold over a small time step t∈[tk,tk+Δtk) as x˙=f(x,m,u,t)+Gx(x,m,t)1Δtkwk(64)where E[wk]=0 and E[wiwj⊤]=I3δij (δij: Kronecker delta).Figure 5 summarizes the MC simulation results for the chance-constrained and unconstrained optimal trajectories. Figures 5a and 5c show the dispersed trajectories, where trajectories on the constrained arcs are highlighted in green, whereas those violating the inequality h≤0 are highlighted in red. Figures 5b and 5d visualize the time histories of the osculating orbit eccentricities e of the MC trajectories (gray line), nominal trajectory (black dashed line), and 99.9% confidence bounds (black dotted line). The value of emax is also shown as a black solid line. These figures confirm that the MC trajectories under the chance-constrained control indeed respect the imposed constraint, whereas those under the unconstrained control violate it around 2.0–2.5 TU. The shown 99.9% confidence bound is the one used within the solution method, which is computed via the semi-analytical UQ approach detailed in Sec. IV.B. It is clear from Figs. 5b and 5d that the confidence bounds capture the nonlinear MC results at a great accuracy, justifying the use of the UQ approach within the solution method. Figure 6 also confirms the consistency of the UQ results with the nonlinear MC results, where the 99.9% confidence envelopes (black dotted line) closely match the MC trajectories (gray line).Fig. 5 Monte Carlo simulation results (Example I): Dispersed trajectories and chance constraint values.Fig. 6 State history in MEE coordinates (Example I): Monte Carlo trajectories & 99.9% confidence envelop based on semi-analytical UQ.C. Example II: Transfer to a Non-Keplerian Science Orbit1. Problem SettingsThe second example is a fixed-phase transfer from a 2.0 km frozen TO to a non-Keplerian science orbit in perturbed two-body dynamics. A resonant terminator orbit (RTO), which exists under strong SRP, is chosen as the arrival orbit for its scientific merit in conducting global mapping of the orbiting body [69]. In particular, this scenario considers a sun-side 7:1 RTO (which extends toward the sun and makes 7 revolutions around the body before closing on itself) for its superiority in less operational cost required for the orbit maintenance [70]. Because this arrival orbit is non-Keplerian, the arrival state of the transfer is expressed as a set of osculating orbital elements with fixed phase (fixed fast variable), as listed in Table 2. Figure 7 illustrates the arrival orbit in the Hill frame (defined in the next paragraph), which shows the RTO (blue solid line), arrival state (black circle), and osculating orbit (black dash-dotted line).In this example, we describe the motion of spacecraft in a Hill frame that rotates with the body’s heliocentric orbit with its origin at the body’s center of mass, where the x and z axes are aligned with the sun–body line and the heliocentric orbit normal, respectively, and the y axis completes the right-hand system. This example incorporates the dynamical influence of SRP in the propagation and optimization of transfers, i.e., apert=aSRPd^, where aSRP is defined in Eq. (61), and d^ denotes the unit vector pointing from the sun to the body (d^=[1,0,0]⊤ in the Hill frame).Fig. 7 Arrival orbit of Example II: RTO under strong SRP at Bennu, shown in the Hill frame.This transfer example imposes a chance constraint on the minimum radius of periapsis, which is expressed as Pr[h(x)≤0]≥1−ε,h(x)=rpmin−rp(x)=rpmin−p1+f2+g2(65)where the risk bound ε is set ε=0.001. The minimum periapsis rpmin is set rpmin=0.5 DU (=0.5  km in the physical system). Because the arrival phase is fixed, the boundary conditions are expressed as ψ0(⋅)=x¯0−xdep=06 and ψf(⋅)=x¯f−xarr=06. Thus, fixing x¯0 as x¯0=xdep, it is clear from Eq. (13) that the transversality conditions are [(x¯f−xarr)⊤λmHs]t=tf=08(66)for eight unknowns λ(t0)∈R7 and tf. Like Example I, Hs is constant over time.2. Optimal TrajectoryEquation (60) is solved for λ(t0) and tf with the transversality condition in Eq. (66). Like Example I, Fig. 8 visualizes the optimized trajectories and control histories, with and without the chance constraint, where the target RTO is not shown in Figs. 8a and 8c for brevity (the arrival state and osculating arrival orbit are shown). The constraint arcs are highlighted following the same convention as Example I, revealing that this transfer has two separate constrained arcs on around 1.6–2.5 TU and 5.3–7.1 TU. The appearance of the two constrained arcs is naturally determined in the process of solving the optimal transfer problem thanks to the smooth approximation presented in Sec. V.B, with no need to specify or assume the subarc structure (“off-on-off-on-off” in this case). ToF of the two trajectories are 9.67 TU (chance-constrained) and 9.65 TU (unconstrained), whose difference in the physical system is ∼0.08  h. Figure 9 also confirms a similar trend to Example I in the behaviors of μs and dψs/dt, while exhibiting the important structural difference that two constrained arcs appear on each trajectory.Fig. 8 Optimal trajectories of Example II: Transfer to a non-Keplerian science orbit (RTO).Fig. 9 Numerical continuation over the sharpness parameter ρ (Example II).3. Monte Carlo SimulationsTo confirm the validity of the obtained solutions under the stochastic setting, a set of nonlinear MC simulations are performed in the same fashion as Example I. Figure 10 summarizes the MC simulation results for the chance-constrained and unconstrained optimal trajectories, following the same color/line convention as Fig. 5. Together with Fig. 11, these figures demonstrate the validity of the chance-constrained optimal trajectory solution and the consistency of our semi-analytical UQ approach with the true nonlinear stochastic dynamics.Fig. 10 Monte Carlo simulation results (Example II).Fig. 11 State history in MEE coordinates (Example II): Monte Carlo trajectories and 99.9% confidence envelop based on semi-analytical UQ.D. Consistency of Uncertainty QuantificationThe consistencies of UQ results against true distributions simulated by nonlinear MC are investigated. In particular, we compare the semi-analytical UQ results quantified in the MEE and the Cartesian coordinates. The simpler transfer, Example I (TO-TO transfer), is used to investigate the UQ consistencies between the two coordinate systems.In the MEE coordinates, Fig. 5b clearly shows a good consistency between the UQ and nonlinear MC results. UQ in the Cartesian is performed by propagating the initial state statistics in Tables 2 and 3 using the same propagation equations in Eq. (33), where fkep(⋅)=[v⊤,−(μbody/‖r‖23)r⊤]⊤ and F=[03×3,I3]⊤ are used. The chance constraint Eq. (62) is then evaluated via Eqs. (38) and (39) using the propagated state statistics x¯(t) and Px(t).The UQ result in the Cartesian coordinates is shown in Fig. 12, which also plots the nonlinear MC trajectories that are propagated in the Cartesian coordinates by applying the constrained optimal control history in Fig. 3b. It is clear from the figure that the 99.9% confidence bound obtained via Eqs. (38) and (39) starts rapidly increasing at ∼4.6  TU, leading to an inconsistent UQ result compared with the simulated true distribution. As such, if one attempts to solve for the optimal trajectory shown in Fig. 3a in the Cartesian coordinates, presumably the attempt would not be successful due to this drastic increase of the confidence bound. This comparison emphasizes the importance of choosing an appropriate UQ method to solve a trajectory optimization problem under uncertainty as well as the effectiveness of orbital elements as a coordinate system to solve such a problem.The following discussion is devoted to understanding plausible causes of the UQ inconsistency in the Cartesian coordinates. Because our semi-analytical UQ approach consists of two processes (state statistics propagation and chance constraint evaluation; recall Sec. IV.B), we investigate the consistency of each process separately.Fig. 12 Inconsistency between semi-analytical UQ result and MC trajectories when quantified in Cartesian coordinates, leading to unnecessarily conservative confidence bound (Example I).First, the consistency of the chance constraint evaluation process via UT is examined. It is known that the performance of UT may vary depending on the values of a free parameter αUT, which determines the spread of the sigma points (see Appendix B for more detail on UT). To check the consistency of UT, the chance constraint Eq. (62) is evaluated via UT with different values of αUT∈{0.001,0.01,0.1,0.5,0.75} for the same statistics history x¯(t) and Px(t). The comparison result confirmed that all the chance constraint histories exhibited a spike at ∼4.6–5.0  TU like in Fig. 12, leading to similar inconsistent UQ results regardless of the values of αUT. This implies that the inconsistency of the UQ result is not caused by an inappropriate choice of αUT (at least in this transfer example).Next, the consistency of the state statistics propagation process is investigated. As discussed in Sec. IV.B, we represent the state distribution only by its first two moments (i.e., mean and covariance), and approximate the propagation of the statistics via Eq. (33). To compare the approximated statistics and the true distribution simulated by nonlinear MC, Fig. 13 visualizes them as a snapshot at t=5.0  TU for each coordinate system. The unit of the Cartesian state variables is [DU] for position {r1,r2,r3} and [DU/TU] for velocity {v1,v2,v3}. Figure 13 clearly shows that, although the statistics quantified via Eq. (33) in the MEE coordinates (red) closely match the true distribution (black dots) and the statistics derived from the distribution (blue), the state statistics quantified in the Cartesian do not accurately capture the true distribution at all. This implies that the UQ inconsistency observed in Fig. 12 would be largely due to the inaccurate quantification of the state distribution in the Cartesian coordinates. Additional implication from Fig. 13b is that, in order to solve for the optimal trajectory of Example I with the Cartesian state representation, it would be necessary to take into account higher moments of the state distribution (e.g., skewness and kurtosis) and propagate them within the optimization routine.Fig. 13 Snapshot of state distributions in MEE and Cartesian coordinate systems at t=5.0  TU, propagated with the same initial distribution, stochastic disturbance, and control history (Example I).E. DiscussionThe two numerical examples (TO-TO transfer and TO-RTO transfer) demonstrated the validity of the theoretical development on stochastic primer vector. These results also highlight the effectiveness of our smooth approximation approach to deal with corner discontinuities that appear in constrained optimal control problems. Nonlinear MC simulations verify that the obtained chance-constrained optimal trajectories indeed satisfy the state inequality constraints to 99.9% confidence (prescribed confidence bound).Although the indirect method is chosen in this paper to demonstrate the theoretical results, exploring various solution methods is an important future direction of this work in order to solve more complex transfer problems under uncertainty. The theoretical results developed in Secs. III and IV are independent from particular solution methods. It would be an interesting avenue to combine the stochastic primer vector solution with advanced numerical techniques developed for the direct method, such as those discussed in Sec. V.A.In exploring various solution methods, the choice of UQ methods is crucial to successful numerical solutions. If UQ results are not consistent with the true distributions, the inconsistency affects the control inputs on constrained arcs, leading to the violation of chance constraints (if the uncertainty is underestimated) or infeasible problems (if the uncertainty is overestimated, like in Fig. 12). The analysis in Sec. VI.D demonstrates that the choice of the coordinate system for state representation can largely affect the UQ consistency. Obviously, just choosing orbital element coordinates does not necessarily guarantee a successful UQ performance, depending on the strength of perturbations. To retain the UQ accuracy under strong perturbations, incorporating higher-fidelity UQ methods such as those discussed in Sec. IV.B into the stochastic primer vector framework is an important future direction of this work.Another important extension of this work is to make the stochastic primer vector framework applicable to a broader class of problems. One of the most interesting directions may be generalizing the path and/or terminal constraints, such as imposing constraints on the terminal state covariance. While it is in principle possible to impose such terminal constraints within our current framework, having such constraints may lead to infeasible problems because the state covariance would not be effectively controlled by open-loop control policies. Incorporating (and optimizing) closed-loop policies in the stochastic primer vector framework would be a straightforward direction to make such problems feasible.VII. ConclusionsThis paper extends Lawden’s primer vector theory for constrained optimal orbit transfers under state uncertainty. The new primer vector, termed stochastic primer vector, provides an analytical open-loop optimal control law that respects a probabilistic path constraint, i.e., chance constraint, with a user-specified confidence level. Our main theoretical contributions are threefold: 1) formulate a class of space trajectory optimization problems under uncertainty into a deterministic form with a computationally efficient UQ method through the use of the modified equinoctial coordinates and UT; 2) derive the stochastic primer vector by applying constrained optimal control theory; 3) develop a constrained indirect method with smoothing in which state and costate trajectories are continuously differentiable across constraint corners, eliminating the need for assuming the subarc structures before optimization. This paper demonstrates the theoretical results in two illustrative transfer scenarios around asteroids, which confirm the validity of our theory and emphasize the effectiveness of our UQ approach and smoothed indirect method. As the theoretical results are independent from particular solution methods, it is an important future direction of this work to explore various solution methods and advanced numerical techniques in order to solve more complex transfer problems under uncertainty.‡ These are also called by different names, such as boundary intervals and interior intervals [26], and boundary segments and interior segments [28].§ As pointed out in a number of studies (e.g., Ref. [26]), one may also choose the discontinuity to occur at the exit corner or even distribute at both of the entry and exit corners. This paper chooses to have the corner discontinuity at entry corners.¶ Here we note the computational efficiency of our UQ approach as compared with similar approaches in Refs. [15,16], which employ UT not only for chance constraint evaluation but also for the state statistics propagation.** Reference [51] presents an approach that numerically solves a constrained optimal control problem for roundtrip trajectory design. The approach solves a constrained problem as a multipoint BVP by introducing slack variables. However, the number of slack variables, which need to be defined before solving the problem, depend on the number of constrained arcs, limiting its application to such problems that have predetermined subarc structures.Appendix A. ProofsA.1. Proof of Lemma 1: Constraint MultiplierProof:First, show that there exists no such μc∈[0,+∞) that satisfies Eq. (22) if aT‖βc‖2≤|αc|. For all a^*, the quantity aTβc⊤a^* may take a value in [−aT‖βc‖2,aT‖βc‖2] because ‖a^*‖2=1. This implies that, if aT‖βc‖2<|αc|, then there exists no such a^* (nor μc) that satisfies ψ˙c(⋅)=αc+aTβc⊤a^*=0. If aT‖βc‖2=|αc|, then only μc=∞ or μc=−∞ can satisfy ψ˙c(⋅)=αc+aTβc⊤(pc/‖pc‖2)=0, but these are not within the domain μc∈[0,+∞).Next, under the condition aT‖βc‖2>|αc|, show that μc expressed as in Eq. (24) satisfies Eq. (22), and that μc∈[0,+∞)⊂R. Suppose that aT‖βc‖2>|αc|. Rearranging the terms in Eq. (22) with Γ*=1 leads to αcpc⊤pc=−aTβc⊤pc(A1)Squaring the both sides of Eq. (A1) and substituting Eq. (21) yield a quadratic equation in terms of μc. Thus, Eq. (22) can be solved for μc as μc=(βc⊤po)‖βc‖22±αc2‖βc‖22(‖βc‖2‖po‖2)2−(βc⊤po)2(aT‖βc‖2)2−αc2(A2)where recall that po=−F⊤λx. To arrive at Eq. (24), the sign ambiguity in Eq. (A2) needs to be resolved.The sign ambiguity is resolved as follows. Using Eqs. (21) and (A2), the right-hand side of Eq. (A1) is rewritten as −aTβc⊤pc=−aT(βc⊤po−μc‖βc‖22)=±aTαc2(‖βc‖2‖po‖2)2−(βc⊤po)2(aT‖β‖2)2−αc2This implies that the identity αcpc⊤pc=±aTαc2(‖βc‖2‖po‖2)2−(βc⊤po)2(aT‖βc‖2)2−αc2must hold in order for Eq. (A1), and hence Eq. (22), to hold. This requires sign(±αc2)=sign(αc), and thus μc* is uniquely determined as in Eq. (24).We then show that μc in Eq. (24) satisfies μc∈[0,+∞)⊂R. Note that inequality ‖βc‖2‖po‖2−βc⊤po≥0 always holds due to the Cauchy–Schwarz inequality. Hence, since aT‖βc‖2>|αc|, the inside of the square root in Eq. (24) is always nonnegative, implying that there exists μc∈(−∞,+∞)⊂R that satisfies Eq. (22). The last piece to show is that μc in Eq. (24) always takes positive values. Letting ψ˙o compactly denote ψ˙c(x,m,uo,t), we have ψ˙o≜ψ˙c(x,m,uo,t)=αc+aTβc⊤po‖po‖2(A3)leading to that βc⊤po=‖po‖2aT(ψ˙o−αc)Substituting this equation into Eq. (24) and rearranging the terms yield μc=‖po‖2aT‖βc‖22[ψ˙o−αc+αc‖βc‖22−((ψ˙o−αc)/aT)2‖βc‖22−(αc/aT)2](A4)Recalling from Eq. (14) that ψ˙o>0 on constrained arcs, the quantity inside the square root in Eq. (A4) is greater than 1 if αc>0 while being ∈[0,1) if αc≤0, which implies that μc≥‖po‖2aT‖βc‖22ψ˙o>0completing the proof.   □A.2. Proof of Lemma 2: Smoothing for Constrained Optimal Control ProblemsProof:The first property (1) is shown first. It is clear from Eq. (59) that ϕtanh(⋅) and ϕELU(⋅) are continuously differentiable with respect to ψ and μ*, respectively, including at corners. Provided that the inequality constraint functions ψc (deterministic) and ψs (stochastic) are twice differentiable (and hence that {αc,βc} and {αs,βs} are differentiable), it is also clear that μc* and μs* are continuously differentiable, respectively. The twice differentiability of ψc is assumed in Sec. III. The twice differentiability of ψs is due to the availability of the analytical gradient of UT operations (derived in Ref. [50]) and the assumption on the twice differentiability of h(⋅).Showing (2) and (3) uses the sign identity of μ* and ψ˙o, i.e., sign(μ*)=sign(ψ˙o) [see Eq. (A2) for the definition of ψ˙o]. It is straightforward to show the sign identity by noting that μc>0 if ψ˙o>0 (shown in Appendix A.1), μc=0 if ψ˙o=0 [verified by substituting ψ˙o=0 into Eq. (A3)], and that μc<0 if ψ˙o<0 (verified by showing μc≤‖po‖2aT‖βc‖22ψ˙oin the same manner as in Appendix A.1).The second property (2) is verified by showing that μ˜=μ* if ψ=0∧ψ˙o>0 (i.e., on constrained arcs), independent from the values of ρ1 and ρ2. Suppose that ψ=0∧ψ˙o>0. Using the sign identity of μ* and ψ˙(⋅,m,uo,t), we have μ*>0 since ψ˙(⋅,m,uo,t)>0. Hence, ψ=0 and μ*>0 lead to μ˜=μ* from Eqs. (58) and (59), which ensures the satisfaction of the constraint.The third property (3) is verified by showing the following three equations: a) limρ1→+0ϕtanh(ψ)=0 if ψ<0; b) ϕtanh(ψ)=1 if ψ=0, independent from the values of ρ1; and c) limρ2→+0ϕELU(μ*)=0 if ψ˙o≤0. Equations (a) and (b) are shown by noting that tanh(−∞)=−1 and that e2+12e2=11+tanh1respectively. Equation (c) is shown by noting that limρ2→+0ϕELU(μ*)=0 if μ*≤0 and the sign identity of μ* and ψ˙o.   □Appendix B. Unscented TransformUnscented transformed (UT) is briefly reviewed in the following. See [40,41] for more detail. Let a function y=F(x;q) represent a nonlinear function that maps a random vector x∈Rnx and a deterministic vector q∈Rnq to a random vector y∈Rny. A UT operation computes approximate values of the mean and covariance of transformed distributions by evaluating F(⋅) at a finite number (2nx+1) of samples so called sigma points. The sigma points, denoted by χ(i)∈Rnx,i=0,1,…,2nx, are sampled according to the pretransformed distribution x∼N(x¯,Px). The approximate mean y¯ and covariance Py are computed as y¯=∑i=02nxwm(i)F(χ(i);q),Py=∑i=02nxwc(i)[F(χ(i);q)−y¯][F(χ(i);q)−y¯]⊤(B1)where wm(i) and wc(i) are weighting scalars for the mean and covariance computation, respectively. Let UT(x¯,Px;F(x,q)) denote the UT operator that performs Eq. (B1), returning [y¯,Py].The computation of χ(i), wm(i), and wc(i) is based on the scaled UT presented in Ref. [41]. For given parameters αUT∈(0,1) and βUT∈R, the sigma points are sampled as {χ(i)}i=0,1,…,2nx={x¯,x¯+γUTPx1/2,x¯−γUTPx1/2}, where Px1/2 satisfies Px1/2Px1/2=Px. The spread of sigma points γUT is given by γUT=3αUT. The weighting scalars are computed as wm(0)=γUT2−nx/γUT2, wc(0)=(γUT2−nx/γUT2)+(1−αUT2+βUT), and wm(i)=wc(i)=1/2γUT2 for i=1,2,…,2nx. βUT allows us to incorporate a priori knowledge about the distribution of y; this paper uses βUT=2, which minimizes the covariance approximation error due to higher-order terms under the Gaussian assumption [41].Computing the optimal control determined by the stochastic primer vector solution [i.e., Eqs. (53) and (55)] requires the gradient of UT with respect to state statistics (through the computation of αs and βs). The gradient of UT is available in an analytical form, as derived in Ref. [50] (also available as an online supplemental material).AcknowledgmentKenshiro Oguri acknowledges financial support for his Ph.D. study from Masason Foundation (AM000017).\r            References\r        [1] Lawden D. F., “General Theory of Optimal Rocket Trajectories,” Optimal Trajectories for Space Navigation, Butterworths, London, 1963, Chap. 3. Google Scholar[2] Jezewski D. J., “Primer Vector Theory and Applications,”  Lyndon B. Johnson Space Center,  NASA  TR R-454, Houston, TX, Nov. 1975. Google Scholar[3] Marec J. P., “Optimal Transfers in a General Gravitational Field,” Optimal Space Trajectories, Elsevier, New York, 1979, pp. 53–70. https://doi.org/10.1016/B978-0-444-41812-8.50013-2 Google Scholar[4] Russell R. P., “Primer Vector Theory Applied to Global Low-Thrust Trade Studies,” Journal of Guidance, Control, and Dynamics, Vol. 30, No. 2, 2007, pp. 460–472. https://doi.org/10.2514/1.22984 LinkGoogle Scholar[5] Gershwin S. B. and Jacobson D. H., “A Discrete-Time Differential Dynamic Programming Algorithm with Application to Optimal Orbit Transfer,” AIAA Journal, Vol. 8, No. 9, 1970, pp. 1616–1626. https://doi.org/10.2514/3.5955 LinkGoogle Scholar[6] Whiffen G. J. and Sims J. A., “Application of a Novel Optimal Control Algorithm to Low-Thrust Trajectory Optimization,” AAS/AIAA Space Flight Mechanics Meeting, AAS Paper  01-209, 2001. Google Scholar[7] Lantoine G. and Russell R. P., “A Hybrid Differential Dynamic Programming Algorithm for Constrained Optimal Control Problems. Part 1: Theory,” Journal of Optimization Theory and Applications, Vol. 154, No. 2, 2012, pp. 382–417. https://doi.org/10.1007/s10957-012-0039-0 CrossrefGoogle Scholar[8] Betts J. T., “3. Optimal Control Preliminaries,” Practical Methods for Optimal Control and Estimation Using Nonlinear Programming, Soc. for Industrial and Applied Mathematics, Philadelphia, PA, 2010, pp. 91–121, Chap. 3. https://doi.org/10.1137/1.9780898718577.ch3 Google Scholar[9] Hargraves C. and Paris S., “Direct Trajectory Optimization Using Nonlinear Programming and Collocation,” Journal of Guidance, Control, and Dynamics, Vol. 10, No. 4, 1987, pp. 338–342. https://doi.org/10.2514/3.20223 LinkGoogle Scholar[10] Oh D., Landau D., Randolph T., Timmerman P., Chase J., Sims J. and Kowalkowski T., “Analysis of System Margins on Deep Space Missions Using Solar Electric Propulsion,” 44th AIAA/ASME/SAE/ASEE Joint Propulsion Conference & Exhibit, AIAA Paper  2008-5286, 2008, pp. 1–30. https://doi.org/10.2514/6.2008-5286 Google Scholar[11] Rayman M. D. and Williams S. N., “Design of the First Interplanetary Solar Electric Propulsion Mission,” Journal of Spacecraft and Rockets, Vol. 39, No. 4, 2002, pp. 589–595. https://doi.org/10.2514/2.3848 LinkGoogle Scholar[12] Rayman M. D., Fraschetti T. C., Raymond C. A. and Russell C. T., “Coupling of System Resource Margins Through the Use of Electric Propulsion: Implications in Preparing for the Dawn Mission to Ceres and Vesta,” Acta Astronautica, Vol. 60, Nos. 10–11, 2007, pp. 930–938. https://doi.org/10.1016/j.actaastro.2006.11.012 CrossrefGoogle Scholar[13] Zimmer S., Ocampo C. and Bishop R., “Reducing Orbit Covariance for Continuous Thrust Spacecraft Transfers,” IEEE Transactions on Aerospace and Electronic Systems, Vol. 46, No. 2, 2010, pp. 771–791. https://doi.org/10.1109/TAES.2010.5461656 CrossrefGoogle Scholar[14] Jenson E. L. and Scheeres D. J., “Multi-Objective Optimization of Covariance and Energy for Asteroid Transfers,” AAS/AIAA Astrodynamics Specialist Conference, American Astronautical Soc. Paper  20-550, 2020. Google Scholar[15] Ozaki N., Campagnola S., Funase R. and Yam C. H., “Stochastic Differential Dynamic Programming with Unscented Transform for Low-Thrust Trajectory Design,” Journal of Guidance, Control, and Dynamics, Vol. 41, No. 2, 2018, pp. 377–387. https://doi.org/10.2514/1.G002367 LinkGoogle Scholar[16] Ozaki N., Campagnola S. and Funase R., “Tube Stochastic Optimal Control for Nonlinear Constrained Trajectory Optimization Problems,” Journal of Guidance, Control, and Dynamics, Vol. 43, No. 4, 2020, pp. 645–655. https://doi.org/10.2514/1.G004363 LinkGoogle Scholar[17] Greco C., Di Carlo M., Vasile M. and Epenoy R., “Direct Multiple Shooting Transcription with Polynomial Algebra for Optimal Control Problems Under Uncertainty,” Acta Astronautica, Vol. 170, May 2020, pp. 224–234. https://doi.org/10.1016/j.actaastro.2019.12.010 CrossrefGoogle Scholar[18] Greco C., Campagnola S. and Vasile M., “Robust Space Trajectory Design Using Belief Stochastic Optimal Control,” AIAA Science and Technology Forum and Exposition, AIAA Paper  2020-1471, 2020. Google Scholar[19] Ridderhof J., Pilipovsky J. and Tsiotras P., “Chance-Constrained Covariance Control for Low-Thrust Minimum-Fuel Trajectory Optimization,” AAS/AIAA Astrodynamics Specialist Conference, American Astronautical Soc. Paper  20-618, 2020. Google Scholar[20] Olympio J. T. and Yam C. H., “Deterministic Method for Space Trajectory Design with Mission Margin Constraints,” 61st International Astronautical Congress, 2010. Google Scholar[21] Olympio J. T., “Designing Robust Low-Thrust Interplanetary Trajectories Subject to One Temporary Engine Failure,” AAS/AIAA Space Flight Mechanics Meeting, 2010. Google Scholar[22] Laipert F. E. and Longuski J. M., “Automated Missed-Thrust Propellant Margin Analysis for Low-Thrust Trajectories,” Journal of Spacecraft and Rockets, Vol. 52, No. 4, 2015, pp. 1135–1143. https://doi.org/10.2514/1.A33264 LinkGoogle Scholar[23] Venigalla C., Englander J. A. and Scheeres D. J., “Low-Thrust Trajectory Optimization for Maximum Missed Thrust Recovery Margin,” AAS/AIAA Astrodynamics Specialist Conference, American Astronautical Soc. Paper  20-438, 2020. Google Scholar[24] Vasile M., Absil C. O. and Riccardi A., “Set Propagation in Dynamical Systems with Generalised Polynomial Algebra and Its Computational Complexity,” Communications in Nonlinear Science and Numerical Simulation, Vol. 75, Aug. 2019, pp. 22–49. https://doi.org/10.1016/j.cnsns.2019.03.019 CrossrefGoogle Scholar[25] Bryson A. E., Ho Y.-C., Bryson A. E. and Ho Y.-C., “Optimization Problems for Dynamic Systems with Path Constraints,” Applied Optimal Control, CRC Press, Boca Raton, FL, 2018, pp. 90–127, Chap. 3. https://doi.org/10.1201/9781315137667-3 Google Scholar[26] Hartl R. F., Sethi S. P. and Vickson R. G., “A Survey of the Maximum Principles for Optimal Control Problems with State Constraints,” SIAM Review, Vol. 37, No. 2, 1995, pp. 181–218. https://doi.org/10.1137/1037043 CrossrefGoogle Scholar[27] Bryson A. E., Denham W. F. and Dreyfus S. E., “Optimal Programming Problems with Inequality Constraints I: Necessary Conditions for Extremal Solutions,” AIAA Journal, Vol. 1, No. 11, 1963, pp. 2544–2550. https://doi.org/10.2514/3.2107 LinkGoogle Scholar[28] McIntyre J. and Paiewonsky B., “On Optimal Control with Bounded State Variables,” Advances in Control Systems, Vol. 5, Elsevier, New York, 1967, pp. 389–419. https://doi.org/10.1016/B978-1-4831-6718-3.50012-8 Google Scholar[29] Broucke R. A. and Cefola P. J., “On the Equinoctial Orbit Elements,” Celestial Mechanics, Vol. 5, No. 3, 1972, pp. 303–310. https://doi.org/10.1007/BF01228432 CrossrefGoogle Scholar[30] Taylor J., “Comments on a Multiplier Condition for Problems with State Variable Inequality Constraints,” IEEE Transactions on Automatic Control, Vol. 17, No. 5, 1972, pp. 743–744. https://doi.org/10.1109/TAC.1972.1100133 CrossrefGoogle Scholar[31] Jacobson D., Lele M. and Speyer J., “New Necessary Conditions of Optimality for Control Problems with State-Variable Inequality Constraints,” Journal of Mathematical Analysis and Applications, Vol. 35, No. 2, 1971, pp. 255–284. https://doi.org/10.1016/0022-247X(71)90219-8 CrossrefGoogle Scholar[32] Pontryagin L. S., Boltyanskii V. G., Gamkrelidze R. V. and Mischenko E. F., The Mathematical Theory of Optimal Processes, CRC Press, Boca Raton, FL, 1962, Chap. V. Google Scholar[33] Berkovitz L. D., “On Control Problems with Bounded State Variables,” Journal of Mathematical Analysis and Applications, Vol. 5, No. 3, 1962, pp. 488–498. https://doi.org/10.1016/0022-247X(62)90020-3 Google Scholar[34] Leitmann G., “A Note on State-Constrained Optimal Control,” Journal of Optimization Theory and Applications, Vol. 7, No. 3, 1971, pp. 209–214. https://doi.org/10.1007/BF00932479 CrossrefGoogle Scholar[35] Chang S., “Optimal Control in Bounded Phase Space,” Automatica, Vol. 1, No. 1, 1962, pp. 55–67. https://doi.org/10.1016/0005-1098(63)90006-2 Google Scholar[36] Speyer J. L. and Bryson A. E., “Optimal Programming Problems with a Bounded State Space,” AIAA Journal, Vol. 6, No. 8, 1968, pp. 1488–1491. https://doi.org/10.2514/3.4793 LinkGoogle Scholar[37] Jacobson D. and Lele M., “A Transformation Technique for Optimal Control Problems with a State Variable Inequality Constraint,” IEEE Transactions on Automatic Control, Vol. 14, No. 5, 1969, pp. 457–464. https://doi.org/10.1109/TAC.1969.1099283 CrossrefGoogle Scholar[38] Jazwinski A. H., “Stochastic Differential Equations,” Stochastic Processes and Filtering Theory, Dover Publ., New York, 2007, pp. 93–141, Chap. 4. Google Scholar[39] Hessem D. V., “Stochastic Inequality Constrained Closed-Loop Model Predictive Control,” Ph.D. Thesis,  Technische Univ. Delft, Delft, The Netherlands, 2004. Google Scholar[40] Julier S., Uhlmann J. and Durrant-Whyte H., “A New Method for the Nonlinear Transformation of Means and Covariances in Filters and Estimators,” IEEE Transactions on Automatic Control, Vol. 45, No. 3, 2000, pp. 477–482. https://doi.org/10.1109/9.847726 CrossrefGoogle Scholar[41] Julier S., “The Scaled Unscented Transformation,” IEEE American Control Conference, IEEE, New York, 2002, pp. 4555–4559. https://doi.org/10.1109/ACC.2002.1025369 Google Scholar[42] Oguri K. and McMahon J. W., “Robust Spacecraft Guidance Around Small Bodies Under Uncertainty: Stochastic Optimal Control Approach,” Journal of Guidance, Control, and Dynamics, Vol. 44, No. 7, 2021, pp. 1295–1313. https://doi.org/10.2514/1.G005426 LinkGoogle Scholar[43] Jasour A. M., Aybat N. S. and Lagoa C. M., “Semidefinite Programming for Chance Constrained Optimization over Semialgebraic Sets,” SIAM Journal on Optimization, Vol. 25, No. 3, 2015, pp. 1411–1440. https://doi.org/10.1137/140958736 Google Scholar[44] Terejanu G., Singla P., Singh T. and Scott P. D., “Uncertainty Propagation for Nonlinear Dynamic Systems Using Gaussian Mixture Models,” Journal of Guidance, Control, and Dynamics, Vol. 31, No. 6, 2008, pp. 1623–1633. https://doi.org/10.2514/1.36247 LinkGoogle Scholar[45] Jones B. A., Doostan A. and Born G. H., “Nonlinear Propagation of Orbit Uncertainty Using Non-Intrusive Polynomial Chaos,” Journal of Guidance, Control, and Dynamics, Vol. 36, No. 2, 2013, pp. 430–444. https://doi.org/10.2514/1.57599 LinkGoogle Scholar[46] Vittaldev V., Russell R. P. and Linares R., “Spacecraft Uncertainty Propagation Using Gaussian Mixture Models and Polynomial Chaos Expansions,” Journal of Guidance, Control, and Dynamics, Vol. 39, No. 12, 2016, pp. 2615–2626. https://doi.org/10.2514/1.G001571 LinkGoogle Scholar[47] Park R. S. and Scheeres D. J., “Nonlinear Mapping of Gaussian Statistics: Theory and Applications to Spacecraft Trajectory Design,” Journal of Guidance, Control, and Dynamics, Vol. 29, No. 6, 2006, pp. 1367–1375. https://doi.org/10.2514/1.20177 LinkGoogle Scholar[48] Arasaratnam I., Haykin S. and Elliott R. J., “Discrete-Time Nonlinear Filtering Algorithms Using Gauss–Hermite Quadrature,” Proceedings of the IEEE, Vol. 95, No. 5, 2007, pp. 953–977. https://doi.org/10.1109/JPROC.2007.894705 CrossrefGoogle Scholar[49] Jia B., Xin M. and Cheng Y., “High-Degree Cubature Kalman Filter,” Automatica, Vol. 49, No. 2, 2013, pp. 510–518. https://doi.org/10.1016/j.automatica.2012.11.014 CrossrefGoogle Scholar[50] Oguri K. and McMahon J. W., “Stochastic Primer Vector for Robust Impulsive Trajectory Design Under Uncertainty,” AAS/AIAA Astrodynamics Specialist Conference, AAS Paper  20-495, 2020. Google Scholar[51] Ranieri C. L. and Ocampo C. A., “Optimization of Roundtrip, Time-Constrained, Finite Burn Trajectories via an Indirect Method,” Journal of Guidance, Control, and Dynamics, Vol. 28, No. 2, 2005, pp. 306–314. https://doi.org/10.2514/1.5540 LinkGoogle Scholar[52] Kelley H. J., “Method of Gradients,” Mathematics in Science and Engineering, Vol. 5, Academic Press, Cambridge, MA, 1962, pp. 205–254. https://doi.org/10.1016/S0076-5392(08)62094-9 Google Scholar[53] Denham W. F. and Bryson A. E., “Optimal Programming Problems with Inequality Constraints. II—Solution by Steepest-Ascent,” AIAA Journal, Vol. 2, No. 1, 1964, pp. 25–34. https://doi.org/10.2514/3.2209 LinkGoogle Scholar[54] Teo K. L. and Jennings L. S., “Nonlinear Optimal Control Problems with Continuous State Inequality Constraints,” Journal of Optimization Theory and Applications, Vol. 63, No. 1, 1989, pp. 1–22. https://doi.org/10.1007/BF00940727 CrossrefGoogle Scholar[55] Nocedal J. and Wright S. J., “Interior-Point Methods for Nonlinear Programming,” Numerical Optimization, Springer, New York, 2006, pp. 563–597, Chap. 19. https://doi.org/10.1007/978-0-387-40065-5_19 Google Scholar[56] Hestenes M. R., “Multiplier and Gradient Methods,” Journal of Optimization Theory and Applications, Vol. 4, No. 5, 1969, pp. 303–320. https://doi.org/10.1007/BF00927673 CrossrefGoogle Scholar[57] Bertsekas D. P., “The Method of Multipliers for Inequality Constrained and Nondifferentiable Optimization Problems,” Constrained Optimization and Lagrange Multiplier Methods, Elsevier, New York, 1982, pp. 158–178, Chap. 3. https://doi.org/10.1016/B978-0-12-093480-5.50007-6 Google Scholar[58] Sims J. A. and Flanagan S. N., “Preliminary Design of Low-Thrust Interplanetary Missions,” AAS/AIAA Astrodynamics Specialist Conference, American Astronautical Soc. Paper  99-338, 1999. Google Scholar[59] Gill P. E., Murray W. and Saunders M. A., “SNOPT: An SQP Algorithm for Large-Scale Constrained Optimization,” SIAM Journal on Optimization, Vol. 12, No. 4, 2002, pp. 979–1006. https://doi.org/10.1137/S1052623499350013 CrossrefGoogle Scholar[60] Clevert D.-A., Unterthiner T. and Hochreiter S., “Fast and Accurate Deep Network Learning by Exponential Linear Units (ELUs),” arXiv:1511.07289, 2015. Google Scholar[61] Barron J. T., “Continuously Differentiable Exponential Linear Units,” arXiv:1704.07483, 2017, pp. 1–2. Google Scholar[62] Taheri E. and Junkins J. L., “Generic Smoothing for Optimal Bang-Off-Bang Spacecraft Maneuvers,” Journal of Guidance, Control, and Dynamics, Vol. 41, No. 11, 2018, pp. 2470–2475. https://doi.org/10.2514/1.G003604 LinkGoogle Scholar[63] Junkins J. L. and Taheri E., “Exploration of Alternative State Vector Choices for Low-Thrust Trajectory Optimization,” Journal of Guidance, Control, and Dynamics, Vol. 42, No. 1, 2019, pp. 47–64. https://doi.org/10.2514/1.G003686 LinkGoogle Scholar[64] Yan H. and Wu H., “Initial Adjoint-Variable Guess Technique and Its Application in Optimal Orbital Transfer,” Journal of Guidance, Control, and Dynamics, Vol. 22, No. 3, 1999, pp. 490–492. https://doi.org/10.2514/2.7631 LinkGoogle Scholar[65] Taheri E., Li N. I. and Kolmanovsky I., “Co-State Initialization for the Minimum-Time Low-Thrust Trajectory Optimization,” Advances in Space Research, Vol. 59, No. 9, 2017, pp. 2360–2373. https://doi.org/10.1016/j.asr.2017.02.010 CrossrefGoogle Scholar[66] Scheeres D. J., McMahon J. W., French A. S., Brack D. N., Chesley S. R., Farnocchia D., Takahashi Y., Leonard J. M., Geeraert J., Page B., Antreasian P., Getzandanner K., Rowlands D., Mazarico E. M., Small J., Highsmith D. E., Moreau M., Emery J. P., Rozitis B., Hirabayashi M., Sánchez P., Van wal S., Tricarico P., Ballouz R.-L., Johnson C. L., Al Asad M. M., Susorney H. C. M., Barnouin O. S., Daly M. G., Seabrook J. A., Gaskell R. W., Palmer E. E., Weirich J. R., Walsh K. J., Jawin E. R., Bierhaus E. B., Michel P., Bottke W. F., Nolan M. C., Connolly H. C. and Lauretta D. S., “The Dynamic Geophysical Environment of (101955) Bennu Based on OSIRIS-REx Measurements,” Nature Astronomy, Vol. 3, No. 4, 2019, pp. 352–361. https://doi.org/10.1038/s41550-019-0721-3 CrossrefGoogle Scholar[67] Hesar S. G., Scheeres D. J. and McMahon J. W., “Sensitivity Analysis of the OSIRIS-REx Terminator Orbits to Maneuver Errors,” Journal of Guidance, Control, and Dynamics, Vol. 156, No. 1, 2016, pp. 3747–3766. https://doi.org/10.2514/1.G002058 Google Scholar[68] Scheeres D., “Orbit Mechanics About Asteroids and Comets,” Journal of Guidance, Control, and Dynamics, Vol. 35, No. 3, 2012, pp. 987–997. https://doi.org/10.2514/1.57247 LinkGoogle Scholar[69] Broschart S. B., Lantoine G. and Grebow D. J., “Quasi-Terminator Orbits Near Primitive Bodies,” Celestial Mechanics and Dynamical Astronomy, Vol. 120, No. 2, 2014, pp. 195–215. https://doi.org/10.1007/s10569-014-9574-3 CrossrefGoogle Scholar[70] Oguri K. and McMahon J. W., “Risk-Aware Mission Design for In Situ Asteroid Exploration Under Uncertainty,” 2021 IEEE Aerospace Conference, Inst. of Electrical and Electronics Engineers, New York, 2021, pp. 1–17. https://doi.org/10.1109/AERO50100.2021.9438479 Google Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Neural-Based Predictive Control for Safe Autonomous Spacecraft Relative Maneuvers",
        "url": "https://arc.aiaa.org/doi/10.2514/1.G005481",
        "date": "20210913",
        "content": "I. IntroductionDistributed space systems composed of several microsatellites flying in formation are becoming increasingly attractive for the space community. As the number of satellites increases, an unprecedented level of autonomy is required to perform guidance, navigation, and control (GNC) tasks for formation maintenance and reconfiguration. Model-predictive control is a powerful control strategy that, if combined with convex programming, guarantees optimality and closed-loop control for trajectory generation and control actuation. It has already been studied for distributed reconfiguration [1,2]; nevertheless, such planning algorithms are dependent on the accuracy of the dynamic model and they might fail if the on-board dynamic model does not include correct gravitational models, perturbations, or other nonlinear terms. To maintain a high level of accuracy in the dynamic modeling used for planning, as well as a low computational effort, there is a need for an adaptive algorithm that can cope with partially known environment, whose computational burden does not scale linearly with the modeling accuracy. Classic reinforcement learning and meta-reinforcement learning have become truly powerful lately, due to their generalization capabilities. Nevertheless, this paper proposes a different approach that is based on hybrid solutions, featuring both Artificial Intelligence (AI) methods and classical algorithms. One reason is that classic reinforcement learning requires huge and extensive training campaign where thousands of episodes are presented to the agent to be able to learn the correct actions. The reward drives the learnt policy, so maintaining an analytical structure of the cost function avoids the need for retraining the agent if the reward was different. In addition, the meta-reinforcement learning approach would certainly be able to handle the collision avoidance constraint. For instance, Gaudet et al. [3] demonstrated that the agent learns to quickly adapt to novel control problems by learning over a wide range of scenarios. Nevertheless, the scenario of distributed collision-free reconfiguration with different target state may lead to nearly infinite configurations that could challenge the reinforcement learning paradigm. For this reason, in this work, only one block (dynamics reconstruction) is left to AI-based method coupling the classical framework.The proposed model-based reinforcement learning (MBRL) is developed for controlling a formation configuration and generating trajectories for distributed reconfigurations. This approach enables autonomous quasi-optimal reconfiguration in unknown or unmodeled environments as well as fuel-efficient control strategies for formation maintenance, leveraging the incremental knowledge of the environment.In a distributed architecture no information is globally available to all agents regarding the planning of each element; therefore each spacecraft needs to predict future maneuvers of potentially colliding agents. Each spacecraft can only measure the relative state. When an impulsive reconfiguration is performed, there are no means to estimate the future trajectory of neighboring spacecraft. Usually, the collision avoidance constraint is enforced by assuming the formation to evolve naturally or along predefined trajectories, which are known by the system [4,5]. Such assumption is quite restricting when dealing with systems that implement a distributed GNC architecture. The consequence is that the maneuvers may be executed by one spacecraft at a time, preventing the formation to evolve simultaneously. Two novel approaches are here presented to solve the shortcoming and enable the formation to maneuver safely and simultaneously, namely, inverse reinforcement learning (IRL) and long short-term memory (LSTM) network trajectory forecasting. IRL is employed for impulsive trajectory prediction of neighboring satellites. Such method was originally developed for imitation learning [6], and then extended to learn demonstrated behaviors and the underlying cost function [7]. Demonstrations of practical real-world performance with three applied case studies have been given recently [7,8]. Concerning space applications, Linares and Furfaro [9] proposed an approach based on IRL to determine the behavior of space objects. The IRL method requires a user-defined cost function structure. Moreover, the method becomes more accurate as the number of observations and predictions grows. To improve the capability of the algorithm for short-term scenarios, a complementing method is based on LSTM recurrent neural networks (RNNs), which is trained sequentially to predict the temporal behavior of the observed states. The algorithm scheme used in this paper is shown in Fig. 1. Concerning the whole algorithm architecture, the main features are as follows: Each spacecraft senses the environment with relative measurements and learns the underlying dynamics by supervised learning.Each spacecraft observes the others, and it performs LSTM-IRL and feeds such predictions to the collision avoidance path constraint used in the MBRL.Each spacecraft plans its own reconfiguration trajectory using MBRL, which performs an optimization exploiting the dynamics reconstructed by supervised learning. The model is encapsulated in an artificial RNN. The collision avoidance constraint takes as input the predicted trajectory of neighboring agents.The justification for this work and the goal of the paper is to develop an algorithm that addresses the following features: To develop a neural-based reconstruction algorithm for system dynamics identification, which allows an autonomous spacecraft to refine the on-board dynamic model as it flies, coping with unmodeled perturbations and nonlinearities. It is achieved by supervised learning of an RNN.To develop a planning algorithm that can adapt to the perturbed environments using the neural reconstructed dynamics. This prevents the failure of traditional algorithms in the presence of unmodeled terms in the dynamic model enhancing the autonomy and flexibility of the spacecraft. The task is performed using the developed MBRL method.To develop a relative trajectories prediction algorithm to ensure collision-free simultaneous reconfigurations. This is required when coordinated maneuvers are needed, where the hypothesis of the formation evolution according to natural dynamics does not hold. The neighboring trajectories are predicted by IRL and LSTM to guarantee safe reconfigurations.Fig. 1 Overall algorithm architecture for neural-based planning and control for collision-free coordinated spacecraft reconfigurations.The paper is divided into four main sections. Section II describes the MBRL algorithm. Section III describes the trajectory prediction algorithms for collision-free maneuvers. Section IV presents the results for the numerical validation. Finally, Sec. V draws the conclusions.II. Model-Based Reinforcement Learning for Trajectory PlanningA. Spacecraft Formation Dynamics LearningAn RNN is employed for dynamics reconstruction. Let us assume having a system that evolves according to the equation x˙=F(x,u). Furthermore, it is assumed that the observation is equal to the state for the sake of simplicity, i.e., y=x. The algorithm can easily be extended to different measurement models by introducing the measurement function h(x) or its linear matrix version H. The system dynamics can be learned using an artificial RNN trained by standard Levenberg–Marquardt backpropagation algorithm. One effective strategy is to use an analytical model coupled with an ANN to reconstruct uncertain constant parameters (e.g., spherical harmonics coefficients in [10]). Another approach is to couple the neural network with an estimation algorithm to reconstruct only the perturbation terms, taking as basis the linearized natural dynamics [11,12]. Differently from the above methods, here the whole dynamics is encapsulated into an artificial neural network (ANN). The neural dynamics reconstruction lies on the theoretical foundation of the universal approximation theorem of ANNs [13]. Recurrent networks have the capability of handling time-series data efficiently. The connections between neurons form a directed graph, which allows an internal state memory. This enables the network to exhibit temporal dynamic behaviors. When dealing with dynamics identification, it is crucial to exploit the temporal evolution of the states; hence RNN shows superior performances with respect to multilayer perceptron (MLP), as shown in Fig. 2 and 3 [14]. In detail, a nonlinear autoregressive exogenous model (NARX) recurrent network is employed. It is worth remarking that the NARX model uses control action as inputs and state as output, given a certain n-delay of the training data. The n-delay of the training data means that the network is fed with an n-long sequence of precedent states. The NARX network shown in Fig. 4 is particularly suited for the task, being able to make prediction when used in closed-loop architecture. Figure 2 shows the different propagation of the feed-forward (MLP), a standard layer-recurrent neural network (LRNN), and the proposed NARX, pretrained equally. The reference orbit is a 6 a.m.–6 p.m. sun-synchronous orbit of 775 km altitude; the initial relative state is δχ=[1001002003002000]/a expressed in relative orbital elements. The prediction position and velocity accuracy, compared with the analytical unperturbed nonlinear (NL) and J2-perturbed model (NL-J2), demonstrates the superior performance of recurrent networks in dynamics reconstruction. The offline pretrained NARX is constantly updated on-board while performing operations, as described later [see Eq. (1)]. Figure 3 shows the improvement for the same open-loop prediction of N=100 planning steps between the pretrained network (offline) and the network generated after performing one reconfiguration simulation. It is important to remark that the prediction reported in Fig. 3 is open loop, namely, a forward propagation, which is not representative of the closed-loop use of the network in the guidance and control algorithm. As the agents keep performing relative orbital maneuvers, the knowledge of the actual dynamics is refined online, which can be used for an incremental performance planning. The NARX network is a two-layer, two-step delay with the 10−6 neurons shown in Fig. 4. The process of learning can be initiated off-line based on one of the well-known relative dynamic model. The pretraining is performed presenting to the network a set of 1000 trajectories generated using the Clohessy–Wiltshire model. The dynamic model can be represented as xk+1=F˜Ts(xk,uk), where the transition matrix is associated to the sampling time Ts. The model is learned using the network N˜Ts trained by backpropagation. In this paper, the well-established Levenberg–Marquardt algorithm is employed for minimizing: minw∑k‖N˜Ts(x,u,w)−yk+1‖2(1)where N˜ is the ANN model at the current learning step, hence the dependency on the weights w. The vector y is the observation vector, here assumed to be equal to the state x.Fig. 2 Comparison between NARX, LRNN, and MLP dynamic propagation in the local-vertical–local-horizontal frame. The plot demonstrates the superior performance of RNN for dynamics reconstruction using coarse initialization training.Fig. 3 Comparison between pretrained (offline) and refined (online) network prediction for N=100 planning steps.Fig. 4 Nonlinear autoregressive exogenous model used for on-board dynamic model reconstruction.B. Neural Planning and ControlModel predictive control (MPC) is an optimization-based guidance and control strategy that merges the advantage of optimization and closed-loop control [1]. Typically, the objective function includes the quadratic difference between the target state and the spacecraft state, xk at each time step, and a quadratic term representing the control effort [1], as in Eq. (2). J(xk,uk)=[(xk+N−xk*)TS^(xk+N−xk*)+∑i=1N−1(xk+i−xk*)TS(xk+i−xk*)+∑i=0N−1uk+iTRuk+i](2)where S and R are positive semidefinite matrices, S^ is the solution of the discrete algebraic Riccati equation (DARE), N is the number of prediction steps, k indicates the current time step, and i indicates the time steps within the receding horizon. At each time step, the optimization problem can be expressed as minu  J(xk,uk)subject to  xk+i+1=F˜Ts(xk+i,uk+i),i=1,…,Numin<ui<umax,i=1,…,N1−(xp,k+i−xj,k+io)TP(xp,k+i−xj,k+io)<0,i=1,…,N,j=1,…,m,j≠p(3)where k indicates the current time step, and i the time step within the receding horizon. The last constraint refers to the collision avoidance and will be thoroughly discussed in Sec. III. Hence, the objective function is minimized taking into account the dynamics constraint and the maximum thrust limit. The optimization variable is the control history Uk, which is the set of control actions for each time step within the receding horizon. Uk=[uk,…,uk+N−1] is a stacked vector containing the decision variables for the optimization problem, namely, the control action for each discretization time step. The MBRL (or neural-model predictive control) exploits the neural dynamics reconstruction presented in Sec. II.A to enhance the robustness, effectiveness, and flexibility of the traditional MPC. The difference is that the dynamic model used in the optimization is encapsulated in an ANN model. The latter is mathematically tractable, and it adapts continuously as the spacecraft flies. In its pretrained form, the AI model approximates the linear dynamics (i.e., Clohessy–Whiltshire model). In the MBRL framework, the dynamics used in the MPC in Eq. (3) is replaced by the neural model Ns. Such strategy creates a highly coupled learning and planning algorithm that resembles the approach of reinforcement learning but does not prevent the exploitation of the underlying physics. As anticipated, the controller is extended to feature the collision avoidance constraint. The constraint is nonlinear; hence the problem transforms into a quadratic optimization with nonlinear constraints. In this paper the MBRL is compared with a traditional MPC controller. The MPC implementation uses the same optimal control problem of MBRL, namely, the same cost function and constraints. The analytical dynamic model used is the Clohessy–Whiltshire linearized dynamics. Both approaches are solved using sequential quadratic programming (sqp). The sqp has been selected for the medium-scale problem in the receding horizon optimization as well as for its efficiency and robustness.III. Relative Trajectory Prediction for Collision AvoidanceAs stated in Sec. I, one critical task for distributed operation is to safely maneuver avoiding collision between agents. The distributed architecture does not allow the agents to communicate their own state, planned trajectories, and target position to the other elements of the formation. This means that when the satellites perform impulsive maneuvers they have no means to predict the relative trajectories of the other agents. It is critical that, based on few relative observation between agents, the reconfiguration trajectory of neighboring satellites could be predicted. In this way, collision avoidance constraints can be taken into account by the each spacecraft’s MBRL algorithm in the shape of a keep-out-ellipsoid. The path constraint for satellite p is added as 1−(xp,k+i−xj,k+io)TP(xp,k+i−xj,k+io)<0,i=1,…,N,j=1,…,m,j≠p(4)where m is the number of agents, k indicates the current time step, and i indicates the time step within the receding horizon. The xj,k+io vector is the predicted trajectory derived by the collision avoidance algorithm. The nonconvex constraint in Eq. (4) is convexified by unfolding the ellipsoid into a tangent plane, as done in previous work [14]. Convex optimization guarantees the convergence of the algorithm to a global minimum. As the number of satellites grows, the constraint becomes more challenging to fulfill, given that the set of feasible positions reduces dramatically. IRL and LSTM are two methods for generating predictions of future trajectories based on few observations. The two approaches were thought to be used interchangeably; nevertheless, the results will show the benefit of coupling the two algorithms. The methods addressing the collision avoidance are focused on the prediction of impulsive trajectories of neighboring agents. The planning itself is carried out by MBRL, aided by the prediction made by the IRL-LSTM. At each GNC time step, the IRL runs to generate the neighboring agents’ trajectory prediction; such prediction is fed to the MBRL that uses the trajectory prediction to incorporate the convexified collision avoidance constraint.A. Inverse Reinforcement LearningIn general, the cost function of an optimal control problem for trajectory planning in the horizon (t, T) can be described as the summation of a running intermediate cost and the terminal state penalty. The cost function can be recast into a feature-based expression where the cost is a linear combination of f nonlinear features. In principle, each state–control pair can represent a feature. In this paper the optimizer is described as an optimization over a linear combination of features ϕ, which represent cumulative cost along feasible trajectories and terminal state penalty. The feasible trajectories are those respecting optimization constraint and dynamics: the set of state–control pairs represents a policy π, borrowing a term from the reinforcement learning world. Using such approach, the cost function can be rewritten [6]: w=[w1,w2,…,wf,wT]T,μ(π)=[{∑tT−1ϕ(xt,ut)}1,…,fϕT(xT)]→cost:J=wT⋅μ(π)(5)The above formulation is necessary to introduce and discuss the feature matching approach (FMA) for IRL.1. Feature-Matching ApproachThe concept of IRL is to estimate a cost function that delivers an optimal trajectory compatible with an expert demonstrated trajectory, called γ˜={(xt,ut)}tT for simplicity. The demonstrated trajectory is the reconfiguration path followed by the neighboring agents. The estimated cost function translates into trajectories through the application of an optimal control problem. Such optimal control problem is hand-crafted: in this paper, the MBRL described above is used as planner, where the control history (i.e., control action for each horizon step) is the only decision variable. It is important to note that the expert cost function, parametric in the set of features, is not known, but we assume the demonstration to be optimal for the estimated one. Each trajectory is generated by a policy π, which characterizes the state–control pairs at each instant in time, ideally. In detail, given a set of No observations of the demonstrated trajectory Dγ˜={(xi,ui)}i=1No we need to find a cost function J, under which the demonstrated trajectory looks optimal according to the estimated cost function. It means that the demonstrated trajectory is the result of an optimization of a certain cost function that we want to estimate, namely, the expert cost function. FMA solves for the weights in Eq. (5) by attempting to match the cumulative feature cost demonstrated by the expert under the optimal policy π˜ and the policy π* based on the estimated cost function. The FMA can be expressed in compact form: J(γ˜|π˜)<J(γ|π)→wT⋅μ(π˜)<wT⋅μ(π),∀  γ,π(6)where it is stated that the demonstrated trajectory is optimal with respect to the estimated cost function. The demonstrated trajectory owns significant information about the structure of the cost function; hence the algorithm significantly benefits if the discrepancy between estimated optimal trajectory and expert one is integrated in the optimization [15,16]. Loss augmentation represents a cost gap structured margin: Lγ˜(π)=∑i=1No‖x˜i−xi‖2. By inserting the loss augmentation in Eq. (6) we obtain the expression for the FMA for IRL: minw  ‖w‖2subject to  wT⋅μ(π˜)<wT⋅μ(π)−Lγ˜(π)(7)Equation (7) represents a convex optimization. Nevertheless, the set of policies the algorithm sweeps is theoretically not finite. This makes the optimization intractable, in particular for computational constraints of several interesting applications in spacecraft GNC. We may suppose that there exists a policy π* that minimizes the right-hand side of the constraints in Eq. (7). Then, the constraints in Eq. (7) can be written as wTμ(π˜)<minπ{wTμ(π)−Lγ˜(π)} without any loss of generality. We can place the constraint into the cost function. This yields an unconstrained optimization, which can be solved using gradient-based algorithms: minwη2‖w‖2+(wTμ(π˜)−minπ{wTμ(π)−Lγ˜(π)})(8)where η is a user-defined coefficient. The FMA-IRL is actually a nested optimization problem. The outer loop is unconstrained, whereas the inner loop, which is a path-planning optimization, may be constrained, both linearly and nonlinearly. The cumulative feature cost for the formation spacecraft trajectories can be expressed as μ(π)=[XkTSsXkUkTRrUk(FXk)TS^(FXk)](9)where Xk, Uk, Ss, and Rr are the stacked vectors and matrices to shorten the summation in Eq. (5). Note that no target state guess is inserted, making the formulation insensitive to such parameter. The target state guess is a priori estimation of the target state, i.e., the objective state of the formation. From Eq. (9), the weights vector is w=[ws,wr,ws^]T.2. Inner Loop: Fast Quadratic Programming Model Predictive ControlThe nested optimization resulting from the FMA for trajectory prediction relies on an inner loop, calculating the trajectory generated by the estimated cost function. The inner policy evaluation is performed using a fast MPC recast in quadratic programming (QP) formulation. Such strategy allows a rapid convergence of the inner loop, limiting the computational burden of the whole algorithm. In particular, the MPC resembles the architecture presented in Sec. II with the additional term entailing the gap structured margin Lγ˜(π). The proposed implementation uses the Clohessy–Whiltshire linearized natural dynamics for state prediction. In general, this approach can be extended to a neural reconstructed dynamics. The QP formulation is minUk 12UkTQUk+HUksubject to  VUk<W(10)where Uk=[uk,…,uk+N−1] is a stacked vector containing the decision variables for the optimization problem, namely, the control action for each discretization time step. The matrices of the QP formulation can be written as Q=2wrRr+2ws^ΩTSs^Ω−2ΩPpΩ and H=2x^kTΨSs^Ω+2XγPpΩ, where Xγ is the stacked vector of the demonstrated trajectory, Pp is a stacked identity matrix. The matrices Ω and Ψ represent the stacked state transition matrix and control matrix for the linearized relative dynamics. The demonstrated trajectories for each agent is generated using the MBRL approach. Each agent demonstrates its own trajectory to all the other elements of the formation.3. Outer Loop: Unconstrained OptimizationThe cumulative feature cost is a function of the policy, which is basically the sequence of control action output of the MBRL. The inner loop generates an optimal policy (control action sequence) based on the current estimate of the cost function (current weights). The optimal policy is used to calculate the cumulative feature cost used in Eq. (8). The outer loop is a convex unconstrained minimization problem that can be solved by quasi-Newton methods with gradient descent. In the proposed implementation, the gradient reads ∇w=ηw+(μ(π˜)−μ(π)), which completes the FMA-IRL algorithm.B. Neural-Sequential Trajectory ForecastingThe trajectory prediction for collision avoidance based on IRL is a promising algorithm, which delivered good results during the numerical validation test campaign. Although IRL is simple and effective, it presents two drawbacks for working out the delicate task: The cost features have carefully been designed by analyzing the dynamics of the spacecraft. In particular, it is assumed that all the spacecraft executes the formation reconfiguration using an MBRL algorithm with the same cost function.The unknown cost function is assumed to be quadratic in the control effort; hence at least an estimate of the observed control thrust impulse is required. A possible way to solve this issue is approximating the control term by a discrete velocity differential between two subsequent observations, provided that they are close in time.As stated above, recurrent networks have the capability of handling time-series data efficiently. From this premises, the use of RNN can be extended also for trajectory identification of neighboring satellites. Differently from the dynamics reconstruction used in MBRL, the network for neighboring satellites, does not need the control input, because it tries to estimate the future trajectory by only observing the relative state. The type of RNN used for neighboring satellites trajectory prediction is an LSTM network [17]. The LSTM network is used for on-board prediction of future state given the observed trajectory history (i.e., observed relative measurements). In this paper, a sequence of observed relative states is used to perform the online training. As the number of observations grows, the prediction becomes more accurate; nevertheless, even limited observations (e.g., as low as 10) guarantee an acceptable prediction for the short-term horizon. The LSTM can be trained to make predictions based on time sequence data. Given the demonstrated trajectory γ˜={(xt,ut)}tT, where we neglect the control ut, the proposed sequential supervised learning is performed by feeding the network with the gathered input states and compared with the same states shifted of one time step: namely, xin,LSTM={γ˜}(t,t+(N−1)⋅Ts) and yout,LSTM={γ˜}(t+TS,t+N⋅Ts). To obtain a more robust fit and to prevent the training from diverging, it is required to standardize the training data to have zero mean and unit variance.Finally, the complete algorithm reads as Algorithm 1.IV. Numerical Simulations and ResultsThe proposed algorithm architecture is reported in Fig. 1 and tested in two application scenarios, representative of in-plane and out-of-plane relative reconfiguration. The selected scenarios are tight formations with 1 N thrust limit, requiring constant relative position and velocity control to satisfy the strict requirements on relative states. The error with respect to the target state is indicated as σp=‖x−x*‖. A summary of the employed neural networks is reported in Table 1. The numerical simulations features are as follows: Each spacecraft plans its own trajectory using the MBRL algorithm. The planner entails a collision avoidance constraint in the optimization scheme. The guidance and control sample time is 60 s. Each spacecraft measures only the relative state of all the other agents of the formation. The predicted trajectories of each neighboring satellites are delivered by the LSTM and IRL algorithms and are fed to the constrained MBRL.The true dynamics used to carry out simulations is a fully nonlinear J2-perturbed relative model with respect to the reference orbit reported in Table 2.The simulation is stopped when the target configuration is reached, i.e., when position and velocity errors are below 10 m and 0.1  m/s, respectively.A. In-Plane ManeuverThree satellites fly in rigid formation, i.e., a formation in which the relative distances and orientation among the satellites remain fixed. The aperture plane is perpendicular to the orbital plane. The initial condition consists in the three satellites at the vertices of an equilateral triangle of 13 m side lying on y-z plane. Yaw rotations of the aperture plane are possible as long as the relative formation between the arrays is kept. The numerical results for a yaw rotation of 30°, shown in Fig. 5, are reported in Table 3. For close reconfiguration, the MBRL outperforms the traditional MPC in terms of both fuel consumption and time of flight, as reported in Table 3. The required Δv is ∼5% lower when using MBRL. It is interesting to test the algorithm in a hypothetical scenario where the relative distances are two orders of magnitude larger. The difference in accuracy and required Δv between the compared algorithms becomes more significant, as shown in Fig. 6. This is because nonlinearities become more and more relevant as the formation grows in size. The MBRL uses the neural reconstructed dynamics that captures these unmodeled terms.Fig. 5 Formation reconfiguration following 30° yaw rotation of the synthetic aperture.Fig. 6 Large reconfiguration following 30° yaw rotation of the synthetic aperture.B. Out-of-Plane ManeuverThe cross-track formation can be achieved by fixing the relative position or exploiting natural relative orbits, which owns a cross-track harmonic motion. The relative orbital elements, in particular δe and δi, completely define the central bounded relative orbit [18,19]. The simulated reconfiguration is a transfer between two cross-track relative orbits with parallel and perpendicular relative inclination/eccentricity vector, namely, from δe⊥δi to δe∥δi with aδi=aδe=2  km. In such reconfiguration, far from the target, the MPC fails in trajectory control and the controller diverges, whereas MBRL completes the reconfiguration using Δv∼30  m/s, as shown in Fig. 7. The MPC failure is due to the large distance and the cross-track requirement, which is different from the other test cases. Nevertheless, if one could know beforehand the environment, the MPC could be tuned to solve the reconfiguration successfully. The main point is that, if an MPC scheme (with its associated tuned parameters) is used without modifications in all the scenarios, the output can fail given the low adaptivity. The MBRL still uses the same tuning for all the scenarios presented, but it is still able to perform all the reconfigurations successfully.Fig. 7 Cross-track reconfiguration from δe⊥δi to δe∥δi with aδi=aδe=2  km.C. Collision Avoidance AlgorithmsTwo algorithms have been presented to cope with the lack of knowledge on the neighboring satellites trajectories while performing reconfiguration. If the formation is reconfiguring using impulsive maneuvers, the zero-impulse natural dynamics is no longer valid; indeed the keep-out-zone limit may often intersect, violating the constraint due to wrong trajectory prediction. Figure 8 shows a challenging reconfiguration where the spacecraft swap the along track positions separated by 200 m. As shown, the relative distance between the satellites falls below the keep-out-zone limit of 100 m when the prediction of neighboring agents is carried out using natural dynamics. On the other hand, coupling the MBRL planner with an impulsive trajectory identification algorithm, such as IRL, allows a safe reconfiguration.The comparison simulation consists of a sample of No observation of a neighboring satellite’s trajectory. These observations are processed by the IRL algorithm to approximate a cost function, whose optimization delivers a predicted trajectory shown in Fig. 9. Simultaneously, the observations are used to train the LSTM network, which predicts future states. The number of prediction is set to Np=5, whereas No=10. The two algorithms are beneficial with respect to natural dynamics prediction for controlled reconfiguration, used in literature. The prediction accuracy for the proposed architecture is <10  m compared with ∼100  m if using prediction based on the system natural dynamics evolution. A more comprehensive analysis has been conducted to map the behavior of the algorithm for different combination of Np and No in the same scenario described before. Figure 10 shows the difference in the presented algorithms. On the one hand, short-horizon predictions based on few observations are better resembled using LSTM. On the other hand, the IRL accuracy is higher when a larger observation set is used. A combination of the two approaches may be the best solution. The simulations are run using a laptop computer using Intel Core i7-6500U [email protected] GHz. The computational time is very limited for IRL ∼1  s, whereas the network takes approximately ∼2.5  s to perform the training. The computational burden scales linearly with the number of satellites, given that each trajectory prediction is based on disjoint sets of observations. Nevertheless, as mentioned in Sec. III, a large number of collision avoidance constraints (one for each agent) poses threats to the algorithm convergence. All the numerical routines can be optimized for on-board implementation. One important remark is that RNNs currently lack deep support for the implementation on space-grade boards; thus it is expected that the computational loads results may significantly improve.Fig. 8 Close intersecting reconfiguration. The relative distances between the agents are shown. MBRL-ND coupled with natural dynamics prediction for collision avoidance violates the constraints during close approach.Fig. 9 Neighboring satellite’s trajectory. Predicted trajectories based on IRL, LSTM, and natural dynamics are shown in colored dots. The error plot is shown on the right.Fig. 10 Map of RMS error of the neighboring agent trajectory prediction based on Clohessy-Wiltshire (CW) model, IRL algorithm, and LSTM, left to right, as a function of the number of observations and predictions.V. ConclusionsThis paper presents an innovative strategy for the guidance and control of distributed formation solving the shortcomings that arise from the incomplete representation of the dynamic environment as well as the lack of knowledge of future trajectories of neighboring satellites during coordinated maneuvers. The trajectory and control is generated using an MBRL approach. Two algorithms, namely, IRL and LSTM network, are explored to guarantee collision-free operations. IRL reconstructs the cost function of each agent and predicts trajectories of concurring agents during the reconfiguration. The second method exploits an LSTM recurrent network to capture the dynamics and predict the trajectory. In this way, both natural dynamics and thrust dynamics are managed when enforcing the collision-avoidance constraint. LSTM demonstrated more accurate predictions for the short-term horizon, whereas IRL for the longer-term. This result leads to the conception of a coupled architecture where the first prediction is given by the LSTM and the successive by the IRL. The results show that the proposed algorithms perform correctly and solve reconfiguration scenarios that are challenging, or even fatal, for traditional algorithms. Being computationally light, online neural-network-aided algorithms can be deployed in microsatellites, where the computational power is limited. Also, the algorithms adapt to the environment capturing the unmodeled terms delivering successful control where traditional and nonadaptive algorithms may fail.\r            References\r        [1] Wahl T. and Howell K., “Autonomous Guidance Algorithms for Formation Reconfiguration Maneuvers,” AAS/AIAA Astrodynamics Specialist Conference, Univelt, Columbia River Gorge, Stevenson, Washington, D.C., Aug. 2017. Google Scholar[2] Morgan D., Chung S. J. and Hadaegh F. Y., “Model Predictive Control of Swarms of Spacecraft Using Sequential Convex Programming,” Journal of Guidance, Control, and Dynamics, Vol. 37, No. 6, 2014, pp. 1725–1740. https://doi.org/10.2514/1.G000218 LinkGoogle Scholar[3] Gaudet B., Linares R. and Furfaro R., “Six Degree-of-Freedom Body-Fixed Hovering over Unmapped Asteroids via LIDAR Altimetry and Reinforcement Meta-Learning,” Acta Astronautica, Vol. 172, July 2020, pp. 90–99. https://doi.org/10.1016/j.actaastro.2020.03.026 CrossrefGoogle Scholar[4] Chu J., “Dynamics, Distributed Control and Autonomous Cluster Operations of Fractionated Spacecraft,” Ph.D. Thesis,  TU Delft, Delft, The Netherlands, 2015. 9789461865113. Google Scholar[5] Di Mauro G., Spiller D., Bevilacqua R. and Curti F., “Optimal Continuous Maneuvers for Satellite Formation Reconfiguration in J2-Perturbed Orbits,” 2018 Space Flight Mechanics Meeting, AIAA Paper  2018-0216, Jan. 2018, pp. 1–20. https://doi.org/10.2514/6.2018-0216 Google Scholar[6] Abbeel P. and Ng A. Y., “Apprenticeship Learning via Inverse Reinforcement Learning,” Proceedings of the 21st International Conference on Machine Learning, Assoc. for Computing Machinery, New York, 2004. Google Scholar[7] Finn C., Levine S. and Abbeel P., “Guided Cost Learning: Deep Inverse Optimal Control via Policy Optimization,” 33rd International Conference on Machine Learning, ICML 2016, Vol. 1, Journal of Machine Learning Research, New York, 2016, pp. 95–107. Google Scholar[8] Ratliff N. D., Silver D. and Bagnell J. A., “Learning to Search: Functional Gradient Techniques for Imitation Learning,” Autonomous Robots, Vol. 27, No. 1, 2009, pp. 25–53. https://doi.org/10.1007/s10514-009-9121-3 Google Scholar[9] Linares R. and Furfaro R., “Space Objects Maneuvering Detection and Prediction via Inverse Reinforcement Learning,” Proceedings of the Advanced Maui Optical and Space Surveillance (AMOS) Technologies Conference, edited by Ryan S., The Maui Economic Development Board, Inc., Sept. 2017, p. 46. Google Scholar[10] Pasquale A., Silvestrini S., Capannolo A. and Lavagna M., “Non-Uniform Gravity Field Model on Board Learning During Small Bodies Proximity Operations,” 70th International Astronautical Congress (IAC 2019), International Astronautical Federation (IAF), Washington, D.C., 2019, pp. 1–11. Google Scholar[11] Pesce V., Silvestrini S. and Lavagna M., “Radial Basis Function Neural Network Aided Adaptive Extended Kalman Filter for Spacecraft Relative Navigation,” Aerospace Science and Technology, Vol. 1, Jan. 2019, Paper 105527. https://doi.org/10.1016/j.ast.2019.105527 Google Scholar[12] Silvestrini S. and Lavagna M., “Neural-Aided GNC Reconfiguration Algorithm for Distributed Space System: Development and PIL Test,” Advances in Space Research, Vol. 67, No. 5, 2021, pp. 1490–1505. https://doi.org/10.1016/j.asr.2020.12.014 CrossrefGoogle Scholar[13] Haykin S., Neural Networks: A Comprehensive Foundation, 2nd ed., 1999, Pearson Education Prentice Hall, India, Chaps. 3–5. https://doi.org/10.1142/s0129065794000372 Google Scholar[14] Silvestrini S. and Lavagna M., “Model-Based Reinforcement Learning for Distributed Path Planning,” 15th Symposium on Advanced Space Technologies in Robotics and Automation, European Space Agency, European Space Research and Technology Centre, Noordwijk, The Netherlands, 2019. Google Scholar[15] Ratliff N. D., Bagnell J. A. and Zinkevich M. A., “Maximum Margin Planning,” 23rd International Conference on Machine Learning, 2006, pp. 729–736. https://doi.org/10.1145/1143844.1143936 Google Scholar[16] Taskar B., Guestrin C. and Koller D., “Max-Margin Markov Networks,” Advances in Neural Information Processing Systems 16, edited by Thrun S., Saul L. K. and Schölkopf B., MIT Press, Cambridge, MA, 2004, pp. 25–32, http://papers.nips.cc/paper/2397-max-margin-markov-networks.pdf. Google Scholar[17] Hochreiter S. and Schmidhuber J., “Long Short-Term Memory,” Neural Computation, Vol. 9, No. 8, 1997, pp. 1735–1780. https://doi.org/10.1162/neco.1997.9.8.1735 CrossrefGoogle Scholar[18] Silvestrini S., Pesce V. and Lavagna M., “Distributed Autonomous Guidance, Navigation and Control loop for Formation Flying Spacecraft Reconfiguration,” 5th CEAS Conference on Guidance, Navigation and Control, CEAS, Milan, Italy, 2019, pp. 1–19. Google Scholar[19] D’Amico S. and Montenbruck O., “Proximity Operations of Formation-Flying Spacecraft Using an Eccentricity/Inclination Vector Separation,” Journal of Guidance, Control, and Dynamics, Vol. 29, No. 3, 2006, pp. 554–563. https://doi.org/10.2514/1.15114 LinkGoogle Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Visualization of Coolant Liquid Film Dynamics in Hypergolic Bipropellant Thruster",
        "url": "https://arc.aiaa.org/doi/10.2514/1.B38421",
        "date": "20210916",
        "content": "AbstractWe conduct a high-speed visualization of coolant liquid film dynamics inside a 10N-class bipropellant thruster using monomethylhydrazine and a mixture of nitrogen tetroxide with approximately 3% nitric oxide as propellants at equivalent conditions with the flight model. The direct visualization of the liquid film inside a quartz glass chamber demonstrates the transient dynamics of film flow from ignition to cutoff for the first time. The scenario for the life of the film flow is found as follows: the coolant fuel jet impinges on the chamber wall being the liquid film; the friction force from the chamber wall rapidly decelerates the film as one-tenth of the injection velocity; next, the film moves sheared by the fast combustion gas downstream; and eventually the film completely evaporates by heat transfer from the hot combustion gas. The liquid film presents the typical ripple wave structure, covered by the velocity and thermal boundary layers. The effect of the mixture ratio is significant as the film flow rate increases at a small mixture ratio, leading to the longer film length.NomenclatureDinner diameter of the chamber, mFCfilm-cooling ratehfilm thickness, mLfilm length, mm˙Ffuel mass flow rate, g/sm˙FCfilm mass flow rate, g/sm˙Ooxidizer mass flow rate, g/sMRoverall mixture ratioMRcoremixture ratio of core flowPcchamber pressure, MPaQvolumetric flow rate, m3/sReffilm Reynolds numberTfilm lifetime, sttime, sTflameadiabatic flame temperature, Kνkinematic viscosity, m2/sVfrontfilm front velocity, m/sVinjfilm injection velocity, m/sVlocallocal film velocity, m/sαthermal diffusivity of film, m2/sεexpansion ratio of the nozzleθcircumferential phase of chamber, radλwavelength of film flow, mρfilm density, kg/m3ταtimescale for temperature boundary layer, sτνtimescale for velocity boundary layer, sI. IntroductionBipropellant thrusters are widely used to control orbit and attitude for geostationary satellite buses that require higher specific impulse and larger thrust unachievable by monopropellant thrusters [1,2]. Combinations of hypergolic fuel and oxidizer, such as hydrazine or monomethylhydrazine (MMH) for fuel and a mixture of nitrogen tetroxide with approximately 3% nitric oxide (MON3) for oxidizer, eliminate complex ignition systems. In the recent and future cargo spacecraft for the International Space Station [3–6] and in planetary exploration missions for descent and ascent modules [7–9], the bipropellant thrusters keep playing an essential role. The bipropellant thrusters use a combustion chamber generally made of ceramic [10] or high-temperature heat-resistant metal, such as niobium alloy [11,12] or one of the precious metals [13,14]. Inside the combustion chamber, the fuel and oxidizer jets ejected from an injector impinge to form a liquid sheet, followed by sheet atomization, mixing, ignition, and combustion, in a sequential fashion. As schematically depicted in Fig. 1, the chamber wall must tolerate heat transfer from the hot combustion gas, exceeding 3000K; thus, a film-cooling technique is widely employed by extending a thin liquid film on the chamber inner surface by directly impinging fuel jets and spreading along as a liquid film [15]. The liquid film produced on the chamber wall elongates downstream with evaporation, developing to a certain length at the balancing point between the heat input and the latent heat, reaching a steady state at last. The chamber wall temperature in the area covered by the coolant film can remain at the saturation temperature of liquid film, avoiding direct heat input from the combustion gas. It is important for designing thrusters to retain a sufficient flow rate for the film-cooling fuel and simultaneously to minimize the film flow rate for improving specific impulse. By predicting the film extension length based on a physical understanding of the film flow dynamics, the compatible management of thermal tolerance and performance is strongly demanded.Several past studies have been devoted to liquid film dynamics. Kinney et al. [16] initiatively took snapshots of a liquid film flow in a transparent tube with a cocurrent fast hot gas, presenting the wavy film formation due to strong shear stress by the gas stream. Cherdantsev et al. [17] and Shinan et al. [18] also observed the liquid film flow sheared by a high-velocity gas stream. Inoue and Maeda [19] succeeded in the comprehensive formulation describing the unstable liquid film dynamics. Stechman et al. [20] tried to predict the film length based on heat transfer between the combustion gas and chamber wall. Shine et al. [21] proposed a one-dimensional control volume approach for a fundamental energy-balance concept. There are some semi-empirical correlations for various combinations of propellants such as hydrogen peroxide/kerosene [22] and liquid oxygen (LOX)/liquid hydrogen [23].Fig. 1 Schematics of temperature and coolant liquid film distributions inside a bipropellant thruster.One of the issues that arises is a lack of experimental data for coolant liquid film dynamics under an operating combustion condition inside a practical thruster. Yarygin et al. [24] experimentally measured the film thickness and velocity subjected to a sonic air flow by using capacitance sensors and quantified the amount of droplet entrainment. Knuth [25] conducted experiments using the hot air flow with water as the liquid coolant in a tube. Morrell [26] employed small rocket engines operating with three different coolant films: water, ethyl alcohol, and liquid ammonia. Arnold et al. [27] experimentally measured temperature distribution of a LOX/liquid methane combustor and studied the film-cooling efficiency. These studies, however, focused on the film-cooling flow at the steady states, and there have been limited experimental data available reporting the developing film dynamics before reaching the steady film length. Consequently, as recently emphasized by Shine and Nidhi [28], it is still difficult to accurately predict the film length, attributed to the limited quantitative experimental data especially for the unsteady film dynamics inside a practically operating bipropellant thruster.Therefore, in the present paper, we conduct a high-speed optical measurement inside a quartz glass chamber, quantifying the coolant liquid film dynamics and the film length exposed to the hypergolic combustion gas stream. Based on the experimental results, we investigate the effect of chamber wall, combustion gas, and evaporation on the film flow. To the best of our knowledge, this paper is the first to report the unsteady film dynamics under the same operating conditions as 10N-class practical bipropellant thrusters.II. Experimental MethodFigure 2 shows a schematic of the experimental setup. From upstream, there are two tanks for fuel and oxidizer pressurized by helium gas, solenoid valves for the respective paths, and the bipropellant thruster including the propellant valves. Detailed explanations can be found in our previous paper [29].We used the combination of MMH and MON3 for fuel and oxidizer, respectively. Table 1 shows their major properties [30,31]. For the coolant film, a higher boiling point and lower vapor pressure are preferable characteristics to be less evaporative and cover the inner wall of the combustion chamber for a longer time. This test campaign uses MMH for the coolant film as usually employed in practical thrusters.Fig. 2 Schematic of the experimental setup [29]. (Reprinted with permission from Journal of Propulsion and Power, Vol. 36, No. 5, 2020, pp. 677–684 Copyright©2020 by AIAA, Inc.)Allowing for the direct observation of the film-cooling flow dynamics, the combustion chamber is made from quartz glass, shown in Fig. 3a. The chamber is integrally manufactured with the throat and the nozzle. The inner diameter of the chamber is D=10  mm, and the expansion ratio of the nozzle is ε=8. The combustion chamber is mounted horizontally to the injector face plate by the metal holder. The film-cooling flow is visualized using a high-speed camera (Vision Research, Phantom Miro M310) through the open window of the holder from the horizontal direction of θ=0, depicted in Fig. 3b. The recording rate is 24,000 fps for self-luminous images, and 51,000 fps for backlight images. The chamber pressure is measured by a pressure transducer, KYOWA PHL-A-5MP-B, with a sampling rate of 1 kHz. The high-speed camera and the pressure transducer are synchronized with the input signal to the propellant valve.The thruster has a single unlike-impinging type injector [29] for the core spray on the central axis of the combustion chamber, and two fuel jets for the film flow on the inner chamber wall. The core fuel and the film-cooling fuel are introduced to the individual injector hole through the same valve and manifold. The timing of coolant film flow and core flow are almost the same due to the same flow velocity calculated by the mass flow rate and the area of each injector hole. The sheet of the core fan is produced on the plane of θ=0. The two injector holes for the coolant film are allocated on the opposite sides at θ=0 and π, respectively. The coolant jet collides with the chamber wall 2 mm downstream from the injector plate, spreading along the chamber wall as a liquid film. The opening response time is 2 to 3 ms [29], indicating that the film flow is in the stable condition at the last moment of 50 ms opening time. We visualize the back side of liquid film spreading in the area of −π/2<θ<π/2 from the injector face plate to the throat.Fig. 3 The quartz glass chamber.Table 2 shows the experimental conditions. All the experiments were conducted at sea level with mixture ratios of MR=1.0,1.6, and 2.1 calculated as MR=m˙Om˙F+m˙FC(1)The target chamber pressure was set to approximately 1 MPa equivalent with the flight model with the same total flow rate of (m˙O+m˙F+m˙F). The Reynolds number of the combustion gas is 3×105  in turbulent condition, based on the length scale of D and gas properties obtained by the chemical equilibrium analysis [32]. The propellant valve motion controlling the firing mode is set to 50 ms for opening time and 950 ms for closing time, with a cycle of 1000 ms. Three pulses are sequentially repeated for each MR condition. It is shown in [29] that the time history of chamber pressure is almost the same just before cutting off, therefore three pulses provide sufficient samples. In the following, the mean experimental results indicate the averaged values in the three pulses.III. Results and DiscussionTo reveal the coolant liquid film dynamics, we present visualization results of the developing coolant film dynamics and then show quantitative measurement results of the film length, velocity, thickness, and wavelength with changing MR.A. Repeatability EvaluationThe relative difference of averaged chamber pressure during stable combustion among the three pulses is 2.5%; thus, the film flow rate is being reasonably constant in the three pulses at each MR condition. Detailed repeatability of the combustion test is evaluated in [29]. We confirmed that the produced liquid film length in the present experiment was longer than the flight model of the ceramic chamber, because the large heat capacity of the thick quartz glass wall cooled the film. The trend of the film length against MR was consistent between the present glass chamber and the flight model.B. Chamber Pressure and Film ExtensionFigure 4 shows time history of the chamber pressure from ignition to cutoff at MR=1.6 and visualization results of the film-cooling flow. In Fig. 4a, the valve-opening signal to the propellant valve indicated by the dotted line is applied at t=0  ms, and ignition is detected by the pressure transducer at t=9  ms. The time lag is attributed to the dribble volume upstream of the chamber and to the pressure-sensing delay [29]. The closed circles in Fig. 4a indicate the chamber pressure corresponding to the visualization results in Fig. 4b. In Fig. 4b, the film is visible on the chamber wall in front of the combustion flame. The white circles represent the most extended film front. At t=6.7–8.7  ms, the film rapidly propagates. After that, the film gradually extends to the maximum length at t=42.1  ms, in which the film front completely evaporates by the heat transfer from the combustion gas. At t=42.1  ms, the chamber pressure becomes a steady state. The film front keeps the same position until t=50  ms at valve close. Thus, the film length can reach the steady state in the 50 ms firing duration as the chamber pressure and the combustion gas velocity reach constant. Another notable phenomenon is that the film flow extends downward as shown in Fig. 4b. The reason is that the chamber is set horizontally, resulting in the film flow being affected by gravity to extend downward.Figure 5 shows the detailed film flow being the maximum film length at t=50  ms and MR=1.6. Figure 5a shows the self-luminous image. A wavy pattern on the film is clearly confirmed up to the film front. The coolant film fully covers the combustion chamber wall at a circumferential direction of −π<θ<π. Figure 5b shows the enlarged impinging region by backlight visualization. A part of the film flows upstream of the collision point, contributing to cooling the area close to the injector face plate. We find the smooth film without the waves near the collision point until 3 mm downstream. The following wavy pattern shows the typical ripple wave, also reported by Kinney et al. [16] and Cherdantsev et al. [17] in the past, formed by superposing two types of instabilities; the Kelvin–Hermholtz instability along the axial direction is initiated by the liquid–gas velocity difference, and the following Rayleigh–Taylor instability in the transverse direction is stimulated by the acceleration of the wave crest [19]. The three-dimensional wavy film structure is clearly identified under the practical operating condition of bipropellant thrusters.Fig. 4 Transient behavior of film-cooling flow (MR=1.6).Fig. 5 Typical film flow along the chamber wall (t=50  ms, MR=1.6).C. Measurement of Film FrontThe visualization results comparing the three MR conditions at t=50  ms are presented in Fig. 6a. The white circles show the film front. As MR increases, the film flow rate decreases, leading to the shorter film length. The wavy film is consistently confirmed. Figure 6b quantifies the mean film lengths of L, with a standard deviation in the three pulses. The film extends to L=40  mm at MR=1.0, while it shortens to being L=20  mm at MR=2.1, evidencing the strong effect of the film flow rate on the film length. We quantitatively discuss the transient behavior of the film extension. The yellow line in Fig. 7a corresponds to the measurement location on θ=−π/2, where the film front is clearly identified, and the axial direction is defined as x. Here, the film front on θ=−π/2 can be shorter than the most extended length in Fig. 6. The x−t diagram of brightness on θ=−π/2 at every 2 ms is presented in Fig. 7b. The extension of the film front downstream is clearly visible for all the MR conditions. The film extends fast after ignition, gradually reaching the constant length at t=50  ms. Figure 7c shows the time series of film length and the film front velocity Vfront by measuring the position of yellow cross symbols in Fig. 7b. The film length is always longer at the smaller MR condition, and the film front velocity is slower typically at MR=2.1. The film front velocity is Vfront≈1  m/s at t=10  ms, approximately one-tenth of the injection velocity of the film fuel jet of Vinj∼O(101)  m/s. The slowly spreading film front indicates that the initial inertia force of film fuel quickly diminishes by the strong friction force from the chamber wall close to the collision point, and the film front develops driven by shear stress from the fast combustion gas stream of O(102)  m/s. After that, the value of Vfront gradually approaches Vfront=0  m/s at t=50  ms, in which the film front completely evaporates. The monotonical deceleration of Vfront suggests that the film front temperature promptly reaches the saturation temperature and continuously evaporates. The film keeps evaporating from the liquid–gas interface; thus, the film front becomes thinner, heated a longer time after injection on the wall. Then, the viscous force inside the liquid film, inversely proportional to the film thickness assuming the Couette flow [19], becomes large downstream, leading to the deceleration of the film front. The deceleration of Vfront also indicates that the effect of thinning film on Vfront overcomes the acceleration of combustion gas from t=0  ms to 50 ms.Fig. 6 The relationship between film length and mixture ratio at t=50  ms (Pc≈1  MPa).Fig. 7 Extension of film front.D. Measurement of Film BodyFigure 8 shows the distributions of local film velocities at t=50  ms, by measuring the axial movement in 0.5 ms at respective locations. Irrespective of MR, it is obvious that the film velocity rapidly decreases to approximately Vlocal=1.0  m/s at x=5  mm by losing the initial inertia force. Then, Vlocal gradually decelerates to being 0  m/s at the film front. Since the trend of Vlocal is consistent with Vfront, the effect of wettability on the film motion is insignificant, as previously reported by Yarygin et al. [24].Figure 9a shows the mean local film velocities V¯local at x>5  mm after the immediate deceleration of Vlocal with error bars suggesting a standard deviation in the three pulses. Here, we obtain V¯local≈1  m/s. The lifetime of the film from injection to completing evaporation is estimated as T∼L/V¯local∼O(10−2)  s, consistent with Fig. 7. From the film flow rate Q, V¯local, and D, we deduce the mean film thickness as follows: h=QπD⋅V¯local(2)Fig. 8 Local film velocity distribution.Figure 9b presents that the film thickness is h∼10  μm. The cross section of the film is covered by the velocity boundary layer in a timescale of τν after collision of the fuel jet on the wall, τν∼h2ν∼O(10−4)  s(3)which is much shorter than T. The corresponding axial distance is of Vinjτν∼O(10−3)  m, equivalent with the smooth film region in Fig. 5b. Analogically, the film temperature becomes saturation temperature heated by the combustion gas in a timescale of τα: τα∼h2α∼O(10−3)  s(4)Both τν and τα are enough shorter than T, demonstrating that the film is a thin film, fully covered by the boundary layer of velocity and temperature. The film continuously evaporates, leading to thinning and deceleration, consistent with the previous discussion, demonstrated in Figs. 7 and 8. The axial distance reaching the saturation temperature is estimated as Vinjτν+V¯local(τα−τν)∼O(10−3)  m, coinciding with less than 10% of L; thus, the film starts to evaporate soon after the collision from the liquid–gas interface.Fig. 9 Film flow characteristics at x>5  mm.E. WavelengthThe film is not smooth but forms a wavy structure, as demonstrated in Fig. 10a. In this figure, there are five wave crests visible along the axial directions as depicted by the lines, induced by the Kelvin–Helmholtz instability. Figure 10b shows the mean values of axial wavelength λ with a standard deviation. The film has instability waves of λ≈1  mm, much longer than the film thickness. The film Reynolds number is Ref=Vlocalh/v∼10, in which the effect of viscosity on the instability is insignificant, and λ is determined by boundary-layer thickness of the gas stream and density ratio of liquid to gas [19,33], whose values are consistent under the same chamber pressure. As the result, λ is independent of MR.F. Transient Behavior of Film FlowFrom the preceding discussion, we summarize the sequential scenario for the transient behavior of film flow, as schematically shown in Fig. 11. The coolant jet collides with the chamber wall.The injected liquid jet with Vinj∼O(101)  m/s impinges on the chamber wall.The coolant film decelerates rapidly.After the impingement, the liquid film is produced. The film decelerates by the wall friction force being Vlocal∼1  m/s by immediately diminishing the initial inertial force, simultaneously heated by the combustion gas reaching the saturation temperature in several millimeters from the collision point.The combustion gas drives the film flow.In this region, the film flow extends sheared by the fast combustion gas. The large velocity difference between the liquid and the gas leads to instabilities, producing ripple waves on the film as illustrated in Fig. 11b. The film continuously evaporates and becomes thin. As a result, the local film velocity gradually decays toward the film front.Evaporation completes.The film completes evaporation at the axial length balancing the heat input from the combustion gas being equivalent with the latent heat. At the MR condition, the film flow rate is larger, and the film length becomes longer.Fig. 10 Axial wavelength at t=50  ms.Fig. 11 Transient behavior of film flow.IV. ConclusionsFor enriching the essential understanding of film-cooling technique, we succeeded in the direct high-speed optical measurements of coolant liquid film dynamics inside a bipropellant thruster chamber made of quartz glass, using MMH and MON3 as propellants, from the ignition to the steady state in the 50 ms firing duration. We were the first to quantify the coolant liquid film dynamics and the film length exposed to the hypergolic combustion gas stream, revealing the unsteady film dynamics under the same operating conditions as 10N-class practical bipropellant thrusters. The experimental results sequentially revealed the transient behavior of the film flow as follows: the coolant fuel jet impinged on the chamber wall being the liquid film; the friction force between the chamber wall and the film rapidly decelerated the film velocity as one-tenth of the injection velocity; then the film moved downstream, sheared by the fast combustion gas downstream, in which the film continuously evaporated and thinned; and eventually the film front completely evaporated by the heat input from the hot combustion gas. The liquid film formed the typical ripple wave structure, covered by the velocity and thermal boundary layers. The effect of the mixture ratio was significant as the film flow rate increased at the small mixture ratio, leading to the longer film length.L. MauriceAssociate EditorAppendix: Dominant Parameter to Determine the Film LengthAs explained in Sec. III, the film length is determined by the balance of supplied film flow rate and the evaporation rate from the film surface. Here, we discuss the effect of difference of adiabatic flame temperature of the core flame produced by the impinging propellants on the film length at each test case. The mixture ratio of MRcore for the core combustion gas, except for the film-cooling fuel, is larger than the total mixture ratio of MR: MRcore=m˙Om˙F=MR1−FC(A1)In the present test, we obtain MRcore=1.4∼3.0 corresponding to MR=1.0∼2.1 at FC=0.3.Figure A1 shows the relationship between the adiabatic flame temperature of Tflame and MRcore, calculated by NASA chemical equilibrium analysis code [32]. Corresponding to MR=1.0, 1.6, and 2.1, we obtain Tflame=2830  K, 3160 K, and 3110 K respectively. As shown in Table 2, the chamber pressure of each test is fixed, and the total flow rate of propellants (m˙O+m˙F+m˙FC) is the same. Hence, m˙FC is inversely proportional to 1+MR. At MR=1.0 and 2.1, m˙FC decreases 60%. Since we confirm Tflame changes approximately 10% against MRcore, the temperature difference between the core gas and coolant film is almost constant. Thus, we conclude that the film flow rate is the dominant parameter to determine the film length, in which the film length shortens at a larger MR condition, consistent with Fig. 6b. Assuming a case that the coolant film is mainly heated by the covering self-decomposing gas, not by the core combustion gas, the film length is reasonably affected by the film flow rate.Fig. A1 The relationship between MRcore and Tflame of core combustion gas.AcknowledgmentWe wish to express our sincere gratitude to all people involved in this research, especially the members of the thruster test team at the Isahaya site of Mitsubishi Heavy Industries.\r            References\r        [1] Sutton G. P., “History of Liquid Propellant Rocket Engines in the United States,” Journal of Propulsion and Power, Vol. 19, No. 6, 2003, pp. 978–1007. https://doi.org/10.2514/2.6942 LinkGoogle Scholar[2] Sutton G. P., “History of Liquid Propellant Rocket Engines in Russia, Formerly the Soviet Union,” Journal of Propulsion and Power, Vol. 19, No. 6, 2003, pp. 1008–1037. https://doi.org/10.2514/2.6943 LinkGoogle Scholar[3] Takata S., Sasaki H., Fukatsu T. and Sugimori K., “The Compatibility Evaluation Method of the 500N and 120N Japanese Bi-Propellant Thrusters with the HTV System and Operation Design,” Transactions of the Japan Society for Aeronautical and Space Sciences, Vol. 12, No. ists29, 2014, pp. 7–15. https://doi.org/10.2322/tastj.12.Pg_7 Google Scholar[4] Kasai T., Ueda S. and Uematsu H., “Technology of H-II Transfer Vehicle Rendezvous System,” Transactions of the Japan Society for Aeronautical and Space Sciences, Vol. 7, No. ists26, 2009, pp. 13–18. https://doi.org/10.2322/tstj.7.Td_13 Google Scholar[5] Daimon Y., Negishi H., Tani H., Matsuura Y., Iihara S. and Takata S., “Flow Field and Heat Transfer Analysis in a MON/MMH Bipropellant Rocket Engine,” International Journal of Energetic Materials and Chemical Propulsion, Vol. 16, No. 3, 2017, pp. 263–280. https://doi.org/10.1615/IntJEnergeticMaterialsChemProp.2018011279 Google Scholar[6] Ahrens I., Laux U., Ress R. and Riehle M., “System Aspects of Europe’s Automated Transfer Vehicle (ATV) Propulsion and Reboost Subsystem,” 57th International Astronautical Congress, International Astronautical Federation Paper  IAC-06-D.2.3.6, Oct. 2006. https://doi.org/10.2514/6.IAC-06-D2.3.06 Google Scholar[7] Tsuda Y., Yoshikawa M., Abe M., Minamino H. and Nakazawa S., “System Design of the Hayabusa 2—Asteroid Sample Return Mission to 1993 JU3,” Acta Astronautica, Vol. 91, Oct.–Nov. 2013, pp. 356–362. https://doi.org/10.1016/j.actaastro.2013.06.028 CrossrefGoogle Scholar[8] Sawai S., Fukuda S. and Sakai S., “Preliminary System Design of Small Lunar Landing Demonstrator SLIM,” Aerospace Technology Japan, Vol. 17, Aug. 2017, pp. 35–43. https://doi.org/10.2322/astj.JSASS-D-16-00050 Google Scholar[9] Campagnola S., Yam C. H., Tsuda Y., Ogawa N. and Kawakatsu Y., “Mission Analysis for the Martian Moons Explorer (MMX) Mission,” Acta Astronautica, Vol. 146, May 2018, pp. 409–417. https://doi.org/10.1016/j.actaastro.2018.03.024 CrossrefGoogle Scholar[10] Sawai S., Sato E. and Uesugi K. T., “Development of Ceramic Based 500N Class Bipropellant Thruster,” 56th International Astronautical Congress of the International Astronautical Federation, the International Academy of Astronautics, and the International Institute of Space Law, International Astronautical Federation Paper  IAC-05-C4.3.01, Oct. 2005. https://doi.org/10.2514/6.IAC-05-C4.3.01 LinkGoogle Scholar[11] Schindler R. C. and Shoenman L., “Development of a Five-Pound Thrust Bipropellant Engine,” Journal of Spacecraft and Rockets, Vol. 13, No. 7, 1976, pp. 435–442. https://doi.org/10.2514/3.57105 LinkGoogle Scholar[12] Chazen M. L. and Sanscrainte W., “Space Shuttle Bipropellant RCS Engine,” Journal of Spacecraft and Rockets, Vol. 11, No. 10, 1974, pp. 685–690. https://doi.org/10.2514/3.62156 LinkGoogle Scholar[13] Rosenberg S. D. and Shoenman L., “New Generation of High-Performance Engines for Spacecraft Propulsion,” Journal of Propulsion and Power, Vol. 10, No. 1, 1994, pp. 40–46. https://doi.org/10.2514/3.23709 LinkGoogle Scholar[14] Shoenman L., Rosenberg S. D. and Jassowski D. M., “Test Experience, 490-N High Performance Engine,” Journal of Propulsion and Power, Vol. 11, No. 5, 1995, pp. 992–997. https://doi.org/10.2514/3.23928 Google Scholar[15] Coulbert C. D., “Selecting Cooling Techniques for Liquid Rockets for Spacecraft,” Journal of Spacecraft and Rockets, Vol. 1, No. 2, 1964, pp. 129–139. https://doi.org/10.2514/3.27612 LinkGoogle Scholar[16] Kinney G. R., Abramson A. E. and Sloop J. L., “Internal Liquid Film Cooling Experiments with Air Stream Temperatures to 2000 F in 2 and 4 inch Diameter Horizontal Tubes,”  NACA TR  1087, 1952. Google Scholar[17] Cherdantsev A. V., Hann D. B. and Azzopardi B. J., “Study of Gas-Sheared Liquid Film in Horizontal Rectangular Duct Using High-Speed LIF Technique: Three-Dimensional Wavy Structure and Relation to Liquid Entrainment,” International Journal of Multiphase Flow, Vol. 67, Dec. 2014, pp. 52–64. https://doi.org/10.1016/j.ijmultiphaseflow.2014.08.003 CrossrefGoogle Scholar[18] Shinan C., Weidong Y., Mengjie S., Mengyao L. and Qiyu S., “Investigation of Wavy Characteristics of Shear-Driven Water Film Using the Planar Laser Induced Fluorescence Method,” International Journal of Multiphase Flow, Vol. 118, No. 1, 2019, pp. 242–253. https://doi.org/10.1016/j.ijmultiphaseflow.2019.04.016 Google Scholar[19] Inoue C. and Maeda I., “On the Droplet Entrainment from Gas-Sheared Liquid Film,” Physics of Fluids, Vol. 33, No. 1, 2021, Paper 011705. https://doi.org/10.1063/5.0038399 Google Scholar[20] Stechman R. C., Oberstone J. and Howell J. C., “Design Criteria for Film Cooling for Small Liquid Propellant Rocket Engines,” Journal of Spacecraft and Rockets, Vol. 6, No. 2, 1969, pp. 97–102. https://doi.org/10.2514/3.29545 LinkGoogle Scholar[21] Shine S. R., Kumar S. S. and Suresh B. N., “A New Generalized Model for Liquid Film Cooling in Rocket Combustion Chamber,” International Journal of Heat and Mass Transfer, Vol. 55, Sept. 2012, pp. 5065–5075. https://doi.org/10.1016/j.ijheatmasstransfer.2012.05.006 CrossrefGoogle Scholar[22] Jand D., Kwak Y. and Kwon S., “Design and Validation of a Liquid Film-Cooled Hydrogen Peroxide/Kerosene Bipropellant Thruster,” Journal of Propulsion and Power, Vol. 31, No. 2, 2015, pp. 761–765. https://doi.org/10.2514/1.B35434 Google Scholar[23] Arnold R., Suslov D. and Haidn O. J., “Film Cooling of Accelerated Flow in a Subscale Combustion Chamber,” Journal of Propulsion and Power, Vol. 25, No. 2, 2009, pp. 443–451. https://doi.org/10.2514/1.39308 LinkGoogle Scholar[24] Yarygin V. N., Prikhodko V. G., Yarygin I. V. and Vyazov Y. N., “Near-Wall Liquid Film Interaction with Co-Current Gas Flow Inside Nozzle and Under Outflow into Vacuum,” Vacuum, Vol. 159, Jan. 2019, pp. 494–499. https://doi.org/10.1016/j.vacuum.2018.11.002 CrossrefGoogle Scholar[25] Knuth E. L., “The Mechanics of Film Cooling,” Jet Propulsion, Vol. 24, No. 6, 1954, pp. 359–365. https://doi.org/10.2514/8.6548 AbstractGoogle Scholar[26] Morrell G., “Investigation of Internal Film Cooling of 1000 Pound Thrust Liquid Ammonia- Liquid Oxygen Rocket Engine Combustion Chamber,”  NACA  RM E51E04, 1951. Google Scholar[27] Arnold R., Suslov D. I. and Haidn O. J., “Experimental Investigation of Film Cooling with Tangential Slot Injection in a LOX/CH4 Subscale Rocket Combustion Chamber,” Transactions of the Japan Society for Aeronautical and Space Sciences, Vol. 7, No. ists26, 2009, pp. 81–86. https://doi.org/10.2322/tstj.7.Pa_81 Google Scholar[28] Shine S. R. and Nidhi S. S., “Review on Film Cooling of Liquid Rocket Engines,” Propulsion and Power Research, Vol. 7, No. 1, 2018, pp. 1–18. https://doi.org/10.1016/j.jppr.2018.01.004 CrossrefGoogle Scholar[29] Fujii G., Daimon Y., Inoue C., Shiraiwa D., Tanaka N. and Furukawa K., “Visualization of Pulse Firing Mode in Hypergolic Bipropellant Thruster,” Journal of Propulsion and Power, Vol. 36, No. 5, 2020, pp. 677–684. https://doi.org/10.2514/1.B37637 LinkGoogle Scholar[30] Marsh W. R. and Knox B. P., “USAF Propellant Handbooks Hydrazine Fuels,”  Air Force Rocket Propulsion Lab.  TR-69-149, 1970. Google Scholar[31] Wright A. C., “USAF Propellant Handbooks Nitric Acid/Nitrogen Tetroxide Oxidizers,” Air Force Rocket Propulsion Lab.  TR-76-76, 1977. Google Scholar[32] Gordon S. and McBride B. J., “Computer Program for Calculation of Complex Chemical Equilibrium Compositions and Applications, I. Analysis,” NASA Reference Publication  1311, 1994. Google Scholar[33] Marmottant P. and Villermaux E., “On Spray Formation,” Journal of Fluid Mechanics, Vol. 498, Jan. 2004, pp. 73–111. https://doi.org/10.1017/S0022112003006529 CrossrefGoogle Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Analytic Costate Initialization from Rough State-Trajectory Estimates",
        "url": "https://arc.aiaa.org/doi/10.2514/1.G005224",
        "date": "20210906",
        "content": "I. IntroductionIn the development of optimal control solutions, there are two general approaches: the direct method and the indirect method. In the direct method, the control is directly manipulated (hence the name) in an iterative manner until an optimal result is achieved. In the indirect method, the iteration is applied to the costate or adjoint variables, on which the controls are dependent (through the necessary conditions of the maximum principle [1]), in an effort to achieve an optimal control. Both methods have strengths and weaknesses, and a significant body of knowledge exists for both methods. The direct method is generally more straightforward and can provide quick results provided that the initial guess for the optimal solution is sufficiently close to allow convergence. However, direct method approaches usually result in approximate optimal solutions. A significant body of work by Betts [2] and others [3–5] focuses on variations on the direct approach involving collocation. Indirect methods, on the other hand, provide very accurate solutions. Benson et al. [6] indicate that “The primary advantages of indirect methods are their high accuracy and the assurance that the solution satisfies first-order optimality conditions.”With regard to the indirect method, Betts [7], quoting Bryson and Ho [8], states, “The main difficulty with these methods is getting started …” One of the difficulties to be addressed in using the indirect method for the solution of an optimal control problem is the necessity of obtaining estimates of the initial costates such that convergence to a solution is feasible and efficient. This primary difficulty lies in the fact that the arrival at an optimal solution is dependent on the selection of the initial costates, which unfortunately is not usually intuitive. Bushong and Lawton [9] develop estimates of the costates for an optimal trajectory by using a near-optimal parameterized solution. Jiang et al. [10] use a nominal trajectory to estimate the adjoint variables for a low-thrust application. Seywald and Kumar [11] discuss a method to estimate the costates for an optimal control problem using the indirect method using results obtained from a related discretized, direct-method solution. Lee and Bang [12] propose an initial guess structure for the costates based on known costate characteristics for the design of spiral orbit transfers. Martell and Lawton [13] provide a methodology that allows for estimation of the costates using finite differences obtained from a known trajectory and implemented through the use of an auxiliary optimization problem.This Note revisits the approach of Martell and Lawton, replacing the auxiliary optimization problem with another auxiliary problem that has an analytic solution. Therefore, no numerical iterations are required for this present approach. The costate solutions from this new approach will then be used in a multiple-shooting method implementation to determine the optimal control for the same problem. It will be demonstrated that even with only rough estimates in the neighborhood of the optimal trajectory, this procedure converges, making it one more possible tool available to those solving optimal trajectory problems.II. Optimal-Control Problem StatementThe focus of this Note is on finding estimates of costates, also known as adjoint variables, of the indirect method of solution, for a certain class of optimal control problems. The optimal control problem is, given the differential equations of the state, find the control-vector function of time u(t) that minimizes the cost function J. x˙=f(x,u,t)(1)(where x∈Rn is the state vector, u∈Rm is the control vector, and t is time), the cost to be minimized J(u)=ϕ(x(tf),tf)+∫t0tfL(x,u,t) dt(2)and the boundary conditions χ(x(t0),t0)=0 and ψ(x(tf),tf)=0, find the control-vector function of time u(t) that minimizes the cost function J. The classic necessary condition for finding the optimal control, u, u*=argmaxu J(3)is the maximum principle [1]. Specifically, the Hamiltonian is formed: H=λTf−L(4)where λ(t)∈Rn is the costate vector. The costate governing differential equation is λ˙=−(∂H∂x)T=−(∂f∂x)Tλ+(∂L∂x)T(5)The boundary conditions on λ are λ(t0)=[∂χT(x)∂xμ]|t=t0(6)λ(tf)=[−∂ϕ∂x+∂ψ∂xTν]|t=tf(7)Given these definitions, the maximum principle states that the optimal u will satisfy the necessary condition u*=argmaxuH(x*,λ*,u,t)(8)where x*(t) is the value of the state on the optimal trajectory at time t. In other words, at each time, on the optimal trajectory, the optimal control is the one that maximizes the Hamiltonian.When the Hamiltonian is not linear in the control, u, and there are no bounds on u, then the maximum principle implies that ∂H∂u=0(9)Equation (9) is solved for u to obtain the control on the optimal trajectory. As such, u is a function of the states and the costates on the optimal trajectory.The class of problems to be solved by the technique of this Note is such that (∂H/∂u)=0 is necessary throughout the whole trajectory. This is a large class of problems, to which many aerospace control problems belong.The solution process requires the appropriate number of tranversality and state boundary conditions given by λ(t0)=[∂χT(x)∂xμ]|t=t0(10)λ(tf)=[−∂ϕ∂x+∂ψ∂xTν]|t=tf(11)χ[x(t0),t0]=0(12)ψ[x(tf),tf]=0(13)Additionally, if the final time is free, then the optimal tf will be such that H(tf)=[−∂ϕ∂t+∂ψ∂tTν]|t=tf(14)The indirect method, in this case, has reduced the optimal control problem to the task of finding the parameters λ(t0), ν, μ, and tf such that the conditions (10–13) are satisfied. The multiple-shooting method is one of the more successful methods for solving boundary-value problems of this type.With an initial estimate for the costates, λ0, a guess for μ, the initial conditions, and the control from Eq. (9), one could numerically integrate the dynamic equations for the state and costates from time t=0 forward to the estimate for tf. This method, known as the simple-shooting method, suffers from the shortfall that small errors in the initial estimates will lead to uncontrollable growth of the costates as the integration progresses in time. An alternative to this approach, which specifically addresses this issue, is the multiple-shooting method. In this method, the trajectory is divided up into a number of nodes, and estimates for the costates are generated at each of the nodes. The integration proceeds as before, but now upon arriving at each node, the costates are “reset” to the estimates previously calculated for that node. The solution is found when the differences in the costates at all the nodes (i.e., between the forward-integrated values and the estimate values) are zero within a specified tolerance. In this manner, the number of nodes may be selected such that the costates do not diverge uncontrollably and the method converges to a solution.III. Method for Estimating the Costates from In-the-Neighborhood TrajectoriesWe start with the finite difference method used in [13]. The adjoint variable differential equations are written as λ˙=[A(x˜,u˜,t)]λ+∂L∂x|x˜,u˜,t(15)where A=−(∂f∂x)T(16)and the tildes (∼) denote values on the estimated trajectory.Equation (15) can then be approximated by [I]λi+1−[I+Ai(x˜i,u˜i,t)Δti]λ˜i=Δti∂L∂x|x˜i,u˜i,ti;i=1,…,w−1(17)The time between nodes, which may vary from panel to panel, is given by Δti=ti+1−ti(18)In matrix notation, Eq. (17) becomes [α1I0……00α2I……000…αw−2I: : : ……αw−1I00……0I]{λ1λ2: λw−1λw}={Δt1∂L∂x|1Δt2∂L∂x|2: Δtw−1∂L∂x|w−1λ(tf)}(19)where each n×n submatrix αi is given by αi=−(I+AiΔti)(20)(The reader should note that these matrix quantities, αi, are not the angle of attack.)Inverting the matrix on the left side of Eq. (19) and multiplying to both sides of the same equation yields {λ1λ2: : λw−1λw}=[α1−1−α1−1α2−1α1−1α2−1α3−1−α1−1α2−1α3−1α4−1…±α1−1α2−1…αw−1−10α2−1−α2−1α3−1α2−1α3−1α4−1…∓α2−1α3−1…αw−1−100α3−1−α3−1α4−1…±α3−1α4−1…αw−1−1: : ………: 00……αw−1−1−αw−1−100……0I]{Δt1∂L∂x|1Δt2∂L∂x|2: Δtw−1∂L∂x|w−1λ(tf)}(21)A brief note with regard to the signs of the terms in the last column of the matrix on the right-hand side of Eq. (21): The w−1 term in that column always has a negative sign associated with it. From there, the terms alternate in sign upward (i.e., the w−2 term is positive, the w−3 term is negative, and so on).Multiplying the right side of Eq. (21) results in {λ1λ2: : λw−1λw}={α1−1Δt1∂L∂x|1−α1−1α2−1Δt2∂L∂x|2+…±α1−1α2−1…αw−1−1λ(tf)α2−1Δt2∂L∂x|2−…∓α2−1α3−1…αw−1−1λ(tf): : αw−1−1Δtw−1∂L∂x|w−1−αw−1−1λ(tf)λ(tf)}(22)Given that λ(tf)=(∂ϕ∂xT+∂ψ∂xTν)(23)the costates are given by {λ1λ2: : λw−1λw}={α1−1Δt1∂L∂x|1−…∓α1−1α2−1…αw−2−1Δtw−1∂L∂x|w−1−α2−1Δt2∂L∂x|2+…±α2−1α3−1…αw−2−1Δtw−1∂L∂x|w−1: : αw−1−1Δtw−1∂L∂x|w−10}+{±α1−1α2−1…αw−1−1∓α2−1α3−1…αw−1−1: : −αw−1−1I}(∂ϕ∂xT+∂ψ∂xTν)|t=tf(24)which can be rewritten as {λ1λ2: : λw−1λw}={d1d2: : dw−10}+{S1S2: : Sw−1I}(∂ϕ∂xfT+∂ψ∂xfTν)(25)={d1+S1∂ϕ∂xfT+S1∂ψ∂xfTνd2+S2∂ϕ∂xfT+S2∂ψ∂xfTν: : dw−1+Sw−1∂ϕ∂xfT+Sw−1∂ψ∂xfTν∂ϕ∂xfT+∂ψ∂xfTν}(26)Now, if we add the initial condition function χ at t=0, transversality gives λ1=∂χ∂x|x˜1,u˜1,t1Tμ(27)Therefore, ∂χ∂xTμ=d1+S1∂ϕ∂xfT+S1∂ψ∂xfTν(28)where S1=±α1−1α2−1…αw−1−1. We now need to find a solution for ν. Our motivation is the maximum principle, where the optimal control (for the class of problems that are the focus of this Note) will be the one that results in (∂H/∂u)=0. By using x and u along nodes, we seek to find costates that leave ∂H/∂u as close to 0 as possible consistent with these data. With this in mind, we introduce the following auxiliary function for which a minimum will be found: Q(ν)=∑i=1w12∂H∂u∂H∂uT(29)By ∂H/∂u in this expression we mean this partial derivative as evaluated at each of the nodes (i.e., evaluated at ti), (∂H/∂u)|ti. This is the main difference between the approach taken in [13] and this approach; this auxiliary function replaces the one in [13] and allows for an analytical solution.Evaluating this partial derivative at the nodes gives ∂H∂u|ti=λT∂f(x,u)∂u|ti(30)=λ^i(ν)T∂f(x˜i,u˜i)∂u(31)=[diT+∂ϕ∂xfSiT+νT∂ψ∂xfSiT]Bi(32)where Bi=∂f(x˜i,u˜i)∂u(33)Substituting Eqs. (30–33) into Eq. (29) results in Q(ν)=12∑i=1w[diT+(∂ϕ∂xf+νT∂ψ∂xf)SiT]BiBiT[di+Si(∂ϕ∂xfT+∂ψ∂xfTν)](34)Taking the partial of J with respect to z and setting equal to 0 yields ∂Q∂ν=∑i=1w[diT+(∂ϕ∂xf+νT∂ψ∂xf)SiT]BiBiTSi∂ψ∂xfT=0(35)which has the solution ν=−[∂ψ∂xf(∑i=1wSiTBiBiTSi)∂ψf∂xfT]−1⋅[∑i=1w∂ψ∂xfSiTBiBiTdi+∂ψ∂xf(∑i=1wSiTBiBiTSi)∂ϕ∂xfT](36)Note that the summation ∑i=1wSiTBiBiTSi is the finite-difference version of the controllability grammian. So, although each term of the summation is of rank m<n, the sum will be of rank n if the problem is controllable. This helps to ensure that the first term in Eq. (36) is invertible for problems that make sense (i.e., which are completely controllable). Equation (36) replaces the auxiliary optimization procedure of [13].IV. Multiple Shooting MethodWith estimates of the initial costates in hand, and along with the state and costate dynamics (and the initial conditions on the state), it is a simple matter to integrate the states and costates forward in time and compare the integrated values of the states and costates with the final conditions. This method, known as the simple shooting method, then allows the initial costates to be adjusted such that the differences between the integrated states and costates and the final conditions are negligible. However, the costates are often highly sensitive to the initial estimates; this sensitivity results in the costates being unstable. As such, minor changes in their initial values can lead to quickly diverging results.To address this issue, we applied the multiple shooting method. In this method, the trajectory is divided into w nodes, and the values of the costates are calculated at each of the nodes using Eq. (26); these values are stored and will be used later to “reset” the costates to prevent unstable behavior. Figure 1a shows a notional depiction of the application of the multiple shooting method for the initial integration of λx. At t1, λx is integrated forward until t2 using Eq. (5). At this point, the value of λx is reset to the value of λx at t2 computed and stored earlier. The integration continues to t3, where the process is repeated until reaching the final node. Using a nonlinear system-of-equations solver, the costate estimates at each node are adjusted and stored, and the integration is executed again. The process continues until the differences Δλx, also known as defects, between the integrated and computed (stored) values, are driven to zero. Figure 1b shows the final result of this process for λx by using the nonlinear system-of-equations solver and iteratively integrating to determine the optimal trajectory.Fig. 1 λx for initial and final values of p.To employ the solver, we established a vector of inputs, p, and an associated vector of dependent values, F(p). The solver functions by manipulating the vector of inputs to drive each element of F(p) to zero (within a user-defined tolerance). Upon convergence of the solver, the final elements of p will be the solution to the system of linear equations.The specific contents of p and F(p) will be discussed in Sec. VI; p chiefly contains the estimated costates at the nodes, plus other problem-specific parameters, whereas F(p) chiefly contains the defects at the nodes, plus additional conditions such as the enforcement of initial-time boundary conditions on the state and costate.V. Illustrative ProblemThe method discussed above is now applied to the problem of a projectile with a single control, α, the angle of attack, which is defined as the angle between the projectile body axis and the velocity vector (see Fig. 2). The projectile is fired from the surface of the Earth with a launch angle θ0, which is measured from the vertical, at an initial velocity v0. We will consider planar motion in a nonrotating, Earth-centered coordinate system. The projectile is fired at a target with a fixed location on the Earth.Fig. 2 Coordinate system showing projectile body orientation.We define the dynamics as follows: x={rv}(37)where r is the two-dimensional position vector from the center of the Earth, and x˙={va}(38)where a, the acceleration, is given by a=(A+N)/m+g(39)where A is the axial force, N is the normal force, m is the projectile mass, and g is the acceleration due to gravity. A is aligned with the projectile body and its magnitude is given by ‖A‖=12ρv2SCA(40)where ρ is the density, v is the magnitude of the velocity, S is the reference area of the projectile, and CA is the constant coefficient of the axial force. N is aligned perpendicular to the projectile body and its magnitude is given by ‖N‖=12ρv2SCNαα(41)where CNα is the gradient of the coefficient of the normal force with respect to α. Both CA and CNα are aerodynamic characteristics of the projectile. The initial conditions are given by χ={r0−rLv0−‖vL‖[cos(θ0)sin(θ0)]}(42)where the subscript 0 denotes the initial position and velocity, and L denotes the launch position and velocity. The final conditions are given by ψ={r(tf)−rT}(43)where the subscript f denotes the final time and T denotes the target position. We define the cost function as J=−v2(tf)(44)and we construct the Hamiltonian to yield H=λrTv+λvTa(45)where λr and λv are the costates of the position and velocity, respectively. Taking the partial derivative of H with respect to the control α and setting equal to zero gives ∂H∂α=λvT∂a∂α=0(46)To find ∂a/∂α, we write N^ and A^ as N^=u^cosα−v^sinα(47)and A^=−u^sinα−v^cosα(48)where v^ is the unit vector along the velocity vector and u^ is perpendicular to v^ in the “up” direction.Defining aN and aA to be ‖N‖/m and ‖A‖/m, respectively, we obtain aaero=−aNsinαv^+aNcosαu^−aAcosαv^+aAsinαu^(49)Recognizing that (∂g/∂α)=0 and therefore (∂a/∂α)=∂aaero/∂α, λvT∂a∂α=[(−∂aN∂α+aA)sinα−(aN+∂aA∂α)cosα]λvTv^+[(∂aN∂α−aA)cosα−(aN+∂aA∂α)sinα]λvTu^=0(50)Rearranging yields [(−∂aN∂α+aA)λvTv^−(aN+∂aA∂α)λvTu^]sinα=[(aN+∂aA∂α)λvTv^+(−∂aN∂α+aA)λvTu^]cosα(51)which can be solved for tanα: tanα=[(aN+∂aA∂α)λvTv^+(−∂aN∂α+aA)λvTu^][(−∂aN∂α+aA)λvTv^−(aN+∂aA∂α)λvTu^](52)We thus have an expression for the optimal control α, which is determined from the costates, which we can obtain using the method outlined in the previous section.To solve for α from the adjoint variables, we express aN and aA as aN=q∞SmCNα⋅α,aA=q∞SmCA(53)Taking partials with respect to the control α gives ∂aN∂α=q∞SmCNα,∂aA∂α=0(54)Combining these with Eq. (52) yields tan α=CNααλv⋅v^+(CA−CNα)λv⋅u^(CA−CNα)λv⋅v^−CNααλv⋅u^(55)We will now use Newton’s method to solve for α. Rearranging Eq. (55) provides us with F(α)F(α)=λv⋅v^(CA−CNα)sinα−λv⋅u^CNα⋅αsinα−λv⋅v^CNα⋅αcosα+λv⋅u^(CNα−CA)cosα=0(56)while the derivative with of F(α) with respect to α is F′(α)=λv⋅v^(CA−CNα)cosα−λv⋅u^CNα⋅sinα−λv⋅u^CNα⋅αcosα−λv⋅v^CNα⋅cosα+λv⋅v^CNα⋅αsinα−λv⋅u^(CNα−CA)sinα(57)Each new estimate of α is obtained from αk+1=αk−F(αk)F′(αk)(58)To determine an initial guess for αk=0, we apply the small angle approximation to Eq. (56), which reduces to −λv⋅u^CNα⋅αk=02+λv⋅v^(CA−2CNα)αk=0+λv⋅u^(CNα−CA)=0(59)which results in an initial guess of αk=0=−λv⋅v^(CA−2CNα)±(λv⋅v^)2(CA−2CNα)2−4(λv⋅u^)2CNα(CNα−CA)2λv⋅u^CNα(60)VI. Application of the MethodologyTo demonstrate the utility of this methodology, two cases are presented where the reference trajectories were generated using two different methods. In the first case, an approximate optimal trajectory was obtained from previously developed software employing a direct method. In the second case, a purely ballistic (i.e., α=0) depressed trajectory flown to the same range was used. The point of using the ballistic trajectory is that the reference trajectories do not need to be nearly optimal; they just need to be of the right shape to produce estimates for the costates that are close enough to permit convergence. In each case, the reference trajectory was then divided into w−1 panels (defined by w nodes); 20 nodes were used in this problem. Using Eq. (36), a value for ν was calculated and subsequently Eq. (26) was used to determine the λs at each of the nodes. With the λs in hand, Eqs. (56) and (59) were then used to calculate the control α.In the first case, previously developed, direct-method software was executed to obtain an approximate optimal trajectory. The trajectory was divided into the same w nodes and the software executed to produce a control history (at the nodes) that would result in a near-optimal trajectory maximizing impact velocity. The output control history, at the nodes, was then used in a simulation based on the indirect method discussed previously. The simulation begins by recreating the approximate optimal trajectory and then produces the estimates for the costates. With these in hand, the dependent vector F(p) is iterated on by adjusting the input vector p until the values in F(p) are reduced to the tolerance of convergence.For this specific application, the independent vector p∈Rnp, where np=4w, is defined by p={λ1λ2: λw−1νμθ0}(61)where each λi is the four-dimensional costate vector (composed of λx, λy, λvx, and λvy) at the ith node. A unique aspect of this application results from the fact that only the costates, and not the states, along with some transversality conditions, are included in p. This has the advantage of keeping p smaller and was possible because the state variables were not nearly as unstable as the costates.The corresponding dependent vector F(p): Rnp→Rnp, F(p)={Δλ2Δλ3: Δλw−1ΔλwΔrλvx,0−μ*cosθ0λvy,0−μ*sinθ0}(62)where the Δλi∈R4 are the differences between the costate vector integrated forward from the previous node, i−1, to the current node, i, and the previously stored λi. For example, Δλ2=λ2integrated−(p5p6p7p8)where λ2integrated comes from integrating λ1=(p1p2p3p4)forward from t1 (t=0) to time t2, using Eq. (5).As to the last four terms of Eq. (62), Δλw (the wth node corresponds with tf) is the difference between the integrated value of λw and λf from Eq. (7), Δr is the difference between the projectile position and the position of the target at time tf, and the last two terms are from the initial transversality conditions. The numerical nonlinear-system-of-equations solver iterates on p until F(p)≈0. Figure 1b shows how the solver drives the Δλx values to zero, as representative of what happens to all four values of the costate vector.This approach successfully converged to an optimal solution with the results shown in the following figures. In each case shown below, “optimal” refers to the solution resulting from the multiple-shooting method approach. Figure 3a shows a comparison of the approximate optimal and optimal trajectories, indicating the degree to which the optimal trajectory matches the original approximate optimal one (because the velocity profiles of the two trajectories are similarly close, this plot is not included). Figure 3b shows a comparison of the approximate optimal angle-of-attack history and the one from the optimal trajectory. Notice that the approximate optimal history is not smooth as is the case for the optimal trajectory. This exemplifies one of the differences between the direct and indirect methods: whereas direct methods provide a good approximation of the optimal control, indirect methods typically result in a more precise optimal solution.Fig. 3 Comparison of approximate and optimal trajectories.Next, the methodology was executed using control inputs from a purely ballistic case. A separate simulation was developed to generate the control history associated with a ballistic (α=0) case and that control history was used in an identical manner in the indirect method simulation (a depressed trajectory was chosen for this case because the lofted trajectory at this range is already close to the optimal solution). The methodology again converged to an optimal solution; a comparison of the ballistic trajectory and the resulting optimally controlled trajectory is shown in Fig. 4a. The optimal trajectory achieves the same range and time of flight as the ballistic trajectory, despite the fact that it flies significantly higher. On the optimal trajectory, the projectile is fired at a smaller launch angle (θ0=62°) compared with the 74° launch angle for the ballistic trajectory. This flight through thinner air allows the projectile to arrive with a higher final velocity than the purely ballistic case (436  m/s vs 413  m/s) as specified by the cost function. A comparison of the velocity profiles is shown in Fig. 4b.Fig. 4 Comparison of ballistic and optimal trajectories.Figure 5 shows a history of the angle of attack for the optimal trajectory (the angle of attack for the ballistic trajectory is uniformly 0). The optimally controlled projectile gradually pitches over from the initial velocity vector for the first part of the trajectory, then pulls slight positive α’s on the descent portion of the flight. This control history results in the significant increase in final velocity mentioned previously.Fig. 5 Optimal angle-of-attack history.Figures 6 and 7 show comparisons of the initial estimates for the costates with the converged costate histories for the approximate optimal and ballistic cases. Figures 6a and 6b show the position costate estimates, whereas Figs. 7a and 7b show the estimates of the velocity costates. For the approximate optimal case, the plots of the initial estimates are fairly close to the final histories; this is expected because the original approximate trajectory is very close to the final optimal trajectory. As can be seen, the estimates derived from the approximate optimal trajectory are much closer to the histories produced during the generation of the optimal trajectory than those produce from the ballistic trajectory. However, even the coarser estimates from the ballistic trajectory are sufficient to allow the method to converge to a solution. It is worth mentioning that although some of the costate estimates appear to be relatively far from the histories generated during the optimal trajectories, they are sufficiently close so as to be in the correct “valley” to allow the methodology to converge to an optimal solution.Fig. 6 Comparison of λr for approximate, ballistic, and optimal trajectories.Fig. 7 Comparison of λv for approximate, ballistic, and optimal trajectories.Subsequently, another case was chosen to explore the robustness of the methodology. By manipulating a longer-range (approximately 40 km) ballistic trajectory by manually altering the angle of attack history, a trajectory was developed that extended the range to approximately 56 km. This was done by specifying an angle of attack at each of the nodes and manually iterating until a longer range was achieved. The optimization methodology was applied using this manually derived control history and an optimal trajectory was achieved. The two trajectories are shown in Fig. 8a. As can be seen, both trajectories are essentially ballistic during the first half of their flight; the optimal trajectory is fired at a higher launch angle than the manual one and then pulls up slightly during the descent phase relative to the manual one. Also, the optimal trajectory is higher in the range extension portion of flight, allowing flight through less dense air and resulting in a significantly higher final velocity, as shown in Fig. 8b.Fig. 8 Comparison of 56 km manual and optimal trajectories.Figure 9a shows a comparison of the position costate estimates and optimal history for λx and λy, whereas Fig. 9b shows a comparison of the velocity costate estimates and optimal history for λvx and λvy. As shown earlier, although the estimates appear to be relatively distant from the integrated traces, they are sufficient to allow convergence to the optimal solution.Fig. 9 Comparison of costate estimates and optimal history for 56 km trajectory.VII. ConclusionsA method was derived that uses a reference trajectory to analytically and noniteratively solve for estimates of the costates associated with the states of the reference trajectory, for a class of optimal control problems. The method finds the costates at the nodes along the reference trajectory by solving for the values that match Pontryagin’s maximum principle as closely as possible in a specified least-squares sense. The particular advancement of this Note is that the reference trajectory need not come from some optimization or near-optimal method. Therefore, the reference trajectory can be quite rough, as long as it generally contains the right features and shape in the ballpark of the ultimate solution.To demonstrate the method, a guided-projectile optimal control problem was solved. Nearly optimal, ballistic, and rough “by-hand” reference trajectories were used in the method, and the subsequently-run multiple-shooting algorithm converged using the results of the method as input. Because the new process for estimating the costates is analytical, is noniterative, and needs only rough estimates of trajectories in the neighborhood of the final solution, it is a good tool to aid in solving optimal control problems via a multiple-shooting algorithm.\r            References\r        [1] Leitmann G., Optimization Techniques, 1st ed., Academic Press, New York, 1962, pp. 255–279, Chap. 7. Google Scholar[2] Betts J. T., Practical Methods for Optimal Control and Estimation Using Nonlinear Programming, 2nd ed., Soc. for Industrial and Applied Mathematics, Washington, D.C., 2010, pp. 109–111, Chap. 3. Google Scholar[3] Hargraves C. R. and Paris S. W., “Direct Trajectory Optimization Using Nonlinear Programming and Collocation,” Journal of Guidance, Control, and Navigation, Vol. 10, No. 4, July–Aug. 1987, pp. 338–342. LinkGoogle Scholar[4] Dennis M. E., Hager W. W. and Rao A. V., “Computational Method for Optimal Guidance and Control Using Adaptive Gaussian Quadrature Collocation,” Journal of Guidance, Control, and Dynamics, Vol. 42, No. 9, Sept. 2019, pp. 2026–2041. LinkGoogle Scholar[5] Gath P. F. and Well K. H., “Trajectory Optimization Using a Combination of Direct Multiple Shooting and Collocation,” AIAA Guidance, Navigation, and Control Conference and Exhibit, AIAA Paper  2001-4047, Aug. 2001. LinkGoogle Scholar[6] Benson D. A., Huntington G. T., Thorvaldsen T. P. and Rao A. V., “Direct Trajectory Optimization and Costate Estimation via an Orthogonal Collocation Method,” Journal of Guidance, Control, and Dynamics, Vol. 29, No. 6, Nov.–Dec. 2006, pp. 1435–1440. LinkGoogle Scholar[7] Betts J. T., Practical Methods for Optimal Control and Estimation Using Nonlinear Programming, 2nd ed., Soc. for Industrial and Applied Mathematics, Washington, DC, 2010, p. 129, Chap. 4. Google Scholar[8] Bryson A. E. and Ho Y.-C., Applied Control Theory, Optimization, Estimation, and Control, 1st ed., Taylor and Francis, New York, 1975, p. 214, Chap. 7. Google Scholar[9] Bushong P. M. and Lawton J. A., “Fast Solution to an Optimal Trajectory Problem,” Conference Proceedings of the AAS/AIAA Spaceflight Mechanics Meeting, American Astronautical Soc. Paper  94-131, Feb. 1994;  also Advances in the Astronautical Sciences, Vol. 87, Univelt, San Diego, CA, 1994, pp. 973–980. Google Scholar[10] Jiang F., Tang G. and Li J., “Improving Low-Thrust Trajectory Optimization by Adjoint Shape-Based Path,” Journal of Guidance, Control, and Dynamics, Vol. 40, No. 12, Dec. 2017, pp. 3280–3287. Google Scholar[11] Seywald H. and Kumar R. R., “Method for Automatic Costate Calculation,” Journal of Guidance, Control, and Dynamics, Vol. 19, No. 6, Nov.–Dec. 1996, pp. 1252–1261. LinkGoogle Scholar[12] Lee D. and Bang H., “Efficient Initial Costates Estimation for Optimal Spiral Orbit Transfer Trajectories Design,” Journal of Guidance, Control, and Dynamics, Vol. 32, No. 6, Nov.–Dec. 2009, pp. 1943–1947. LinkGoogle Scholar[13] Martell C. A. and Lawton J. A., “Adjoint Variable Solutions via an Auxiliary Optimization Problem,” Journal of Guidance, Control, and Dynamics, Vol. 18, No. 6, Nov.–Dec. 1995, pp. 1267–1272. LinkGoogle Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Low-Thrust Solid Rocket Motors for Small, Fast Aircraft Propulsion: Design and Development",
        "url": "https://arc.aiaa.org/doi/10.2514/1.B38104",
        "date": "20210916",
        "content": "AbstractSmall, low-thrust, long-burn-time solid propellant rocket motors could provide propulsion for a new class of kilogram-scale, transonic, uncrewed aerial vehicles (UAVs). This paper investigates technological challenges of small, low-thrust solid rocket motors: slow-burn solid propellants, motors that have low thrust relative to their size (and thus have low chamber pressure), thermal protection for the motor case, and small nozzles that can withstand long burn times. Slow-burn propellants were developed using ammonium perchlorate and 0–20% oxamide (burn-rate suppressant), with burn rates of 1–4  mm⋅s−1 at 1 MPa. Using these propellants, a low-thrust motor successfully operated at a thrust/burn area ratio 10 times less than that of typical solid rocket motors. This kilogram-scale motor can provide 5–10 N of thrust for 1–3 min. An ablative thermal protection liner was tested in these firings, and a new ceramic-insulated nozzle was demonstrated. This paper shows that small, low-thrust solid motors are feasible and presents a baseline design for the integration of such a motor into a small UAV.NomenclatureAbarea of burning propellant surface, m2Atnozzle-throat area, m2Awexposed wall area, m2apropellant burn-rate coefficient, m⋅s−1⋅Pa−nCDaircraft drag coefficient, dimensionlessCFthrust coefficient of the rocket motor, dimensionlessCgeometrygeometric factor in thermal stress model, dimensionlessCsootsoot concentration by volume in the exhaust gas, dimensionlesscpspecific heat capacity of the combustion gas, J⋅kg−1⋅K−1c*characteristic velocity of the propellant/motor, m⋅s−1Dcombustion chamber inner diameter, mEelastic modulus, PaFthrust force of the rocket motor, Nhexternalconvection coefficient of external airflow, W⋅m−2⋅K−1Ispspecific impulse, skinsulthermal conductivity of fiberglass insulation behind the ablative material, W⋅m−1⋅K−1kvirignthermal conductivity of the virgin ablative material, W⋅m−1⋅K−1m˙mass flow rate, kg⋅s−1mppropellant grain mass, kgnpropellant burn-rate exponent, dimensionlesspcchamber pressure of the motor, Paqdynamic pressure of external air flow, Paqconvconvective heat flux to the wall, W⋅m−2qradradiative heat flux to the wall, W⋅m−2Rsthermal shock resistance parameter, KReDReynolds number, with passage diameter as length scale, dimensionlessrpropellant burn rate, m⋅s−1Sflexflexural strength, PaSrefaircraft drag reference area (fuselage frontal area), m2StStanton number, dimensionlessTawadiabatic wall temperature, KTggas temperature, KTwwall temperature, Kεcaseemissivity of the motor case outer surface, dimensionlessεgtotal emittance of the gas, dimensionlessαLEcoefficient of thermal expansion (linear), K−1ζCF, ζc*CF, c* efficiency (measured/ideal values), dimensionlessνPoisson’s ratio, dimensionlessρgdensity of the combustion gas, kg⋅m−3ρssolid density of the propellant, kg⋅m−3σSBStefan–Boltzmann constant, W⋅m−2⋅K−4σθhoop stress, PaI. IntroductionA. Motivation: The Small and Fast Aircraft Capability GapAgap exists in the size and capability of flight vehicles: no small vehicles are capable of sustained level flight at high speed. There is an undeveloped regime of aircraft with speed above 100  m⋅s−1 and mass below 10 kg, based on a survey of US military aircraft specifications in [1–3]. Small, fast aircraft in this regime would be a useful extension of existing capabilities. The proposed aircraft would be carried by a larger host aircraft and air-launched near its cruise speed and altitude.One significant challenge is that small, fast aircraft need propulsion systems with high energy density: as an aircraft is made smaller, the volume for energy storage (∼(length scale)3) shrinks faster than the power demand (∼(drag)∼(length scale)2). Most small aircraft currently use electrically powered propellers; however, the low energy density of batteries makes electric aircraft unsuited for sustained flight at high speeds. Turbine engines and solid rocket motors have the requisite energy and power density, but turbine engines are mechanically complex and difficult to miniaturize. Solid rocket motors offer high specific power and low mechanical complexity.Small, fast aircraft have different thrust and endurance requirements than typical applications of solid rocket motors: the rocket motor must deliver a low thrust level, just enough to counter drag, for a few minutes. In contrast, typical solid rockets deliver their impulse quickly, either to catch up with a target (i.e., tactical missiles) or reduce gravity losses (i.e., sounding rockets and launch vehicles). Most kilogram-scale solid rocket motors only burn for a few seconds, not minutes. Further, the motors investigated here have thrust levels that are unusually low, even relative to the size of the motor. The thrust/burn area ratio is a measure of thrust relative to motor size; these motors have a thrust/burn area ratio one-tenth that of typical solid rocket motors. Adapting solid rockets to the needs of small, fast aircraft is the focus of this paper.B. Previous Research on Low-Thrust, Long-Burn-Time Rocket MotorsThe key design principles for low-thrust, long-burn-time solid rocket motors are to reduce the propellant burn area Ab by using an end-burn grain, to reduce the propellant burn rate by using large AP particles or burn-rate suppressants such as oxamide, and to operate at low chamber pressure [4]. Among the first designs to employ these principles were a series of long-burn-time demonstration motors tested at JPL from 1969–1971 [5]. These motors produced roughly 8 kN of thrust for 110–138 s at chamber pressures of only 0.8–1.0 MPa. More recently, Nowakowski et al. [6] proposed a 245 N thrust, 324 s burn-time motor using these techniques.Perhaps the most similar motor to those considered here is the Five-Minute Rocket Motor developed by Atlantic Research Corporation in the 1970s [7]. Producing 200 N of thrust for 290 s, this motor was also designed for aircraft propulsion. It had a diameter of 178 mm and a total mass of 53 kg. It used an end-burn propellant grain, with the burn rate reduced by adding 5% by mass oxamide to the propellant, and had a chamber pressure of 2.4 MPa. The thermal challenge of a long duration end-burn motor was addressed by lining the motor case with a composite ablative.The motors considered here are considerably smaller, with total mass on the order of 1 kg and thrust on the order of 10 N. Nonetheless, the key design principles of an end-burn grain, slow-burn propellant, and low chamber pressure are still applicable. This paper incrementally extends these approaches to higher oxamide contents (up to 20%) and lower chamber pressures (down to 0.5 MPa), and quantifies the lower limits on thrust/burn area possible with these techniques. It also reports new challenges with combustion gas heat loss and nozzle insulation, which only occur at small sizes and were not reported in the previous studies of long-burn-time motors.II. Design of Small, Low-Thrust MotorsA. Design Goals: Range and EnduranceThe influence of the propulsion system on range can be understood from the Bréguet range equation [8]. To maximize range, the motor should be long and slender to reduce the fuselage drag, the motor should have high specific impulse Isp, and the motor’s inert mass fraction should be low, to give the aircraft higher minitial/mfinal. Figure 1 uses the Bréguet equation to show the powered range of a hypothetical aircraft using such a motor (blue dashed curve), compared against a conventional ballistic rocket (black curve). Both vehicles have an initial mass of 3 kg and are launched at 10 km altitude and 239  m⋅s−1 (Mach 0.8). The aircraft cruises at that speed, has a lift-to-drag ratio of 4, and its low thrust motor gives 8 N of thrust at 110 s specific impulse. The conventional ballistic rocket uses a higher-thrust motor that burns for only a few seconds, giving 200 N of thrust at 220 s specific impulse. The ballistic rocket quickly accelerates to supersonic speeds, and has an initial 45 deg flight path angle.‡ As the ballistic rocket is unpowered for most of its flight, its range is more properly compared to the powered-plus-glide range of the aircraft (solid blue curve). For propellant mass fractions up to 0.5, the aircraft has longer range-to-ground impact than the ballistic rocket, on the order of 40–100 km. Beyond the range comparison, the rocket-propelled aircraft also offers very different trajectory options.Fig. 1 Notional range comparison of a small aircraft using a low-thrust motor and a same-size ballistic rocket.B. Aircraft and Motor Configuration, Notional MissionA proposed aircraft and rocket motor configuration is shown in Fig. 2. The fuselage is long and slender, with tapered ends, to reduce drag. The motor case is the primary structure of the fuselage and has a circular cross section using high-strength/density material (e.g., titanium alloy Ti-6Al-4V) to reduce inert mass.Fig. 2 Concept for a small, fast rocket-propelled aircraft: configuration and motor components. Many configurations of the aerodynamic surfaces are possible; one option is shown in white outlines.An end-burn grain is chosen to give a small propellant burn area, low thrust, and long burn time. An ablative material lines the inside of the motor case to protect the motor case from the hot combustion gas; still, the aft end of the motor case is expected to reach 500–650 K. The payload and controls are mounted to the front of the motor case, which remains cooler.The nozzle is mounted into the tapered aft end of the motor case (Fig. 2, right side). Because of its small size, the nozzle cannot use ablative cooling, which would give unacceptable erosion of the nozzle contour. To keep the motor case at an acceptable temperature, the nozzle is supported by special ceramic insulation. Because of the large temperature variations, material selection must be carefully considered: both the nozzle insert material, boron nitride, and the insulation, fused silica, are highly resistant to thermal shock.To illustrate this configuration, an example aircraft’s notional mission requirements are given in Table 1 and notional design parameters are given in Table 2. The exact thrust level depends on details of the aerodynamic design and mission; it can be set by adjusting the amount of burn-rate suppressant in the propellant and the nozzle-throat diameter. With a fixed propellant burn area, a smaller nozzle-throat area would raise the chamber pressure, make the propellant burn more quickly, and increase thrust.C. Aircraft and Motor Design Coupled via the Thrust/Burn Area RatioThe thrust/burn area ratio F/Ab is a useful parameter for examining the link between the aircraft configuration, flight conditions, and motor design. For the example mission (Table 1), thrust and burn area are fixed by the aircraft design and desired trajectory and set an F/Ab ratio, which is one-tenth the value of typical solid rocket motors. Figure 3 shows the F/Ab needed for rocket-propelled aircraft, and Table 3 gives F/Ab for typical rocket motors.Fig. 3 Contours of required F/Ab for steady, level flight versus cruise altitude and Mach number. F/Ab is computed from Eq. (1), using the atmospheric pressure and drag models shown in the inset plots.For steady, level flight, thrust is set to match the drag on the aircraft at cruise speed: F=D=qCDSref, where the drag reference area Sref is chosen to be the forward-facing area of the fuselage. Dividing both sides by Ab gives FAb=qCD(SrefAb)(1)Here, the dynamic pressure q depends on the trajectory, and Sref/Ab depends on how the motor is configured within the fuselage. For an end-burn motor, Ab is the transverse section area of the propellant grain, and Sref will be slightly larger, due to the ablative liner and case wall that surround the propellant (Fig. 2).A simple model is used to illustrate the trends in required F/Ab versus cruise altitude and Mach number; the results are shown in Fig. 3. F/Ab is computed from Eq. (1), with q=(γair/2)paM2. Also, pa vs altitude is from the COESA atmosphere model (left inset), and a generic transonic drag rise curve is used for CD vs Mach (bottom inset).Typical solid rocket motors operate at F/Ab>15  kPa (see Table 3). Most of the cruise conditions in Fig. 3 require much lower F/Ab. The contours in Fig. 3 cover the range of F/Ab (2–15 kPa) supported by the low-thrust motors proposed here. As will be discussed in the following, even these motors cannot achieve F/Ab much below 2 kPa.To derive the relation of F/Ab to the other motor design parameters, we start with the equations for thrust§ and mass flow equilibrium (see Sutton and Biblarz [4]): F=pcAtCF(pc) and m˙=pcAt/c*=Abrρs=Ab(apcn)ρs. Combining the two equations gives FAb=pcnCF(pc)c*aρs(2)The F/Ab ratio depends on the chamber pressure and the properties of the propellant (n, c*, and a and ρs). F/Ab does not depend on the size of the motor. In fact, Table 3 shows that several motors, which differ in size (total impulse) by five orders of magnitude, have similar values of F/Ab, all between 15 kPa and 35 kPa. However, as shown in Fig. 3, low-thrust motors for small, fast aircraft need much lower F/Ab.To make F/Ab small, the motor must operate at low pc and use a slow-burn propellant with low a. This motivated the development of slow-burn propellants for use at low chamber pressures, described in an accompanying paper [9]. However, operating at low pc reduces CF and Isp because the nozzle expansion is less efficient with a lower pressure ratio across the nozzle. Also, each propellant has a minimum pressure below which it will not burn. These considerations set lower limits on F/Ab.This trend is illustrated in Fig. 4 for several different propellants. For each propellant, F/Ab is calculated using Eq. (2). The propellant properties in Eq. (2) are taken from Vernacchia et al. [9]. Isp is calculated using the ideal one-dimensional nozzle model, assuming matched expansion to an ambient pressure of 30 kPa. Three propellants are ammonium perchlorate (AP) propellants developed in [9]. In these propellants, the burn rate is set by the amount of oxamide (a burn-rate suppressant); propellants with more oxamide burn more slowly at a given pressure. For comparison, an ammonium nitrate (AN) propellant is also included in Fig. 4; properties are from [4] and experiments in [10].Fig. 4 Operating at lower F/Ab reduces specific impulse. Slower-burning propellants give higher specific impulse at a given F/Ab.For each propellant, lower pc reduces Isp (left inset), and achieving lower F/Ab requires lower pc (bottom inset). Thus, for each propellant, the achievable Isp is lower if the required F/Ab is lower (top right plot). The minimum combustion pressures for each propellant are marked with an x. The AP baseline propellant curve is not marked with an x because the minimum pc to choke the nozzle flow is higher than the minimum burn pressure of this propellant. The minimum burn pressures were measured in a strand burner, as detailed in [9]. The minimum burn pressure sets a minimum F/Ab for each propellant.Although the AN propellant has the slowest burn rate, the AP + oxamide propellants can operate at lower F/Ab because they have lower minimum combustion pressures. The 10 and 20% oxamide propellants both can provide F/Ab down to about 2 kPa.At a given chamber pressure, propellants with lower c* give lower Isp (left inset). For the AP + oxamide propellants, adding more oxamide reduces the flame temperature and decreases c*. At a given F/Ab, the slower-burning propellants can operate at a higher chamber pressure (bottom inset). At a given F/Ab, slower-burning propellants give higher Isp (top right plot), because the effect of higher chamber pressure outweighs the lower c*.The F/Ab required for the example mission (Table 1) is about 2.9 kPa and is marked with a black dotted line. At this F/Ab, the baseline AP propellant would need such a low pc that the nozzle flow would barely reach sonic velocity, and the specific impulse would be very low (Ispideal<130  s). The 10 and 20% oxamide propellants can operate at the example mission F/Ab. For the 10% oxamide propellant, the motor would operate at pc=0.21  MPa and Ispideal<153  s; for the 20% oxamide propellant, pc=0.81  MPa and Ispideal<170  s. Practically, the desired chamber pressure would be achieved by setting the Ab/At ratio of the motor, and the throat areas would be different for the different propellants.For F/Ab>3.1  kPa, the AN propellant can operate and has slightly higher specific impulse than the AP + oxamide propellant (Fig. 4, top right). However, the AN propellant is less dense (1480  kg⋅m−3 vs 1600  kg m−3), so less propellant mass can fit in the motor. Additionally, the AP + oxamide propellant family can be used for a wider range of F/Ab. Thus, the AP + oxamide propellants are preferred for this application.III. Thermal Protection ChallengesA. Motor Case Design and Thermal Protection ChallengesThe baseline motor case is designed to be simple, lightweight, strong, and manufacturable. Its geometry is a straight cylinder with a domed forward closure and a conical (boat-tail) aft section (Fig. 2). The motor case material must have sufficient strength at the maximum expected temperature of 500–650 K to support the internal pressure loads and should have a low density to reduce the motor’s inert mass fraction. These requirements suggest a titanium alloy such as Ti-6Al-4V. Low-alloy steels (e.g., D6AC or 4130) are a heavier but less expensive alternative. Aluminum alloys and plastic-matrix composites are not usable at the expected temperatures.For manufacturing, the straight section can be made from off-the-shelf tube, whereas the more complex forward closure and aft section can be made via additive manufacturing. The authors worked with Renishaw Canada Ltd. of Mississauga, Ontario, to print, proof test, and test fire several motor case aft sections made from Ti-6Al-4V.For a typical internal burning grain, the propellant insulates the majority of the interior motor case surface from the hot combustion gases during the burn. However, for an end-burning grain, most of the inner surface is exposed to 1500–2200 K combustion gas for several minutes. The inner surface of the motor case is protected by an ablative liner, as is standard design practice for solid rocket motors [11]. An additional insulating layer of fiberglass cloth is included between the ablative and the case to further reduce the motor case temperature. The baseline design uses an ablative liner made from Dowsil 93-104 (formerly Dow Corning 93-104). This ablative consists of glass, ceramic, and carbon fibers in a silicone rubber matrix; some of its thermal properties are reported in [12]. This ablative liner was tested in a research motor, described further in Sec. IV.The motor case heat transfer problem can be thought of in three zones. In the innermost zone, heat is radiated and convected from the hot gas to the ablative surface. Second, the ablative undergoes pyrolysis reactions, forming char and gaseous products. Third, outside the pyrolysis zone, heat is conducted through the remaining ablative, fiberglass insulation, and metallic motor case and is rejected to the atmosphere by convection and radiation.These three zones could be modeled together by software such as CMA [13] and FIAT [14], but here are treated with separate, simple models that are more intuitive. The internal radiation transfer is simplified by treating the gas and solid surface as isothermal radiators. The outer conduction is simplified by noting that the outside of the pyrolysis zone is at a nearly constant temperature, set by the pyrolysis chemistry. The complex middle pyrolysis zone is not modeled, but the char depth vs exposure time was measured experimentally.Heat is transferred from the hot gas to the ablative inner wall by both convection and radiation [15–17]. Radiation is the dominant heat transfer mode in these motors, due to 1) the low combustion gas mass flux, which reduces convection, and 2) the soot content of the gas, which contributes to radiation. Simplified models were used to assess the convective and radiative heat flux to the walls of a cylinder with hot, sooty gas flowing through it.The convective heat flux was modeled using the Colburn correlation for turbulent pipe flow [18]. The radiative heat flux was modeled assuming radiation from an isothermal soot cloud to an isothermal black wall; in this model, qrad=σSB[ϵg(T=Tg)Tg4−ϵg(T=Tw)Tw4](3)where ϵg(T) is the emittance of the soot cloud and is estimated as ϵg(T)=∫0∞[1−exp(−k1CsootLeλ−1)]eb(λ,T)dλσT4(4)with k1=6 and eb(λ,T) being the blackbody spectral emissive power from Planck’s Law. The procedure for estimating emittance follows [19] and is detailed in [20], Sec. 8.3.1.2. The emittance depends on the concentration of soot Csoot and on the mean optical path length through the cloud Le=0.95D; for the conditions in the example motor combustion chamber (Csoot=10−5,¶D=60  mm), ϵg is expected to be 0.8. Using these models, the radiative heat flux to the chamber walls was predicted to be an order of magnitude greater than the convective heat flux. Thus, only radiative heat flux is considered in the following analysis of hot gas energy loss.Heat loss to the walls cools the combustion gas before it reaches the nozzle. This decreases the motor’s c* and Isp, as both are proportional to the square root of temperature at the nozzle inlet.Here, a lumped-parameter model is presented for the cooling of the hot gas by radiation to the walls of the chamber. Consider as a control volume the cylindrical space within the motor between the burning surface of the propellant and the nozzle inlet (Fig. 5). Combustion gas enters this volume at the propellant flame temperature Tflame, with a mass flow rate m˙. It exits this volume into the nozzle at a lower temperature T2. The char surface surrounding this volume is assumed to be at a uniform and constant temperature Tw and receives a uniform heat flux qw.Fig. 5 Control volume for a lumped-parameter model of energy loss from the hot gas.The conservation of energy equation for this control volume is m˙cp(Tflame−T2)=qwAw(5)where cp is the heat capacity of the gas and Aw is the wall area. The heat flux qw is crudely estimated by treating the gas as an isothermal radiator at an average temperature Tavg=(Tflame+T2)/2. The heat flux is computed from Eq. (3), with Tavg substituted for Tg. Cooling will increase the gas density across the control volume, but this effect is neglected when computing the soot concentration and emissivity.Example results of this model are presented in Fig. 6. As the end-burn grain burns away, more length of wall is exposed, and the exposed wall area increases as Aw=πDLexposed. As Aw increases, more heat is lost, and the gas T2 becomes cooler. The predicted heat loss would reduce the time-averaged c* efficiency to 0.84, as ζc*∼(T2/Tflame)1/2. This severe heat loss is an unusual feature of small, long-burn motors. Because the motor has an end-burning propellant grain, heat radiated from the hot gas is mostly lost to the walls. With a typical core-burning grain, thermal radiation from the hot gas mostly warms the propellant surface; most of the heat is returned to the gas when the propellant burns. Because the motor is long, small diameter, and operates at low thrust, the ratio Aw/m˙ is large. Equation (5) shows that Aw/m˙ is proportional to the drop in hot gas temperature. Thus, it seems that low c* efficiency is an inevitable feature of these motors. This is supported by the c* measured in static firings (Sec. IV).Fig. 6 A model of heat loss from the combustion gas to the walls suggests that the combustion gas will be cooled significantly.For the conduction problem outside the pyrolysis zone, a simple model is used to assess the maximum temperature the motor case could attain at burnout. Imagine that the ablation process were “paused” at burnout, and the heat transfer from the ablative pyrolysis zone to the motor case came to steady state. The heat flux into the case would be qintocase,ss=(lvirginkvirgin+linsulkinsul)−1(Tpyrolysis−Tcase)(6)where lvirgin is the remaining thickness of virgin ablative material, linsul is the fiberglass insulation thickness, and Tpyrolysis is the temperature of the pyrolysis zone. The case temperature in this fictional steady state can be found by solving qintocase,ss=−qexternal=hexternal(Tcase−Tair)+ϵcaseσSB(Tcase4−Tambient4)(7)In reality, the heat flux into the case will be less than qintocase,ss, because virgin ablative is still warming up. Thus, the solution of Eqs. (6) and (7) for Tcase gives an upper-limit value for the case temperature.Solutions of this model are plotted versus external convection coefficient in Fig. 7. The assumed parameter values are lvirgin=1  mm, Tpyrolysis=720  K, and kvirgin=0.35  W⋅m−1⋅K−1 for Dowsil 93-104 [12], kinsul=0.05  W⋅m−1⋅K−1 [21], Tair=248  K, ϵcase=0.3 (typical for Ti alloys), and Tambient=300  K. The blue region shows the expected range of external airflow convection coefficients in flight. These results give confidence that the motor case will remain below the strength-limit temperature of Ti-6Al-4V, so long as the ablative liner does not char through.Fig. 7 Upper-limit motor case temperature versus external convection coefficient for several fiberglass insulation thicknesses.B. Nozzle Design and Thermal ChallengesThe size vs duration design space for solid rocket motor nozzles is shown in Fig. 8. The nozzle for the example motor (blue star) is almost alone in the bottom-right corner. Some other motors have similarly small nozzles (e.g., the STAR 4G) but much shorter burn times. Other motors have long burn times (e.g., over 100 s for the Shuttle RSRM, Orbus-21, Condor, and Five-Minute Motor) but have throat diameters orders of magnitude larger. The bottom right corner (small, long burn) of the design space is associated with difficult thermal issues because of the physics of heat transfer within the nozzle. Data in Fig. 8 are from [4,7,22,23].Conventional solid rocket nozzle designs rely on transient techniques (e.g., heat sink, ablatives). Generally, the length scales for transient heat penetration phenomena (e.g., thermal diffusion, char depth, erosion) scale with exposure time like t1/2 to t1. Longer exposure times give length scales that are too large for very small nozzles. For example, a typical ablative nozzle (like the Shuttle RSRM) would erode by 20 mm under the example motor’s throat conditions and burn time; however, the throat diameter of this nozzle is only 2–5 mm. Instead, a steady-state insulation solution is proposed.Fig. 8 Design space of nozzle-throat diameter vs burn time. Small, long-burn-time nozzles (bottom right corner of the plot) are unusual and face difficult thermal issues.A representative nozzle design is shown in Fig. 9. The nozzle consists of an insert through which the hot gas flows and insulator that contains the heat convected into the insert. The nozzle’s structural shell is an extension of the aft section of the motor case. The insert material is boron nitride ceramic, and the insulator is fused silica. Because the nozzle shell and insulation have different coefficients of thermal expansion, the shell-insulation bond is made with a flexible silicone adhesive.**Fig. 9 Section view of the nozzle from the baseline motor design.Although the insulation is only 6–14 mm thick, there must be a large temperature difference across it. The operating temperature of the insert is 1500–2000 K, whereas the maximum allowable temperature of the shell is limited to 644 K by the shell-insulation adhesive. Thus, the relatively thin insulator must provide a very large thermal resistance and withstand the thermal stresses induced by an extreme thermal gradient.The thermal expansion of the hot inner material is constrained by the cool outer material. It can be shown [24] that the circumferential tensile stress on the outer surface is σθ=αLEE1−νΔTCgeometry(8)where ΔT is the temperature difference between the inside and outside of the insulation, and Cgeometry is a constant factor that depends on the insulator geometry.To survive the thermal stresses, the insulator must be made from a ceramic with favorable material properties. Following Kingery [25], we define the thermal shock resistance parameter Rs: Rs≡Sflex(1−ν)EαLE;RsΔT∼Sflexσθ(9)Ceramics with higher Rs will be less likely to fail due to thermal stress. Because the geometry factor in Eq. (8) is approximately 1 for the insulator, Rs should (at least) be on the order of the temperature difference ΔT across the insulator. Fused silica is a good insulation material because it has a high Rs (960 K) and low thermal conductivity (1  W⋅m−1⋅K−1).Insulation with a cellular structure was investigated as a means to further reduce the thermal conductivity and improve the thermal stress resilience. Ceramic materials with a cellular or porous structure are widely used as insulation materials: examples include firebrick, ceramic foam kiln insulation, and silica-fiber reusable surface insulation tiles used on the Space Shuttle Orbiter [26]. For thermal stresses, a cellular structure reduces stiffness (favorable) but also reduces strength (unfavorable); in some cases, the net effect increases the thermal shock resistance [27].The geometry for the cellular insulator is a honeycomb wrapped onto the revolved shape of the insulator (Fig. 10). This orientation of the honeycomb gives low stiffness in the circumferential direction at the outer face. When bonded into the motor case, the cells are closed off, and there are multiple solid walls in the axial direction. This gives redundancy against leaks; the insulator will remain gas tight even if a few cell walls crack. The cell wall thickness is just over 1 mm; this is about the thinnest wall that can reliably be produced. The thin cell walls reduce the conductive heat transfer in the radial direction.Fig. 10 Geometry of the honeycomb cellular ceramic insulation invented for this work.This shape is compatible with the vat photopolymerization†† printing process. To produce the insulation, first a green part is printed via vat photopolymerization. The green part consists of silica particles held together by a photopolymer binder. Then, the green part is fired in a kiln to burn out the binder and sinter the particles together. The kiln is held at a maximum temperature of 1271°C for 5 min; the temperature schedule of the sintering process has important effects on material properties (see [20], Sec. 10.4.1, and [28]). After kiln firing, the fused silica insulation is bonded to the boron nitride nozzle insert using a silica ceramic adhesive. The insulation and insert are then bonded into the nozzle shell with a silicone polymer adhesive.Analysis of the thermal stresses in the honeycomb (presented in [20], Sec. 10.3, using honeycomb mechanics theory from [29]) indicates that the thermal stresses in the honeycomb are less if the cell walls are thinner. At the current minimum printable wall thickness (1 mm), the honeycomb does not have better thermal stress performance than a monolith. However, finer walls and better thermal stress performance may become possible as printing technology improves. Because the cellular design offers other advantages (lower thermal conductivity, limited crack propagation, and better binder burnout during sintering), it was selected as the baseline insulation design.Thermal analysis was conducted to determine the insulation thickness required to keep the nozzle shell temperature below the temperature limit of the shell-insulator adhesive (Fig. 11). A two-dimensional axisymmetric, steady-state, finite element model was used. The internal convection boundary condition was determined in a separate computational fluid dynamics analysis (detailed in [20], Sec. 9.2.1.3), which accounted for film cooling from the ablative liner and used a hot gas temperature of 2000 K and pressure of 0.7 MPa. Increasing the hot gas temperature or pressure would cause the shell temperature to be higher than shown in Fig. 11. The external boundary condition assumed convection with Taw=248  K and radiation with ϵ=0.9 to a 300 K environment. The exact external convection coefficient will depend on the flight altitude, speed, and detailed aerodynamic design, but a plausible range is highlighted in blue in Fig. 11. An insulation thickness of 10 mm is expected to suffice for most conditions. Thicker insulation increases the base diameter of the fuselage, which increases drag and decreases range.Fig. 11 Maximum steady-state temperature on the nozzle shell versus external convection coefficient for various nozzle insulation thicknesses.C. Nozzle Clogging and Pressure SpikesThe nozzle is vulnerable to clogging by solid debris, due to its very small throat size. Several temporary spikes in chamber pressure were observed in the motor firings. These spikes had amplitudes of 0.091 MPa above the earlier chamber pressure (10–100% of nominal chamber pressure at time of excursion) and rise times of about 1 s (pressure traces from the motor firings are presented in Sec. IV.B.1). These pressure spikes coincided with debris being ejected from the nozzle, visible in high-speed video of the motor firings.A possible explanation of these events is that a piece of solid debris, likely char from the ablative liner, temporarily blocks the nozzle. This reduces the amount of gas that can flow out through the nozzle, causing the chamber pressure to rise. The piece of debris is then ejected, suddenly reopening the nozzle throat and returning the chamber pressure to its normal level. The nozzle-throat diameters were only ∼3  mm, so even small pieces can block most of the throat area. An alternative explanation is that the pressure spikes are caused by flaws in the propellant grain that temporarily increase the burn area [30].To survive these pressure spikes, the motor case must be designed to withstand higher pressures. A somewhat arbitrary suggestion is that the motor case’s maximum design pressure should be 2.0 MPa above the maximum nominal chamber pressure; 2.0 MPa is two times the amplitude of the largest observed pressure spike. Because the nominal chamber pressure is so low, it is likely that a motor case with the minimum manufacturable wall thickness will already provide this margin.IV. Motor TestingA research motor was developed and fired in a static test facility, using the slow-burn propellants from [9] at low chamber pressure. The low thrust/burn area levels needed for this class of motor were successfully demonstrated. These tests also measured the nozzle and combustion efficiencies ζCF and ζc* as defined in [4]. The research motor was also used to test the ablative liner and ceramic-insulated nozzle.A. Research Motor and Test FacilityThe research motor’s components are shown in Fig. 12. The motor case is a round tube made from grade 2 titanium. The end-burning propellant grain burns from right to left in Fig. 12; it is 40 mm in diameter. A full-length propellant grain has a mass of about 700 g, although sometimes the motor has been tested with shorter-length propellant grains. The ablative liner, 3.5 mm thick Dowsil 93-104 backed by fiberglass cloth, protects the motor case from the hot combustion gases. The motor normally uses a water-cooled nozzle (as shown in Fig. 12).Fig. 12 Cross section of the research motor, showing the end-burn propellant grain, ablative liner, and water-cooled nozzle.It was found that a flat face of slow-burn propellant could not be reliably ignited. Ignition was made more reliable by placing a small (2–4 g) piece of faster-burning propellant (“starter grain”) into a “starter pocket” in the aft end of the propellant grain.‡‡ The starter grain was ignited by a 6 W blue laser§§ shone through the nozzle. The burning starter grain then ignited the main propellant grain around it. The additional burn area of the starter pocket causes an initial peak in chamber pressure. After the starter pocket burns away, the burning surface becomes a flat circle [with burn area π (20  mm)2=1257  mm2], and the chamber pressure levels off at a lower value for the rest of the firing.The research motor and its instrumentation are shown in Fig. 13a. The motor was instrumented to measure chamber pressure, thrust, and the temperature of the motor case at several locations. Measuring very low thrust levels required a specialized thrust stand, which is described in [20], Sec. 7.3. Table 4 lists the manufacturer’s rated accuracy of each sensor, and the resolution at which it was read by the analog-to-digital converter (ADC)¶¶ used in these experiments. For each thermocouple, the bias was calibrated out (to within 0.1 K) using an ice-water bath before mounting the thermocouple to the motor case. All data channels were recorded at 100 Hz.Fig. 13 a) The research motor is instrumented to measure thrust, chamber pressure, and case temperatures and b) a prototype air-cooled nozzle was tested on the research motor.The research motor was also used to test prototypes of air-cooled, ceramic-insulated nozzles discussed in Sec. III.B. This setup is shown in Fig. 13b. Two air-cooling jets blow onto the nozzle shell to simulate the in-flight external air flow.B. Motor Testing ResultsFive static firings of the research motor are analyzed here; the conditions of these firings are listed in Table 5. These firings were used to measure the motor’s thrust coefficient and characteristic velocity and to verify operation at low F/Ab.1. Thrust and Chamber Pressure MeasurementsThrust and chamber pressure measurements were recorded for all static fires (Fig. 14). The thrust and pressure curves for static fires (SFs) A, B, and D all have a similar shape: a peak followed by a plateau. The peak is due to increased burn area just after ignition; the thrust and pressure plateau results once a flat end-burn surface is achieved. SF-C used a multisegment propellant grain. The aft (first to burn) segment contained 0% oxamide, burned faster, and produced higher chamber pressure and thrust. The front (last to burn) segment contained 10% oxamide, burned slower, and produced lower chamber pressure and thrust. The multisegment grain is described further in Mathesius [30]. SF-E had the highest oxamide content of 20%. The thrust and chamber pressure decayed during the course of the burn due to nozzle erosion and increasing heat loss to the walls as the burning propellant grain receded. The propellant self-extinguished after 54 s at a chamber pressure of approximately 0.5 MPa, near the minimum burning pressure for 20% oxamide propellant, which is discussed further in Vernacchia et al. [9].Fig. 14 Thrust (left column) and chamber pressure (right) measurements for each static fire. Raw measurements are shown in gray; the filtered signals (5 Hz low-pass, zero-phase, fifth-order Butterworth filter) are shown in blue.In static fires SF-A and B, there is a large amount of noise in the thrust data caused by a cooling pump mounted near the thrust stand. The cooling pump was mounted elsewhere for SF-C and was not used in SF-D or E. In SF-A and B, the measured chamber pressure decays very slowly after burnout due to the pressure transducer plumbing becoming clogged with soot. The plumbing was modified for subsequent static fires to remedy this issue. The cause of the thrust and pressure spike at burnout in SF-A is not known.2. Operation at Low Thrust/Burn Area RatioA very low thrust/burn area ratio of F/Ab=2.4  kPa was achieved in static fires SF-A and B. Both firings used a 13% oxamide propellant, and operated at a very low chamber pressure. The “steady” chamber pressure (after the starter pocket transient) was 0.52 MPa in SF-A and 0.49 MPa in SF-B.These tests were very close to the lower limit on F/Ab. Using the methods from Sec. II.C, the lowest possible F/Ab for this propellant was predicted to be 2.7 kPa. However, this analysis assumed ideal nozzle flow. Taking into account the measured nozzle losses (ζCF=0.851), the predicted lower limit is F/Ab=2.3  kPa. Thus, SF-A and SF-B operated very close to the lowest possible F/Ab for their propellant.Demonstrating operation at low chamber pressure, close to the F/Ab limit, is an important technology risk reduction for low-thrust motors. Other propellants and motors exhibit low-frequency combustion instability (chuffing) when operated at low chamber pressure [4]. These tests show that this slow-burn propellant can operate at very low pc without chuffing, which is necessary for low-thrust motors.3. Characteristic Velocity MeasurementsThe time-averaged c* was measured from the pressure data pc(t), the nozzle-throat area At (average of measurements before and after firing, 0.02 mm accuracy), and the propellant grain mass mp: ⟨c*⟩=Atmp∫tstarttendpc(t) dt(10)The accuracy of the c* measurement is estimated to be ±15 m⋅s−1, using the propagation of error techniques from [31].Characteristic velocity measurements for static fires SF-A, B, D, and E are presented in Fig. 15. For comparison, the ideal c* computed from chemical equilibrium simulations is plotted as a solid black curve; curves for ζc*=0.90 and 0.80 are also shown.Fig. 15 Characteristic velocity measurements (with error bars) for static fires SF-A, B, D, and E.These values for ζc* are unusually low. In larger motors, ζc* is typically >0.95 [4]. The low values of ζc* are probably due to heat loss from the combustion gas to walls of the motor, as c* is proportional to the square root of temperature at the nozzle inlet. The ζc* values measured here agree with the gas cooling predicted by the radiation model in Fig. 6.4. Thrust Coefficient MeasurementsThe thrust coefficient CF measures the effectiveness of the nozzle expansion process. The measured CF is computed from the thrust recording F(t), chamber pressure recording pc(t), and nozzle-throat area At: CFmeas=F/(Atpc). The ideal value of CF can be calculated from first principles [4]. The thrust coefficient efficiency is the ratio of the measured and ideal values: ζCF=CFmeas/CFideal.In all tests, the ideal CF was rather low due to low chamber pressure. The measured CF values were even lower. For example, in SF-E, the average ζCF was 0.924. Figure 16 shows the ideal and measured CF vs time during this firing.***Fig. 16 In static fire SF-E, the average thrust coefficient efficiency was only 0.924.This is a fairly low value of ζCF. In large, well-designed nozzles, ζCF is usually >0.95. However, the nozzles in this work are expected to have larger viscous losses due to their small size. Viscous losses are higher at lower Reynolds number; the throat ReD for these nozzles was about 2.5×104 whereas typical large rocket nozzles have ReD on the order of 106. These viscous losses are an unavoidable feature of small nozzles.5. Ablation and Char Penetration Depth MeasurementsThe char penetration depth determines the required initial thickness of the ablative liner. Thus, measurements of the char penetration depth under realistic motor conditions are important for motor design.After static firings of the motor, the char depth was measured by cutting the liner in half and photographing the section. The liner charring is shown in Fig. 17. There are two distinct regions of char: a black layer on top and a white layer beneath it. The remaining virgin (uncharred) liner material is gray.Fig. 17 The ablative liner is charred by exposure to hot gas. The char has penetrated deeper where the exposure time is longer. Char also builds up beyond the initial thickness of the liner.The end-burning propellant grain burned from right to left in these figures, so the right side was exposed to hot gas for longer. At the right side of Fig. 17c, the char has penetrated deeper into the liner, and less virgin material remains. The char layer extends beyond the original surface of the liner (marked by a red dashed horizontal line in Fig. 17c). This is partially due to the liner material swelling as it chars and partially due to soot deposited on the liner from the combustion gas.Char depth measurements for four static firings are shown in Fig. 18. These firings used propellant with 10% or 13% oxamide and had chamber pressures of 0.5–1.0 MPa.††† For two of the firings (SF-A and SF-D), two sets of depth measurements were taken, one from each side of the cut through the liner. The data show that the char depth increases sublinearly with exposure time. These results indicated that this ablative liner design is feasible for small, long-burn-time motors. Despite the long burn time, the ablative liner only needs to be a few millimeters thick and will not occupy an excessive amount of volume within the motor case.Fig. 18 Char depth measurements from four static firings show that char depth generally increases with exposure time.6. Case Temperature MeasurementsSix thermocouples (type K) were mounted on the outside of the motor case. The temperatures recorded during the SF-C firing are shown in Fig. 19. Thermocouple TC1 was located 80 mm from the aft end of the motor; the other thermocouples were spaced forward in 50 mm increments.Fig. 19 Case temperatures from static fire SF-C. The temperature of each thermocouple (TC1–6) begins to rise after the flame front passes it.The flame front passed under TC1 (the aft-most thermocouple) first; its temperature is the first to rise. There is almost no thermal conduction along the case; the thermocouples remain at the initial temperature until after the flame front passes them. Despite the long test duration (90.3 s), the case did not reach thermal steady state; its temperature was still rising at burnout. After burnout, the case temperature continued to increase as heat from the hot char soaked out to the case.These measurements indicate that the thermal protection system performed adequately. The case temperatures recorded during the firing are well below the allowable limit for Ti-6Al-4V (810 K). The case temperature did exceed the 644 K limit of the shell-nozzle adhesive, but only did so after burnout, and after burnout that adhesive may fail without consequence. This static firing had little external airflow on the case; a separate experiment measured the external convection coefficient to be 3  W⋅m−2⋅K−1. Evaluating Eqs. (6) and (7) with this hexternal value predicts an upper-limit case temperature of 683 K, just above the maximum temperature measured in SF-C. With in-flight airflow, the model predicts the case temperature could be kept below 644 K, even for longer firings that approach thermal quasi-steady state (Fig. 7). This should be validated in future motor firings.7. Nozzle DemonstrationCeramic insulated nozzles were tested on the research motor in static fires SF-D and E; the test hardware is shown in Fig. 13b. The in-flight external convection is simulated by air-cooling jets, which blow on the nozzle shell. These firings demonstrated that the ceramic honeycomb insulation could withstand the period of highest thermal stress (which is expected to occur about 10 s after ignition).These nozzle tests revealed the importance of proper material quality for the nozzle inserts. In SF-D, severe pitting of the nozzle walls was observed (see photograph in [20] Fig. 9-25). Because the pitting disturbed the nozzle gas flow, the average CF efficiency for SF-D was only 0.748. The pitting is likely due to impurities in the boron nitride (BN) material. The SF-D nozzle insert used a grade of boron nitride that contained B2O3 binder; this binder is not suitable for high temperatures. For SF-E a new nozzle insert was made from a 99% pure binder-less grade of boron nitride.‡‡‡ With the pure BN, no pitting occurred, and the average CF efficiency was higher, at 0.924.As reported in Table 5, the boron nitride nozzle insert’s throat eroded during both firings. Some throat erosion still occurred in SF-E, even with the improved material; however, the amount of erosion appears acceptable.V. ConclusionsSmall, fast aircraft need miniature, yet powerful, propulsion systems. Low-thrust solid rocket motors can meet this need. For example, a kilogram-scale solid rocket motor could produce 5–10 N of thrust for a few minutes, which would enable a small UAV, built around the motor, to fly at Mach 0.8.Such a motor is very different from conventional kilogram-scale solid rocket motors. The thrust level is orders of magnitude lower, and the burn time is 10–100 times longer. To design these motors, the preliminary selection of thrust, chamber pressure, and propellant can be made using the charts in Sec. II.C and is linked to the aircraft design and mission by the thrust/burn area ratio. Three major technology challenges arise for these motors, and were investigated in this work. First, a slow-burn propellant is needed, which must operate at unusually low chamber pressures of 0.5–2 MPa. Several AP + hydroxyl-terminated polybutadiene (HTPB) + oxamide propellants were characterized; their burn rates can meet the needs of a range of aircraft and missions by varying the propellant’s oxamide content. Second, the inner surface of the motor is exposed by the end-burn configuration and requires thermal protection. This is accomplished with a silicone-matrix ablative and fiberglass insulation, but the heat loss from the combustion gas causes a noticeable 15% reduction in impulse. Third, the millimeter-scale nozzle cannot be ablatively cooled for several minutes, and instead uses a ceramic nozzle surrounded by thermal-stress-tolerant fused silica insulation. The feasibility of all these solutions was demonstrated in motor firings.K. A. GonthierAssociate Editor‡ The ballistic rocket’s range is computed using an ordinary differential equation solver, a generic streamlined body CD(M) table, and the COESA atmosphere model.§ Properly, CF is a function of γ,pe/pc, and pa/pc. In this analysis, it is assumed that γ is the same for all propellants, and that the nozzle expansion is always designed to give pe matched to the ambient pressure at the cruise altitude. With these other parameters fixed, CF is a function of just pc.¶ The soot concentration was measured in separate propellant combustion experiments; see [20], Sec 5.6.** This work used Permatex Ultra Copper RTV silicone from ITW Permatex, Solon, Ohio.†† Also known as stereo-lithography; performed on a Form 2 printer from Formlabs, Somerville, Massachusetts.‡‡ The starter pocket is not depicted in Fig. 12 (as depicted in that figure, it has already burned away) but is depicted in Figs. 7-5 and 7-6 of [20].§§ A NUBM44 445 nm laser diode from Nichia Corp., Anan, Japan.¶¶ U3 data acquisition system from LabJack Corp., Lakewood, Colorado.*** The measured value exceeding the ideal value at startup is an artifact due to the slower impulse response of the pressure sensor compared to the thrust sensor.††† For SF-C, which used a multisegment propellant grain, only data from the forward segment are included in Fig. 18. The aft portion of the liner was exposed to combustion gases from both grain segments, so its char depth is more difficult to interpret.‡‡‡ Supplied by Aremco Products Inc., Valley Cottage, New York.AcknowledgmentsThis work was funded by BAE Systems, Inc., Massachusetts Institute of Technology (MIT) Lincoln Laboratory, and the U.S. Department of Defense’s Rapid Reaction Technology Office (RRTO). Jon Spirnak designed and built the research motor as part of master’s thesis research. Todd Billings and David Robertson of the MIT Aeronautics and Astronautics shops and Mark Kirby and Carl Hamann of Renishaw Canada Ltd. assisted in the production of the research motor and its test facility equipment. Undergraduate research assistants Jakob Coray and Jovan Zhang helped to set up the motor test facility and characterize the nozzle air-cooling system.\r            References\r        [1] Jane’s All the World’s Aircraft: Unmanned, IHS Markit, London, 2016. Google Scholar[2] Jane’s All the World’s Aircraft: In Service, IHS Markit, London, 2016. Google Scholar[3] Lennox D. and Rees A., Jane’s Weapons: Air Launched, Jane’s Information Group, Alexandria, VA, 1988. Google Scholar[4] Sutton G. P. and Biblarz O., Rocket Propulsion Elements, 8th ed., Wiley, Hoboken, NJ, 2010, p. 65, 448. Google Scholar[5] Shafer J. I., “Solid-Propellant Motors for High-Incremental-Velocity Low-Acceleration Maneuvers in Space,”  Jet Propulsion Lab.  JPL-TM-33-528, Pasadena, CA, March 1972, https://ntrs.nasa.gov/search.jsp?R=19720012197. Google Scholar[6] Nowakowski P., Kasztankiewicz A., Marciniak B., Okninski A., Pakosz M., Noga T., Majewska E., Rysak D. and Wolanski P., “Space Debris Mitigation Using Dedicated Solid Rocket Motor,” 8th European Conference for Aeronautics and Space Sciences, EUCASS Assoc. Paper # 994, 2019. https://doi.org/10.13009/EUCASS2019-994 Google Scholar[7] Compton J., Thies C., Kurzeja S. and McGarry J., “Five-Minute Rocket Motor,” AIAA/SAE 10th Propulsion Conference, AIAA Paper  1974-1203, Oct. 1974. https://doi.org/10.2514/6.1974-1203 LinkGoogle Scholar[8] Cavcar M., “Bréguet Range Equation?” Journal of Aircraft, Vol. 43, No. 5, 2006, pp. 1542–1544. https://doi.org/10.2514/1.17696 LinkGoogle Scholar[9] Vernacchia M. T., Mathesius K. J. and Hansman R. J., “Slow-Burn Ammonium Perchlorate Composite Propellants with Oxamide: Burn Rate Model, Testing, and Applications,” Journal of Propulsion and Power (to be published). https://doi.org/10.2514/1.B38106 Google Scholar[10] Vernacchia M. T., “Development, Modeling and Testing of a Slow-Burning Solid Rocket Propulsion System,” M.S. Thesis,  Massachusetts Inst. of Technology, Cambridge, MA, 2017, https://dspace.mit.edu/handle/1721.1/112515. Google Scholar[11] Natali M., Kenny J. M. and Torre L., “Science and Technology of Polymeric Ablative Materials for Thermal Protection Systems and Propulsion Devices: A Review,” Progress in Materials Science, Vol. 84, Dec. 2016, pp. 192–275. https://doi.org/10.1016/j.pmatsci.2016.08.003 CrossrefGoogle Scholar[12] Resch C. L., “Ablation Models of Thermal Protection Materials,” Johns Hopkins APL Technical Digest, Vol. 13, No. 3, 1992, pp. 426–430, https://www.jhuapl.edu/Content/techdigest/pdf/V13-N03/13-03-Resch.pdf. Google Scholar[13] Moyer C. B. and Rindal R. A., “An Analysis of the Coupled Chemically Reacting Boundary Layer and Charring Ablator. Part 2—Finite Difference Solution for the In-Depth Response of Charring Materials Considering Surface Chemical and Energy Balances,”  NASA  CR-1061, June 1968, https://ntrs.nasa.gov/search.jsp?R=19680017220. Google Scholar[14] Chen Y.-K. and Milos F. S., “Ablation and Thermal Response Program for Spacecraft Heatshield Analysis,” Journal of Spacecraft and Rockets, Vol. 36, No. 3, 1999, pp. 475–483. https://doi.org/10.2514/2.3469 LinkGoogle Scholar[15] Pearce B. E., “Radiative Heat Transfer Within a Solid-Propellant Rocket Motor,” Journal of Spacecraft and Rockets, Vol. 15, No. 2, 1978, pp. 125–128. https://doi.org/10.2514/3.28003 LinkGoogle Scholar[16] Duval R., Soufiani A. and Taine J., “Coupled Radiation and Turbulent Multiphase Flow in an Aluminised Solid Propellant Rocket Engine,” Journal of Quantitative Spectroscopy and Radiative Transfer, Vol. 84, No. 4, 2004, pp. 513–526. https://doi.org/10.1016/S0022-4073(03)00268-1 CrossrefGoogle Scholar[17] Cross P. G., “Radiative Heat Transfer in Solid Rocket Nozzles,” Journal of Spacecraft and Rockets, Vol. 57, No. 2, 2020, pp. 247–260. https://doi.org/10.2514/1.A34598 LinkGoogle Scholar[18] Hill P. and Peterson C., Mechanics and Thermodynamics of Propulsion, 2nd ed., Pearson Education, Inc., New York, 1992, pp. 129–130. Google Scholar[19] Siegel R. and Howell J. R., “Thermal Radiation Heat Transfer: Volume 3—Radiation Transfer with Absorbing, Emitting, and Scattering Media,”  NASA  SP-164, Vol. 3, Jan. 1971, https://ntrs.nasa.gov/search.jsp?R=19710021465. Google Scholar[20] Vernacchia M. T., “Development of Low-Thrust Solid Rocket Motors for Small, Fast Aircraft Propulsion,” Ph.D. Dissertation,  Massachusetts Inst. of Technology, Cambridge, MA, May 2020, https://hdl.handle.net/1721.1/127069. Google Scholar[21] Spirnak J. R., “Development, Modeling and Testing of Thermal Protection Systems in Small, Slow-Burning Solid Rocket Motors,” Thesis, Massachusetts Inst. of Technology, Cambridge, MA, 2018, https://dspace.mit.edu/handle/1721.1/118689. Google Scholar[22] Propulsion Products Catalog, Nothrop Grumman Innovation Systems, Magna, UT, June 2018. Google Scholar[23] Ellis R. A. and Keller R. B., “SP-8115: Solid Rocket Motor Nozzles,”  NASA  SP-8115, June 1975, https://ntrs.nasa.gov/search.jsp?R=19760013126. Google Scholar[24] Barron R. F. and Barron B. R., “Thick-Walled Cylinders and Spheres,” Design for Thermal Stresses, Wiley, Hoboken, NJ, 2011, pp. 378–415. https://doi.org/10.1002/9781118093184.ch9 Google Scholar[25] Kingery W. D., “Factors Affecting Thermal Stress Resistance of Ceramic Materials,” Journal of the American Ceramic Society, Vol. 38, No. 1, 1955, pp. 3–15. https://doi.org/10.1111/j.1151-2916.1955.tb14545.x CrossrefGoogle Scholar[26] Goldstein H. E., “Fibrous Ceramic Insulation,” Advanced Materials Technology, NASA Langley Research Center, Hampton, VA, Nov. 1982, pp. 261–274, https://ntrs.nasa.gov/search.jsp?R=19830003890. Google Scholar[27] Lu T. J. and Fleck N. A., “The Thermal Shock Resistance of Solids,” Acta Materialia, Vol. 46, No. 13, 1998, pp. 4755–4768. https://doi.org/10.1016/S1359-6454(98)00127-X CrossrefGoogle Scholar[28] Wan W., Huang C.-E., Yang J., Zeng J. and Qiu T., “Effect of Sintering Temperature on the Properties of Fused Silica Ceramics Prepared by Gelcasting,” Journal of Electronic Materials, Vol. 43, No. 7, 2014, pp. 2566–2572. https://doi.org/10.1007/s11664-014-3112-7 Google Scholar[29] Gibson L. J. and Ashby M. F., Cellular Solids: Structure and Properties, 2nd ed., Cambridge Solid State Science Series, Cambridge Univ. Press, Cambridge, England, U.K., 1997, pp. 94–106. https://doi.org/10.1017/CBO9781139878326 Google Scholar[30] Mathesius K. J., “Manufacturing Methods for a Solid Rocket Motor Propelling a Small, Fast Flight Vehicle,” MS Thesis, Massachusetts Inst. of Technology, Cambridge, MA, June 2019, https://dspace.mit.edu/handle/1721.1/122377. Google Scholar[31] “Propagation of Error for Many Variables,” NIST/SEMATECH e-Handbook of Statistical Methods, National Inst. of Standards and Technology, Gaithersburg, MD, Oct. 2013. https://doi.org/10.18434/M32189 Google Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Custer Channel Wings for Short Takeoff and Landing of Unmanned Aircraft",
        "url": "https://arc.aiaa.org/doi/10.2514/1.C035944",
        "date": "20210916",
        "content": "AbstractThe channel wing is a lift-enhancement concept pioneered by Willard Ray Custer in the late 1940s in an effort to provide a fixed-wing aircraft with short takeoff and landing (STOL) capabilities. This paper experimentally investigates the possibility of using Custer channel wings for slow flight and STOL of small (under 35 kg) fixed-wing unmanned aerial vehicles. The Custer unmanned aircraft developed at the University of Southampton is introduced in this paper, including details of the installed channel wings and other systems necessary for slow-flight operation. Results from wind-tunnel tests are presented, showing a significant lift increase due to the channel wings in the range of airspeeds of interest. Flight tests are carried out to demonstrate the slow flight and STOL capabilities of the aircraft, showing superior stall characteristics and a two-thirds reduction of the runway length required when using the channel wings. Flight-test comparisons to a conventional wing–propeller configuration show superior slow-flight performance and 7–9% lower cruise speed of the channel-wing aircraft.I. IntroductionThere is often a need for aviation missions in spatially restricted environments where long runways are not available. Many concepts of vertical takeoff and landing (VTOL) aircraft exist; these are, however, usually not able to reach high cruise speeds and cover much range compared to conventional fixed-wing airplanes because of needing oversized rotors designed for vertical takeoff. A compromise between fixed-wing cruise properties and VTOL capabilities is offered by concepts characterized as short takeoff and landing (STOL) aircraft. Using aerodynamic lifting surfaces and various forms of lift-enhancement systems, STOL airplanes can be efficient in cruise flight while providing improved takeoff and landing performance.An example of such a lift-enhancement concept is the channel wing invented by Willard Ray Custer in the late 1940s. A standard wing (or part of it) on a fixed-wing airplane is replaced by a wing of semicircular shape enclosing a propeller (see Fig. 1). The spinning propeller draws air over the upper surface of the curved wing, generating lift even when the airplane is stationary or when its airspeed is very low.The channel wing was researched, mostly experimentally, between the 1940s and 1970s by several institutes, including the U.S. Army Air Forces (AAF) [1,2], NACA [3], ANTONOV [4], and Rhein-Flugzeugbau [5]. Somewhat later, NASA financed research of a pneumatic circulation control channel wing conducted by Englar and Campbell [6] (see [7] for a more comprehensive review of literature and patents). A theoretical approach for modeling of the channel-wing aerodynamics was proposed in 1971 by Blick and Homer [8], and high-fidelity computational analysis of the channel wing was conducted by Müller et al. [9] in 2014, both replicating the high-lift augmentation effect known from experiments.Fig. 1 Early CCW-2 aircraft, 1948. (Image courtesy of custerchannelwing.net; http://www.custerchannelwing.net/images/CCW-2_1948.jpg [retrieved 12 August 2021].)The early AAF study [1] reports that the observed channel wings are “markedly inferior to the helicopter in producing static lift, but superior to conventional wing–propeller arrangements in producing both static lift and lift when forward velocity exists,” while the lift increment is “of the same nature as that existing with conventional wing–propeller arrangements.” It is presumed in the report that the channel wing is more effective in producing lift than conventional arrangements “due to the channeling effect of the duct on the propeller inflow and to effects of the propeller trailing vortices.” The NACA study [3] is skeptical about performance and handling qualities of the tested Custer airplane at static conditions, but the data measured at positive forward speeds reveal a favorable lift-enhancement effect of the channel wings at high angles of attack.Although a few light aircraft using the channel-wing concept were produced by the Custer Channel Wing Corporation in the 1950s and 1960s (see Fig. 2), the development was discontinued due to financial issues after failing to obtain certification and attract new investors. The precertification flight tests of the CCW-5 aircraft discovered insufficient handling qualities, and even though these were subsequently improved by empennage modifications, the alleged STOL performance (takeoffs within 250 ft and stall speed 22 mph comparing to 1000–3000 ft and 70–80 mph for similar existing aircraft [10–13]) was not replicated in a commercial evaluation and was deemed as “not impressive enough” to balance deficiencies in cruise performance and costs [14]. Critics further emphasized safety concerns over the possibility of engine failure during a landing or takeoff, and poor visibility over the nose of the airplane at high pitch attitudes [11].In application to unmanned aerial vehicles (UAVs), issues, such as passenger safety and comfort, are not relevant. Compared to other lift augmentation devices, production of channel wings at this scale is simple and repeatable by adopting 3-D printing technology for manufacture combined with the availability of reliable off-the-shelf electric motors and propellers. The simplicity and robustness of such a high-lift system with minimum moving parts and maintenance requirements are what motivated the study of channel wings by researchers at the University of Southampton.Fig. 2 Original CCW-5 aircraft. (Image courtesy of custerchannelwing.net; http://www.custerchannelwing.net/images/CCW5_1.jpg [retrieved 12 August 2021].)In 2016, the first paper dealing with the use of channel wings for UAVs was published [15], including computational fluid dynamics (CFD) analysis, wind-tunnel results, and observations from first test flights. Despite demonstrating significant lift enhancement using the channel wings, STOL was never achieved because of handling issues experienced at low speeds. A new, improved design that overcomes these issues and the subsequent test results are presented here.II. Platform OverviewThe UAV considered in this paper is shown in Fig. 3. This airframe is the third generation of the Custer UAV developed at the University of Southampton, in pursuit of achieving STOL capabilities on a fixed-wing aircraft by the use of channel wings.Following design methods practiced at the University of Southampton [16], the UAV body is composed of selective-laser-sintered (3-D printed) nylon parts and hot-wire cut foam aerodynamic surfaces supported by carbon-fiber-reinforced polymer (CFRP) spars, automating the manufacturing process as much as possible. The overall dimensions of the UAV are shown in Fig. 4, and the design specifications are listed in Table 1. Details of the individual components specific to the Custer UAV are described in the following sections.Fig. 3 Custer UAV.A. WingsEach wing is composed of a channel-wing section inboard and a standard wing section outboard, as shown in Fig. 4. For ease of manufacturing, the chord is constant along the whole wing, and no dihedral or sweep are present. The wing is ended by a curved wingtip to reduce vorticity and thereby minimize the induced drag [16]. The aileron spans the whole length of the standard wing section to maximize roll authority, which is essential for flight at low speeds. The setting angle of the standard wing section is in line with the fuselage central axis. Structurally, the main wing load is carried by a CFRP spar spanning from the center of the fuselage to the wingtip, supporting both wing sections.The channel-wing section on its own is shown in detail in Fig. 5. Besides the channel itself, this part includes a horizontal section with motor mount running across the channel and side sections for connecting to the rest of the wing and for supporting the tail.The channel has the same chord length as the rest of the wing and a diameter of 35 cm. The bottom of the channel profile is defined by a thicker NACA 4412 airfoil profile, transitioning to a thinner NACA 4405 profile on the sides, as can be seen in the front view in Fig. 6. This is because, as suggested in [7] ([17] patent), the sides of the channel have little contribution to the overall lift (due to the lift vectors acting horizontally and against each other), and the crescent front profile gives a useful drag reduction.Fig. 5 Channel-wing section.The sides of the channel are then blended into the wing connectors of the NACA 4415 airfoil profile, being used in the rest of the wing. The outward wing connector contains housing for the boom connecting the tail of the airplane.Fig. 6 Channel-wing section, front and side views (note the crescent profile and the 8 deg setting angle).The horizontal section running across the channel houses the motor mount, encloses the main carbon-fiber spar and the necessary wiring, and supports the channel against bending. An airfoil profile (NACA 0015) was selected for this section to minimize drag, in contrast to the bare strut structures of the original designs [7].The whole channel, including the horizontal section, has an 8 deg setting angle with respect to the rest of the wing, as shown in the side view in Fig. 6. This increases the total lift at any given angle of attack without a risk of stall; as known from previous experiments, a motor with propeller running in the channel wing has stall delaying effect on the resulting lift curve [18].Fig. 4 Custer UAV (dimensions in mm).B. Power TrainThe motors installed in the channel wings are Hacker A50-12S V3 480 kV brushless motors, powering three-bladed counter-rotating 14×7 in. Master Airscrew propellers (see Fig. 7). Robust (90 A rated) speed controllers are used to reduce the risk of overheating and failure. The power to the motors is sourced from a 6S 6250 mAh LiPo pack.The two-blade 18×8  in. APC propeller at the nose of the plane is powered by an OS GF30 four-stroke gasoline engine providing 2.06 kW at 9000 rpm. With a 0.5 liter fuel tank, this caters for long-range missions and an extended flight time of around 2 h, as well as emergency power in case of electric motor failure.Fig. 7 Channel wing installed propulsion.C. TailThe Southampton Custer UAV has a notably large tail area with fully floating split horizontal stabilizer/elevator (“stabilator”), depicted in Fig. 8. The tail was developed especially with STOL operation in mind to mitigate the controllability issues at slow flight encountered in previous designs [15].With the large surface area spanning across the whole region behind the channel-wing sections, the tail makes use of the slipstream generated by the wing–propellers at low speeds. The elevator is split into two independent parts acting as “tailerons” to provide roll authority even when the airspeed around the ailerons on the wings is very low. Thin fins are mounted where the elevator splits, acting as endplates to prevent flow detachment. Besides improving controllability at low speeds, the tailerons provide extra redundancy on roll control in case of aileron failure.Fig. 8 Tail with fully floating split elevator.D. ControllerThe controller installed in the Custer UAV is the Pixhawk 4 with the PX4 Drone Autopilot open-source software.‡ It is used to stabilize the airplane as well as to monitor it in flight and log data.A custom control module is used for attitude stabilization, allowing for gain scheduling and mixer changes during flight. The control diagram is shown in Fig. 9.Here, ω=(p,q,r) and ε=(ϕ,θ,ψ) denote the roll, pitch, and yaw angular rates and Euler angles as by convention [19]. The attitude control commands along the roll, pitch, and yaw axes, cattitude=(cp,cq,cr), are computed using a feedback law: cattitude=KD(θsp)Δω+KP(θsp)Δεwhere KD(θ)∈R3×3 and KP(θ)∈R3×3 are the derivative and proportional feedback gain matrices, and (Δω, Δε) are the vectors of perturbations from the desired attitude (ωsp, εsp) that need to be stabilized. The gain scheduling based on pitch set-point angle θsp is realized using linear interpolation between specified operating points, and the values of gains that provided adequate stability augmentation in the flight tests are recorded in Table 2.Fig. 9 Control diagram of the attitude stabilization module.The output of the controller to the actuators u=(uMP,uMS,uEF,uAP,uAS,uEP,uES,uR) consisting of port motor, starboard motor, front engine, port aileron, starboard aileron, port elevator, starboard elevator, and rudders is then computed in the “mixer” function, combining the attitude commands from the controller and the motors and engine throttle commands cthrottle=(cTM,cTE) from the pilot as [uMPuMSuEFuAPuASuEPuESuR]=[000.31000−0.3100000110000−100000.31000−0.3100000100][cpcqcrcTMcTE]In particular, note that the roll is mixed into the elevators to create the taileron effect, and the yaw is mixed into the wing motors to augment the yaw authority at high angles of attacks and low speeds associated with STOL operation.III. Wind-Tunnel TestsA series of wind-tunnel tests was carried out in the R. J. Mitchell Wind Tunnel at the University of Southampton. The wind tunnel has 3.5 m wide × 2.4 m high × 10.5 m long working section, wind-speed range from 4 to 40  m/s with less than 0.2% turbulence, and an air chiller to control airflow temperature to 19°C. The airframe was hung upside down using a three-strut attachment with remotely adjustable pitch angle, as shown in Fig. 10. The resolution of the 100 kg load cell balance in use is 0.1 N and the accuracy is 0.5% of the reported readings. The digital inclinometer used to set up the angle of attack has resolution of 0.1 deg and accuracy of ±0.5  deg. The measurements were taken over 3 days in two and three sweeps for the powered and unpowered cases, respectively, with at least two measurements taken per each sweep; average results are presented. Possible sources of error are elasticity of the structure, wingtip interaction with the tunnel-wall boundary layer, and blockage effects. The blockage effects were assessed by comparison with a similar airframe (Decode-1) in [16], where using CFD, the correction factors of 0.92 and 1.04 were determined for lift and drag, respectively. Given these modest effects, wind-tunnel corrections have not been included further in the analysis. The wing–motors are connected to a constant DC power supply limited to 942 W per motor. At the maximum available power, the installed motor–propeller unit reaches 7500–8200 rpm in the airspeed range of interest 0–15 m/s, corresponding to advance ratios of 0–0.31. The chord-based Reynolds numbers applicable for these tests at off-static conditions are in the range of 1–4×105.The measured lift and drag forces for a range of wind speeds and angles of attack with the electric motors on zero and 942 W power are shown in Fig. 11. The figure shows that, as expected, applying the motor power both increases the produced lift and generates forward thrust. At 10  m/s wind speed and 15 deg angle of attack, the increase in lift is around 66 N, which is enough to achieve a level flight. The generated thrust of 12 N in these flight conditions is just slightly less than needed to overcome the induced drag; however, more thrust can be generated in flight using up to 1.25 kW of the available motor power.Fig. 10 Testing in the R. J. Mitchell Wind Tunnel.Further insight into the effects of the channel wings can be obtained by considering the nondimensionalized lift data in Fig. 12 (using the projected area of the wings from Table 1 as the reference area). One can distinguish between a lift offset effect shifting the whole lift curve upward and a stall offset effect delaying the transition to stall. The stall offset effect has character similar to other wing–propeller configurations [20,21] and generates large lift forces at high angles of attack at all airspeeds. The lift offset effect has a similar character to plain flap configurations [22], but it decreases with increasing airspeed due to saturation of the propeller advance ratio.Fig. 11 Wind-tunnel data: lift and drag force.The generated thrust and corresponding lift increments due to channel-wing operation at 0 deg angle of attack from Fig. 11 are for clarity plotted again in more detail in Fig. 13. The figure shows that the channel wings best generate lift from thrust at nonzero airspeeds and that above 5  m/s the rate of increase in lift with increase in thrust remains constant. Combined with the stall offset effect at higher angles of attack, this confirms the view that the Custer channel wings are most suitable for STOL rather than VTOL applications [1,6,8].Fig. 12 Wind-tunnel data: coefficient of lift.Fig. 13 Generated lift to generated thrust for different wind speeds at 0 deg angle of attack.IV. Flight TestsFlight testing took place near Swindon, England, U.K., and all the flight experiments on the Custer UAV were carried out by a professional UAV pilot.§ The runway for takeoffs and landings is covered by a short-trimmed grass surface. The atmospheric conditions applicable for the reported tests correspond to temperatures of around 13°C, 80% air humidity, and sea-level atmospheric pressure. The average wind speed at 100 m altitude extracted from the flight data is 8  m/s with 3  m/s gusts. The wind speed at 4 m height monitored using a wireless weather station averages to 4  m/s with 3  m/s gusts.During flight testing, data were logged on an SD card by the onboard controller, and videos were recorded from the University of Southampton mobile, command control and communications vehicle. The logged data were analyzed to extract the results presented here. In the following discussion, standard mode is defined as a flight mode using only the front engine, while the electric motors in the channel wings are turned off (with hard brake activated in the speed controllers). Assisted mode refers to a flight mode with the electric motors in the channel wings engaged, while the front engine is used according to need, for example, for short takeoffs or fast recovery. The assisted mode is used mainly for slow-flight and STOL maneuvers to save batteries, even though, in principle, it is possible to use it for cruise flight in case of front engine failure.A. Initial TestsAn initial series of flight tests was performed to assess general flying qualities of the airplane. In cruise flight, the handling qualities and natural stability, as reported by the pilot, are very satisfactory. The control responsiveness is extremely effective, the short-period modes are well damped, and the phugoid mode is lightly damped, indicating positive static margin (as defined by convention [19]).Initially, in assisted slow flight, it was difficult for the pilot to sustain a steady trajectory due to the loss of natural stability and prevailing wind gusts. Subsequently, the attitude stabilization routine in the onboard controller was tuned up until it provided adequate support for steady flight (as presented in Table 2).B. Slow FlightTo compare the slow-flight capabilities in the standard and assisted modes, a stall speed test was performed. In the standard mode, the airframe achieves 13.5  m/s airspeed at 18 deg angle of attack and 50% front engine throttle before departing in stall.Compared to this, in the assisted mode using the attitude stabilization, a slow, level flight is sustainable at range of airspeeds from 13 to 10  m/s with angles of attack from 10 to 20 deg using 50–70% motor throttle. The aircraft keeps full directional control using rudders and differential thrust for heading changes, tailerons with ailerons for roll stability, elevators for speed control, and thrust for altitude regulation. Using full motor power, first stall is observed with angle of attack approaching 30 deg, corresponding to an airspeed below 8  m/s.To keep full directional control and for power efficiency, a target airspeed of 11  m/s is selected for the slow-flight operations in the assisted mode. This is achieved commanding 20 deg pitch set-point angle and 60% motor throttle input to the onboard controller.C. Takeoff and LandingTo compare the takeoff performance in the standard and assisted modes, a series of takeoffs was performed starting from a fully stopped horizontal position on the runway. The distance needed to liftoff and to climb to 5 and 15 m altitude from engaging the throttle was measured and three stages considered. The first stage represents the initial accelerated ground run and liftoff with the airplane pitching up. In the second stage, from liftoff to 5 m altitude, the airplane transitions to a steady climb. The third stage from 5 to 15 m is a phase of steady climb such that the airplane is gaining altitude without losing speed. The climb rate and climb slope values in this stage were recorded. The situation is sketched in Fig. 14.Examples of the recorded takeoff data logs in both modes are plotted in Fig. 15. The measured takeoff performance is summarized in Table 3. Reducing the takeoff distance to one-third and tripling the achievable climb rate, the impact of the channel wings is significant.Fig. 14 Takeoff performance measures.To compare the landing performance in the standard and assisted modes, a series of landings in both modes was performed. The landing distance from 15 and 5 m altitude and from the touchdown to a full stop on the runway was measured. The first stage from 15 to 5 m represents a steady landing approach, where the descent rate, descent slope, and airspeed are recorded. The stage from 5 m to touchdown represents the landing flare. The third stage from touchdown to full stop represents the ground roll necessary to stop the plane (in which no wheel brakes are installed). The situation is sketched in Fig. 16.Fig. 15 Takeoff from full stop to 15 m height data log examples: a) standard mode and b) assisted mode.Examples of the recorded landing data logs in both modes are plotted in Fig. 17. The measured landing performance is summarized in Table 4. Reducing the landing distance to one-third, the impact of the channel wings is again significant.Fig. 16 Landing performance measures.The takeoff and landing performance in the standard and assisted modes is finally compared in the height–distance graphs of Fig. 18. The plots show clear benefits of the assisted mode in terms of the field length needed for successful takeoffs and landings.Fig. 17 Landing from 15 m height to a full-stop data log examples: a) standard mode and b) assisted mode.For comparison, data from another two short landings in the assisted mode are presented in the height–distance graphs of Fig. 19. The figure shows that superior landing performance is achievable by commanding a more aggressive descent rate. Alternatively, softer manipulation results in slightly worse performance. The resulting touchdown will also be influenced by the wind gusts during the last seconds of landing, especially for small UAVs of this weight category.Fig. 18 Comparing the trajectories in the height–distance plane: takeoff from full stop to 15 m height and landing from 15 m height to full stop.Fig. 19 Comparing the assisted-mode landing trajectories from 15 m height to full stop.D. DiscussionThe presented flight tests were run several times until confidence in the achieved results was reached. The published numbers represent an average performance that was found achievable in a safe manner, respecting the natural tendencies and structural limitations of the airplane, according to the judgment of the experienced UAV pilot. Naturally, all the takeoffs and landings are carried out heading against the prevailing wind direction. Besides the process errors due to the wind gusts, varying battery voltage, or subjectivity of the pilot’s judgment, the results are affected by measurement errors due to the nature of the sensor equipment.For the standard-mode performance results to be representative of a standard configuration airplane, one has to acknowledge that such standard configuration airplane would benefit from additional payload capacity that is occupied by the mass of the lift-enhancement systems. This is estimated to be 2.0–3.5 kg depending on the channel wing and tail replacements. The achievable range is also reduced due to the extra drag from the channel wings and tail compared to such standard configuration airplane.Furthermore, a conventional airplane may typically be equipped with flaps or slats high-lift devices, improving the takeoff and landing performance. Based on other UAVs of this size designed by the authors in [16], it is estimated that installing plain flaps that extended over the inboard 40% of the wings would increase the maximum lift coefficient from around 1.2 to 1.7 and lead to a touchdown speed reduction by 20%, being significantly less than the reduction achieved by the channel wing in Table 4.The recorded Custer UAV videos can be watched online¶,** or downloaded together with all the flight logs and wind-tunnel data from the University of Southampton online repository [23].V. Conventional Wing–Propeller Arrangement ComparisonThe preceding sections focus on demonstrating the effect of applying the motor power in the channel wings. Although it has been shown that the lift augmentation effect is sufficient to make the STOL operation possible, it is still of interest to address the following two points. First, what is the impact of the drag from the channel wings on the cruise speed compared to standard wing sections? Second, would a simpler conventional wing–propeller configuration not provide the same lift augmentation effect?To answer these questions, the Custer UAV from Sec. II was modified by replacing the channel-wing sections with a standard wing substitute, as shown in Fig. 20. This consists of a straight wing of the same airfoil profile and chord length as the rest of the wing, with a motor mount placing the pusher–propeller one-fourth chord length behind the trailing edge. The total mass reduction due to this change is 500 g, representing 3.2% of the total weight of the Custer UAV. For a fair comparison, this is compensated by a payload weight placed in the front part of the fuselage, such that the longitudinal position of the center of gravity for both designs is equal. The rest of the aircraft, including the empennage, is unchanged. The standard and channel-wing configuration aircraft are compared in flight tests as follows. (Flight testing methods from Sec. IV apply.)A. Cruise Speed ComparisonTo quantify the drag increment due to the channels, a cruise flight test in the standard mode was performed on half and full front engine throttles, recording the achieved airspeed for both configurations. The results in Table 5 indicate only minor cruise speed reduction due to the channels. A possible explanation is that the channel-wing sections are aerodynamically well shaped and relatively small compared to the rest of the wing. In relation to the cruise speed, it is still important to note that a comparable standard configuration plane with no STOL systems would have the drag further reduced by using a smaller-sized empennage and by getting rid of the wing-mounted propellers.Fig. 20 Standard wing sections on Custer UAV.B. Slow Flight and Takeoff ComparisonTo compare the lift generation capacity and applicability for STOL operation, first, a takeoff to 15 m height was performed with both concepts in the assisted mode. The takeoff trajectories in the height–distance plane plotted in Fig. 21 show a clear advantage of the channel wing in terms of the distance needed for liftoff and climb, indicating a superiority in the amount of lift it generates.Second, a slow-flight test in the assisted mode was performed using both configurations. Figure 22 shows that the transition to slow flight using the standard wing sections is problematic, as the elevator at its maximum deflection struggles to push the nose of the aircraft upward. As the transition proceeds for over 20 s, the minimum achieved airspeed is 10  m/s at 28 deg angle of attack, with the motors already running at 100% throttle. Compared to this, using the channel wings, the transition to slow flight is immediate, achieving 10  m/s at 20 deg angle of attack and 70% throttle. This is twice as efficient, because the electric current consumption at 70% throttle is only 30 A per motor, compared to 60 A at full throttle. The approach trajectory can be adjusted effectively using elevators, and the aircraft can slow down temporarily up to 8  m/s by increasing the pitch and adding throttle, as shown in Fig. 22.Fig. 21 Takeoff in the assisted mode, comparison.The insufficient elevator authority observed in the standard wing configuration can be attributed to the propeller slipstream not meeting with the tail control surfaces in this flight regime. Consequentially, the longitudinal control is ineffective, undermining the stability and maneuvering options for slow approach and landing. For this reason, the slow-flight operation with the standard wings was considered unsafe, and short landing tests were not carried out. It is noted that even though the lift of the standard wing configuration in Fig. 20 may be further increased by installing flaps, the corresponding negative pitching moment would make achieving of the high incidence longitudinal trim for slow-flight operation even more problematic. Installation of flaps to channel wing has also been considered; see, for example, the SFB 880 project [24] in Fig. 23.Fig. 22 Slow-flight comparison: a) standard wing and b) channel wing.Fig. 23 SFB 880 flapped channel-wing concept from Müller et al. [24]. (Copyright @ 2014.)VI. ConclusionsThe wind-tunnel results presented in this paper show significant lift enhancement due to the channel wings. Besides a lift offset effect in the linear region of the lift curve, an important contribution to the generated lift is the effect of stall offset at high angles of attack. To be able to use this extra lift at low speeds, however, steady flight in this regime has to be sustainable.The flight-test results show that this is possible, thanks to the slipstream from the wing propellers, and that without this slipstream, the control authority at low speed is insufficient. The effect of the channel wings is therefore twofold: it provides extra lift as well as slipstream necessary for controlled flight at otherwise unattainably low speeds.The flight-test results presented here further show that controlled landing in this flight regime is possible, resulting in substantial reduction of the airfield length needed compared to conventional landings. The same reduction was achieved in the required takeoff distance by using the extra lift and all the available power.Altogether, it is concluded that installing well-designed channel-wing sections and control surfaces on a fixed-wing airplane considerably shortens the runway size necessary for its operation. One such design that also increases redundancy in control actuators has been presented here. The STOL abilities obtained this way are at the expense of available payload capacity and achievable range.In regard to the application to small UAVs in particular, it was shown that despite their sensitivity to wind-gust perturbations, slow flight and short landings are possible with the help of readily available modern control hardware. It was also shown that, adopting 3-D printing technology, the channel-wing concept at this scale is easily realizable. This makes it suitable for unmanned missions, where good fixed-wing cruise properties are demanded together with limitations on the available runway size, such as, for example, in surveillance operations run from the decks of naval vessels.In comparison to a conventional wing propeller arrangement, the extra drag arising from using the channel wings did not turn out to be a major handicap for cruise performance. The inferior lift generation capacity and insufficient handling quality of the standard wing arrangement observed in slow flight made it unsuitable for STOL operation.Further work will be carried out to improve the channel-wing design to get the maximum out of its lift generation potential. Preliminary wind-tunnel studies show that this may be achieved by minimizing the gap between the propeller and the channel, the effects of which are currently subject to flight testing. At the same time, control methods to expand the attitude stabilization routine for altitude hold and reference tracking, combining both the petrol engine and electric motors in a way that maximizes energy efficiency, are being investigated.AcknowledgmentsThis research has been supported by the Engineering and Physical Sciences Research Council (grant number EP/L015382/1) and the University of Southampton. Contributions of students working on this and previous Custer unmanned aerial vehicle designs are gratefully acknowledged.‡ PX4 Drone Autopilot, https://github.com/PX4 [retrieved 12 August 2021].§ Paul Heckles Flight Centre, https://www.paulhecklesrc.co.uk [retrieved 12 August 2021].¶ Soton UAV, Custer UAV project, https://www.sotonuav.uk/projects/#custer [retrieved 12 August 2021].** Custer UAV, https://www.youtube.com/watch?v=nz-QEdNT1xA [retrieved 12 August 2021].\r            References\r        [1] Young D. W., “Test of 1/3-Scale Powered Model of Custer Channel Shaped Wing,” U.S.  Army Air Forces TR  5142, U.S. Army Air Force Materiel Command, Wright Field, Dayton, OH, 1944. Google Scholar[2] Young D. W., “Test of Two Custer Channel Wings Having a Diameter of 37.2 Inches and Lengths of 43 and 17.5 Inches,” U.S.  Army Air Forces TR  5568, U.S. Army Air Force Materiel Command, Wright Field, Dayton, OH, 1947. Google Scholar[3] Pasamanick J., “Langley Full-Scale-Tunnel Tests of the Custer Channel Wing Airplane,”  NACA RM  L53A09, Langley Aeronautical Lab., Langley Field, VA, 1953. Google Scholar[4] Gordon Y. and Gunston B., Soviet X-Planes, Midland Publ., Leicester, England, 2000, p. 13. Google Scholar[5] Zöller P., Rhein-Flugzeugbau GmbH und Fischer Flugmechanik, Books on Demand, Norderstedt, Germany, 2016, Chap. 5. Google Scholar[6] Englar R. J. and Campbell B. A., “Development of Pneumatic Channel Wing Powered-Lift Advanced Super-STOL Aircraft,” 20th AIAA Applied Aerodynamics Conference, AIAA Paper  2002-2929, June 2002. https://doi.org/10.2514/6.2002-2929 LinkGoogle Scholar[7] Gokce Z. O. and Camci C., “Channel Wing as a Potential VTOL/STOL Aero-Vehicle Concept,” Recent Patents on Mechanical Engineering, Vol. 3, No. 1, 2010, pp. 18–31. https://doi.org/10.2174/1874477X11003010018 Google Scholar[8] Blick E. F. and Homer V., “Power-On Channel Wing Aerodynamics,” Journal of Aircraft, Vol. 8, No. 4, 1971, pp. 234–238. https://doi.org/10.2514/3.44260 LinkGoogle Scholar[9] Müller L., Heinze W., Kožulovic D., Hepperle M. and Radespiel R., “Aerodynamic Installation Effects of an Over-the-Wing Propeller on a High-Lift Configuration,” Journal of Aircraft, Vol. 51, No. 1, 2014, pp. 249–258. https://doi.org/10.2514/1.C032307 LinkGoogle Scholar[10] Boyne W., “The Custer Channel Wing Story,” Airpower Magazine, Vol. 7, No. 3, May 1977, pp. 8–19, 58, http://rexresearch.com/custer/custer.htm#9 [retrieved 12 Aug. 2021]. Google Scholar[11] Wright T., “That Extra Little Lift,” Air & Space Magazine, May 2007, https://www.airspacemag.com/history-of-flight/that-extra-little-lift-17186541 [retrieved 12 Aug. 2021]. Google Scholar[12] Brown K., “Special Report: Cockpit-Testing the Legendary Channel-Wing,” Popular Mechanics, Sept. 1964, http://www.angelfire.com/va3/bythefire/Pop_mech_0964.html [retrieved 12 Aug. 2021]. Google Scholar[13] Ray J. G., “Flight Performances of the Custer Channel Wing CCW-5,” Tech. Rept.,  Ray and Ray, Airlines Operations, Aviation Research, Washington, D.C., Dec. 1955. http://www.angelfire.com/va3/bythefire/Ray_Ray1.html [retrieved 12 Aug. 2021]. Google Scholar[14] Clements H. R., “The Channel Wing Revisited,” Soc. of Automotive Engineers TP  2006-01-2387, Warrendale, PA, 2006. https://doi.org/10.4271/2006-01-2387 Google Scholar[15] Keane P. M. and Keane A. J., “Use of Custer Channel Wings-Wing Ducts on Small UAVs,” Journal of Aerospace Engineering, Vol. 29, No. 3, 2016, Paper 04015059. https://doi.org/10.1061/(ASCE)AS.1943-5525.0000535 CrossrefGoogle Scholar[16] Keane A., Sóbester A. and Scanlan J., Small Unmanned Fixed-Wing Aircraft Design: A Practical Approach, Wiley, Hoboken, NJ, 2017. CrossrefGoogle Scholar[17] Spence W. G., “Curved Wing Structure for Aircraft,” U.S. Patent US3504873A, 1970. Google Scholar[18] Gunther C., Marchman J. and VanBlarcom R., “Comparison of Channel Wing Theoretical and Experimental Performance,” AIAA 38th Aerospace Sciences Meeting and Exhibit, AIAA Paper  2000-257, Jan. 2000. https://doi.org/10.2514/6.2000-257 LinkGoogle Scholar[19] Etkin B. and Reid L. D., Dynamics of Flight: Stability and Control, 3rd ed., Wiley, Hoboken, NJ, 2015. Google Scholar[20] Catalano F. and Stollery J., “The Effect of a High Thrust Pusher Propeller on the Flow over a Straight Wing,” AIAA 11th Applied Aerodynamics Conference, AIAA Paper  1993-3436, Aug. 1993. https://doi.org/10.2514/6.1993-3436 LinkGoogle Scholar[21] Chinwicharnam K. and Thipyopas C., “Comparison of Wing–Propeller Interaction in Tractor and Pusher Configuration,” International Journal of Micro Air Vehicles, Vol. 8, No. 1, 2016, pp. 3–20. https://doi.org/10.1177/1756829316638206 CrossrefGoogle Scholar[22] Cahill J. F., “Summary of Section Data on Trailing-Edge High-Lift Devices,”  NACA TR  938, 1949. Google Scholar[23] Mihalik J. and Keane A. J., “Data Supporting the ‘Custer Channel Wing for Short Take-Off and Landing of Unmanned Aircraft’ Article,” Univ. of Southampton, Dec. 2019. https://doi.org/10.5258/SOTON/D1162 Google Scholar[24] Müller L., Kožulovic D. and Radespiel R., “Aerodynamic Performance of an Over-the-Wing Propeller Configuration at Increasing Mach Number,” CEAS Aeronautical Journal, Vol. 5, Sept. 2014, pp. 305–317. https://doi.org/10.1007/s13272-014-0108-1 CrossrefGoogle Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Adaptable Deployable Entry and Placement Technology Sounding Rocket One Modeling and Reconstruction",
        "url": "https://arc.aiaa.org/doi/10.2514/1.A35090",
        "date": "20210925",
        "content": "AbstractSounding Rocket One (SR-1), the first flight test of the Adaptable Deployable Entry and Placement Technology (ADEPT), was performed on September 12, 2018. ADEPT is a deployable aeroshell that is stowed for launch and deployed before atmospheric flight to increase the drag area of the spacecraft. The main objectives of the SR-1 flight test were to demonstrate that the ADEPT vehicle deploys exo-atmospherically and to characterize the stability of the vehicle during atmospheric flight. The SR-1 test vehicle was a 0.7-m-diam, 70°-half-angle faceted sphere-cone and was the primary payload on an UP Aerospace Spaceloft launch vehicle from the White Sands Missile Range. ADEPT successfully separated from the spent booster in its stowed configuration, opened above 100 km altitude, and landed in the deployed configuration within White Sands Missile Range. ADEPT was able to reach peak Mach number of 3.1 and was able to show angle-of-attack stability through Mach 0.8, which was the objective of the mission. The aerodynamics and flight mechanics of the vehicle were modeled preflight for performance and range safety predictions. After the flight, the on-board instrumentation was used to reconstruct the flight performance. This paper describes the predictions and postflight reconstruction, and how the predictions compared with the flight data.Nomenclatureaxy, axz, ayzinertial measurement unit calibration parametersCA, CY, CNaxial, side, and normal aerodynamic force coefficientsCDdrag force coefficientCl, Cm, Cnroll, pitch, and yaw aerodynamic moment coefficientsCmq, Cnrpitch and yaw moment damping derivativesDvehicle diameter, mKainertial measurement unit scale factor matrixKnKnudsen numberkxa, kya, kzainertial measurement unit scale factor componentsLgoregore length, mLrefreference length, mM∞freestream Mach numberrnnose radius, mSrefreference area, m2Tinertial measurement unit calibration matrixVwind-relative velocity magnitude, m/sVx, Vy, Vzwind-relative velocity components in vehicle body frame, m/sXcgaxial center of gravity position in body frame, my+dimensionless wall spacing in computational gridsαangle of attack, radαTtotal angle of attack, radβangle of sideslip, radδdeflection, mI. IntroductionAt 7:30 a.m. Mountain Daylight Time on September 12, 2018, a 0.7-m-diam version of the Adaptable Deployable Entry and Placement Technology (ADEPT) vehicle was launched on-board a suborbital sounding rocket from Spaceport America within the grounds of the White Sands Missile Range (WSMR) in New Mexico. Sounding Rocket One (SR-1) was the first ADEPT shape to be tested outside of laboratory conditions.The ADEPT entry body is being developed to enhance planetary probe missions that need to decelerate larger payloads to the ground. Unlike traditional rigid aeroshells that are packed into launch vehicles at their full size, deployable aeroshells like ADEPT can be stowed in a smaller form factor during launch. Deployment before entry increases the diameter and the aerodynamic drag force while reducing the ballistic coefficient of the vehicle during entry. The benefits of a lower ballistic coefficient include deceleration at higher altitudes, leading to a larger altitude margin before touchdown and lower aerodynamic heating [1]. ADEPT has been proposed as an enabling technology for many planetary entry concepts, including International Space Station down mass [2], human-scale Mars missions [3,4], Earth return from beyond low-Earth orbits, [2] Venus landers [1,5], and nano-satellite missions [6].ADEPT employs a three-dimensional woven carbon fabric as the heatshield, which serves as both thermal protection system and primary structure, and provides a compact entry vehicle package. Past studies concluded that deployables, such as ADEPT, can enable science objectives for a variety of small spacecraft that are secondary payloads and need a low-volume deployable entry system that can withstand high temperatures. Specifically, the nano-ADEPT entry vehicles (<1  m diameter) are targeted for systems with an entry mass of less than 25 kg and a payload mass on the order of 15 kg. For mission considerations, nano-ADEPT is intended where volume and mass constraints would limit or prohibit the use of a rigid aeroshell for the mission application. [7]The SR-1 flight article falls within the nano-ADEPT class of vehicles. A scale model of the ADEPT vehicle has been tested in arcjet conditions to understand aeroheating, wind tunnel conditions to quantify structural characteristics, and laboratories to characterize the mechanisms [8,9]. SR-1 was the full end-to-end system test of the nano-ADEPT vehicle from the stowed configuration, deployment in the upper atmosphere, and then entry, descent, and landing (EDL).The SR-1 concept of operations is shown in Fig. 1. ADEPT launched on-board an UP Aerospace Spaceloft XL Sounding Rocket as the primary payload. During ascent, the sounding rocket spun up to 7 Hz (2520  deg/s) for gyroscopic stability. Approaching apogee around 120 km, a yo-yo de-spin mechanism reduced the spin rate to 0.555 Hz (200  deg/s), which resulted in a residual spin rate of 0.12 Hz (42  deg/s) postdeployment. This spin rate was selected to provide gyroscopic stability to the test article during the exo-atmospheric flight. After yo-yo de-spin, the payload section separated from the spent booster, and shortly afterward the nosecone separated from the payload section while starting a timer within the ADEPT payload. Based on a launch vehicle timer, the ADEPT stowed vehicle was ejected from the payload section during exo-atmospheric ascent. Then, before reaching apogee, a timing circuit on-board ADEPT triggered deployment of the aeroshell to the desired 70°-half-angle, sphere-cone faceted shape, as confirmed by a deployment travel limit switch. No further configuration changes occurred during descent. The ADEPT SR-1 flight was part of a technology demonstration with a trajectory that was designed to reach Mach 3 at 70 km geodetic altitude before decelerating to subsonic speeds and impacting the ground within WSMR at close to 25  m/s. No parachute was used for stability or to decelerate the vehicle.Since SR-1 was the first end-to-end test of the ADEPT shape, the key performance parameters (KPPs) of SR-1 flight were more fundamental: deploy the ADEPT shape exo-atmospherically and maintain the shape through the rest of the flight, and demonstrate aerodynamic stability without active control during entry and descent down to Mach 0.8 [2], which is usually the region in planetary vehicles a subsonic decelerator like a parachute would be deployed. Because of the suborbital trajectory of the sounding rocket, the ADEPT SR-1 test article was not designed to reach mission-relevant conditions for many planetary entry situations.Fig. 1 ADEPT SR-1 concept of operations [2].The remainder of this paper is organized as follows. Section II describes the static and dynamic aerodynamic modeling and aerodatabase development used in trajectory simulations of the ADEPT vehicle. Section III provides an overview of the flight mechanics simulation used for preflight trajectory simulation and performance analysis. Section IV describes the suite of flight test instrumentation data used for postflight evaluation of the vehicle trajectory, aerodynamics, and assessment of the KPPs. Section V describes how the sensor data were used to reconstruct the trajectory, shows the as-flown trajectory, and presents the aerodynamic reconstruction results. Section VI describes the postflight evaluation and reconciliation of the as-flown trajectory compared with the preflight trajectory simulation results. Concluding remarks are provided in Sec. VII.II. Aerodynamic ModelThe following sections describe the ADEPT SR-1 flight test article, design trajectory, aerodynamics database, computational methods, and aerodynamic uncertainties applied in Monte Carlo trajectory simulations.A. Test Article Geometry and Design TrajectoryThe deployed, as-flown ADEPT SR-1 geometry is shown in Fig. 2. The test article was an eight-sided, faceted cone with a 70° half-angle and a spherical nose segment with maximum diameter D of 0.688 m (measured between opposing rib tips), nose radius rn of 0.35 m, and a reference area of 0.372  m2. The deployable heatshield, with an open backshell and aft structure, was similar to that of the hypersonic inflatable aerodynamic decelerator (HIAD) test articles flown on the Inflatable Reentry Vehicle Experiment II (IRVE-II) and IRVE-3 missions [10,11] and the supersonic inflatable aerodynamic decelerators (SIADS) that were tested under the aegis of the Low-Density Supersonic Decelerator (LDSD) project [12]. As a comparison, the IRVE-3 geometry was 60° sphere-cone forebody with a maximum diameter of 3.0 m (see Fig. 2) compared with the 70°-sphere-cone, 0.688-m-diam forebody ADEPT SR-1.The ADEPT SR-1 was a 3U CubeSat. Additional details on the ADEPT SR-1 geometry are provided in Fig. 3, which lists the dimensions of the as-built vehicle measured shortly before flight. The axial center of gravity (CG) position for ADEPT SR-1 was at a distance xCG/D of 0.15, aft of the nose. Although this CG position is further forward than is typical of blunt body entry vehicles (0.25–0.3), this position was chosen explicitly to have the vehicle impact the ground nose-first, in order to protect the flight data stored onboard the payload. There would be some difference in stability characteristics seen in ADEPT SR-1 flight and a full-scale demonstration where CG location would be more aft. With an entry mass of 11 kg, the vehicle had a ballistic coefficient of approximately 20  kg/m2 assuming a CD of approximately 1.5, which was close to supersonic drag coefficient found in early aerodynamic analysis of ADEPT SR-1. The aerodynamics data sets, methods, tools, and implementation applied to ADEPT SR-1 draw from experience on the IRVE missions that had similar ballistic coefficients[10,11].Fig. 2 ADEPT SR-1 and IRVE-3 flight test articles.Forebody geometry generally dominates blunt body aerodynamics at hypersonic conditions, with aft geometry contributing progressively more at supersonic and subsonic conditions due to increasing base pressure coefficient with decreasing Mach number. The altitude–velocity profile and atmospheric density also govern the resulting aerodynamics. A design reference trajectory was used to specify atmospheric conditions for aerodynamics analysis. The design trajectory targeted a minimum separation altitude of 100 km for ADEPT SR-1 and a peak Mach number during entry of 3. The design trajectory is shown in Fig. 4, with box-and-whisker plots to show the variation in Mach number and dynamic pressure based on a statistical simulation of the trajectory. Atmospheric interface was defined at 85 km geodetic altitude.Fig. 3 ADEPT SR-1 as-flown geometry.Fig. 4 ADEPT SR-1 design trajectory.B. Static AerodynamicsThe ADEPT SR-1 aerodynamics database structure and methods were based on those developed for the successful Earth-based IRVE-II and IRVE-3 flight experiments [10,11,13] as well as the Mars Exploration Rovers and Phoenix Mars entry capsules [14,15]. As described in Table 1, the aerodatabase was organized by flight regime, with inputs of angle of attack, angle of sideslip, Knudsen number, and Mach number. The aerodynamic coordinate system is given in Fig. 5.The aerodatabase presented here assumed the vehicle to be axisymmetric. This assumption allowed the aerodynamic coefficients to be specified in the total angle-of-attack plane and then decomposed into the α and β planes for use in a six-degree-of-freedom (6-DOF) trajectory simulation. Total angle of attack αT, shown in Fig. 5, is defined in the plane of the vehicle’s velocity and axial symmetry axis. This axis was arbitrarily chosen for ADEPT SR-1 to bisect a single gore on the heatshield. As the number of gores increases, the forebody shape approaches that of a smooth sphere-cone. It was unknown before the flight whether the eight-gore, faceted geometry of ADEPT SR-1, when spin-stabilized, would approximate a truly axisymmetric blunt body.Fig. 5 ADEPT SR-1 aerodynamics coordinate frame.It was assumed that the vehicle was rigid, with negligible midgore deflections during flight. An aerodynamic loads test was completed in April 2015 in the US Army’s 7×10 Foot Wind Tunnel located at NASA Ames Research Center. The test was conducted at low subsonic conditions (M∞<0.3) to obtain static deflected shape data and pressure distributions on an 0.7-m-diam ADEPT article across a range of fabric pretensions, dynamic pressures, and angles of attack, in addition to force and moment balance data [9]. The requirement on ADEPT SR-1 for the maximum deflection was δ/Lgore≤0.02, where Lgore was the undeflected length of the fabric from nose cone to the rib tip. At this requirement, the sphere-cone geometry was still within the bounds of the aerodynamic adder uncertainties in the ADEPT SR-1 aerodatabase to account for bent airframe effects. At the targeted fabric pretension and maximum dynamic pressure expected for ADEPT SR-1, the measured δ/Lgore in this static loads test was 0.005, where δ was the fabric deflection from the undeflected shape. This amount of deflection yields a projected area equal to 99.5% of that for an ideal 70°, 8-sided faceted shaped. On the basis of this result, the aerodatabase assumed ADEPT SR-1 to behave as a rigid heatshield and did not account for any midgore or rib deformation.Static aerodynamic coefficients were tabulated at multiple points along the design trajectory (Fig. 6) using the methods listed in Table 1 for αT values of 0, 10, and 20°. This range of αT was chosen to bound the expected angle of attack and sideslip envelope in flight for a ballistic blunt body with no active control. The upper limit of 20° bounds reconstructed angles of attack and sideslip from both IRVE-II (spinning, no active control) [10] and Phoenix (not spinning, reaction control system dead-banded in the atmosphere) [15]. Note that in Fig. 6 an earlier iteration of the design trajectory with a lower apogee was used to generate the noncontinuum portion of the aerodatabase, hence the misalignment between database points and the reference trajectory in that regime. Although the aerodynamic analysis used an out-of-date reference trajectory, the differences in the updated trajectory were bounded by the aerodynamic uncertainties in the database in that regime of flight. Aerodynamic coefficients were linearly interpolated between flight regimes, and all moments were reported about the nose (heatshield center).The suborbital flight resulted in peak Mach number reaching supersonic conditions. With no supersonic wind tunnel test data available for the ADEPT SR-1 faceted geometry, the continuum, static aerodynamics were based entirely on computational fluid dynamics (CFD) simulations. In all cases, forces and moments were computed on both forebody and aftbody surfaces.Fig. 6 Static aerodynamics anchor points along the ADEPT SR-1 design trajectory.1. Noncontinuum Aerodynamics Simulation ApproachThe noncontinuum aerodynamics were predicted using a computational methodology that accounts for interactions among individual molecules and between individual molecules and the vehicle. Free-molecular data that were originally generated for IRVE-3 with the direct simulation Monte Carlo (DSMC) analysis code (DAC) were used for Kn>2.23 (115 km) [11,16]. Transitional data were generated for the ADEPT SR-1 geometry at altitudes from 115 to 75 km (Kn=2.23–0.0023) with the Multiphysics Algorithm with Particles (MAP) [17] for lower density conditions and DAC [16] for higher density conditions. These data helped bridge the free-molecular and continuum flow regimes. Reference [17] discusses mesh selection and other configuration settings for noncontinuum aerodynamics.When ADEPT separated from the launch vehicle payload section, the nose tip was pointed toward the ground and the vehicle velocity vector was pointed toward the zenith. After apogee, the vehicle’s velocity vector pointed toward nadir, making the angle of attack between the body axis going through the nose of the vehicle and the velocity vector less than 180°. Because of this configuration, the free-molecular and transitional portion of the aerodatabase provided coverage for angles of attack from 0 to 180°.2. Transonic/Subsonic Static Aerodynamics CFD Simulation ApproachTransonic and subsonic static aerodynamics were generated with the Fully Unstructured Navier–Stokes (FUN3D) CFD code [20,21]. FUN3D is a NASA-developed suite of tools for solving fluid dynamics problems using fully unstructured and mixed element grid topologies. FUN3D is regularly applied to subsonic, transonic, and supersonic aerodynamics simulations for blunt bodies, with and without backshells, and procedures developed for similar flight projects in terms of convergence and grid sizes were applied in this analysis. FUN3D is capable of solving the Reynolds-averaged Navier–Stokes equations through perfect gas and finite-rate simulations. Local time-stepping is applied for steady flows, and second-order time-accuracy is applied for unsteady flows. The flow solver is based on second-order, node-based, finite-volume discretization. For the cases presented here, Roe’s flux reconstruction [22] was used with no limiter. Solutions assumed perfect-gas air. The flow was modeled as fully turbulent using detached eddy simulation (DES) with a Spalart–Allmaras submodel [23] and no compressibility correction, which are assumptions used in similar conditions for FUN3D [24]. All solutions were run with second-order time-accuracy. Solutions were deemed to be complete once averaging of CA over 5000 time step intervals resulted in less than a 3% change in coefficient value.The computational grid for FUN3D was generated on a simplified geometry that eliminated the ribs and struts on the aft side of the heatshield and used a smooth, solid 3U CubeSat payload. Through previous experience working with similar geometries, it was found that these typical forebody simplifications do not affect the static aerodynamic calculations, which are more sensitive to the lack of convex backshell [24–26]. Grids were fully three-dimensional and generated using the Advanced Front/Local-Reconnection (AFLR3) method [20] and used an inviscid, tetrahedral mesh in the volume and prisms in the boundary layer near the body. The computational grids for this analysis averaged 9.8 million grid nodes. Dimensionless wall spacing (also known as y+) was determined to yield values <1 over the entire vehicle. The geometry, as well as a sample grid from the FUN3D solutions, is shown in Fig. 7.Figure 8 shows instantaneous velocity contours at Mach 0.3 and 0.6 conditions with the vehicle at 0° angle of attack, zoomed to show the near-body flowfield. As expected, the flow separates around the shoulder of the vehicle, and the blunt body wake flow is unsteady. Similar to the supersonic CFD solutions, the aftbody pressures are appreciably lower than the forebody pressures, with the heatshield pressures dominating the resulting static aerodynamics. While the flight experiment focus was from Mach 3 to Mach 0.8, solutions were computed down to Mach 0.3.Fig. 7 FUN3D geometry and sample unstructured grid.Fig. 8 Instantaneous velocity contours for Mach 0.3 (left) and Mach 0.6 (right) conditions and α=0° (FUN3D).3. Supersonic Static Aerodynamics CFD Simulation ApproachSupersonic static aerodynamics were generated with the Unstructured Three-Dimensional (US3D) CFD code [18,19], which is an implicit and parallel flow solver of the compressible, finite-volume Navier–Stokes equations on both structured and unstructured meshes. The code also includes modeling options for solving complex flows with effects of finite-rate chemistry and thermal nonequilibrium, neither of which needed to be modeled for ADEPT SR-1. For the cases presented here, convective fluxes were computed using a second-order modified Steger–Warming [27] flux vector splitting method with a Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL) [28] scheme using a pressure limiter. Time integration was performed with the implicit second-order Data Parallel Line Relaxation (DPLR) [29] method, where wall-normal lines exist. Full matrix point relaxation was used everywhere else in the domain. The freestream was modeled with calorically perfect air, and the viscosity was computed using Sutherland’s law. The flow was assumed to be fully turbulent and was modeled using the Spalart–Allmaras turbulence model [23] with the Catris–Aupioux compressibility correction [30].The grid for the US3D solutions was generated on a simplified geometry that eliminated the struts on the backside of the heatshield. The ribs that support the heatshield fabric were included in the grid geometry. The CubeSat payload was simplified to a smooth, 3U box. Although US3D can accept unstructured grids, a fully structured grid was used for ADEPT SR-1 aerodynamic database solutions to allow for checks against solutions generated with the DPLR CFD code [29]. The half-body grid with a symmetry pitch plane contained 11.8 million points. Figure 9 shows the half-body geometry and grid topology. All US3D results were rotated to account for the differences in coordinate frame to agree with the definition given in Fig. 5.Figure 10 shows Mach number and pressure contours for a Mach 3 case. As expected, the supersonic solutions were unsteady, due to the separated wake flow aft of the maximum diameter. Forebody pressures dominate the aerodynamics of the vehicle and were an order of magnitude greater than those on the backside, including fluctuations.Fig. 9 US3D geometry and structured grid topology.Fig. 10 Freestream Mach number contours and forebody surface pressure contours for Mach 3.0 conditions.C. Dynamic Pitch DampingBlunt bodies are known to be dynamically unstable at supersonic Mach numbers, characterized by attitude growth during flight through these conditions [31]. A limited set of ballistic range shots (5 total) were conducted for ADEPT SR-1. Although the data were useful to qualitatively evaluate the dynamic damping behavior of this shape, it was insufficient to develop a quantitative model. For ADEPT SR-1, functional forms developed from ballistic range testing for IRVE-3 [11] were implemented into the aerodatabase. For dynamic pitch damping, aft geometry is a significant contributor to the driving mechanism that arises from unsteady variations in the aft body pressure distribution. Although IRVE-3 was a 60° sphere-cone, it had a similar aft geometry with no backshell and an exposed payload extending aft from the nose (see Fig. 2). Even though the axial CG position for ADEPT SR-1 (xCG/D=−0.15) is more forward than the articles for the IRVE-3 ballistic range testing (xCG/D=−0.23), no damping data for similar shapes with further forward axial CG positions are known. At conditions where no data exist, the vehicle was assumed to be neutrally stable (Cmq=Cnr=0). Additionally, the limited set of ballistic range shots of ADEPT SR-1 showed similar trends to the IRVE-3 model, hence supporting the choice of dynamic coefficient model chosen for the flight aerodatabase. The data points from the ADEPT ballistic test range are included later in this paper in Fig. 13.D. Aerodynamics UncertaintiesAerodynamics uncertainties for ADEPT SR-1 were largely based on past flight experience and engineering judgment from the IRVE missions. Table 2 shows the static aerodynamics uncertainties, and Table 3 shows the dynamic aerodynamics uncertainties. All uncertainties were applied uncorrelated, with the distributions listed in Tables 2 and 3. Values in between the set points listed in the tables are calculated using interpolation by Mach and Knudsen number.Aerodynamics uncertainties are typically larger at supersonic conditions compared with hypersonic (Mach>5) due to the challenges of modeling the separated wake and resulting contributions. Similar to the IRVE-3 model, pitching and yawing moment uncertainties were modeled with both an adder term (shifts trim angle) and a multiplier term (changes moment slope). Example of how the uncertainty terms are applied in an aerodatabase can be found in Ref. [32]. While ADEPT SR-1 was intended to be spin-stabilized, the moment uncertainty formulation was maintained to capture possible asymmetric shape changes, and a rolling moment uncertainty was included to account for limitations in the axisymmetric assumption. All moments were dispersed about the CG and then converted to their equivalent value at the moment reference point.E. Aerodynamic DatabaseThe following sections describe the static and dynamic aerodynamics database of ADEPT SR-1. The aerodynamics database was implemented into the Program to Optimize Simulated Trajectories II (POST2) [33] simulation as a subroutine with inputs of Knudsen number, Mach number, angle of attack, and angle of sideslip. The aerodatabase returns nominal aerodynamic force and moment coefficients in the body frame (Fig. 5). For off-nominal cases, the aerodatabase accepts an array of dispersion parameters for each coefficient and flight regime as inputs and returns dispersed aerodynamic force and moment coefficients.1. Static Aerodynamics DatabaseAs discussed in Sec. II.B, the static aerodynamics database is divided by flight regime. In the following figures, CN and Cm are given in the αT plane. The aerodatabase decomposes these coefficients into the α and β planes (Fig. 5). Figure 11 shows the noncontinuum aerodynamics for ADEPT SR-1, where decreasing altitude corresponds to decreasing Kn. At noncontinuum conditions, large values of CA and CN, such as those plotted in Fig. 11, are common for blunt body entry vehicle shapes.Figure 12 shows the nominal continuum static aerodynamics database. The error bars in Fig. 12 are the ±3σ values computed from the amplitude variation in the time-averaged CFD solutions.Fig. 11 Nominal noncontinuum static aerodynamics (αT plane).With no wind tunnel test data at flight conditions available on the faceted ADEPT SR-1 shape, comparisons with ground test data were limited to configurations with smooth sphere-cone forebodies. For CA, the CFD results on the ADEPT SR-1 faceted shape are lower than coefficient values derived from force balance data in supersonic wind tunnel testing of a smooth 70° sphere-cone forebody [34]. Reynolds number differences are significant, as supersonic wind tunnel testing is generally on the order of Re∞/ft=1.0 million, whereas supersonic conditions along the ADEPT SR-1 design trajectory have Re∞/ft between 0.15 and 0.35 million. Differences are also due to the ADEPT SR-1 faceted shape having a smaller physical drag area than the smooth sphere-cone even though both shapes use a reference area based on the circular projected area of the maximum diameter.Fig. 12 Nominal supersonic continuum static aerodynamics (αT plane).Fig. 13 Dynamic damping database.For blunt bodies, CA dominates the static aerodynamics. As the vehicle decelerates, CA decreases continuously from rarefied to continuum conditions. As the vehicle decelerates further, to supersonic conditions, the pressure coefficient on the aft surfaces is negative, providing a positive increment to the forebody axial force. This aft pressure contribution produces the slight rise in CA shown before the sharp decrease through transonic conditions. Preflight estimates of pitching moment trends with angle of attack indicate the ADEPT SR-1 vehicle to be statically stable (negative slope with α) across the entire trajectory, for angles of attack below 20°.2. Dynamic Damping DatabaseThe dynamic damping database for ADEPT SR-1 was taken directly from IRVE-3, which used data from ballistic range testing of a subscale IRVE-2 test article [11]. The aerodatabase used functional forms of Cmq values as a function of Mach number and total angle of attack, with the assumption that the vehicle is axisymmetric (Cmq=Cnr). At noncontinuum conditions, a constant, stable value of −0.32 is applied based on experience from the IRVE-3 flight. At continuum conditions above Mach 3.5 in the aerodatabase, Newtonian aerodynamic predictions of stable hypersonic pitch damping were blended with unstable supersonic pitch damping. Figure 13 shows the supersonic and subsonic dynamic damping database as functions of total angle of attack and Mach number. Cmq>0 is unstable, Cmq<0 is stable, and Cmq=0 is neutrally stable. Shapes like IRVE-3 are dynamically unstable at small angles of attack and Mach numbers below 2. In Fig. 13, the IRVE-3 dynamic damping model bounds the limited available data for the ADEPT geometry.III. Flight Mechanics Modeling and SimulationThe POST2 [33] was the flight mechanics modeling and simulation tool used to characterize the behavior of ADEPT SR-1 after separation from the payload section. The POST2 is a generalized point mass, discrete-parameter targeting and optimization trajectory simulation program with multivehicle capabilities that integrates translational and rotational equations of motion along the trajectory. It is a 6-DOF flight mechanics simulation tool that can simultaneously simulate the trajectories of up to 20 independent or connected rigid bodies. The simulation tool has been used for several EDL missions, such as the Mars Exploration Rovers [35], Genesis Sample Return Capsule [36], and Mars Science Laboratory [37], to name a few. More recently, it has been used on several Earth atmospheric and suborbital missions like the Low Density Supersonic Decelerator [38,39] and Advanced Supersonic Parachute Inflation Research and Experiment [40] programs. The NASA Langley Research Center (LaRC) version of POST2 [41] has been integrated with engineering models of the atmosphere, such as the Earth Global Reference Atmospheric Model (GRAM) [42], and can use high fidelity aerodynamic databases. The models and their uncertainties are varied using Monte Carlo approaches to provide statistical estimates of various flight performance parameters, such as trajectory conditions at entry interface or attitude predictions at various points during the flight.The flight mechanics simulation models both ADEPT SR-1 and the payload section from which ADEPT SR-1 separates. The vehicles are simulated from the separation event down to impact on the ground, as defined by a digital elevation map of the WSMR. The payload section, modeled as a 3-DOF vehicle with simplified mass and aerodynamics, is used to quantify recontact risk to ADEPT. Before ADEPT separation, the launch provider uses their simulation to model launch, spin-up, and yo-yo de-spin. The launch provider supplies 6-DOF states at the prescribed ADEPT separation event from their Monte Carlo simulations, and these states are used to initialize the POST2 ADEPT SR-1 simulation.Postseparation from the launch vehicle, ADEPT SR-1 is modeled as a 6-DOF vehicle with an aerodynamic database discussed in Sec. II. An assumption in the aerodatabase is axisymmetric congruity; i.e., change in angle of attack is assumed to have the same effect as change in sideslip angle. This assumption is typically used for blunt body aerodynamics and allows the aerodatabase to be parameterized by total angle of attack rather than an individual matrix based on angles of attack and sideslip. However, ADEPT SR-1 has a faceted shape where there are sharp changes in angles between the facets of the forebody. During preflight review of the aerodatabase, it was decided that the axisymmetric assumption should be maintained for preflight analysis, since wind tunnel testing had not revealed a strong tendency for the vehicle to autorotate [9,43] due to rolling moments generated by sideslip or angle-of-attack variations; however, this assumption was subject to change based on flight data from the ADEPT SR-1 mission.Earth-GRAM was chosen for preflight analysis as it provides nominal and dispersed estimates of atmospheric parameters for the full range of flight conditions. Earth-GRAM contains multiple choices of thermospheric models to provide atmospheric estimates above 90 km geodetic altitude. For ADEPT the 2008 Jacchia-Bowman (JB2008) option was used in simulations as that particular model had shown better agreement with exo-atmosphere flight data in past missions [44]. Below 90 km, the atmospheric estimates are based on historical data at the location of interest. Specifically, closer to the ground, the range reference atmosphere for WSMR [45] was used. These historical datasets are created for each month and are based on data that are averaged across many years; thus, the average weather for that month is represented but the day-to-day variations may not be captured.Finally, the simulation incorporated higher fidelity models to capture the dynamics of the vehicle during critical events. One example is a model describing ADEPT deployment. The ADEPT SR-1 vehicle is initially in the stowed configuration but then unfurls during the deployment process. Although the deployment process is fast (approximately 100 ms), the rapid change in mass distribution with springs could impart a pitch or yaw rate due to differential rates of deployment on each side of the vehicle. Preflight analysis showed that the vehicle attitude during atmospheric entry was sensitive to the exo-atmospheric pitch and yaw rates on the vehicle. Thus, data from ground deployment tests were used to create a model that imparted a variable pitching and yawing moment on the vehicle during deployment. In a Monte Carlo analysis, where the pitching and yawing moment profiles are varied stochastically, the resulting pitch and yaw rates on the vehicle envelop the conditions experienced during ground tests.IV. Flight Test Instrumentation and SensorsA. ADEPT SR-1 Sensor SummaryThe reconstruction fidelity and accuracy of the ADEPT SR-1 flight vehicle performance was dependent on the availability of instrumentation and sensor data postflight. ADEPT SR-1 was instrumented to reconstruct the 6-DOF flight profile. A combination of onboard sensors, external measurements, and other data sources was identified preflight for the reconstruction process. An instrumentation and sensor product availability matrix was established to determine the minimum success criteria and quality for a postflight reconstruction. A description of data products and general proposed usage is included in Table 4. ADEPT SR-1 also relied on preflight weather balloon measurements of atmospheric pressure, temperature, and winds for postflight estimation of atmospheric states.There were two inertial measurement units (IMU) on-board ADEPT SR-1 to capture the vehicle acceleration and angular rates. A GPS unit, C-Band Transponder for radar tracking, and magnetometer provided redundant sources of data for the vehicle position, velocity, and attitude. The vehicle was equipped with a GoPro camera to take videos of the flight and record light emitting diode (LED) that indicated if the various ribs of the latching mechanism that hold the ADEPT deployed shape remain in the fully locked configuration. The WSMR also used their radar tracking stations to determine the vehicle’s trajectory as assisted by ADEPT’s on-board C-Band Transponder. The launch provider supplied meteorological profiles of atmospheric information. A GPS-based tracking device, Spot Trace, which was on-board ADEPT was used during recovery operations to locate the vehicle after impact. No sensor data was telemetered during the mission; thus, energy attenuation systems in the nose of the vehicle were needed to prevent damage to the data recording devices on-board the vehicle.The critical data product for reconstruction of the ADEPT SR-1 trajectory came from the IMUs. These were the only instruments that collected acceleration and angular data at a resolution sufficient for orientation determination throughout the flight test. The minimum criterion for orientation reconstruction was data from at least one IMU. The minimum criterion for reconstruction of position and velocity was either GPS data or tracking radar data product. Tracking radar does not generate an orientation history but can provide qualitative data regarding the overall performance of the vehicle. The following subsections detail the specific information for each instrumentation and sensor data type.B. Inertial Measurement UnitsThree IMUs were available for usage during various portions of the SR-1 flight test. These three devices are identified in Table 4 as Affordable Vehicle Avionics (AVA) [46], X-IO Next Generation IMU (NGIMU) [47], and Memsense H3-IMU [48]. Two of the devices, AVA and NGIMU, were integrated avionics components of the ADEPT SR-1 vehicle. The H3 IMU was the onboard IMU for the sounding rocket and is only relevant for ADEPT SR-1 reconstruction to the point of vehicle separation.The AVA and NGIMU units were integrated in the ADEPT SR-1 vehicle as redundant IMU data sources for risk reduction purposes. The AVA device also handled processing of the onboard GPS data. Each device stored data to internal memory for retrieval postflight. Since no data were telemetered, recovery of the flight vehicle and successful transfer of the collected data were critical for mission success. During the launch portion of the flight, both AVA and NGIMU were expected to saturate the X-axis gyroscope channel, due to the high roll rate of up to 7 Hz (2520  deg/s) experienced during the spin stabilized sounding rocket ascent.The H3 IMU was an external data source available for the reconstruction process and was integrated with the sounding rocket launch vehicle. This unit provided ADEPT SR-1 relevant data from launch to vehicle separation. The H3 IMU was a critical data source for establishing the initial conditions of the ADEPT SR-1 vehicle at separation. During the spin stabilized portion of the ascent, the H3 IMU was the only device with an X-axis gyroscope capable of accurately measuring the angular rate of the vehicle. Table 5 details the specifications of the various IMUs. Uncertainties for these devices were determined via a combination of unit calibration and reference documentation.C. Onboard Sensor CalibrationThe ADEPT SR-1 IMUs, AVA, and NGIMU recorded data from a suite of tri-axial sensors including an accelerometer, a gyroscope, and a magnetometer. At manufacturing, these sensors perform within a stated tolerance that addresses bias, scaling, alignment, repeatability, and thermal sensitivity. The ADEPT SR-1 team conducted a series of tests that calibrated each sensor independently to improve the overall accuracy of recorded data. Calibration parameters were calculated from a data set of 500 consecutive points. The calibration process yielded parameters that resolve bias, scaling factor, and misalignment in each sensor. A bias is identified by nonzero values when no force is acting on the sensor. A scale factor defines a linear relationship between the output voltage of the sensor and the physical activity it measures. Bias and scale factor are each defined by three unknowns. Misalignment is an error between the sensor axes and the platform axes and is defined by six angles. These 12 parameters were solved by a least-squares approach. The solution is used to create the components of rotation matrix T, the scale factor matrix K, and a bias vector. These equations are shown in Eqs. (1) and (2). Note that the tests detailed below discuss the collection of calibration data sets and were performed with the IMUs mounted in the ADEPT SR-1 vehicle, which eliminates error and uncertainty associated with board misalignment; however, misalignment between the IMU sensors and the board must still be considered. T=(1−ayzazyaxz1−azx−axyayz1)(1)Ka=diag(kxa,kya,kza)(2)The accelerometer calibration test was conducted on a flat table with ADEPT SR-1 placed in a fixture to allow for rapid and precise rotation. The calibration process required both positive and negative measurements from each accelerometer axis. To accurately define the axes, inclinometer readings were taken at several points on the electronics chassis. Data for calibration were recorded when SR-1 was within 0.1° of perpendicular to the table. The fixture used to support the flight vehicle for calibration is shown in Fig. 14. The specific value of gravity associated with the GPS coordinates of the test location was used as truth.The gyroscope test was performed on a spin table. The ADEPT SR-1 was placed in a fixture securing it during the rotations. The gyroscope calibration exercised both the positive and negative directions of the instrument and was excited to ±120, ±240, and ±360  deg/s. An optical spin rate tracker was used to record the truth value at each rate for each ADEPT SR-1 axis. Figure 14b shows the setup for testing the ADEPT SR-1 Y-axis gyroscope.Fig. 14 IMU calibration devices.The magnetometer calibration test required a magnetically benign area so as to not interfere with the instruments. The Compass Rose at Moffett Field, originally used to calibrate aircraft magnetometers, was selected for this purpose. Using an independent magnetometer, magnetic north was identified and the magnetic field measured. The vehicle was placed into 24 unique attitudes through X, Y, and Z rotations. This provided enough data to successfully complete calibration on the tri-axial suite of sensors.The other IMU used for reconstruction was the H3 IMU on-board the launch vehicle. Calibration of the H3 IMU was completed by the launch provider.D. Global Positioning SystemThe only onboard GPS product was expected to be provided by the AVA sensor package. This device was a GPS receiver (Novatel OEM615, with COCOM limits removed) integrated with the AVA sensor suite, with a dedicated patch antenna placed on the aft end of the ADEPT entry vehicle. The unit was expected to deliver position, velocity, and associated uncertainties. However, it was discovered postflight that the onboard GPS unit was not able to establish a viable GPS solution after separation from the launch vehicle (four satellites required for a viable solution and only three were sensed).Postflight investigation suggested that there were three potential causes that prevented proper function. First, since the GPS patch antenna was obscured from having a view of the sky before separation from the launch vehicle, a prelaunch procedure was developed to use a GPS repeater to successfully obtain GPS lock through the late access panel on the launch pad. This procedure was implemented approximately 2 h before launch. However, because 2 h elapsed between the last successful solution determination and when the GPS receiver would see a new set of orbiting satellites upon separation from the launch vehicle, it is possible that too much time elapsed. Second, in conversations with the manufacturer, it was determined that GPS receiver firmware settings were not optimal for the high acceleration and velocity levels experienced. Future coordination with the manufacturer regarding expected implementation environments is recommended to optimize receiver performance. Third, low signal strength received through the patch antenna could have been amplified using an in-line amplifier to increase the likelihood of sensing four or more GPS satellites.Postflight, it was discovered that a secondary payload on the sounding rocket contained a pair of GPS receivers. This payload, the Autonomous Flight Termination Unit (AFTU), provided position and velocity data and was used during the reconstruction process. These GPS data provided position and velocity measurements during the initial ascent portion of the flight. Figure 15a contains a time versus altitude plot of the GPS data used for ADEPT SR-1 reconstruction.Fig. 15 Position data for ADEPT SR-1 flight.E. Tracking RadarRadar tracking of the ADEPT SR-1 flight vehicle was enabled by an onboard C-band transponder. The transponder provided a signal that allowed WSMR to track the vehicle from launch to impact. Preflight coordination with the range was completed, and three distinct radar tracks were expected to be provided in the form of slant range, elevation, azimuth, and uncertainty values. However, the tracking radar data received by the ADEPT SR-1 team were limited to postapogee due to a misunderstanding with WSMR. These data, provided in a latitude, longitude, and altitude format, lacked associated uncertainty values. These two deviations from the expected data directly impacted the ability to reconstruct the ADEPT SR-1 flight vehicle trajectory. Figure 15b is a graphical representation of the postapogee altitude information as a function of launch time obtained from the range. Some lessons learned from this experience include closer direct coordination with the radar tracking team rather through intermediaries so that miscommunication is limited.V. Postflight ReconstructionA. Trajectory ReconstructionThe reconstructed ADEPT SR-1 trajectory was computed by a MATLAB-based Iterative Extended Kalman Filter-Smoother code known as the New Statistical Trajectory Estimation Program (NewSTEP) [49]. This software is a modernized and generalized implementation of the Statistical Trajectory Estimation Program (STEP) [50], which was developed during the 1960s. The NewSTEP tool can process many types of sensor measurements, such as IMU, GPS, air-data sensors, and ground-based measurements like radar, to produce an optimal estimate of the as-flown vehicle trajectory. The tool has been extensively used for various trajectory reconstruction problems over the last two decades. Recent examples include the flight testing of inflatable heatshields [12] and parachute configurations [40].For ADEPT SR-1, NewSTEP was configured to process three separate onboard IMU measurements, GPS data, atmospheric weather balloon measurements, and ground-based radar tracking data. The reconstruction process was tested extensively before the ADEPT SR-1 launch by making use of simulated sensor data sets created by the POST2 trajectory simulation.Various sensor suite combinations were explored during the reconstruction process, with the final results described in this section. The data products and sensors used for this process included the AVA IMU accelerations and angular rates, H3 X-axis angular rates, and radar and GPS data provided by WSMR and AFTU. The data products used in the final reconstruction were not the preflight sensor suite, but were instead the logical solution matrix for the data received. Table 6 contains the matrix of sensors used in the following reconstruction results.The uncertainties used during the reconstruction process were determined through a combination of preflight testing, sensor-provided uncertainties, and previous experience in sensor uncertainty quantification; e.g., as native uncertainties for the radar data were not provided, the uncertainties used were based upon prior experience with similar radar data sources and past experience with WSMR. The IMU uncertainty values were determined via a combination preflight calibration, testing, or manufacturer specifications, where applicable. The GPS units used for reconstruction provided estimated position and velocity uncertainties.The final reconstruction was initialized from the launch pad and terminated at 400 s into the flight. At approximately 400 s into the trajectory, the body rates on the vehicle exceeded the capabilities of the onboard IMUs, and IMU-based reconstruction was no longer possible. Radar tracking continued after 400 s, and the approximate impact time of the vehicle was determined to be 857 s after launch.The IMU sensor combination was established after data quality issues were discovered with the NGIMU unit onboard the vehicle. The onboard AVA IMU was used for acceleration and angular rate information from the launch pad to 400 s after launch. However, during the first 57 s of the flight, the X-axis gyroscope channel from AVA was replaced with the X-axis gyroscope data from the H3 IMU. During this period the sounding rocket was spin stabilized at a roll rate higher than the capabilities of the AVA IMU. However, the H3 IMU sensor performance was capable of continuous operation during this period of the flight. Data from the magnetometers did not meet expectations and were determined to be corrupted by systematic errors, and thus were not used in the reconstruction.The launch and deployment of the ADEPT SR-1 from the sounding rocket was in-family with preflight predictions. The altitude at separation was approximately 107 km with a vehicle roll rate of approximately 43  deg/s. The vehicle roll rate increased after reentry and reached values greater than 300  deg/s before IMU saturation at 400 s. The angle of attack of the vehicle and sideslip of the vehicle remained below 20° between the peak Mach number (Mach 3.1) and Mach 0.8, a key time of interest for the experiment.The results presented in this paper are focused on the ADEPT SR-1 flight after separation from the launch vehicle. Key events during this portion of flight can be found in Table 7. Figures 16–20 detail selected reconstruction results starting from launch vehicle separation to IMU saturation at 400 s.Fig. 16 Position and altitude reconstruction.Fig. 17 ADEPT SR-1 dynamic pressure and Mach number reconstruction.Fig. 18 ADEPT SR-1 accelerations.Fig. 19 ADEPT SR-1 angular rates.Fig. 20 ADEPT SR-1 attitude angles.B. Atmosphere ReconstructionThere were no in situ sensors to take atmospheric measurements on-board ADEPT SR-1 or the launch vehicle; however, atmosphere-relative quantities like Mach number, angle of attack, and dynamic pressure were desired during the postflight reconstruction. Thus, ADEPT SR-1 used a collection of atmospheric measurements and weather model data to aggregate launch day atmospheric properties similar to other sounding rocket based tests in the recent past [51]. The data sources are summarized in Table 8.The launch provider took several upper altitude and lower altitude atmospheric measurements before and after the launch using weather balloons. The primary purpose of these measurements was to provide wind speed measurements near the launch site that would influence the azimuth of the launch vehicle. The last minute adjustment of the launch vehicle azimuth to maintain the same landing site location is common practice for sounding rockets and is called wind weighting. However, these measurements are not designed for scientific assessment of the atmospheric profile during the launch trajectory, and the altitude of the measurements is capped by the capability of the weather balloon. For ADEPT SR-1, the highest altitude reached by these balloons was approximately 15 km geodetic altitude. The upper altitude balloons were 600 g Hwoyee weather balloons, and the lower altitude balloons were 100 g models of the same brand. A rise rate of roughly 5  m/s was targeted. The 600 g Hwoyee balloon was paired with a Ublox GPS breakout instrument, pressure sensors, and K-type thermocouple, whereas the low-altitude weather balloon did not have pressure and temperature sensors but used an Adafruit breakout.Above 15 km in altitude, data from the Global Modeling and Assimilation Ocean (GMAO) tool at Goddard Space Flight Center (GSFC) were used to provide temperature, pressure, density, and wind speed information. The GMAO creates predictions of Earth atmospheric properties daily at increments of 3 h [52]. These predictions, known as GEOS-5, are then reanalyzed after the prediction time has passed with local observations to recompute the atmospheric state. These observations include radiosonde data from the National Weather Service, ground station measurements, radar wind sensors, and maritime data. Although GEOS-5 is not an in situ weather measurement, the reanalysis data benefit from some in situ measurements to improve the atmospheric estimate. The GEOS-5 data are computed at a grid that is 0.5° in latitude and 0.625° in longitude. The ADEPT SR-1 trajectory covered a large swath of latitude and longitude; therefore two grid points closest to the launch and landing sites, respectively, were used. Additionally, the GEOS-5 reanalysis data were available for 12:00 and 15:00 UTC, whereas the launch took place close to 13:30 UTC, so reanalysis data from both time points were used. Postflight, GMAO provided data to quantify GEOS-5 uncertainties at the WSMR region based on comparison with historical meteorological rocket data [52–55].The GEOS-5 predictions are applicable to approximately 65 km geodetic altitude, which is above the scientific region of interest for ADEPT SR-1. However the vehicle trajectory was predicted to reach 115 km altitude. Therefore to ease the estimation of atmospheric quantities, the atmospheric reconstruction was extended to 125 km. The authors found no high-quality measurements or models of atmospheric measurements at WSMR that adequately captured local weather phenomenon. Thus, the 1976 US Standard Atmosphere data [56] was used to extend pressure, temperature, and density measurements above the GEOS-5 model height, and wind speeds were assumed to be zero.Figures 21–23 summarize the various datasets used for ADEPT SR-1 atmospheric reconstruction and also show the final ADEPT SR-1 reconstructed atmosphere and uncertainties. To combine the various data sources, the mean of each data source was taken at each altitude level. For the balloonsonde wind data, a 10-point moving average filter, which was tuned through trial and error, was applied to cut off high-frequency noise and yield wind speeds that vary on the scale of hundreds of meters. From the ground to 15 km altitude, the temperature from the mean balloonsonde data was assumed to be the temperature along the flight path of the ADEPT SR-1. Figure 21 shows that there was a discrepancy between the GEOS-5 mean and balloonsonde mean, but because the balloonsonde data were measurements taken at locations flown by the ADEPT SR-1 spacecraft, they were used for the reconstruction. From 15 to 65 km, the mean GEOS-5 temperature profile was used. Finally, from 65 km and higher, the temperature profile from the 1976 US Standard atmosphere was used along with an adjustment that shifted the standard atmosphere-based profile to the GEOS-5 highest altitude temperature. Based on this ADEPT SR-1 temperature profile, pressure and density were calculated using the hydrostatic equation and perfect gas law. Finally, the wind profiles were combined in a manner similar to the temperature profile. However, it was assumed that wind speeds above 65 km were zero. Note that Range Reference Atmosphere (RRA) is the range reference atmospheric wind speed in September at the WSMR and is provided for reference only.The uncertainties for the region with only GEOS-5 data were based on comparing past predictions with historical meteorological rocket measurements at WSMR. The uncertainties in temperature, density, and wind speeds were estimated. Uncertainties in pressure could not be computed because the GEOS-5 model makes predictions at constant pressure levels, thus making pressure the independent variable in the process. For the region below 15 km, each individual profile from the balloonsodes and GEOS-5 predictions was compared with the ADEPT SR-1 mean estimate. The sample standard deviation of this difference was estimated as the uncertainties. In the region where standard atmosphere was used, the percentage uncertainty of the last GEOS-5 data point was used as the uncertainty for the region above 65 km.Fig. 21 ADEPT SR-1 temperature reconstruction and the various datasets used during the process.Fig. 22 ADEPT SR-1 east–west wind reconstruction and the various datasets used during the process.Fig. 23 ADEPT SR-1 north–south wind reconstruction and the various datasets used during the process.C. Aerodynamic ReconstructionVehicle aerodynamic force and moment coefficients for ADEPT SR-1 were calculated from linear and angular accelerations measured in flight with the AVA IMU, reconstructed dynamic pressure, vehicle mass, reference area, and reference length. The reconstructed aerodynamics were reconciled with the preflight aerodatabase using a parameter estimation technique to solve for a set of dispersions that best fit the reconstructed trajectory. An equation error approach [57] was used to estimate parameters of the aerodatabase that best fit the reconstructed force and moment coefficients. This approach has been used in the past for Mars Science Laboratory [58] and the Low-Density Supersonic Decelerator project [12]. The reconciled set of uncertainty factors was computed using a nonlinear least-squares method to determine the best fit to the reconstructed total force and moment coefficients over the time period from 250 to 400 s after launch.The results of the parameter estimation approach are shown in Table 9. These parameters are the values of uncertainty factors determined to best fit the reconstructed aerodynamics and map to the supersonic/transonic/subsonic uncertainties given in Table 2. Note that the uncertainty factors are normalized such that a value of unity corresponds to a 3σ uncertainty. As such, many of these values are well beyond the 3σ level. These results may be due to sensor misalignments that could corrupt side/normal and pitch/yaw adders in particular and will be investigated in future work.Comparisons of the nominal, reconstructed, and reconciled aerodynamic force and moment coefficients are shown in Figs. 24 and 25. Figure 24 provides a detailed view of the fits to the flight data over several oscillations for CN and Cm. Figure 25 shows the preflight nominal aerodatabase along with the results of the reconstruction and best fit dispersed aerodatabase given by the uncertainty factors listed in Table 9. Axial force coefficient was underpredicted between 250 and 275 s, and the abrupt drop in CA just before 300 s was not captured in preflight modeling. Beyond 275 s, axial force coefficient was overpredicted by the nominal aerodatabase. Based on the parameter estimates given in Table 9, the reconstructed CA was within the ±3σ uncertainty on the nominal value.The inaccuracy of the axisymmetric assumption for the ADEPT SR-1 shape is apparent in the comparisons of CY and CN in Fig. 25, as these coefficient values are not centered about zero. The amplitude growth in pitch and yaw inherent in the CY and CN histories was expected, due to the dynamic instability of blunt bodies decelerating through supersonic conditions. The values of CY and CN were underpredicted preflight, whereas Cm and Cn were overpredicted. In Table 9, the uncertainty parameter estimates for the pitch and yaw moment multipliers, which change the slope of the pitch and yaw stability curves, far exceed the 3σ values carried in the preflight aerodatabase. It is expected that reformulation of the aerodatabase as a function of both α and β, as opposed to αT, will significantly reduce this discrepancy, as this will improve agreement of CY and CN reconstructed in flight with values predicted through simulation at nonzero sideslip angles. If these updates do not significantly improve agreement with the reconstructed flight performance, wind tunnel testing is recommended to develop a ground test basis for aerodynamics of the faceted ADEPT shape.Fig. 24 Details of fits to ADEPT SR-1 flight data.Fig. 25 Comparison of preflight nominal, reconstructed, and reconciled aerodynamic force and moment coefficients for ADEPT SR-1.D. On-Board Video Analysis and Rate ReconstructionThe trajectory and aerodynamic reconstruction of ADEPT SR-1 was stopped at 400 s after launch as the on-board gyroscopes became saturated due to the vehicle tumbling. However, the on-board video camera continued to operate well past the start of the tumbling behavior. Thus, the on-board video was analyzed to reconstruct the attitude rates of the vehicle, specifically in areas the gyroscope could not provide information due to saturation.The root-sum-square (RSS) attitude rate from the on-board gyroscope and reconstruction from the video analysis is shown in Fig. 26. Video analysis of the vehicle attitude rate starts at ADEPT SR-1 deployment, when the dynamic event could be used to synchronize the time of the camera and the gyroscopes. From ADEPT SR-1 deployment to the start of tumbling (135–400 s after launch), the vehicle attitude rates are gleaned by frame-by-frame analysis of observables such as the sun and the fact that the camera faces the −Z direction of the vehicle. These rates are comparable with the on-board rates from the gyroscope. Once the vehicle starts tumbling post 400 s, the observed spin rate of the horizon or the periodic vertical scrolling of the horizon can be used for reconstructing the tumble rate. The attitude rate poststart of tumbling was reconstructed in three places: at 416 s when the vehicle gyroscopes were not saturated, at 431 s when the vehicle gyroscopes were saturated, and at 575 s when the vehicle gyroscopes were again not saturated. For the first and third instances, there is good agreement between the video analysis and the on-board gyroscopic rate. For the second instance, the video analysis can estimate the maximum tumble rate of 3090  deg/s, when the vehicle’s on-board gyroscopes were saturated. The existence of the on-board video adds new information about ADEPT SR-1 flight performance during a phase when the traditional reconstruction sources were not usable.Fig. 26 Reconstruction of ADEPT SR-1 attitude rates using video analysis.VI. Flight Mechanics Performance Results and Comparison with Flight DataThe following sections compare preflight estimates from the flight mechanics simulation and the reconstructed trajectory. Such analysis can quantify how well the preflight simulation captured the behavior of the actual flight and thereby elucidate gaps in modeling. In cases where the Monte Carlo predictions do not bound the reconstructed values, a process known as reconciliation is used to systematically update flight simulation settings to determine if the reconstructed performance can be replicated by a simulation. This reconciliation process was used successfully after recent Earth flight tests [40,59,60] to support model changes and improve future flight predictions.A. Comparison of Reconstructed Trajectory with Preflight EstimateFigure 27 shows a comparison of the preflight nominal trajectory from the flight mechanics simulation and the reconstructed trajectory. The reconstructed trajectory extends up to 400 s of flight time, after which the vehicle started tumbling and precluded IMU-based integration of the trajectory needed for the reconstruction. Radar tracking data of the position of the vehicle were available to the end of the flight and are shown in Fig. 27a. The preflight trajectory is only modeled from separation from the launch vehicle, which occurs around 95 s after launch. Unexpected behavior in preflight analysis, such as the rolling moment experienced during supersonic flight and tumbling observed below Mach 0.2, is still unresolved in the reconciliation process.The comparison shows that the reconstructed altitude and velocity profile from ADEPT SR-1 separation onward was lower than the nominal preflight estimate. Later figures will show that even in a statistical sense, the reconstructed altitude and velocity at separation were on the lower end of the preflight uncertainty envelope. The lower values mean that the ADEPT SR-1 vehicle had lower kinetic and potential energy than preflight estimates.Fig. 27 Comparison for preflight nominal predictions and reconstructed trajectory.Figure 28a shows the root mean square (RMS) of the pitch and yaw rate during the ADEPT separation and deployment process, and Fig. 28b shows the vehicle’s roll rate. Also listed is the preflight expectation of the parameter. The RMS of pitch and yaw rate at separation is the tip-off rate that is imparted to the vehicle and is a significant contributor to the vehicle attitude stability in exo-atmospheric flight. Unfortunately, tip-off rate is not very easy to tune for launch providers for vehicles without active attitude control system like ADEPT SR-1. The vehicle has a nonzero roll rate in exo-atmospheric flight for gyroscopic stability, and this value changes when ADEPT reconfigures from the stowed to the deployed shape. Large tip-off rates can offset the gyroscopic stability of the vehicle and create an undesired attitude (large angle of attack) when sensible atmosphere is reached. Because the reconstructed tip-off rate was higher than the preflight expectation, largely again since it is a hard parameter to target for launch providers, initial postflight analysis focused on the impact of the larger rate. However, as the roll rate imparted to the vehicle during separation was close to the nominal expectation, the slight increase in tip-off rate did not adversely affect the vehicle attitude at entry and is discussed later in this section.The reconstructed value and preflight predictions for several events are summarized in Table 10. The preflight predictions are a result of Monte Carlo analysis where models, such as atmosphere, aerodynamics, and mass properties, were dispersed randomly for 8001 cases to aggregate statistics about events of interest. The reconstructed values are listed as percentiles of the Monte Carlo result, where a low (close to 0) or high (close to 100) percentile denotes that the reconstruction is a low-probability event, whereas a percentile close to 50 denotes that the value is close to the median of the prediction; thus, a high probability event.Fig. 28 Preflight expectation and reconstructed attitude rates during separation and deployment.Predictions of altitude and velocity at separation and apogee were higher than the reconstructed trajectory, although the roll rate of the vehicle postseparation was close to the preflight estimate value of 200  deg/s. Statistics at entry interface, defined for ADEPT SR-1 as 85 km geodetic altitude, show a similar story. The velocity was lower than expected, but attitude quantities, like roll rate or flight path angle, were close to the median. The peak Mach number was close to the desired value of Mach 3, whereas reconstructed peak dynamic pressure and maximum sensed acceleration are high probability events (between 5 and 95 percentile) within the preflight Monte Carlo predictions.B. Reconciliation of Reconstructed Trajectory and Flight Mechanics SimulationFigure 29 shows reconciled Monte Carlo results. Reconciliation involves updating preflight simulation assumptions using flight observables. For ADEPT SR-1, the flight observables included the actual estimated state of the vehicle at separation, reconstructed atmosphere, and observed attitude dynamics of the vehicle captured on IMUs.Figure 29 also contains the preflight prediction and the reconstructed values (plotted as dashed lines). The percentile noted on the reconstructed line is compared with the preflight estimate. As different flight observables are incorporated into the simulation, the predictions become more focused and the reconstructed trajectory is closer to the simulation prediction. For example, matching the separation states made the Monte Carlo predictions of apogee geodetic altitude and entry interface planet relative velocity align with the reconstruction, even though previously the reconstructed value was a low-probability item from the preflight prediction. Similarly, incorporating the reconstructed atmosphere improved the predicted distribution of an atmospheric-relative quantity like peak Mach number, whereas updates to both atmosphere and separation states improved the prediction of maximum sensed acceleration. However, the reconciliation of Mach number and peak acceleration shows that the simulation predictions do not encompass the reconstruction; the difference could be due to some other factor not captured in the simulation or adjustments needed for existing models such as the aerodatabase. In these two cases, the difference was small and did not warrant additional changes.Fig. 29 Reconciliation Monte Carlo results compared with reconstructed trajectory. Vertical black line shows what percentile the reconstruction constituted of the preflight prediction.The two KPPs for ADEPT SR-1 were to successfully deploy the vehicle exo-atmospherically and to demonstrate stability of the vehicle based on total angle of attack less than 90° during supersonic and transonic flight. The first KPP is verified via the on-board GoPro camera, which recorded that the rib deploy LED was active throughout entire flight once the vehicle was deployed [2]. The second KPP is verified by comparing the angle-of-attack history over the course of flight. Figure 30 shows various estimates of the 95th-percentile total angle-of-attack prediction from the flight mechanics simulation. The preflight estimate as well as two updated reconciliation Monte Carlo estimates that are based on postflight data (updated atmosphere and updated separation states) are shown in the figure. The stability threshold, defined as a desire to not exceed specific angle-of-attack at various flight conditions, and the maximum reconstructed total angles of attack in 1 s interval bins are shown.All three Monte Carlo estimates for total angle of attack are similar in Fig. 30, especially in the atmospheric portion of the flight (85 km geodetic altitude and below). The reconstructed total angle of attack at several points is higher than the predicted 95th percentile value, and this difference becomes significant below Mach 1. However, it should be noted that the values do not cross the 20° stability threshold through Mach 0.4, showing stability through supersonic and transonic flight [2]. Increase in angle of attack in transonic and subsonic flow has been observed on rigid bodies in the past [61] and was expected for ADEPT SR-1 as well. Nevertheless, the larger than expected total angle-of-attack history suggests that even the reconciled simulation, which was updated to incorporate the reconstructed atmosphere and the best estimated states at separation, cannot predict the subsonic attitude history of the vehicle. Further work in refining the aerodynamics, especially in the subsonic regime, is suggested by the results in Fig. 30.Fig. 30 The 95th percentile predicted total angle of attack compared with the reconstructed values.An unexpected phenomenon observed during the ADEPT SR-1 flight was the large roll rate increase in the vehicle during supersonic flight after peak Mach number was reached. Figure 31 shows the roll rate and angle of attack for the latter portion of the flight together with the reconstructed Mach number. The roll rate of ADEPT SR-1 increased from 44 to 370  deg/s in the time the vehicle went from peak Mach of 3.1 to Mach 0.7. This increase in roll rate was not predicted by preflight simulations (see Fig. 32), nor could it be recreated during reconciliation with changes, such as updating to the day of flight atmosphere or using the actual separation states. Rolling moments caused by large radial CG were considered, including assuming a radial CG on the rib tips of the vehicle (which is the extent to which a radial CG offset is possible), but the simulation could not re-create the roll rate increase seen in flight.The large roll rate increase observed in the flight data necessitates a rolling moment coefficient in the supersonic regime that is outside bounds of the current ADEPT SR-1 aerodatabase. One of the reasons for the underestimation of the rolling moment is the axisymmetric assumption made in the aerodatabase. Recall that one of the ramifications of the axisymmetric assumption is that moments created by a change in angle of attack are equivalent to moments created by a change in sideslip angle. Recent CFD simulations where angle of attack and sideslip angle have been independently varied result in rolling moments larger than the current aerodatabase. However, traditional CFD alone may not be well suited to capture the rolling dynamics observed in this flight regime. Newer dynamic CFD methods, similar to those from Stern and Brock [62–64], show promise but are still in their infancy. The large rolling moment increase could be due to the faceted forebody shape, warping of the fabric, or non-axisymmetric aftbody shape. Fully capturing the rolling dynamics in a flight mechanics simulation may require additional ground tests with the ADEPT shape to quantify the rolling moment during supersonic and transonic phases of flight.Fig. 31 Reconstructed attitude dynamics profile comparison with Mach number.Fig. 32 The 95th percentile prediction of roll rate compared with reconstructed values.Reconciliation was also applied in comparison of the preflight estimates of the landing location to the actual recovery site. Figure 33 shows various 99th percentile confidence landing ellipses from the flight mechanics simulation, with the landing ellipse sizes noted by major and minor axes. The mean preflight landing location is 9 km from the recovery location, whereas the mean of the landing ellipse from the most up-to-date reconciliation Monte Carlo (updated atmosphere and separation state) is 4.6 km from the recovery location. The difference between the latest reconciliation and the recovery location could be potentially improved if the aerodatabase is extended to a larger angle of attack, as the preflight aerodatabase in the supersonic and subsonic regimes was limited to 20° total angle of attack but in flight ADEPT SR-1 tumbled below Mach 0.2.Fig. 33 The 99th percentile confidence landing ellipse compared with actual ADEPT recovery location.VII. ConclusionsADEPT SR-1 was the first end-to-end test of the novel aeroshell that can enable many types of planetary entry missions. This paper showed results from the preflight simulations and compared them to the flight data. Analysis of the flight data showed that the ADEPT SR-1 flight test achieved both of its primary objectives, which were to deploy the test article exo-atmospherically and demonstrate aerodynamic stability without active control down to Mach 0.8. In addition, the more comprehensive set of preflight metrics and simulation predictions were shown to bound the flight data for most of the parameters involved. Through reconciliation processes and updating the simulation with flight observables, such as the day of flight atmosphere and separation states, the simulation predictions came closer to the reconstructed states. However, the ADEPT SR-1 flight had an unexpected roll rate increase observed during supersonic flight and also tumbled at low subsonic speeds, which is often addressed in missions by deploying a parachute. These observations were beyond the envelope of preflight simulations. The fundamental physics that caused the rolling behavior is not as well-understood.Although the experiment was successful, reconstructed flight performance identified multiple limitations of the preflight aerodynamics database. Computational simulations were used to develop the entirety of the ADEPT SR-1 static aerodynamics database. For the supersonic, transonic, and subsonic conditions defining the ADEPT SR-1 trajectory, aftbody pressure is a significant contributor to the total axial force on the vehicle. Ground test data are generally used in place of CFD due to challenges of accurately modeling the effects of massively separated flow on pressure on such surfaces. During low supersonic and subsonic ADEPT SR-1 flight, the axial force coefficient was overpredicted, indicating a deficiency in the computational approaches used to simulate such conditions. Ground test data, specifically wind tunnels for static coefficients and an extensive ballistic range test series for dynamic coefficients, might be necessary to reduce uncertainties in aerodynamics predictions for blunt bodies at supersonic, transonic, and subsonic conditions.The ADEPT SR-1 flight also had some sensors that did not perform as expected. Another lesson learned would be closer communication with sensor manufacturers to lessen miscommunication and have onboard sensors that are at optimum setting for testing environment.The ADEPT SR-1 shape is not axisymmetric but has eight seamed fabric gores stretched across ribs, which cannot be approximated using a smooth conical surface. Aerodynamic reconstruction demonstrated the inaccuracy of the axisymmetric assumption, and forward work includes expanding the aerodynamics database to account for effects arising from an non-axisymmetric heatshield. At subsonic conditions, the vehicle experienced angles in excess of 20°, indicating a need to extend the aerodynamic database to larger angles.G. E. PalmerAssociate EditorAcknowledgmentsPart of this research was funded by NASA Space Technology Mission Directorate’s Game Changing Development Program. The authors acknowledge several Adaptable Deployable Entry and Placement Technology (ADEPT) team members who have contributed to the flight mechanics work presented in this paper. These team members include Brandon Smith, Ryan McDaniel, Derek Leichty, Juan Cruz, and Shak Ghassemieh. The authors would also like to thank Allen Minor of UP Aerospace and Erik Magnuson from NASA Kennedy Space Center for providing various ADEPT Sounding Rocket One datasets that were not part of the on-board measurements. Additionally, the authors very much appreciate the GEOS-5 uncertainty analysis work done by Lawrence Coy of NASA Goddard Space Flight Center on a short time frame.\r            References\r        [1] Dutta S., Smith B., Prabhu D. and Venkatapathy E., “Mission Sizing and Trade Studies for Low Ballistic Coefficient Entry Systems to Venus,” IEEE Aerospace Conference, IEEE, New York, 2012, pp. 1–14. https://doi.org/10.1109/AERO.2012.6187002 Google Scholar[2] Cassell A., Wercinski P., Smith B., Yount B., Ghassemieh S., Nishioka O., Kruger C., Brivkalns C., Makino A., Wu S., Mai N., McDaniel R., Guarneros-Luna A., Williams J., Hoang D., Rowan R., Dutta S., Korzun A., Cruz J., Green J., Tynis J. and Karlgaard C., “ADEPT Sounding Rocket One Flight Test Overview,” AIAA Aviation 2019, AIAA Atmospheric Flight Mechanics Conference, AIAA Paper  2019-2896, 2019. https://doi.org/10.2514/6.2019-2896 Google Scholar[3] Venkatapathy E., Arnold J., Fernandez I., Hamm K., Peterson K., Prabhu D., Empey D., Dupzyk I., Huynh L., Hajela P., Gage P., Howard A. and Andrews D., “Adaptive Deployable Entry and Placement Technology (ADEPT): A Feasability Study for Human Missions to Mars,” 21s AIAA Aerodynamic Decelerator Systems Technology Conference and Seminar, AIAA Paper  2011-2608, 2011. https://doi.org/10.2514/6.2011-2608 Google Scholar[4] Cassell A., Brivkalns C. A., Bowles J., Garcia J., Kinney D. J., Wercinski P., Cianciolo A. and Polsgrove T., “Human Mars Mission Design Study Utilizing the Adaptive Deployable Entry and Placement Technology,” 2017 IEEE Aerospace Conference, IEEE, New York, 2017, pp. 1–16. https://doi.org/10.1109/AERO.2017.7943585 Google Scholar[5] Smith B., Venkatapathy E., Wercinski P., Yount B., Prabhu D., Gage P., Glaze L. and Baker C., “Venus In Situ Explorer Mission Design Using a Mechanically Deployed Aerodynamic Decelerator,” IEEE Aerospace Conference, IEEE, New York, 2013, pp. 1–18. https://doi.org/10.1109/AERO.2013.6497176 Google Scholar[6] Smith B., Cassell A., Kruger C., Venkatapathy K., Kazemba C. and Simonis K., “Nano-ADEPT: An Entry System for Secondary Payloads,” IEEE Aerospace Conference, IEEE, New York, 2015, pp. 1–11. https://doi.org/10.1109/AERO.2015.7119095 Google Scholar[7] Cassell A., Smith B., Wercinski P., Ghassemieh S., Hibbard K., Nelessen A. and Cutts J., “ADEPT, A Mechanically Deployabe Re-Entry Vehicle System, Enabling Interplanetary CubeSat and Small Satellite Missions,” SmallSat Conference, Utah State Univ. Libraries, Logan, UT, 2018, pp. 1–8. Google Scholar[8] Wercinski P., Smith B., Yount B., Kruger C., Brivkalns C., Makino A., Cassell A., Dutta S., Ghassemeih S., Wu S., Battazzo S., Nishioka O., Venkatapathy E. and Swanson G., “ADEPT Sounding Rocket One (SR-1) Flight Experiment Overview,” 2017 IEEE Aerospace Conference, IEEE, New York, 2017, pp. 1–7. https://doi.org/10.1109/AERO.2017.7943889 Google Scholar[9] Smith B., Yount B., Kruger C., Brivkalns C., Makino A., Cassell A., Zarchi K., McDaniel R., Ross J., Wercinski P., Venkatapathy E., Swanson G. and Gold N., “Nano-ADEPT Aeroloads Wind Tunnel Test,” IEEE Aerospace Conference, IEEE, New York, 2016, pp. 1–20. https://doi.org/10.1109/AERO.2016.7500719 Google Scholar[10] O’Keefe S. and Bose D., “IRVE-II Post-Flight Trajectory Reconstruction,” AIAA Atmospheric Flight Mechanics Conference, AIAA Paper  2010-7515, 2010. https://doi.org/10.2514/6.2010-7515 Google Scholar[11] Olds A. D., Beck R. E., Bose D. M., White J. P., Edquist K. T., Hollis B. R., Lindell M. C., Cheatwood F. M., Gsell V. T. and Bowden E. L., “IRVE-3 Post-Flight Reconstruction,” AIAA Aerodynamic Decelerator Systems Conference, AIAA Paper  2013-1390, 2013. https://doi.org/10.2514/6.2013-1390 Google Scholar[12] Karlgaard C. D., Kutty P., O’Farrell C., Blood E., Ginn J. and Schoenenberger M., “Reconstruction of Atmosphere, Trajectory, and Aerodynamics for the Low-Density Supersonic Decelerator Project,” Journal of Spacecraft and Rockets, Vol. 56, No. 1, 2019, pp. 221–240. https://doi.org/10.2514/1.A34223 LinkGoogle Scholar[13] Moss J. N., Glass C. E., Hollis B. R. and Norman J. W. V., “Low-Density Aerodynamics for the Inflatable Reentry Vehicle Experiment,” Journal of Spacecraft and Rockets, Vol. 43, No. 6, 2006, pp. 1191–1201. https://doi.org/10.2514/1.22707 LinkGoogle Scholar[14] Schoenenberger M., Cheatwood F. M. and Desai P. N., “Static Aerodynamics of the Mars Exploration Rover Entry Capsule,” AIAA Aerospace Sciences Meeting, AIAA Paper  2005-0056, 2005. https://doi.org/10.2514/6.2005-56 Google Scholar[15] Edquist K. T., Desai P. N. and Schoenenberger M., “Aerodynamics for Mars Phoenix Entry Capsule,” Journal of Spacecraft and Rockets, Vol. 48, No. 3, 2011, pp. 713–726. https://doi.org/10.2514/1.46219 LinkGoogle Scholar[16] LeBeau G. and Lumpkin F., “Application Highlights of the DSMC Analysis Code (DAC) Software for Simulating Rarefied Flows,” Computer Methods in Applied Mechanics and Engineering, Vol. 191, Nos. 6–7, 2001, pp. 595–609. https://doi.org/10.1016/S0045-7825(01)00304-8 CrossrefGoogle Scholar[17] Liechty D., “Object-Oriented/Data-Oriented Design of a Direct Simulation Monte Carlo Algorithm,” Journal of Spacecraft and Rockets, Vol. 52, No. 6, 2015, pp. 1521–1529. https://doi.org/10.2514/1.A33177 LinkGoogle Scholar[18] Nompelis I. N., Drayna T. and Candler G. V., “Development of a Hybrid Unstructured Implicit Solver for the Simulation of Reacting Flows over Complex Geometries,” AIAA Fluid Dynamics Conference, AIAA Paper  2004-2227, 2004. https://doi.org/10.2514/6.2004-2227 Google Scholar[19] Nompelis I. N., Drayna T. and Candler G. V., “A Parallel Unstructured Implicit Solver for Hypersonic Reacting Flow Simulations,” AIAA Computational Fluid Dynamics Conference, AIAA Paper  2005-4867, 2005. https://doi.org/10.2514/6.2005-4867 Google Scholar[20] Biedron R. T., Carlson J.-R., Derlaga J. M., Gnoffo P. A., Hammond D. P., Jones W. T., Kleb W. T., Lee-Rausch E. M., Nielsen E. J., Park M. A., Rumsey C. L., Thomas J. L. and Wood W. A., “FUN3D Manual: 13.2,”  NASA  TM 2017-219661, Aug. 2017. Google Scholar[21] Anderson W. K. and Bonhaus D. L., “An Implicit Upwind Algorithm for Computing Turbulent Flows on Unstructured Grids,” Computers and Fluids, Vol. 23, No. 1, 1994, pp. 1–21. https://doi.org/10.1016/0045-7930(94)90023-X CrossrefGoogle Scholar[22] Roe P. L., “Approximate Reimann Solvers, Parameter Vectors, and Difference Schemes,” Journal of Computational Physics, Vol. 43, No. 2, 1981, pp. 357–372. https://doi.org/10.1016/0021-9991(81)90128-5 CrossrefGoogle Scholar[23] Spalart P. R. and Allmaras S. R., “A One-Equation Turbulence Model for Aerodynamic Flows,” AIAA Aerospace Sciences Conference, AIAA Paper  1992-0439, 1992. https://doi.org/10.2514/6.1992-439 Google Scholar[24] Korzun A., Bibb K., Canabal F., Childs R., Tang C., Rizk Y., Van Norman J. and Tynis J., “Powered Descent Aerodynamics for Low and Mid Lift-to Drag Human Mars Entry, Descent, and Landing Vehicles,” AIAA SciTech 2020, AIAA Paper  2020-1510, 2020. https://doi.org/10.2514/6.2020-1510 Google Scholar[25] Cianciolo A., Lugo R., Korzun A., Slagle A., Queen E., Dillman R. and Powell R., “Low Lift-to-Drag Morphing Shape Design,” AIAA SciTech 2020, AIAA Paper  2020-1266, 2020. https://doi.org/10.2514/6.2020-1266 Google Scholar[26] Korzun A., Nielsen E., Walden A., Jones W., Carlson J., Moran P., Henze C. and Sandstrom T., “Effects of Spatial Resolution on Retropropulsion Aerodynamics in an Atmospheric Environment,” AIAA SciTech 2020, AIAA Paper  2020-1749, 2020. https://doi.org/10.2514/6.2020-1749 Google Scholar[27] Steger J. L. and Warming R. F., “Flux Vector Splitting of the Inviscid Gasdynamic Equations with Application to Finite-Difference Methods,” Journal of Computational Physics, Vol. 40, No. 2, 1981, pp. 263–293. https://doi.org/10.1016/0021-9991(81)90210-2 CrossrefGoogle Scholar[28] van Leer B., “Towards the Ultimate Conservative Difference Scheme. V. A Second-Order Sequel to Godunov’s Method,” Journal of Computational Physics, Vol. 32, No. 1, 1979, pp. 101–136. https://doi.org/10.1016/0021-9991(79)90145-1 CrossrefGoogle Scholar[29] Wright M. J., Candler G. V. and Bose D., “A Data-Parallel Line Relaxation Method for the Navier-Stokes Equations,” AIAA Journal, Vol. 36, No. 9, 1998, pp. 1603–1609. https://doi.org/10.2514/2.586 LinkGoogle Scholar[30] Catris S. and Aupoix B., “Density Corrections for Turbulence Models,” Aerospace Science and Technology, Vol. 4, No. 1, 2000, pp. 1–11. https://doi.org/10.1016/S1270-9638(00)00112-7 CrossrefGoogle Scholar[31] Kazemba C., Braun R., Schoenenberger M. and Clark I., “Dynamic Stability Analysis of Blunt-Body Entry Vehicles Using Time-Lagged Aftbody Pitching Moments,” Journal of Spacecraft and Rockets, Vol. 52, No. 2, 2015, pp. 393–403. https://doi.org/10.2514/1.A32894 LinkGoogle Scholar[32] Schoenenberger M., Brown G. and Yates L., “Surface Pressure Ballistic Range Test of Mars 2020 Capsule in Support of MEDLI2,” AIAA Aviation 2017, AIAA Paper  2017-4079, 2017. https://doi.org/10.2514/6.2017-4079 Google Scholar[33] Striepe S., Powell R., Desai P., Queen E., Way D., Prince J., Cianciolo A., Davis J., Litton D., Maddock R., Shidner J., Winski R., O’Keefe S., Bowes A., Aguirre J., Garrison C., Hoffman J., Olds A., Dutta S., Zumwalt C., White J., Brauer G., Marsh S., Lugo R., Green J., Williams R. and Engel M. C., Program To Optimize Simulated Trajectories (POST II), Version 4.3.0 r2321, 2020. Google Scholar[34] Korzun A., Murphy K. and Edquist K., “Supersonic Aerodynamic Characteristics of Blunt Body Trim Tab Configurations,” AIAA Applied Aerodynamics Conference, AIAA Paper  2013-2809, 2013. https://doi.org/10.2514/6.2013-2809 Google Scholar[35] Desai P. N., Schoenenberger M. and Cheatwood F. M., “Mars Exploration Rover Six-Degree-of-Freedom Entry Trajectory Analysis,” Journal of Spacecraft and Rockets, Vol. 43, No. 5, 2006, pp. 1019–1025. https://doi.org/10.2514/1.6008 LinkGoogle Scholar[36] Desai P. N., Qualls G. D. and Schoenenberger M., “Reconstruction of the Genesis Entry,” Journal of Spacecraft and Rockets, Vol. 45, No. 1, 2008, pp. 33–38. https://doi.org/10.2514/1.30042 LinkGoogle Scholar[37] Way D. W., Davis D. J. and Shidner J. D., “Assessment of the Mars Science Laboratory Entry, Descent, and Landing Simulation,” AAS/AIAA Space Flight Mechanics Conference, AAS Paper  13-420, 2013. Google Scholar[38] Bowes A., Davis J. D., Dutta S., Striepe S., Ivanov M., Powell R. and White J. P., “LDSD POST2 Simulation and SFDT-1 Pre-Flight Launch Operations Analyses,” AAS/AIAA Space Flight Mechanics Conference, AAS Paper  15-232, 2015. Google Scholar[39] White J. P., Bowes A., Dutta S., Ivanov M. and Queen E., “LDSD POST2 Modeling Enhancements in Support of SFDT-2 Flight Operations,” AAS/AIAA Space Flight Mechanics Conference, AAS Paper  16-221, 2016. Google Scholar[40] Dutta S., Karlgaard C., Tynis J., O’Farrell C., Sonneveldt B., Queen E., Bowes A., Leyleck E. and Ivanov M., “Advanced Supersonic Parachute Inflation Research Experiment Preflight Trajectory Modeling and Postflight Reconstruction,” Journal of Spacecraft and Rockets, Vol. 57, No. 6, 2020, pp. 1387–1407. https://doi.org/10.2514/1.A34706 LinkGoogle Scholar[41] Lugo R., Shidner J., Powell R., Marsh S., Hoffman J., Litton D. K. and Schmitt T., “Launch Vehicle Ascent Trajectory Simulation Using the Program to Optimize Simulated Trajectories II (POST2),” Astronautical Sciences Spaceflight Mechanics 2017 Conference, AAS Paper  17-274, 2017. Google Scholar[42] Leslie F. and Justus C., “The NASA Marshall Space Flight Center Earth Global Reference Atmosphere Model—2010 Version,”  NASA  TM-2011-216467, 2011. Google Scholar[43] Cruz J. and Green J. S., “Subsonic Dynamic Testing of a Subscale ADEPT Entry Vehicle,” AIAA Aviation 2019, AIAA Atmospheric Flight Mechanics Conference, AIAA Paper  2019-2898, 2019. https://doi.org/10.2514/6.2019-2898 Google Scholar[44] Dutta S., Bowes A., Cianciolo A. D., Glass C. and Powell R., “Guidance Scheme for Modulation of Drag Devices to Enable Return from Low Earth De-Orbit,” AIAA Atmospheric Flight Mechanics Conference, AIAA Paper  2017-0467, 2017. https://doi.org/10.2514/6.2017-0467 Google Scholar[45] “White Sands Missile Range, New Mexico: Range Reference Atmosphere, 0-70 km Altitude,”  Range Commanders Council, White Sands Missile Range  TR Document 365-83, 1983. Google Scholar[46] Cockrell J., “Affordable Vehicle Avionics (AVA),” 2016, https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/20160008701.pdf. Google Scholar[47] NGIMU User Manual 1.3, XI-O, 1st ed., x-io Technologies Ltd., Bristol, U.K., 2017, http://x-io.co.uk/downloads/NGIMU-User-Manual-v1.3.pdf. Google Scholar[48] H3 IMU Product Specification & User’s Guide PSD 1001 Rev B, Memsense, Rapid City, SD, 2010. Product Number MP00037. Google Scholar[49] Karlgaard C., Blanchard R., Kirsch M., Tartabini P. and Toniolo M., “Hyper-X Post-Flight Trajectory Reconstruction,” Journal of Spacecraft and Rockets, Vol. 43, No. 1, 2006, pp. 105–115. https://doi.org/10.2514/1.12733 LinkGoogle Scholar[50] Wagner W. and Serold A., “Formulation on Statistical Trajectory Estimation Programs,”  NASA  CR 1482, 1970, http://en.scientificcommons.org/42645943. Google Scholar[51] O’Farrell C., Karlgaard C., Tynis J. and Clark I., “Overview and Reconstruction of the ASPIRE Project’s SR01 Supersonic Parachute Test,” IEEE Aerospace Conference, IEEE, New York, 2018, pp. 1–18. https://doi.org/10.1109/AERO.2018.8396502 Google Scholar[52] “MERRA-2 instU_3d_asm_Np: 3d, diurnal, Instantaneous, Pressure-Level, Assimilation, Assimilated Meteorological Fields V5.12.4,” Global Modeling and Assimilation Office (GMAO)  TR 5.12.4, Greenbelt, MD, 2015. https://doi.org/10.5067/6EGRBNEBMIYS Google Scholar[53] Gelaro R., McCarty W., Suarez M. J., Todling R., Molod A., Takacs L., Randles C. A., Darmenov A., Bosilovich M. G., Reichle R., Wargan K., Coy L., Cullather R., Draper C., Akella S., Buchard V., Conaty A., da Silva A. M., Gu W., Kim G.-K., Koster R., Lucchesi R., Merkova D., Nielsen J. E., Partyka G., Pawson S., Putman W., Rienecker M., Schubert S. D., Sienkiewicz M. and Zhao B., “The Modern-Era Retrospective Analysis for Research and Applications, Version 2 (MERRA-2),” Journal of Climate, Vol. 30, No. 14, 2017, pp. 5419–5454. https://doi.org/10.1175/JCLI-D-16-0758.1 CrossrefGoogle Scholar[54] Randel W., Chanin M.-L. and Michaut C., “Information about the SPARC (Stratosphere-Troposphere Processes and their Role in Climate) Rocket Data Set (Including the White Sands Rockets),”  WMO/ICSU/IOC World Climate Research Programme TR, 2002. Google Scholar[55] Fujiwara M., Wright J. S., Manney G. L., Gray L. J., Anstey J., Birner T., Davis S., Gerber E. P., Harvey V. L., Hegglin M. I., Homeyer C. R., Knox J., Kruger K., Lambert A., Long C. S., Martineau P., Molod A., Monge-Sanz B. M., Santee M. L., Tegtmeier S., Chabrillat S., Tan D. G. H., Jackson D. R., Polavarapu S., Compo G. P., Dragani R., Ebisuzaki W., Harada Y., Kobayashi C., McCarty W., Onogi K., Pawson S., Simmons A., Wargan K., Whitaker J. S. and Zou C.-Z., “Introduction to the SPARC Reanalysis Intercomparison Project (S-RIP) and Overview of the Reanalysis Systems,” Atmospheric Chemistry and Physics, Vol. 17, No. 2, 2017, pp. 1417–1452. https://doi.org/10.5194/acp-17-1417-2017 CrossrefGoogle Scholar[56] “U.S. Standard Atmosphere, 1976,”  NASA  TM-X-74335,  NOAA-S/T-76-1562, 1976. Google Scholar[57] Morelli E. A. and Klein V., Aircraft System Identification: Theory and Practice, 2nd ed., AIAA Education Series, Sunflyte Enterprises, Williamsburg, VA, 2016, pp. 273–278. Google Scholar[58] Schoenenberger M., Norman J. W. V., Karlgaard C. D., Kutty P. and Way D. W., “Assessment of the Reconstructed Aerodynamics of the Mars Science Laboratory Entry Vehicle,” Journal of Spacecraft and Rockets, Vol. 51, No. 4, 2014, pp. 1076–1093. https://doi.org/10.2514/1.A32794 LinkGoogle Scholar[59] Dutta S., Bowes A., Striepe S., Davis J. D., Blood E. M. and Ivanov M., “Supersonic Flight Dynamics Test 1—Post-flight Assessment of Simulation Performance,” AAS/AIAA Space Flight Mechanics Conference, AAS Paper  15-219, 2015. Google Scholar[60] Dutta S., Bowes A., White J., Striepe S., Queen E., O’Farrell C. and Ivanov M., “Post-Flight Assessment of Low Density Supersonic Decelator Flight Dynamics Test 2 Simulation,” AAS/AIAA Space Flight Mechanics Conference, AAS Paper  16-222, 2016. Google Scholar[61] Spencer D., Blanchard R., Braun R., Kallemeyn P. and Thurman S., “Mars Pathfinder Entry, Descent, and Landing Reconstruction,” Journal of Spacecraft and Rockets, Vol. 36, No. 3, 1999, pp. 348–356. https://doi.org/10.2514/2.3478 LinkGoogle Scholar[62] Stern E., Gidzak V. and Candler G., “Estimation of Dynamic Stability Coefficients for Aerodynamic Decelerators Using CFD,” AIAA Apllied Aerodynamics Conference, AIAA Paper  2012-3225, 2012. https://doi.org/10.2514/6.2012-3225 Google Scholar[63] Stern E., Schwing A., Brock J. and Schoenenberger M., “Dynamic CFD Simulations of the MEADS II Ballistic Range Test Model,” AIAA Atmospheric Flight Mechanics Conference, AIAA Paper  2016-3243, 2016. https://doi.org/10.2514/6.2016-3243 Google Scholar[64] Brock J., Stern E. and Wilder M., “Computational Fluid Dynamics Simulations of Supersonic Inflatable Aerodynamic Decelerator Ballistic Range Tests,” Journal of Spacecraft and Rocekts, Vol. 56, No. 2, 2019, pp. 526–535. https://doi.org/10.2514/1.A34208 LinkGoogle Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "InSight Aerothermal Environment Assessment",
        "url": "https://arc.aiaa.org/doi/10.2514/1.A35078",
        "date": "20210923",
        "content": "AbstractThe Mars Interior Exploration using Seismic Investigations, Geodesy and Heat Transport (InSight) spacecraft, which successfully touched down on the planet surface on November 26, 2018, was proposed as a near build-to-print copy of the Mars Phoenix vehicle to reduce the overall cost and risk of the mission. Because the lander payload and the atmospheric entry trajectory were similar enough to those of the Phoenix mission, it was expected that the Phoenix thermal protection material thickness would be sufficient to withstand the entry heat load. However, allowances were made for increasing the heatshield thickness because the planned spacecraft arrival date coincided with the Mars dust storm season. The aftbody thermal protection system components were not expected to change. In a first for a U.S. Mars mission, the aerothermal environments for InSight included estimates of radiative heat flux to the aftbody from the wake. The combined convective and radiative heat fluxes were used to determine if the as-flown Phoenix thermal protection system design would be sufficient for InSight. Although the radiative heat fluxes on the aftbody were predicted to be comparable to, or even higher than the local convective heat fluxes, all analyses of the aftbody thermal protection system showed that the design would still be adequate. Aerothermal environments were computed for the vehicle from postflight reconstruction of the atmosphere and trajectory and compared with the design environments. These comparisons showed that the predicted as-flown conditions were less severe than the design conditions.I. IntroductionThe Interior Exploration using Seismic Investigations, Geodesy and Heat Transport (InSight) mission is a robotic lander designed to study the deep interior of the planet Mars. The primary instruments are intended to measure the seismic activities of Mars along with temperature distribution up to 6 m in depth. To reduce overall cost and risk of the mission, the InSight entry vehicle was designed to be a near build-to-print of the Phoenix entry vehicle, including the thermal protection system (TPS). Therefore, the baseline TPS design for the InSight entry vehicle included the same TPS materials and thicknesses as Phoenix. The aerothermal analysis of the InSight spacecraft was targeted to determine if the designed TPS thicknesses were sufficient to survive the InSight entry environments. Allowances were made for an increase in thickness for the TPS for the forebody due to a scheduled entry during the traditional dust storm season on Mars. Dust in the atmosphere was not expected to influence the convective heating on the aftbody other than the effects of slight increases in the density. Unlike Phoenix and all previous U.S. Mars missions, this InSight mission included the radiative component of the heat flux on the spacecraft. All previous U.S. Mars missions neglected the contribution of radiation to the total heating because it was believed to be negligible. At the time of InSight’s project Critical Design Review (CDR), the InSight Aerothermal Working Group (AWG) began a radiation analysis effort based on recent theoretical analyses [1], simulations [2–6], experiments [7], and flight data [8] indicating that heating from midwave infrared CO2 radiation would be significant, primarily on the aftbody components. This new approach influenced the prevailing TPS margin policy [9] by adding new uncertainties to the radiative heating [10]. All analyses showed that the design TPS thicknesses on the aftbody components had positive margins for the mission.Immediately after the entry, descent, and landing of the InSight components on Mars on November 26, 2018, reconstruction of the entry began. Once the best estimated trajectory (BET) was determined [11–13], aerothermal analyses on that BET showed that the predicted as-flown conditions were more benign than the design conditions.II. Aerothermal Design AnalysisThe InSight geometry was a 70° sphere-cone forebody, and the aftbody consisted of a conical backshell and parachute cone, along with a parachute lid. The entry vehicle and TPS materials are illustrated in Fig. 1.Design trajectories were determined from Monte Carlo simulations about the target trajectory. The trajectory designers provided the computational fluid dynamics (CFD) analysts with synthetic trajectories that were created to bound the 99th percentile of the ranges seen in the simulations. These bounding entries consisted of the trajectory that subjected the vehicle to the maximum heat rate (MHR) and the trajectory along which the vehicle would sustain the maximum total heat load (MHL). Analysts used the MHR trajectory to evaluate the survivability of the TPS materials and the MHL trajectory to determine the thickness of the TPS to keep the bond line temperatures below design allowables.Fig. 1 InSight spacecraft geometry.A. Convective HeatingAerothermal convective heating calculations were performed at Lockheed Martin, using the LAURA code [14], and at NASA Ames Research Center, using the DPLR code [15]. Both codes are capable of calculating both 2-D/axisymmetric and full 3-D simulations. DPLR and LAURA are viewed as NASA’s workhorse flow solvers, and they have been extensively used to predict the aerothermal environments of planetary vehicles [16–21].The Langley Aerothermodynamic Upwind Relaxation Algorithm (LAURA) is a high-fidelity, structured grid flow solver, specialized for hypersonic reentry physics, using state-of-the-art algorithms for CFD simulations [14,22]. Key elements of LAURA include Roe’s averaging [23] and Yee’s Symmetric Total Variation Diminishing (STVD) [24] formulation of second-order, inviscid flux. Its nonequilibrium real-gas Navier–Stokes flow calculations are parallelized.The Data Parallel Line Relaxation (DPLR) code uses a finite-volume discretization to solve the reacting Navier–Stokes equations for fluids in thermochemical nonequilibrium on structured grids. It is also parallelized for effcient computing on large clusters. Although the software was originally designed for steady-state aerothermodynamic analysis of planetary entry vehicles, DPLR has evolved over the years to include a broad spectrum of numerical and physical models that enable it to accurately simulate most compressible flows. Additional details on DPLR’s capabilities can be found in the references [15,25,26].Both LAURA and DPLR were run with the Martian atmosphere modeled using a Mitcheltree 8-species (CO2, CO, N2, O2, NO, C, N, O), 12-reaction model over a supercatalytic wall in radiative equilibrium. The InSight design trajectory was ballistic; although based on Phoenix trajectory reconstruction, some excursion from zero angle of attack was expected. Although most of the aerothermal analyses were axisymmetric/2-D, i.e., no angle of attack, additional 3-D runs were performed with a 10° angle of attack to assess the possible onset of turbulent flow on the heatshield.Mars Science Laboratory (MSL) flight reconstruction [27] was used to determine updated, less conservative criteria for turbulent transition on the InSight heatshield. Based on the MSL data, InSight analysts used a momentum thickness Reynolds number criterion of Reθ=400 for smooth wall transition onset and a roughness height Reynolds number criterion of Rekk=200 for rough wall transition onset. Analysts determined an equivalent-sand-grain roughness [28] k by measuring the actual roughnesses on multiple SLA-561 V arcjet test models and found that a value of 0.6 mm bounded all data on models tested in heat fluxes below 100  W/cm2. Fully margined predicted heat fluxes on the InSight heatshield were substantially lower than 100  W/cm2. Figure 2 shows the calculated values for Reθ and Rekk distributions along the InSight heatshield at various times in the trajectory flying at a 10° angle of attack, including the peak heat flux time (PH) and the peak dynamic pressure times (PP). As seen in the figures, the values were substantially below the Reθ=400 and Rekk=200 criteria. Therefore, analyses on the heatshield were performed with laminar flow.The unmargined convective heating distributions calculated by both LAURA and DPLR are shown in Fig. 3. The earliest and latest times were only run with LAURA in order to facilitate better curve fits for boundary conditions for TPS sizing. Although LAURA and DPLR predict nearly identical results on the heatshield, there are some differences on the aftbody. Mid-lower backshell peak fluxes occurred inside regions of flow recirculation with complex structure, where LAURA and DPLR solutions vary. The peaks were found at interfaces between “lobes.” To be conservative when determining the TPS thickness requirements on the backshell, the analyses between the two codes were compared, and the maximum values at each time were used to develop boundary conditions for thermal sizing analyses.Fig. 2 Calculated Reθ and Rekk for the InSight heatshield at various times along the trajectory.Fig. 3 Unmargined convective heat flux distribution on InSight at various times along the trajectory, LAURA (left) compared with DPLR (right).B. Radiative HeatingEarly radiation analyses were performed by both LAURA/HARA and DPLR/NEQAIR. The High-temperature Aerothermodynamic RAdiation (HARA) model that was applied is discussed in detail by Johnston et al. [29,30]. A line-by-line approach is used for atoms and optically thick molecules, whereas a smeared band model is used for optically thin molecules. HARA’s modeling is based on a set of atomic levels and lines from the National Institute of Standards and Technology (NIST) [31] and Opacity Project databases [32]. The atomic bound-free model is composed of cross sections from the Opacity project’s online TOPbase [33], which were curve fit by Johnston [29]. HARA uses tangent-slab (1-D assumption) as the default option for calculating the wall-directed radiative heat flux, with an option for running full angular integration for appropriate cases using a process known as ray tracing. Non-EQuilibrium AIR (NEQAIR) is a line-by-line radiation code that computes spontaneous emission, absorption, and stimulated emission due to transitions between various energy states of chemical species along a line of sight. Twenty-two individual electronic transitions are considered for atoms and molecules, with the molecular band systems being resolved for each rotational line. Since the report of Whiting et al. [34], numerous updates have been incorporated into NEQAIR, including using the latest version of the NIST atomic database (version 5.0) [35], using the bound-free cross sections from TOPbase [33], incorporating the CO2 database from CDSD-4000 [1], parallelization, and improvements to the mechanics of quantum spectroscopy (QSS). The version of NEQAIR used preflight was v14.0.24. As with HARA, NEQAIR uses the tangent-slab approximation as the default option for radiation transport. For aftbody points, ancillary utilities enable NEQAIR to perform full hemispherical integration calculations of radiative heat flux comparable to HARA’s ray tracing.Early results showed significant differences between the solutions sets, due to inadequate resolution in the spectral grid in HARA that was later corrected [10]. For that reason, the DPLR/NEQAIR results formed the baseline solution for preflight, although sensitivity studies from LAURA/HARA and direct LAURA-DPLR and NEQAIR-HARA comparisons were also made.For most of the preflight InSight calculations, NEQAIR was run in tangent-slab mode on axisymmetric flow solutions, as the traditional practice for radiation analysis in this work. Because of the complexities of the flow found in the wake of a vehicle, and the more complicated geometries on the aftbody, using a tangent-slab approximation is questionable for aftbody radiative heating calculations [6]. For more accurate estimation of radiative heat flux on the aftbody, full angular integrations are required. Full angular integration is achieved by performing a numerical integration of radiance at a body point with respect to solid angle over all possible lines of sight to/from the body point. Although this approach has since been automated for both HARA and NEQAIR, preflight radiative conditions were evaluated with HARA ray tracing at few times and compared with the tangent-slab results. From these comparisons, conservative knock down factors for tangent slab values were developed for the various regions of the aftbody. Figure 4 shows the ratios of the ray tracing to the tangent-slab results over the entire body at the time of peak radiative heating on the parachute lid (left) and the time varying ratio on the parachute lid (right). Conservative, constant over time, knock down factors were determined, with the analysts using 1.0 (no reduction) for the mid-lower backshell location, 0.75 for the main seal and parachute cone location, and 0.41 for the center of the parachute lid.Fig. 4 Ratios of HARA ray tracing to tangent-slab radiation calculations.C. Combined Aeroheating ResultsOnce the convective and radiative heating contributions were determined, they were combined to evaluate the effect of the radiative component on the total heating. For the heatshield stagnation point, Fig. 5 shows that the contribution of radiant heating was small and that convective heating dominated the total heating.Figures 6a–6d show the predicted convective and radiative heating for the main seal, mid-lower backshell, the parachute cone, and the center of the parachute lid locations, respectively. Each of these locations was critical to determining the TPS thickness requirements. On the aftbody, several of the locations show the radiative heating to be at a similar magnitude to the convective heating. These results indicate that the previous approach to TPS design for Mars [9], neglecting radiative heating from the wake, could result in nonconservative designs for aftbody TPS. This should be further verified when the Mars 2020 spacecraft enters the Mars atmosphere in February 2021 with aftbody total heat flux and radiometer measurements from the MEDLI2 set of 6 instruments [36].Fig. 5 Preflight predictions of the heatshield stagnation point heating.Once the modeling uncertainties and margins (not discussed in this paper) were added to the design heating profiles, TPS thickness analyses were performed. The Phoenix aftbody TPS designs were found to be adequate for the InSight mission. The InSight heatshield TPS thickness was nevertheless augmented by about 25% for flight through a dusty atmosphere (also not discussed in this paper).Fig. 6 Heating predictions for various locations on the InSight aftbody.III. Reconstructed Aerothermal EnvironmentsThe InSight mission launched from Vandenberg AFB on May 5, 2018, and entered the atmosphere of Mars on November 26, 2018. Extensive data analyses were performed from all available instrumentation to reconstruct the best-estimated trajectory (BET) of the spacecraft. It should be noted that InSight did not have any aerothermal instrumentation (e.g., pressure sensors, heat flux gages, thermocouples), so aerothermal reconstruction predictions were based solely on the BET. Using the BET, both DPLR and LAURA analyzed the convective heating on the vehicle with no angle of attack. As with preflight comparisons, both codes agreed within 1% on the forebody and had the expected differences on the aftbody. The LAURA code was run in 3-D to evaluate the conditions at angle of attack at the peak heating and peak pressure times. Boundary-layer properties at angle of attack agreed with design analyses where the flow over the forebody remained laminar for the flight.The BET-reconstructed peak convective heating along the body for the InSight entry was predicted to be very similar to the MHL nominal values, as shown in Fig. 7 (red curves). The convective heating distribution at the peak dynamic pressure (Fig. 7, royal blue curves) was lower for the BET than the MHL design due to a faster entry duration.The NEQAIR and HARA codes were used to analyze the radiative heating on the aftbody using full hemispherical integration, instead of the tangent slab analyses with knockdown factors used for preflight predictions. The codes agreed within 5% on most aftbody points of interest.Fig. 7 Comparison of predicted convective heating profiles using the BET (left) and the MHL design trajectory (right).The aerothermal heating predictions for select locations for the BET are shown in Figs. 8 and 9.Reconstruction has shown that the BET flew for a shorter time than the design environment as evident when comparing the stagnation point heating histories, shown in Fig. 10. The times for the MHL were adjusted such that the peak heating times coincide. Although the predicted peak heat fluxes for the BET were similar to those for the MHL design, the predicted total heat loads on the vehicle were considerably less. Total heat load tends to drive the TPS thickness requirements. Therefore, the as-built TPS thicknesses were demonstrably conservative for the InSight as-flown trajectory.Fig. 8 Reconstructed stagnation point heating predictions for the BET.Fig. 9 Reconstructed heating predictions of the main seal (left) and parachute lid (right) for the BET.Fig. 10 Comparison of predicted BET and MHL stagnation point heating histories.IV. ConclusionsThe InSight mission was the first U.S. mission to Mars to consider the radiative heating component on the backshell TPS. Although the preflight aerothermal analyses showed that the radiative heating on the heatshield was predicted to be extremely small, the analyses also showed that the radiative heating was predicted to be comparable to, and sometimes greater than, the convective heating for several aftbody locations. This should be further verified with aftbody total heat flux and radiometer measurements from the MEDLI2. As NASA proceeds with future Mars missions, the aftbody radiation will no longer be neglected when designing the TPS for the spacecraft.R. M. CummingsAssociate EditorAcknowledgmentsThe authors would like to acknowledge the NASA Space Technology Mission Directorate for sponsoring the InSight postflight reconstruction efforts. The work of C. Szalai was carried out at the Jet Propulsion Laboratory, California Institute of Technology, under a contract with NASA (80NM0018D0004).\r            References\r        [1] Tashkun S. and Perevalov V., “CDSD-4000: High-Resolution, High-Temperature Carbon Dioxide Spectroscopic Data-Bank,” Journal of Quantitative Spectroscopy and Radiative Transfer, Vol. 112, No. 9, 2011, pp. 1403–1410. https://doi.org/10.1016/j.jqsrt.2011.03.005 CrossrefGoogle Scholar[2] Babou Y., Riviere P., Perrin M.-Y. and Soufiani A., “Spectroscopic Data for the Prediction of Radiative Transfer in CO2–N2 Plasmas,” Journal of Quantitative Spectroscopy and Radiative Transfer, Vol. 110, Nos. 1–2, 2009, pp. 89–108. https://doi.org/10.1016/j.jqsrt.2007.08.026 CrossrefGoogle Scholar[3] da Silva M. L. and Beck J., “Contribution of CO2 IR Radiation to Martian Entries Radiative Wall Fluxes,” 49th AIAA Aerospace Sciences Meeting and Exhibition, AIAA Paper  2011-135, 2011. https://doi.org/10.2514/6.2011-135 LinkGoogle Scholar[4] LeBrun A. and Omaly P., “Investigation of Radiative Heat Fluxes for EXOMARS Entry in the Martian Atmosphere,” 4th International Workshop on Radiation of High Temperature Gases in Atmospheric Entry, 2010. Google Scholar[5] Palmer G. and Cruden B., “Experimental Validation of CO2 Radiation Simulations,” 43rd AIAA Thermophysics Conference, AIAA Paper  2012-3188, 2012. https://doi.org/10.2514/6.2012-3188 LinkGoogle Scholar[6] Mazaheri A., Johnston C. and Sefidbakht S., “Three-Dimensional Radiation Ray Tracing for Shock-Layer Radiative Heating Simulations,” Journal of Spacecraft and Rockets, Vol. 50, No. 3, 2013, pp. 485–493. https://doi.org/10.2514/1.a32448 LinkGoogle Scholar[7] Cruden B., Prabhu D. and Brandis A., “Measurement and Characterization of Mid-Wave Infrared Radiation CO2 Shocks,” 11th AIAA/ASME Joint Thermophysics and Heat Transfer Conference, AIAA Paper  2014-2962, 2014. https://doi.org/10.2514/6.2014-2962 LinkGoogle Scholar[8] Cruden B., Brandis A., White T., Mahzari M. and Bose D., “Radiative Heating During Mars Science Laboratory Entry: Simulatio, Ground Test, and Flight,” Journal of Thermophysics and Heat Transfer, Vol. 30, No 3, 2016, pp 642–650. https://doi.org/10.2514/1.t4798 LinkGoogle Scholar[9] Cozmuta I., Wright M., Laub B., Chen Y.-K. and Willcoxson W., “Defining Ablative Thermal Protection System Margins for Planetary Entry Vehicles,” 42nd AIAA Thermophysics Conference, AIAA Paper  2011-3757, 2011. https://doi.org/10.2514/6.2011-3757 Google Scholar[10] Brandis A., Saunders D., Johnston C., Cruden B. and White T., “Radiative Heating on the Aftbody of Martian Entry Vehicles,” 45st AIAA Thermophysics Conference, AIAA Paper  2015-3111, 2015. https://doi.org/10.2514/6.2015-3111 LinkGoogle Scholar[11] Maddock R., Dwyer-Cianciolo A., Karlgaard C., Korzun A., Litton D. and Zumwalt C., “InSight Entry, Descent, and Landing Post-Flight Performance Assessment,” AIAA SciTech Forum, AIAA Paper  2020-1270, 2020. https://doi.org/10.2514/6.2020-1270 LinkGoogle Scholar[12] Karlgaard C., Korzon A., Schoenenberger M., Bbonfiglio E., Kass D. and Grover M., “Mars InSight Entry, Descent, and Landing Trajectory and Atmosphere Reconstruction,” AIAA SciTech Forum, AIAA Paper  2020-1271, 2020. https://doi.org/10.2514/6.2020-1271 LinkGoogle Scholar[13] Korzun A., Maddock R., Schoenenberger M., Edquist K., Zumwalt C. and Karlgaard C., “Aerodynamic Performance of the 2018 InSight Mars Lander,” AIAA SciTech Forum, AIAA Paper  2020-1272, 2020. https://doi.org/10.2514/6.2020-1272 LinkGoogle Scholar[14] Mazaheri A., Gnoffo P., Johnston C. and Kleb B., “LAURA Users Manual,”  NASA  TM 2010-216836, 2010. Google Scholar[15] Wright M., Candler G. and Bose D., “Data-Parallel Line Relaxation Method for the Navier-Stokes Equations,” AIAA Journal, Vol. 36, No. 9, 1998, pp. 1603–1609. https://doi.org/10.2514/3.14012 LinkGoogle Scholar[16] Edquist K. T., Dyakonov A. A., Wright M. J. and Tang C. Y., “Aerothermodynamic Environments Definition for the Mars Science Laboratory Entry Capsule,” 45th AIAA Aerospace Sciences Meeting and Exhibit, AIAA Paper  2007-1206, 2007. https://doi.org/10.2514/6.2007-1206 LinkGoogle Scholar[17] Wright M. J., Prabhu D. K. and Martinez E. R., “Analysis of Afterbody Heating Rates on the Apollo Command Module, Part 1: AS-202,” AIAA Thermophysics Conference, AIAA Paper  2004-2456, June 2004. https://doi.org/10.2514/6.2004-2456 LinkGoogle Scholar[18] Wright M. J., Loomis M. A. and Papadopoulos P. E., “Aerothermal Analysis of the Project Fire II Afterbody Flow,” Journal of Thermophysics and Heat Transfer, Vol. 17, No. 2, 2003, pp. 240–249. https://doi.org/10.2514/2.6757 LinkGoogle Scholar[19] Papadopoulos P., Prabhu D., Olynick D., Chen Y. K. and Cheatwood F. M., “CFD Code Comparisons for Mars Entry Simulations,” AIAA Aerospace Sciences Meeting and Exhibit, AIAA Paper  1998-0272, Jan. 1998. https://doi.org/10.2514/6.1998-272 LinkGoogle Scholar[20] Queen E. M., Cheatwood F. M., Powell R. W., Braun R. D. and Edquist C. T., “Mars Polar Lander Aerothermodynamic and Entry Dispersion Analysis,” Journal of Spacecraft and Rockets, Vol. 36, No. 3, May–June 1999. https://doi.org/10.2514/2.3462 LinkGoogle Scholar[21] Gnoffo P. A., Weilmuenster K. J., Braun R. D. and Cruz C. I., “Influence of Sonic-Line Location on Mars Pathfinder Probe Aerothermodynamics,” Journal of Spacecraft and Rockets, Vol. 33, No. 2, March–April 1996. https://doi.org/10.2514/3.26737 LinkGoogle Scholar[22] Gnoffo P., Gupta R. and Shinn J., “Conservation Equations and Physical Models for Hypersonic Air Flows in Thermal and Chemical Nonequilibrium,”  NASA  TP-2867, 1989. Google Scholar[23] Roe P., “Approximate Riemann Solvers, Parameter Vectors, and Difference Schemes,” Journal of Computational Physics, Vol. 43, No. 2, 1981, pp. 357–372. https://doi.org/10.1016/0021-9991(81)90128-5 CrossrefGoogle Scholar[24] Yee H. C., “A Class of High-Resolution Explicit and Implicit Shock Capturing Methods,”  NASA  TM 101088, Feb. 1989. Google Scholar[25] Wright M., “A Family of Data-Parallel Relaxation Methods for the Navier-Stokes Equations,” Ph.D. Thesis,  Univ. of Minnesota, Minneapolis, MN, 1997. Google Scholar[26] Wright M., White T. and Mangini N., “Data-Parallel Line Relaxation (DPLR) Code User Manual Acadia-Version 4.01.1,”  NASA  TM-2009-215388, Oct. 2009. Google Scholar[27] White T., Mahzari M., Bose D. and Santos J., “Post-Flight Analysis of the Mars Science Laboratory Thermal Protection System Response,” 44th AIAA Thermophysics Conference, AIAA Paper  2013-2779, June 2013. https://doi.org/10.2514/6.2013-2779 LinkGoogle Scholar[28] Kandlikar S. G., Schmitt D., Carrano A. L. and Taylor J. B., “Characterization of Surface Roughness Effects on Pressure Drop in Single-Phase Flow in Minichannels,” Physics of Fluids, Vol. 17, 2005. https://doi.org/10.1063/1.1896985 CrossrefGoogle Scholar[29] Johnston C., Hollis B. and Sutton K., “Spectrum Modeling for Air Shock-Layer Radiation at Lunar-Return Conditions,” Journal of Spacecraft and Rockets, Vol. 45, No. 5, 2008, pp. 865–878. https://doi.org/10.2514/1.33004 LinkGoogle Scholar[30] Johnston C. O., Hollis B. and Sutton K., “Non-Boltzmann Modeling for Air Shock Layers at Lunar Return Conditions,” Journal of Spacecraft and Rockets, Vol. 45, No. 5, Sept.–Oct. 2008, pp. 879–890. https://doi.org/10.2514/1.33006 LinkGoogle Scholar[31] Ralchenko Y., “NIST Atomic Spectra Database, Version 3.1.0,” July 2006, https://www.nist.gov/pml/atomic-spectra-database [retrieved 3 Sept. 2007]. Google Scholar[32] The Opacity Project Team, The Opacity Project, Vol. 1, Inst. of Physics Publishing, Bristol, England, U.K., 1995. https://doi.org/10.1063/1.47073 Google Scholar[33] Cunto W., Mendoza C., Ochsenbein F. and Zeippen C., “TOPbase at the CDS,” Astronomy and Astrophysics, Vol. 275, Aug. 1993, pp. L5–L8, http://cdsweb.u-strasbg.fr/topbase/topbase.html. Google Scholar[34] Whiting E., Park C., Yen L., Arnold J. and Paterson J., “NEQAIR96, Nonequilibrium and Equilibrium Radiative Transport and Spectra Program: User’s Manual,”  NASA  RP-1389, 1996. Google Scholar[35] Kramida A., Ralchenko Y., Reader J. and Team N. A., “NIST Atomic Spectra Database, Version 5.0.0,” July 2012, https://www.physics.nist.gov/asd/ [retrieved July 2012]. Google Scholar[36] Hwang H., Bose D., Wright H., White T., Schoenenberger M., Santos J., Karlgaard C., Oishi T. and Trombetta D., “Mars 2020 Entry, Descent, and Landing Instrumentation (MEDLI2),” 46th AIAA Thermophysics Conference, AIAA Paper  2016-3536, June 2016. https://doi.org/10.2514/6.2016-3536 LinkGoogle Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Conceptual Study on Low-Melting-Point Thermoplastic Fuel/Nitrous Oxide Hybrid Rockoon",
        "url": "https://arc.aiaa.org/doi/10.2514/1.A35040",
        "date": "20210906",
        "content": "AbstractA hybrid rockoon, which is a hybrid rocket launched from a high-altitude balloon, is proposed. The rocket system configuration was studied for single-stage or multiple-stage rockets, and the performance and range safety requirements were considered. The propellants of the hybrid-rocket motor are a low-melting-point thermoplastic fuel and nitrous oxide, which are beneficial, owing to their mechanical properties at cold temperatures experienced in high-altitude environments. Three-dimensional launch trajectory analyses were performed for science missions aimed at sampling cosmic dust levitating in the upper stratosphere. The apogee altitude can be significantly increased by elevating the altitude of the launch point because the problem of low thrust level of the hybrid rocket is solved by increasing the nozzle expansion ratio. Suborbital trajectories with multiple apogee points and orbital missions to extremely low Earth orbits are presented, which provide a long flight path in the upper atmosphere. The sequence of events and flight characteristics of the proposed hybrid rockoon system are discussed, and necessary technological improvements in the structure and propulsion systems are presented.NomenclatureAenozzfle exit areaCAaxial drag force coefficientCfthrust coefficientDdrag force vectorer, ep, eyroll, pitch, and yaw unit vectors, respectivelyGgravitational constantggravity of EarthIspspecific impulseIsp,vacspecific impulse in vacuumMmass of Earth with atmospheremmass of the vehiclem˙mass flow rate of the nozzlePaatmospheric pressurePccombustion pressureQmaxmaximum dynamic pressureRlocation of the vehicleScross-sectional area of the vehicleTthrustvavelocity of the atmosphere in the Earth-centered inertial systemx, y, zEarth-centered inertial coordinate systemγ, εazimuth and elevation angles of the vehicleγ0, ε0azimuth and elevation at the launcherΔVvelocity changeΔVatmosatmospheric pressure lossΔVdragdrag lossΔVgravitygravity lossΔVsteeringsteering lossφ, λlongitude and latitude at the launch pointωr, ωp, ωyroll, pitch, and yaw rates, respectivelyI. IntroductionHybrid propellant rockets have many advantages over other types of chemical rockets in safety, simplicity, and cost [1]. Liquid propellant rocket engines can achieve high propulsive performances; however, they require multiple turbopumps and complex pipes. Solid propellant rockets are simple and have been used for small rockets; however, significant cost is necessary for safe handling of hazardous propellants. Therefore, many studies have been performed on hybrid rockets composed of safe and low-cost propellants. SpaceShipTwo is launched from a mother aircraft and reached an altitude of 89.9 km, which is the highest altitude reached by hybrid rockets. In addition, the hybrid sounding rocket HEROS was launched from the ground and reached an altitude of 32.3 km [2]. However, an orbital satellite launch with a hybrid rocket has not yet been realized. This is because its low thrust-to-weight ratio due to the slow burning rate increases the gravitational loss during the ascending phase. Because the gravitational loss of the upper stage is less than that of the first stage, the hybrid-rocket upper stage is competitive with other chemical rockets [3]. Gravitational loss can be significantly reduced by an air-launch, where the vehicle can be launched at a smaller elevation angle because the atmospheric pressure is lower. The simplest air-launch method is a rockoon, in which a rocket and a launcher are lifted by a large balloon to an altitude of approximately 20 km, where the atmospheric pressure is approximately one-hundredth of that at sea level. As an air-launched rocket can be regarded as the upper stage where the first stage is a balloon, it is possible to launch without a large gravitational loss, even with a hybrid rocket.A rocket on a balloon was exposed to a high-altitude atmosphere for hours before ignition. The temperature at an altitude of 20 km is approximately –50°C, which could cause misfiring and embrittlement of solid propellants. Wada et al. [4] developed a low-melting-point thermoplastic (LT) fuel/nitrous oxide (N2O) hybrid rocket that successfully performed supersonic flight. The glass transition temperature of the LT fuel is lower than –50°C, and N2O can be stored in a liquid state at–50°C without the use of any heating or cooling device. Thus, the LT fuel/N2O hybrid propellant is suitable for balloon-launched rockets.The hybrid rockoon system is applicable not only to suborbital missions in the stratosphere and mesosphere, but also to orbital space missions. One of the missions of our rocket is to capture cosmic dust levitating in the upper atmosphere that has entered from space for planetary science research. Suborbital missions are classified into stratosphere missions that reach altitudes less than 50 km, mesosphere missions with altitudes of 50–100 km, and high-altitude missions with altitudes of 100 km or higher. The particle diameter and time since entering the atmosphere are different for each layer, and the launch vehicle is required to pass through the altitude range for as long as possible to increase the flow volume of the air that contains cosmic dust. In this paper, the concept of the LT fuel/N2O hybrid rockoon for suborbital and orbital missions is presented, and the feasibility and remaining problems to be solved are discussed.II. Rocket SystemA. PropulsionThe LT fuel/N2O hybrid-rocket motor was used for all the stages. The low melting point of the LT fuel enhances its vaporization, and this property facilitates rapid mixing with the liquid oxidizer. Thus, the burning rate is higher than that of other hybrid propellants, such as hydroxyl-terminated polybutadiene (HTPB) and polymethyl methacrylate [5]. Hydroxyl-terminated polybutadiene is used in the engine of Scaled Composites SpaceShipTwo suborbital spaceplane. Under the oxidizer mass flux of 100  kg/(m2⋅s), the regression rates of the LT fuel and HTPB are 1.6 and 0.7  mm/s, respectively [6]. This rate is similar to those of a paraffin-based fuel. Furthermore, it is soft at room temperature and exhibits hyper-elasticity, which prevents cracks even in high-altitude environments. This was shown from the master curve for the viscoelastic behavior of the LT fuel that was obtained through tensile tests at temperatures ranging from −40 to 40°C [7]. Therefore, the LT fuel is suitable for high-altitude air-launches. N2O is often used as a liquid oxidizer because its saturation pressure at ground-level air temperature is 5 MPa, which is similar to the combustion pressure in typical rocket engines. When N2O is cooled to −50°C, the saturation pressure decreases to 0.7 MPa. This is too low to be injected directly into the combustion chamber; therefore, pressurization methods using high-pressure gas or centrifugal pumps are necessary. Furthermore, the density of liquid N2O increases by 20% when it is cooled to this temperature; hence, the tank size can be reduced. The thickness of the N2O tank can be further reduced if a small electrically driven N2O pump is used. Small electric centrifugal pumps, such as those used in the Rutherford engine of the Electron rocket developed by Rocket Lab, have become feasible in recent times [8]. Another advantage of this combination of LT fuel and N2O is its safety. If a solid propellant rocket is lifted by a balloon, an accidental fall to the ground and the resulting explosion of the propellant are considered to be potential risks. Such accidents can be excluded from the risk assessment of hybrid rockets with nonexplosive propellants.The 5 kN hybrid-rocket motor shown in Fig. 1 is under development. It was designed for a single-stage vehicle that can reach an altitude of 30 km when launched from the ground. Self-pressurized N2O was injected in the liquid state through a showerhead-type injector. Table 1 presents the propulsion characteristics of the motor obtained by a ground firing test at atmospheric conditions with the LT fuel at room temperature [6]. This motor was designed to burn for a maximum of 30 s, whereas it has been demonstrated to burn for 15 s in the latest ground firing tests. Full-duration firing tests will be performed in early 2022. Because no firing test was performed at temperatures below 0°C, further investigation is necessary. The specific impulse in vacuum was calculated by considering the thrust loss due to the atmospheric pressure applied to the nozzle exit area: Isp,vac=Isp+PaAem˙g(1)Fig. 1 Hybrid-rocket test motor (5 kN).Owing to the low atmospheric pressure at high altitudes, the nozzle expansion ratio can be increased to improve the specific impulse. The propulsion characteristics for various altitudes of the 5 kN hybrid motor are presented in Table 2. The nozzle exit diameter can be increased to realize the optimum expansion ratio up to a maximum value of 260 mm, which is the diameter of the vehicle. The maximum thrust coefficient Cf at the optimum expansion ratio is obtained from Fig. 3-8 in Sutton and Biblarz [9] for a specific heat ratio of 1.3. The actual values of Cf were obtained by multiplying with the Cf efficiency, as shown in Table 1. Thus, the specific impulse in vacuum increases by 50 s when it is launched at an altitude of 20 km.B. Target Orbit and Flight SequenceThe sequence of events (SOEs) in the hybrid rockoon missions are presented in Fig. 2 and Table 3. A single-stage rocket does not perform stage separation and follows a gravity-turn trajectory throughout the flight. For a two-stage rocket, its attitude is spin stabilized and fixed after X+60 s when the dynamic pressure vanishes. In stratosphere and mesosphere missions, the second-stage ignition time was determined such that the first and second peaks of the altitude were almost the same. In the maximum-altitude mission, the second stage was ignited as soon as possible, that is, 5 s after the first-stage burnout, which consisted of 2 s for stage separation and 3 s of ignition delay to ensure the separation distance.Fig. 2 Flight sequence of rockoon.In advanced three-stage rockets, the two-stage stratosphere mission is followed by an additional third stage to deliver the payload to Earth’s orbit. No attitude control was performed before the third-stage ignition to avoid flight safety risks. Two target orbits were considered in this study: a low Earth orbit (LEO) with a perigee altitude of 200 km and an extremely low Earth orbit (ELEO) with a perigee altitude of 100 km. The ELEO has a shorter orbit lifetime than the LEO; however, it is suitable for dust sampling in the thermosphere and for science missions that are generally performed with ground-launched sounding rockets. To maximize the launch capacity, it is desirable to insert the payload at the perigee point. In other words, the vehicle should be at a perigee altitude with only a horizontal velocity at the burnout of the final stage. If no attitude control is performed before the third-stage ignition, as in the SOE used in this study, the perigee altitude of the final orbit is determined by the apogee altitude of the temporary orbit at the burnout in the first stage, which can be adjusted by the launcher elevation angle ε0. Then, the elevation ε1 at the end of the gravity-turn trajectory is obtained. The rhumb-line control angle to make the vehicle axis horizontal was initially assumed to be Δε=π−ε1. This value was optimized to make the final velocity vector horizontal. The final-stage ignition time is another important parameter that maximizes payload capacity. It was determined such that the time of the final stage burnout is the time of the maximum-altitude of the jettisoned second stage. These parameters were computed by changing the values in the trajectory analysis to satisfy the conditions. The optimization of the rhumb-line control angle and the final stage ignition time was performed using the optimization function in the MATLAB 2020a toolbox.C. Balloon LauncherThe most common methods of air-launch are dropping a rocket from an aircraft flying at an altitude of 12 km, such as the Pegasus rocket and LauncherOne by Virgin Orbit. This allows for the launch of relatively large rockets with weights over 20 t. The balloon-type launch method is not applicable for such heavy rockets. However, if the vehicle weight is sufficiently small such that it can be hung on a balloon, the reduction in velocity loss is greater than that in the aircraft-type launches because a balloon can reach a higher altitude of over 20 km. The maximum launch altitude of a rockoon is characterized by the balloon volume Vb and the total weight W, including the launcher, rocket, and balloon membrane. The gross lift of a balloon is FL=(ρair−ρgas)Vbg, where ρair and ρgas are the densities of the air and helium gas filled in the balloon, respectively. The lift and total weight balance at the launch altitude FL=Wg. Assuming a total weight W=2000 kg for the heaviest three-stage rocket, a balloon volume Vb=26,300  m3 with a diameter of 37 m is required to reach the launch altitude of 20 km. The weight of the balloon membrane was approximately 20 kg, which was significantly smaller in the rockoon structure. These dimensions become smaller for single- and two-stage rockets.Some issues must be resolved before the balloon launcher is realized. A balloon and an object hung on a balloon oscillate in two pendulum modes. These are a rigid pendulum mode, in which they rigidly rotate around a horizontal axis at their center of gravity, and a torsion pendulum mode, in which the balloon and the hanging object rotate with each other around a vertical axis on their center of gravity. The former mode is excited by a shear flow with a velocity gradient along the vertical axis during the ascending troposphere. As the velocity gradient is very low in the stratosphere, the latter mode is the main problem that causes a launch azimuth error. In a previous research project involving a telescope on a high-altitude balloon [10], the attitude of the telescope was controlled using a control moment gyro with an error angle of one arc minute. As such, precise control is not necessary for the air-launching of a rocket; a simpler attitude control system is applicable before ignition.Another issue is the attitude instability immediately after the first-stage ignition, where it takes a short but nonnegligible time to reach an adequate velocity for aerodynamic stability. The required velocity increases with the launch altitude because the air density and dynamic pressure decrease. Because the rocket was dropped in the air several seconds before ignition in previous rockoon systems, such as HIMES [11], there was a large uncertainty in the attitude after ignition. Our rockoon system comprises a rail launcher hanging on a balloon to limit attitude change. We successfully performed air-launch experiments, in which a small model rocket was launched from a launcher rail hanging on a crane 1 m above the ground. Although details about these experiments will be reported separately, it was confirmed that the uncertainty in the attitude can be lowered with the rail launcher.D. Attitude Control and Launch SafetyOwing to weight concerns, the rocket was not equipped with a recovery system. The payload and balloon-launcher system are planned to be recovered with a parachute. Furthermore, no active attitude control system was used for the launch vehicle that was spin stabilized after a wing-stabilized gravity-turn trajectory until the dynamic pressure vanishes. If the launch altitude is so high that the air density is too low for the wing stabilizer to be effective, an alternative option is to use a spin-launcher system proposed by the authors [12], in which a spin-stabilized rocket is launched after it is spun up to stabilize the attitude oscillation. The spin axis is changed only by the rhumb-line control during the interstage coasting phase. There is no room for a command destruction system onboard. Therefore, the launch safety system, which was demonstrated by the smallest orbital rocket SS-520-5, was adopted [13]. When the rocket does not follow the trajectory before the second-stage ignition, all the components of the rocket will drop inside the notified restricted area. The ignition of the upper stage is disabled by default and enabled after the rhumb-line control by a command signal sent from a ground facility, if and only if the spin rate and attitude of the spin axis are confirmed as normal. Otherwise, the upper stage is not ignited, and the rocket impacts the ground in a predetermined safety area.Spin stabilization of a hybrid rocket has not been previously demonstrated. As approximately half of the weight is a liquid propellant, the dynamic behavior of the liquid surface and circulating flow in the propellant tank could have crucial effects on the spin instability. One solution is to prevent the formation of a vapor–liquid interface in the tank by making the tank either full or empty during the coasting phase. However, anticirculation baffles are necessary in the propellant tank during the accelerating phase, and in this case, the presence of this interface is inevitable. As the liquid propellant becomes depleted, sloshing in the tank will stabilize because the acceleration, which increases toward the end of the combustion, settles the liquid surface. Although the feasibility of spin stability requires further investigation using a six-degree-of-freedom analysis, it exceeds the scope of this study.E. Structure and InertiaTable 4 shows the specifications of the single-stage and multiple-stage rockets developed by extending the 5 kN motor. The ground-launch and air-launch types of the single-stage rocket differ only in their propulsion characteristics owing to the nozzle extension. The propellant weight of each stage was determined by maximizing the total ΔV for the three-stage rocket. Our 5 kN hybrid-rocket motor is used as the first stage of a single- and two-stage rocket, and it is used as the second stage in a three-stage rocket. The three-stage rocket is an advanced configuration that requires future improvements in the specific impulse and structure mass ratio. These values were computed under the assumptions presented in Table 4, based on the nominal values of the 5 kN hybrid-rocket motor presented in Fig. 1, considering that the burning time was extended to 30 s. Each stage is composed of a single engine of different dimensions, because clustering the same rocket motor chambers decreases the stage mass ratio. The main structures of the rocket are the combustion chamber and N2O tank. They are composed of an aluminum alloy tube wrapped with a carbon-fiber-reinforced polymer composite to withstand the internal pressure. The stresses due to the acceleration and aerodynamic bending moment are smaller than those due to the internal pressure in such small rockets that can be lifted by balloons.F. AerodynamicsThe axial drag force coefficient CA has an uncertainty; therefore, it was varied from 0.25 to 0.8. The lower limit value was obtained through wind-tunnel tests for subsonic flow in the Japanese M-V rocket, which has a simple body shape, conical nose faring, and cylindrical body without a tail wing stabilizer or side boosters. A higher limit value was selected considering the wave drag in the transonic flows.III. Trajectory AnalysisTo investigate the advantage of a balloon-launched LT fuel/N2O hybrid rocket, numerical 3-D trajectory analyses of the planned rocket science missions were performed.A. Theory of Trajectory AnalysisA trajectory analysis program was built as a MATLAB/Simulink model, in which the motion equation was solved for a point mass on the Earth-centered inertial (ECI) coordinate system. It assumes the WGS84 Earth model and the U.S. standard atmosphere 1984. The attitude, thrust, and mass history are predetermined as input parameters according to the SOE, as described later.The launch-vehicle state is represented by nine variables, including three vectors with three elements: the location R=(x,y,z)T of a point mass, the roll-axis unit vector er=(rx,ry,rz)T, and the pitch-axis unit vector ep=(px,py,pz)T. The vectors er, ep are fixed on the vehicle whose rotational symmetry axis is er. The yaw axis unit vector ey is not stored as a state variable because it is immediately obtained as ey=er×ep. These attitude vectors are unit vectors and are normal to each other. Thus, the number of independent attitude variables is reduced to three, similar to the Euler angles. In this study, the spin around the roll axis was not considered, and the pitch axis was assumed to be parallel to the local horizontal plane. The pitch maneuver is predetermined or made parallel to the instantaneous airspeed vector during a zero-lift gravity turn.Let us assume that a rocket is on a launcher at longitude φ and latitude λ, then the launcher azimuth angle is γ0 and the elevation angle is ε0. While Earth rotates around the z axis of the ECI system, we select the x axis such that a point at longitude φ=0 on the equator (λ=0) is on the x axis at the time of the first-stage ignition. Then, thenitial attitude vectors on the launcher are obtained as (er,ep)=(cosφ−sinφ0sinφcosφ0001)(cosλ0−sinλ010sinλ0cosλ)(1000cosγ0sinγ00−sinγ0cosγ0)(cosε00sinε0010−sinε00cosε0)(000110)(2)where the rightmost matrix contains the original attitude vectors on the ECI system representing a rocket lying horizontally and directed to the north at the point φ=λ=0, as depicted in Fig. 3a. By multiplying the rotation matrices by the original attitude vectors from the left in this order, the attitude vectors on the launcher are obtained.Fig. 3 Definition of the coordinate system. a) Original state in the ECI system; b) attitude rate and time derivative of the unit vectors.The pitch rate ωp and yaw rate ωy are the angular velocities around each axis that rotate together with the vehicle. Their relations with the time derivative of the unit vectors er, ep are derived from Fig. 3b as e˙r=ωyep−ωpey(3)e˙p=ωrey−ωyer(4)Although the effect of the roll rate ωr is also included in Eq. (4), this term vanishes because the spin dynamics are not considered in this study. In the Simulink model, the initial vectors obtained using Eq. (2) and the time derivatives obtained using Eqs. (3) and (4) are connected to the input of an integration block to obtain the history of the attitude vectors. During a gravity-turn trajectory, the roll axis was kept parallel to the airspeed. The attitude at the end of the gravity turn was set as the initial value of the integration block.The external forces acting on the rocket are thrust, drag, and gravity. The equation of motion is mR¨=Ter+D−GMm|R|2eR(5)where T=m˙gIsp−paAe(6)D=−12ρa|R˙−va|(R˙−va)SCA(7)The second term on the right-hand side of Eq. (6) is the atmospheric pressure loss, which is applied only when the motor is burning, and eR is a unit vector of the location vector R. The direction of the drag force vector D is opposite to that of the airspeed vector, R˙−va. The lift force acting normal to the airspeed vector was not considered in this study. The velocity of air due to the rotation of Earth ωER was obtained as follows: va=x2+y2ωER(cosθ−sinθ0)=ωER(−yx0)(8)Equation (5) was solved using the Simulink model: the acceleration vector R¨ is an input to an integrator to obtain the velocity vector R˙, which in turn is an input to another integrator to obtain the location vector R. The attitude was changed according to the SOE. The thrust vector is assumed to be parallel to the roll axis. The vehicle mass was decreased when the stage was jettisoned.Velocity losses are calculated as ΔVatmos=∫paAemdt(9)ΔVdrag=∫DerR˙mdt(10)ΔVsteering=∫Tm(1−er⋅eR˙)dt(11)ΔVgravity=∫geR⋅eR˙dt(12)where eR˙ is a unit vector parallel to the velocity vector R˙. The term in each integral, except for the atmospheric pressure loss term, was input to an integrator to obtain the velocity losses during the entire calculation time. The atmospheric pressure loss was integrated only when the motors were burning.A variable time-step solver, ode23t, was used. The constancy of the calculation results was confirmed by changing the time step. The correctness of our code was confirmed by obtaining the same results under identical analysis conditions as those of Open Tsiolkovsky ver. 0.14 [14], which is an open-source program that was developed independently.The vector expression of the vehicle attitude used in this study is mathematically identical to the quaternion expression. It avoids the singularity problem existing in the Euler angle expression because the attitudes are represented by vectors, not angles. Although this representation requires more calculation time and memory resources than quaternions, it is more intuitive and easy to understand the status of the vehicle; therefore, the programming and debugging processes proceed rapidly.The rocket was launched under the conditions presented in Table 5. An adequate speed is necessary for the rocket to clear the launcher to avoid an immediate fall to the ground in the gravity-turn trajectory. The assumed velocity is common in sounding rockets.B. Single-Stage MissionThe analytical results for the vertically launched single-stage rocket are presented in Table 6. The single-stage rocket with CA=0.5 did not reach an altitude 30 km of for ground launch, whereas the altitude increased by 140 km for air-launch. The maximum dynamic pressure decreased to one-tenth that of the ground launch. The acceleration increased because of the increase in the specific impulse. Figure 4a depicts the effect of the drag coefficient on the apogee altitude. Ground launches require CA<0.3 to reach an altitude of 30 km. This value is similar to that of the Epsilon rocket, and it is difficult to realize this value for a wing-stabilized rocket. In contrast, CA has a diminished effect in air-launches where the air density is low. Therefore, efforts to reduce CA in an air-launch are not as important as those for ground launches. Figure 4b depicts the effects of the launch altitude on the apogee altitude and Qmax. A launch altitude of 11 km was sufficient for an apogee altitude of 100 km. Qmax in the ascent phase rapidly decreases for air-launches from 10 km or higher.Fig. 4 Apogee altitude of vertically launched single-stage rocket; effect of a) CA and b) launch altitude (CA=0.5).Figure 5 depicts the trajectories of a single-stage rocket for various launcher elevation angles. The duration of flight decreases with the elevation angle due to an increase in the drag loss; however, the downrange is maximized at an elevation angle of approximately 70 deg. As a long flight path is preferable for cosmic dust sampling, these elevation angles should be selected. The downrange is negative only for the vertical launch shown in Fig. 5b because Earth rotates faster than the vehicle during the flight.Fig. 5 Trajectories for various elevation angles of the single-stage rocket: a) altitude time history and b) shape of the trajectory.A suborbital rocket experiences a peak in the dynamic pressure in both the ascent and descent reentry phases. The white circles in Fig. 5a are the peaks corresponding to the dynamic pressure. The altitude of these peaks is almost independent of the elevation angle; however, their magnitudes change, as shown in Fig. 6. As observed in Table 6, Qmax in the reentry phase is larger than that in the ascent phase for an air-launch, and the difference increases with the elevation angle.Fig. 6 Relation between the dynamic pressure and launch elevation angle (launch altitude = 20 km).C. Two-Stage MissionThe trajectories of the two-stage rocket in the stratosphere and mesosphere missions are shown in Fig. 7. The duration of the coasting phase between the first-stage burnout and the second-stage ignition was adjusted to make the two peaks of altitude approximately the same. The launch elevation angles were chosen to make the peak altitude 50 km for the stratosphere mission or 80 km for the mesosphere mission. The altitude of the first peak was changed by changing the elevation angle and that of the second peak was changed by changing the second-stage ignition time.Fig. 7 Trajectories of the two-stage rocket: a) altitude time history and b) shape of the trajectory.Figure 7b clearly shows the shapes of the trajectories. The downrange in the second stage was longer than that in the first stage. The allocation of the recovery team near the drop point is an issue to be addressed because the second-stage drop point is 400–600 km away from the launch point. There are three peaks of dynamic pressure, as indicated by the white circles in Fig. 7. The altitudes at Qmax are approximately constant, similar to those of the single-stage mission. The time history of dynamic pressure is shown in Fig. 8. The peaks observed during the second-stage burning were lower than those of the first peaks. However, it is possible that the fairing should not be jettisoned before the second peak.Fig. 8 Dynamic-pressure history of the two-stage rocket.The main characteristics of the flight trajectories are presented in Table 7 (CA=0.5). The apogee altitude of the highest mission was 660 km, resulting in the highest Qmax value at reentry. For a greater value of the first ascent Qmax, the reentry Qmax is lower. This is because the high apogee altitude increases the reentry velocity and the air density is low in such a high trajectory.D. Three-Stage Orbital MissionThe launch trajectories of the three-stage orbital missions are shown in Fig. 9. After the payload is inserted into an ELEO of 100 km, it is decelerated at the perigee point due to the aerodynamic drag force. The apogee altitude gradually decreased and finally dropped to the ground when the apogee altitude reached approximately 200 km. Because the perigee point maintains an almost-constant altitude, it is possible to sample the dust levitating at a constant altitude. Although the dropping point is always near the perigee point, its longitude changes depending on the orbital circulation times owing to the rotation of Earth. When the payload is inserted into an LEO 200×500  km, it becomes a satellite with a long orbital lifetime. Table 8 shows the launch capability and flight characteristics of each orbital mission. The dynamic pressure is higher for the lower orbit because the rocket flies at a lower altitude where the air density is high. Nevertheless, it is still smaller than those experienced in a ground launch, which often exceeds 100 kPa. The elevation angle at the end of the gravity-turn trajectory is smaller for a low launch elevation angle ε0; therefore, the attitude change by the rhumb-line control Δε for ELEO is smaller than that for LEO.Hereafter, the benefits of the rockoon system and the effects of the orbit insertion altitude are discussed in terms of velocity losses. As shown in Table 9, the total velocity losses in a balloon launch are small, whereas those in a ground launch are approximately 1500–2000  m/s. In particular, those in the ELEO mission are below 600  m/s, which is quite low for an orbital mission. The losses due to the existence of the atmosphere, ΔVatmos and ΔVdrag are significantly reduced compared to those in ground launch, where the drag loss is 40–160  m/s, in general [15]. The most significant reduction in velocity loss is observed in gravity loss, which is generally 1150–1600  m/s in ground-launched LEO missions [11]. Because even the advanced three-stage rocket described in Table 4 is not capable of orbital launching from the ground, the effect on the gravitational loss cannot be calculated directly; however, a reduction in gravitational loss of more than 400  m/s was confirmed. In ground or sea launches, the rocket must accent almost vertically until it passes through a dense atmosphere to avoid high dynamic pressure. This increases its gravity loss; however, in a balloon launch at high altitudes over 20 km, a launch trajectory with a low elevation angle is possible, resulting in a low gravity loss.Fig. 9 Altitudes in the orbital missions plotted vs a) downrange and b) time.Figure 10 depicts the time histories of the gravity and steering losses, which dominate the velocity loss of the hybrid rockoon. In both missions, most of the gravity loss was generated during the first stage before the second-stage ignition, at which the flight-path angle becomes small. It is greater in the LEO mission because the launcher angle and flight-path angle in the gravity-turn trajectory are higher than those in ELEO. Steering losses are generated even in the gravity-turn trajectories, in which the elevation angle is aligned with the airspeed vector. This is because the steering loss is calculated using the velocity vector in the ECI coordinate system. The velocity vector R˙ has a horizontal component of approximately 400  m/s directed to the east owing to the rotation of Earth, even when the rocket is on the launcher. Thus, the thrust vector parallel to the vehicle axis vector er and velocity vector R˙ have an angle even in the gravity-turn trajectory.Fig. 10 Time histories of velocity losses in ELEO mission: a) gravity loss and b) steering loss.The steering losses generated during the second stage of burning vary with the orbit insertion altitude. The vehicle axis was oriented almost horizontally until the second-stage ignition in both cases. At the same time, the velocity vector is also horizontal in the trajectory to ELEO, whereas it has a large vertical component for LEO, resulting in a relatively large steering loss of 92  m/s in the second stage. Because the balloon launch relaxes the dynamic-pressure limitation, the launcher elevation ε0 is determined by the orbit insertion altitude. The rockoon also has a maximum altitude at which a payload can be inserted with a low velocity loss. The altitude depends on the propellant mass distribution of the vehicle. The first-stage propellant mass should be increased to efficiently reach higher orbits.IV. ConclusionsThe advantages of balloon air-launch and the problems that still need to be solved are investigated for small LT fuel hybrid rockets. It can be concluded that an LT fuel/N2O hybrid rocket is suitable for launch using a high-altitude balloon, in which the vehicle is cooled to –50°C before ignition. By launching from a balloon at an altitude of 11 km, a single-stage hybrid rocket launched using our 5 kN motor can reach an apogee altitude of 100 km. Furthermore, a two-stage rocket can reach 660 km if it is vertically air launched at an altitude of 20 km. The importance of reducing the axial drag force on the vehicle is relatively small for air-launch because the drag loss is low. However, the maximum dynamic pressure at reentry increased with the apogee altitude.Cosmic dust sampling missions have been proposed, in which a two-stage hybrid rocket follows a long trajectory in the stratosphere or mesosphere. Such trajectories are possible by long-term coasting before the second-stage ignition. The downrange of such a mission is approximately 400–600 km. The balloon-launched three-stage hybrid rocket could realize orbital missions to ELEO 100 km with a velocity loss below 600  m/s, which is suitable for dust sampling in the thermosphere. Furthermore, it is possible to launch a small satellite to LEO 200 km with a long orbital lifetime at low cost with a small number of operators and equipment. Potential beneficiaries include small companies or laboratories at universities.However, more improvements are desirable in terms of propulsion and structural performance. For example, the combustion pressure can be increased by using an electric N2O turbopump. This increases the specific impulse and reduces the weight of the liquid fuel tank. We are developing a new electric turbopump for hybrid rockets, and test firing will be performed no later than 2023. Air-launch experiments with a rail launcher lifted by an actual balloon will be performed in 2022. Combined tests of these systems will be feasible in 2025 or earlier.J. T. CassibryAssociate Editor\r            References\r        [1] Karabeyoglu A., Stevens J., Geyzel D., Cantwell B. and Micheletti D., “High Performance Hybrid Upper Stage Motor,” 47th AIAA/ASME/SAE/ASEE Joint Propulsion Conference and Exhibit, AIAA Paper  2011-6025, July 2011, pp. 1–25. https://doi.org/10.2514/6.2011-6025 LinkGoogle Scholar[2] Kobald M., Fischer U., Tomilin K., Petrarolo A. and Schmierer C., “Hybrid Experimental Rocket Stuttgart: A Low-Cost Technology Demonstrator,” Journal of Spacecraft and Rockets, Vol. 55, No. 2, 2018, pp. 484–500. https://doi.org/10.2514/1.A34035 LinkGoogle Scholar[3] Casalino L., Letizia F. and Pastrone D., “Optimization of Hybrid Upper-Stage Motor with Coupled Evolutionary/Indirect Procedure,” Journal of Propulsion and Power, Vol. 30, No. 5, 2014, pp. 1390–1398. https://doi.org/10.2514/1.B35111 LinkGoogle Scholar[4] Wada Y., Kato R., Kato N. and Hori K., “Small Rocket Launch Experiment Using Low Melting Point Thermoplastic Fuel/N2O Hybrid Rocket,” 49th AIAA/ASME/SAE/ASEE Joint Propulsion Conference, AIAA Paper  2013-4050, July 2013. LinkGoogle Scholar[5] Wada Y., Jikei M., Kato R., Kato N. and Hori K., “Application of Low Melting Point Thermoplastics to Hybrid Rocket Fuel,” Transactions of the Japan Society for Aeronautical and Space Sciences, Aerospace Technology Japan, Vol. 10, No. ists28, 2012, pp. Pa_1–Pa_5. https://doi.org/10.2322/tastj.10.pa_1 CrossrefGoogle Scholar[6] Kawabata Y., Kimura M., Wada Y., Nagase R., Kato R., Kato N., Hori K. and Matsui T., “Experimental Study on 5-kN Thrust Level Hybrid Rocket Motor Using Low-Melting-Point Thermoplastic Fuel,” AIAA Propulsion and Energy 2020 Forum, AIAA Paper  2020-3751, Aug. 2020. Google Scholar[7] Kawabata Y., Kimura M., Wada Y., Nagase R., Yasuda T., Kato N., Hori K. and Matsui T. “Experimental and Numerical Study on Feasibility of 5 kN Thrust Level Hybrid Rocket Motor Using the Low-Melting-Point Thermoplastic Fuel,” 71st International Astronautical Congress, IAF, Paris, France, 2020, Paper IAC-20-C4.4.6. Google Scholar[8] Bailey M., “Frequent and Reliable Launch for Small Satellites: Rocket Lab’s Electron Launch Vehicle and Photon Spacecraft,” Handbook of Small Satellites, Springer, Berlin, Germany, 2020, pp. 1–17. Google Scholar[9] Sutton G. and Biblarz O., Rocket Propulsion Elements, 7th ed., Wiley, New York, 2001, p. 67. Google Scholar[10] Ye X., Yajima N., Ai G. and Hu N., “Attitude Control and High Precision Pointing Control System of a Large Balloon Borne Solar Telescope,” Advances in Space Research, Vol. 26, No. 9, 2000, pp. 1419–1422. https://doi.org/10.1016/S0273-1177(00)00076-4 CrossrefGoogle Scholar[11] Inatani Y., Akiba R., Hinada M. and Nagatomo M., “Atmospheric Reentry Flight Test of Winged Space Vehicle,” 18th International Symposium on Space Technology and Science, JSASS, Tokyo, Japan, 1992, pp. 1263–1270. Google Scholar[12] Shoyama T. and Fujimoto K., “Feasibility Study on Spin Air-Launch of Small Rocket from Balloon,” Aerospace Technology Japan, The Japan Society for Aeronautical and Space Sciences, Vol. 19, Jan. 2020, pp. 39–45. https://doi.org/10.2322/astj.JSASS-D-19-00033 CrossrefGoogle Scholar[13] Inatani Y. and Ohtsuka H., “SS-520 Nano Satellite Launcher and Its Flight Result,” 32nd Annual AIAA/USU Conference on Small Satellites, Paper  SSC18-IX-03, Utah State Univ., 2018. Google Scholar[14] Anon., https://github.com/istellartech/OpenTsiolkovsky [29 Dec. 2019]. Google Scholar[15] Sarigul-Klijn N., Sarigul-Klijn M. and Noel C., “Air-Launching Earth to Orbit: Effects of Launch Conditions and Vehicle Aerodynamics,” Journal of Spacecraft and Rockets, Vol. 42, No. 3, 2005, pp. 569–575. https://doi.org/10.2514/1.8634 LinkGoogle Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Flight Mechanics Feasibility Assessment for Co-Delivery of Direct-Entry Probe and Aerocapture Orbiter",
        "url": "https://arc.aiaa.org/doi/10.2514/1.A34953",
        "date": "20210916",
        "content": "AbstractThe co-delivery of a direct-entry probe and an aerocapture orbiter from a single atmospheric entry state is a novel way to include ride-along probes or orbiters on interplanetary missions. This is made possible through combining two technologies: low-cost small satellites and aerocapture. This study investigates the feasibility of this co-delivery method from a flight-mechanics perspective. The availability of direct-entry and aerocapture trajectories from a single entry flight-path angle is assessed for a large range of feasible ballistic coefficients at Earth, Mars, Venus, Titan, and Neptune. Apoapsis altitude, peak heat flux, total heat load, and peak g-load are also quantified across this trade space. A representative scenario implementing closed-loop guidance is presented for a proof of concept, and the trajectory dispersions due to relevant uncertainties are quantified in a Monte Carlo analysis. Passive ballistic impactor or penetrator probes as a secondary mission with a primary lift-modulated aerocapture orbiter is identified as the most promising configuration.I. IntroductionCo-delivery of a probe and an orbiter is a powerful architecture for a variety of interplanetary missions. The Galileo and Cassini–Huygens missions are two famous examples, among many others, of this approach. Given the infrequency of major planetary science missions, it is desirable to maximize scientific return by gathering data from orbit as well as in situ measurements from the atmosphere or surface. Although interplanetary probe and orbiter missions have already been accomplished a number of times, two technologies could be combined to enable a new type of co-delivery architecture for planetary science missions.The first technology is low-cost small satellites (SmallSats), especially CubeSats, which have accounted for an increasingly large share of satellites launched each year since around 2012 [1]. Technological innovations, including the miniaturization of electronics and availability of commercial off-the-shelf hardware, have led to a steady increase in the capabilities possible in these small form factors, and CubeSat missions have now moved beyond serving a primarily educational role to make numerous notable scientific contributions [2]. A 2014 study sponsored by the Keck Institute for Space Studies presented space science mission concepts “uniquely enabled by the small satellite platform,” and recommended including small spacecraft as secondaries on all missions beyond low Earth orbit [3]. NASA has also studied a variety of mission concepts through its Planetary Science Deep Space SmallSat Studies program [4]. In November 2018, Mars Cube One (MarCO)-A and MarCO-B, the twin CubeSat communications relays accompanying the InSight Mars lander, successfully demonstrated the merit of SmallSats in deep space applications [5]. Ongoing research is applying SmallSat innovation to entry, descent, and landing (EDL) by developing technologies including deployable aeroshells and multifunctional EDL structures [6,7]. SmallSat secondary spacecraft enhance planetary science missions only if the secondary mission can minimize the additional mass, risk, cost, and complexity to the primary mission.The second technology is aerocapture, the often-studied technique of flying through the atmosphere of a planet to reduce the spacecraft’s energy and capture into orbit, as shown in Fig. 1. This technique has been studied for decades, but not implemented in flight. In recent years, significant work has contributed to the development of aerocapture and related technologies, including development of advanced thermal protection systems [8], robust flight-control methods and guidance algorithms [9–11], uncertainty quantification [12–15], deployable decelerator technology [6,16,17], and broad aerocapture technology studies [18–20] to list a few. A 2016 study at the NASA Jet Propulsion Laboratory concluded that, while aerocapture technology readiness is destination dependent, no prior flight demonstration would be needed to implement aerocapture on Titan, Mars, and possibly Venus [18]. Some of the renewed interest in aerocapture can be attributed to recent concepts for missions to the ice giants (Uranus and Neptune) in preparation for the Planetary Science Decadal Survey [21], because it is these destinations where aerocapture can offer the most benefit compared to propulsive orbit insertion [22].The concept that combines secondary SmallSats and aerocapture is to design a probe and an orbiter to reach their desired final states from a single approach trajectory and entry state, illustrated in Fig. 2. The two vehicles travel together during cruise and separate shortly before atmospheric entry, and then diverge during atmospheric flight due to differences in their aerodynamic properties and control strategies. The orbiter stays higher in the atmosphere, dissipating just enough energy to perform aerocapture, while the probe continues deeper into the atmosphere until reaching its desired target state, such as parachute deployment or surface impact. By designing the probe and orbiter to target a single atmospheric entry state, the need for a critical divert maneuver performed shortly before entry is avoided. For example, a satellite using lift-modulated aerocapture to reach Mars orbit could release several small probes that follow ballistic trajectories down to the surface. A jettison event is still required to physically separate the orbiter and probe and prevent recontact in the atmosphere, akin to the mechanical separation of the Mars Science Laboratory (MSL) aeroshell from its cruise stage 10 min before atmospheric entry [23]. In general, this co-delivery approach can apply to missions with multiple probes or orbiters, but for simplicity this study proceeds assuming only one of each. The following are key terms used in this study: “Co-delivery” refers to any two or more spacecraft that reach a shared destination via a single interplanetary trajectory, such as the delivery of five separate probes by the Pioneer Venus Multiprobe bus [24].“Probe” is used as a catch-all term, including landers, impactors, deep atmospheric probes, etc.“Secondary” refers to a smaller, ride-along addition to a larger, more expensive “primary” craft; for example, MarCO was a secondary mission for the InSight primary spacecraft. In the context of the proposed co-delivery method, a primary orbiter could have a secondary probe or the other way around; hence, these terms are defined separately.Fig. 1 Diagram of the aerocapture process.The primary motivation for targeting a single entry state for both orbiter and probe is to avoid requiring a divert maneuver, and managing its associated error, shortly before entry. If this maneuver is performed early, the probe would either require a propulsion subsystem and navigation capability, or would be coasting without course-correction capability from separation until entry. The later the orbiter performs the divert maneuver, the larger this maneuver becomes and the less time there is to quantify and potentially mitigate maneuver execution error. This is not to say that these other co-delivery architectures are not feasible; indeed, Galileo and Cassini–Huygens successfully had probes coast passively for nearly 150 and 20 days, respectively [25,26]. Rather, targeting a single entry condition is a solution to this tradeoff that reduces maneuver complexity on approach and eliminates a source of navigation error. Furthermore, by codelivering the probe and orbiter, the secondary craft is able to benefit from the resources of the primary spacecraft, such as power, propulsion, and communications, until shortly before atmospheric entry. This may significantly simplify the design of the secondary ride-along craft compared to separate post-launch operations; for example, independent operations and navigation during cruise proved to be a significant challenge for the MarCO CubeSats [27].Fig. 2 Conceptual diagram of co-delivery from a single entry state, shown as a close-up view of the region in the dashed-line box in Fig. 1; features exaggerated.Reference [28] qualitatively discusses the challenges of the proposed co-delivery method in detail. These challenges include the timing and dynamics of the separation event, post-separation collision concerns, timing and observation geometry between the orbiter and probe, and the feasibility of trajectories that deliver an orbiter for aerocapture and a probe for direct entry from a single entry state. The last of these is the focus of this study, with the remaining challenges left for future work.This study focuses on the feasibility of the flight mechanics associated with this co-delivery strategy. A broad trade space is explored to understand the regions of feasibility for co-delivery from a single entry state while quantifying relevant mission constraints. Earth, Mars, Venus, Titan, and Neptune applications are considered. A single representative scenario is developed that implements closed-loop guidance for both vehicles, and illustrates the performance of these vehicles under relevant uncertainties via Monte Carlo simulation.II. Trade StudyThe purpose of this section is to understand, at a high level, the combinations of trajectories and vehicles for which co-delivery from a single entry state is a possibility. A wide range of entry trajectories are simulated and classified by their final states, and a number of key constraining parameters are computed. The goal of this study is to demonstrate the fundamental flight mechanics feasibility of this co-delivery method at each destination and provide a starting point for further investigation of any specific mission concept.A. MethodologyTo simulate these trajectories, three-degree-of-freedom equations of motion are numerically integrated assuming a point-mass gravity with lift and drag forces acting on each vehicle [29]. Consistent with the flight of a blunt body in hypersonic continuum flow, constant aerodynamic coefficients, constant mass, and zero thrust are assumed, as well as zero wind. The vehicle state is propagated using a variable-step Runge–Kutta numerical integration method of order 5(4) [30]. The vehicle is initialized at the atmospheric interface altitude hatm, and the values used are listed in Table 1 [34–36,38]. For each target destination, a representative planet-relative entry velocity VR,0 is defined based on entry velocities of previous planetary entry missions or aerocapture mission studies [31–33]. Entry flight-path angle (EFPA) and ballistic coefficient are varied as part of the trade study. Entry flight-path angle is the angle between the planet-relative velocity vector of the vehicle at atmospheric entry and the local horizontal. The ballistic coefficient β is effectively a ratio of inertial to aerodynamic forces on the vehicle and is defined in Eq. (1), where m is vehicle mass, CD is hypersonic drag coefficient, and A is reference area. Note that, although the particular results described herein will vary as a function of entry velocity, the purpose of this work is to demonstrate the conceptual feasibility of this co-delivery technique. The parameters used in this analysis are listed in Table 1. β=mCDA(1)Profiles of atmospheric density are taken from the nominal output of the Global Reference Atmospheric Model (GRAM) for that planet/moon [40–44], where each GRAM provides an engineering-level model that can produce both mean and dispersed atmospheric data. The density profile is then linearly interpolated with altitude; although density varies approximately exponentially with altitude, GRAM data are output every 0.1  km, and so linear interpolation between data points is sufficiently accurate for this application. To approximately characterize the effect of density variability, results are shown for density profiles at ±3 standard deviations from nominal, where these ±3σ profiles are directly output by GRAM.Several potentially constraining quantities are calculated for each trajectory, one of which is peak heat flux. Specifically, the peak convective heat flux at the stagnation point for a fully catalytic surface is estimated using the Sutton–Graves method [45] in the form shown in Eq. (2). In this equation, ρ is density and Rn is effective nose radius, and the k coefficients and the atmospheric composition data used to compute them are listed in Table 1 [35,37,39]. Radiative heating is not included in this analysis. Total integrated heat load is computed by numerically integrating the stagnation point convective heat flux over time. An effective nose radius of Rn=1  m is assumed, which allows easy scaling of these heating results for other nose radius values. The maximum sensed acceleration in terms of Earth g’s values is also calculated. q˙s=kρRnVR3(2)Each trajectory is categorized based on its exit state: if the trajectory intersects the surface (or some minimum altitude), it is a probe; if the vehicle exits the atmosphere on an elliptical orbit, it is an orbiter; and if the vehicle exits the atmosphere on a hyperbolic orbit, the trajectory is categorized as escape. For the orbiter trajectories, apoapsis altitude is computed using the post-atmospheric Keplerian state of the vehicle.Three types of trajectories are described in the open-loop analysis presented in this study: ballistic, full-lift-up, and full-lift-down. These descriptors do not imply that the vehicle has no additional control authority; rather, they represent nominal trajectories for which no lift- or drag-modulation is required. A lift-to-drag ratio of L/D=0.25 is selected based on the approximate hypersonic trim L/D of MSL and Mars 2020 and the known capabilities of a 70 deg sphere cone aeroshell [36]. Although the results of this study provide insight into the consequences of increasing or decreasing L/D from this value, quantitative analysis for vehicles with significantly different L/D is left for future work. By showing these three cases, the set of trajectories approximately accessible with a 70 deg sphere cone aeroshell is characterized for each scenario.B. ResultsThe results at each planetary destination are summarized in Figs. 3–7. For each of the three trajectory types, trajectories are simulated across a grid of varying EFPA and ballistic coefficient. For each grid, at any given β, there will be some EFPA value that delineates between probes and orbiters. These EFPA values form the black line on each plot. Similarly, if the inertial entry velocity exceeds escape velocity, there will be an EFPA value delineating between orbiters and escape trajectories, and this is shown as the purple line. The shaded regions for each line are bounded by the values of that line when the ±3σ profiles are used for density. Therefore, any grid points left of the black line are probe trajectories, any grid points between the lines are orbiters (aerocapture), and to the right of the purple line are escape trajectories. Contours of apoapsis altitude, peak g-load, peak heat flux, and total heat load are then overlaid for each plot. Note that the contour values are not necessarily evenly incremented, and that the x-axis scale varies significantly between destinations.The interpretation of these plots is illustrated through the following example. By definition, the proposed co-delivery method is feasible where a probe trajectory and orbiter trajectory both exist at the same EFPA for realistic ballistic coefficients. Because the vehicles share an entry condition, co-delivery scenarios are identified in these plots with vertical cross sections along a single EFPA. As a simple example, a vertical line at −5.5  deg (not shown) for the Earth-ballistic plot would pass through the middle of the black line. Here, ballistic coefficients less than 75  kg⋅m−2 are probes and greater than 110  kg⋅m−2 are orbiters. Thus, for 11  km/s entry at Earth with an EFPA of −5.5  deg, co-delivery from a single entry state is possible using only ballistic trajectories, just by tuning the β values of the two vehicles.Fig. 3 Feasibility space for Earth, 11  km⋅s−1 relative entry velocity, shown with example annotation.Fig. 4 Feasibility space for Mars, 6  km⋅s−1 relative entry velocity, and nominal scenario used in Sec. III marked in blue.The application of lift broadens this feasible range significantly. In Fig. 3, a light blue vertical line is added at a nominal EFPA of −6.25 deg. On the ballistic plot, the line is entirely behind the orbiters/probes cutoff, meaning all ballistic coefficients in the range considered (10–200  kg⋅m−2) result in probe trajectories. On the full-lift-up plot, the line is entirely in front of the cutoff line, and so all β values result in orbiter trajectories. The initial apoapsis altitudes for these trajectories vary with ballistic coefficient and are shown in the dashed blue contour lines.For the proposed co-delivery method to be plausible, the architecture should be robust to a number of uncertainties, including navigation uncertainty. This can be described as an entry corridor, a range of possible EFPA values. In Fig. 3, the dashed light blue vertical lines represent an entry corridor of −6.25±0.5  deg. As a result of this uncertainty, the dashed lines now intersect the black cutoff lines for ballistic and lift-up trajectories, and these intersection points give the ballistic coefficient requirements for this scenario. For feasibility even with this large EFPA uncertainty, the orbiter β would need to be at least 40  kg⋅m−2 and the probe coefficient no greater than 160  kg⋅m−2. The value of ±0.5  deg used here is only an example; the same process can be followed for any width entry corridor using the results in Figs. 3–7.Fig. 5 Feasibility space for Venus, 11.5  km⋅s−1 relative entry velocity.These ballistic coefficients might be further constrained by other requirements. Continuing the example annotated in Fig. 3, to achieve an initial apoapsis altitude of at least 150 km, the orbiter β should be at least 75  kg⋅m−2. To keep the total heat load at the stagnation point below 20  kJ⋅cm−2, the probe β should be no greater than 120  kg⋅m−2. Additionally, note that the EFPA range still does not intersect the cutoff line on the full-lift-down plot, and so any ballistic coefficient in range would result in a probe trajectory, although the peak g-loads are significantly higher for lift-down trajectories. In addition to these flight mechanics constraints, packaging and vehicle geometry considerations make some ballistic coefficients more feasible than others.Fig. 6 Feasibility space for Titan, 6  km⋅s−1 relative entry velocity.Fig. 7 Feasibility space for Neptune, 27  km⋅s−1 relative entry velocity.The preceding example demonstrates how a mission designer can choose constraints on nominal EFPA, entry corridor, apoapsis, etc., and then directly assess the feasibility of probe and orbiter co-delivery from a single entry state for that mission scenario from the plots in Figs. 3–7.C. DiscussionThe feasibility assessment at each destination depends on the specific scenario and constraints, making it challenging to compare the destinations in a general way. One heuristic approach is to consider the EFPA range spanned by the probes/orbiters cutoff line (i.e., the difference between the probe/orbiter transition EFPAs at β=200  kg⋅m−2 and β=10  kg⋅m−2 for ballistic trajectories, including the narrowing effect of the atmospheric uncertainty bars). In ascending order, this value is approximately 0.66 deg at Venus, 0.84 deg at Earth, 0.88 deg at Neptune, 1.22 deg at Mars, and 3.8 deg at Titan. These values reflect the ranges of usable EFPAs for two ballistic vehicles, meaning Titan is by far the most flexible if no nominal lift is required. A similar heuristic parameter is the EFPA range gained from a full-lift-up trajectory, defined as the difference between the probe/orbiter transition EFPAs at β=100  kg⋅m−2 for full-lift-up and ballistic trajectories, including the narrowing effect of the atmospheric uncertainty bars. Again, in ascending order, this value is approximately 1.18 deg at Neptune, 1.36 deg at Earth, 1.52 deg at Mars, 1.84 deg at Venus, and 1.9 deg at Titan. Titan again has the widest range by this measure, although by a smaller margin. Notably, Venus has the smallest range for ballistic-only trajectories but has the second-widest range by this measure of lift effectiveness. The small scale height of the Venusian atmosphere at aerocapture altitudes corresponds to rapid density variations with altitude [32], resulting in narrow corridor widths but a large control authority for lifting vehicles. Furthermore, all else being equal, high entry velocities lead to larger theoretical corridor widths for lift-modulation aerocapture vehicles [46], and the representative entry velocity chosen for Venus in this study is high relative to the mass of the planet. It is important to note that these benefits are directly traded off by high g-loads, heat fluxes, and heat loads at Venus; the high entry velocity at Neptune, dictated by its large gravity well and the constraint of reasonable times of flight from Earth, has similar drawbacks. Note that the particular values of these EFPA ranges are tied to the choices of atmospheric interface altitudes listed in Table 1.The results shown in Figs. 3–7 and discussed previously are primarily in terms of ballistic coefficient, which is a ratio and provides no information on the actual mass and volume of the vehicle. The mechanical and aerodynamic design of specific aeroshells to meet a target ballistic coefficient, fit within secondary SmallSat mass and volume constraints, and accommodate a science payload is beyond the scope of this study. That said, there is precedent for entry capsules in a SmallSat form factor. Most notably, the Mars Microprobes provide flight heritage at Mars, and each probe had a ballistic coefficient of 35.6  kg⋅m−2 and an entry mass of 3.6 kg, and would have fit within a 35×35×27.5  cm box [47], well within the mass and volume constraints for a secondary payload on an Evolved Expendable Launch Vehicle Secondary Payload Adapter (ESPA) ring [48]. The Adaptive Deployable Entry and Placement Technology deployable aeroshell enables aeroshell diameters of up to 1.7 m to stow within an ESPA secondary payload volume, and has an expected ballistic coefficient in the range of 25–50  kg⋅m−2 and entry mass of 75–150 kg for delivery of a 12U CubeSat payload volume [6]. The notional design for the Small High Impact Energy Landing Device has a ballistic coefficient as low as 10  kg⋅m−2 for an entry mass of 50 kg and 6 kg payload mass [7,49]. These example designs are included here to illustrate the fact that, although detailed design is out of scope, the co-delivery method is conceivable with SmallSat-class vehicles.There are some key limitations to the approach taken in this study. For the sake of space, only one entry velocity is considered for each destination. In general, increases in entry velocity on the order of 1  km⋅s−1 lead to an increase in lift-modulation control authority, increased g-loads, and a compression of the available apoapsis radii in terms of EFPA, but the overall feasibility of co-delivery is not dramatically affected. This is shown in Ref. [50] through a comparison of feasibility with 10, 11, and 12.5  km⋅s−1 entry velocities at Earth. Another limitation is the bounding case approach to lift modulation. Although it is possible to use 100% of available lift to bias the nominal trajectory (e.g., Viking flew a full-lift-up trajectory with no guidance), in general some control authority must be allocated to compensate for uncertainties in EFPA, atmospheric density, vehicle parameters, etc. MSL, for example, used about 70% of its available lift to bias its nominal trajectory, reserving 30% for control authority margin [36]. The ability of the results shown here to capture these types of trajectories is limited. For example, for a lift-up trajectory at Earth, 11  km⋅s−1, and an EFPA of −6  deg, a ballistic coefficient of 50  kg⋅m−2 results in an apoapsis altitude of about 3000 km. Intuitively, a similar trajectory that instead uses only 70% of its lift for the nominal trajectory would result in aerocapture with a lower apoapsis, but the results shown here do not quantify this idea. Nonetheless, these results give bounding cases within which a vehicle could reserve some control margin for uncertainties by targeting a lower apoapsis or increasing control authority by increasing L/D.Another aerocapture trade reflected in these results is that, in general, more is gained from the lift-up trajectories than from lift-down. From inspection of the example in Fig. 3, it is clear that one appealing configuration is a lift-modulated orbiter with a ballistic probe trajectory. The ballistic probe trajectory could be truly passive, such as for a simple penetrator probe mission, or it could apply lift- or drag-modulation to the ballistic trajectory for the purpose of accommodating uncertainties. Passive impactor or penetrator probes are already excellent candidates for co-delivery due to their simplicity and small size, and so this configuration stands out as a promising mission architecture for multiple reasons.III. Representative ScenarioThe previous section explores a large trade space for probe and orbiter co-delivery by considering numerous point designs. Each of these trajectories is only passively controlled (full-lift-up or -down, or ballistic) and has no accounting for random uncertainties. To further demonstrate the fundamental feasibility of the proposed co-delivery method from a flight mechanics standpoint, this section more closely examines a single representative mission scenario. A nominal scenario is defined that makes use of bank-angle modulation lift control for both the probe and the orbiter. Representative uncertainties are then applied and their effect quantified through a Monte Carlo analysis.A. MethodologyA general co-delivery scenario involves two vehicles, an aerocapture orbiter and a direct-entry probe, each of which may implement some closed-loop guidance to control their atmospheric flight. As noted in Sec. II.C, a particular scenario of interest would involve a passive ballistic probe; because this vehicle would be significantly simpler than an entry vehicle using active guidance and control, it may be a better fit for ride-along probe missions. Thus, three vehicles are considered in this section: a guided orbiter that performs aerocapture, a guided probe following a direct-entry trajectory, and a passive ballistic probe that follows a similar direct-entry trajectory.Mars is chosen as the destination for this representative example scenario. The trajectories are simulated using the same equations of motion as in Sec. II.A, with the addition of the J2 zonal term in the spherical harmonics gravity model, where J2=0.001964 [51]. For the orbiter and guided probe, bank-angle modulation is used as the method of control, which updates the orientation of the lift vector about the velocity vector without changing the angle of attack. This method is selected here for its flight heritage on the MSL and Mars 2020 missions [36,52], but note that other control approaches, such as drag-skirt jettison or direct-force control, would also be applicable.Mode 1 of the Fully Numerical Predictor–Corrector Aerocapture Guidance (FNPAG) scheme developed by Lu et al. [11] is implemented for the orbiter. This guidance algorithm assumes a bang-bang structure to lift modulation, wherein the vehicle uses Brent’s method [53] to numerically predict a switching time from a lift-up angle 0≤σi<90  deg to a lift-down angle 90  deg<σd≤180  deg (σi is called σ0 in [11], renamed here to distinguish from the Fully Numerical Predictor–Corrector Entry Guidance (FNPEG) variable of the same name). This bang-bang structure targets the desired apoapsis while minimizing the total ΔV required for the periapsis raise and apoapsis correction maneuvers. The following simplifying assumptions are made for the purpose of this demonstration: Only longitudinal guidance is implemented, meaning a final apoapsis radius is targeted while ignoring the final inclination or wedge angle. Lateral guidance is normally achieved separately from the modulation of the bank-angle magnitude through periodic bank reversals [11]. Assuming no plane change is desired during aerocapture, the feasibility of achieving the desired apoapsis under uncertainties can be approximately assessed without considering the lateral guidance component, even though for any real aerocapture mission the lateral logic is an important part of the guidance scheme.The initial bank angle is assumed to be σi=0  deg, and the initial guess for the final bank angle (which is updated during phase 2 of FNPAG) is assumed to be σd=150  deg. Note that with σi=0  deg, there is neither lateral force nor lateral control authority during phase 1, but bank reversals could be performed during phase 2.The guidance is run at a rate of 1 Hz and the bank-angle is updated instantaneously, neglecting the effect of a finite roll rate and acceleration for the vehicle.No additional trajectory constraints are imposed, such as limits on peak heat flux or g-load, because the value of those limits would be strongly mission dependent.No atmospheric estimation model is included in the guidance implementation, as this was found to be unnecessary to demonstrate fundamental feasibility for this scenario.These simplifying assumptions are appropriate here because this section presents a proof-of-concept demonstration; a dedicated mission analysis would iteratively tune σd, potentially assume a larger value for σi, implement bank reversals and a finite roll rate and acceleration, and so on.A similar approach is taken for the guided probe, which implements FNPEG, developed by Lu [54]. FNPEG assumes the bank-angle magnitude profile is a linear function of e, as shown in Eq. (3), where e is the negative of the specific orbital energy, as given in Eq. (4). The value of σ0 is then updated with each guidance call to target a desired range and energy, where the desired energy is computed by applying Eq. (4) to the desired radial distance and inertial velocity at the final time. Note that, because the target values for radius and velocity are combined into a single constraint, FNPEG can result in small altitude and velocity errors, but in many applications (such as targeting range at parachute deploy), this is acceptable [54]. At each guidance call, FNPEG uses the golden-section method to minimize the error function [Eq. (5)] [53], where s(ef) is the predicted great-circle range at the target energy, and sf* is the target final range. The value of s(ef) is predicted numerically by including range s (in radians) in the equations of motion as s˙=Vcos(γ)/r and propagating until the target energy is reached [54], where V and γ are both planet-relative values. Similar assumptions are made here as for FNPAG. Lateral guidance is again neglected for the same reasons, instantaneous bank-angle updates are assumed with guidance run at a rate of 1 Hz, and no additional trajectory constraints are imposed. A value of σf=60  deg is used for this study. As with FNPAG, these assumptions are made for the sake of a proof-of-concept demonstration, and a more detailed mission analysis would tune σf, implement finite roll rate and acceleration, etc. |σ(e)|=σ0+e−e0ef−e0(σf−σ0)(3)e=μr−v22(4)f(σ0)=12[s(ef)−sf*]2(5)B. Nominal ScenarioA nominal scenario is constructed starting from the results shown in Fig. 4. As seen from the full-lift-up plot in Fig. 4, a lifting vehicle with β=130  kg⋅m−2 can achieve aerocapture with a low apoapsis from an EFPA of −12  deg. As seen in the ballistic plot, a probe with β=35  kg⋅m−2 can follow a direct-entry trajectory from the same EFPA, either as a ballistic probe or a lifting vehicle dedicating some or all of its control authority to mitigating uncertainties. The orbiter ballistic coefficient was chosen to be similar to that of MSL [36], and the probe ballistic coefficient to be similar to that of the Mars Microprobe capsules [47]. As in the trade study, the guided vehicles have a lift-to-drag ratio of L/D=0.25, whereas the passive probe is ballistic (L/D=0). As before, the entry state is defined at the atmospheric interface altitude with a planet-relative entry velocity of VR,0=6  km⋅s−1, with a due-east initial heading angle at 18.38° latitude. The nominal values of key parameters are listed in Table 2 in the “Mean” column.For the orbiter, the target final orbit is defined to be a 250 km altitude circular orbit. By running an FNPAG trajectory once with no dispersions (a perfect predictor), the switching time required to reach this apoapsis from the entry state described previously is found to be approximately 152.6 s. This nominal trajectory results in a nominal total ΔV cost of 74  m⋅s−1, as shown in Table 3. This total ΔV is computed as the sum of the ΔV for a periapsis raise maneuver performed at the initial apoapsis (ΔV1) and the ΔV for a subsequent apoapsis correction maneuver performed at the new periapsis (ΔV2). This cost is computed as in Eq. (6), where ra and rp are the apoapsis and periapsis radii of the post-atmospheric state, respectively, and ra* and rp* are the desired apoapsis and periapsis radii, respectively: ΔV=ΔV1+ΔV2=2μ|[1ra−1ra+rp*−1ra−1ra+rp]|+2μ|[1rp*−1ra*+rp*−1rp*−1ra+rp*]|(6)For the guided probe, the target altitude and velocity are set to 15 km and 300  m⋅s−1, respectively, and the target range is approximately 700.8 km. This target state corresponds to a Mach number of 1.3 and a dynamic pressure of 175 Pa, where the speed of sound on Mars is found by interpolating from the table provided in [35]. Depending on the specific mission design, the final state targeted by FNPEG could represent parachute deployment, retrorocket ignition, or simply a shift to some other guidance method as the entry capsule continues down to the surface. The main purpose here is to give FNPEG something to aim for so that the effect of uncertainties can be understood, rather than to design a full EDL sequence. With these target values and a perfect predictor, FNPEG computes an initial bank-angle magnitude of approximately σ0=139.3  deg. This nominal trajectory results in zero range error, but has altitude and velocity errors of 441 m and −5.5  m⋅s−1, respectively. As mentioned in Sec. III.A, here FNPEG undershoots the target velocity and overshoots the target altitude in such a way that the final energy is still correct, but these errors are relatively small and could also be further reduced by optimization of the reference trajectory. The discrepancy is mainly notable because a bias can be expected in the results under uncertainty due to these nonzero errors for the nominal trajectory.Lastly, the passive ballistic probe has no target state because it has no variable control authority during atmospheric flight. To compare results with the guided probe, the trajectory of the passive probe is always terminated at 15 km altitude, and the errors are defined as differences compared to the nominal velocity and range values at this altitude: 353.1  m⋅s−1 and 735.0 km, respectively. Note that this means there are no performance results for altitude for the passive probe. This corresponds to a Mach number of 1.6 and a dynamic pressure of 242 Pa.The nominal trajectories for these three vehicles are shown in Fig. 8, where the blue dot shows the point along the trajectory of the orbiter where it switches from lift-up (σi) to lift-down (σd). The orbiter trajectory and either of the two probe trajectories constitute one representative scenario on Mars; a similar process could be followed for any of the feasible regions of the trade space identified in Sec. II.Fig. 8 Nominal trajectories for the orbiter, guided lifting probe, and passive ballistic probe.C. Performance Under UncertaintyHaving designed nominal trajectories for a guided orbiter, guided probe, and passive probe, the performance of these vehicles is assessed under representative uncertainties in the entry state, vehicle aerodynamics, and atmospheric density. A 1500-trial Monte Carlo analysis is performed. The mean and dispersions for each randomized input are listed in Table 2, where 3σ=X indicates a Gaussian distribution with zero mean and standard deviation σ, and ±Y% indicates the bounds for a uniform distribution relative to the mean. The input parameter is computed by adding the mean and a dispersion value randomly generated from the associated probability distribution.Variation in the entry state is simulated by independently normally dispersing the planet-relative EFPA and planet-relative entry velocity magnitude. Because the orbiter and probe are assumed to share a delivery state, the same randomly selected entry state is used for all three vehicles for each trial. The numerical predictor component of FNPAG and FNPEG is given perfect state knowledge, including of the entry state, and so the EFPA and velocity dispersions represent guidance performance under a range of initial conditions, as opposed to performance with an imperfect predictor or error between the navigated and true states. The EFPA dispersion is set equal to the delivery requirement for MSL, and the entry velocity dispersion is set to five times the MSL requirement for the navigation knowledge accuracy used for EDL guidance system initialization [23]. The larger entry velocity dispersion is used in this study to generate a wider range of potential entry states for illustrative purposes.Uncertainty in the aerodynamic properties of the vehicles is modeled by independently uniformly dispersing ballistic coefficient and L/D. Because the orbiter and probe are separate vehicles, their aerodynamic properties are dispersed separately. However, because the passive probe is included for direct comparison to the guided probe, its ballistic coefficient is always set equal to the actual value of the ballistic coefficient of the guided probe; there is no dispersion on the L/D of the passive probe because it always equals zero. Unlike the entry state, the numerical predictor guidance always uses the nominal values for β and L/D, whereas the true state is propagated using the dispersed values for each trial, resulting in an imperfect predictor. The uniform ±5% dispersion for these vehicle parameters represents modeling uncertainty associated with computational fluid dynamics analysis and ballistic range testing, and is based on values used in previous studies [55].Finally, atmospheric density variability on Mars is modeled using Mars-GRAM 2010, which has a built-in capability to output randomly perturbed correlated density profiles in a Monte Carlo sense [41]. Because the orbiter and probe would arrive simultaneously and experience the same atmosphere, the same dispersed density profile is used for all three vehicles in each trial. Differences in the density encountered at a given altitude due to different paths through the atmosphere are assumed negligible for this study. As with the aerodynamics dispersions, the guidance algorithm always uses the nominal density profile in its predictions, whereas the true state is propagated according to the dispersed density profile. The Mars-GRAM 2010 settings are generally kept at their default values, including a perturbation scale of 1 and solar radio flux at 10.7 cm of 68 sfu [41], using the date of 18 February 2021.The results of this 1500-trial Monte Carlo analysis are summarized in Table 3, and histograms of error and cost parameters are shown in Figs. 9–12. The purpose of this analysis is to demonstrate feasibility for this mission scenario and to compare the performance of the guided and passive probes, not to precisely estimate the performance metrics of the vehicles. By numerically examining the convergence as the number of trials was increased, the quantities of interest listed in Table 3 are found to converge to within roughly ±5%. The mean range error for both probes and mean velocity error for the passive probe are exceptions to this statement because, as quantities with nominal values of zero and mean values near zero, their percent errors are poorly behaved. The guided probe range error converges to within roughly 0.05 km, the passive probe range error to roughly 0.2 km, and the passive probe velocity error to roughly 0.5  m⋅s−1.The orbiter achieves aerocapture with a 100% success rate despite a relatively large range in entry states, although some cases do significantly overshoot the desired apoapsis, as seen in Fig. 9. Note that Fig. 9b is a close-up view of Fig. 9a to better see those high-error cases. These errors also lead to a positive skew in the total ΔV results shown in Fig. 10a, with the worst cases exceeding twice the nominal cost. Note that the total ΔV results are centered nearly one standard deviation above the nonzero nominal value. Although these errors are significant, they are not unexpected, considering the relatively large entry state dispersions and the use of an imperfect predictor in the guidance algorithm. The large overshoot cases are often a result of saturation in phase 2 of FNPAG, meaning the vehicle flies full lift down but is still unable to sufficiently reduce its energy, resulting in an apoapsis that is higher than desired. With better tuning of the σd parameter, robustness could be improved and a reduction in the high-error cases may be achieved. The performance could also be improved by adding some adaptive atmospheric estimation capability to the guidance implementation [11,56].Fig. 9 Apoapsis results for orbiter.Fig. 10 ΔV cost for orbiter and altitude error for guided probe.The altitude performance for the guided probe is shown in Fig. 10b, and the range and velocity performance is compared between the guided and passive probes in Figs. 11 and 12, respectively. As expected, the altitude and velocity errors for the guided probe are centered near the nonzero nominal error values. Although the specific requirements for this delivery accuracy would be mission dependent, in general FNPEG shows good performance. Particularly notable for this study is the comparison of range and velocity errors between the guided and passive probes. As expected, the passive probe does perform much worse than the guided probe; in terms of standard deviation, the passive probe has roughly double the velocity error and roughly an order of magnitude more range error compared to the guided probe. That said, a delivery uncertainty on the order of ±50  km range and ±25  m⋅s−1 velocity at 15 km altitude may well be acceptable for some applications. For example, if the probe were a small secondary ride-along payload targeting a broad surface region either by parachute or as an impactor, perhaps these error ranges would be sufficient.Fig. 11 Target range error histograms for guided and passive probes.Fig. 12 Target velocity error histograms for guided and passive probes.The Monte Carlo analysis results are included to demonstrate two main conclusions. First, aerocapture and direct-entry trajectories from the same entry state are feasible even under significant navigation, vehicle, and atmospheric dispersions if the orbiter is provided some control authority and closed-loop guidance capability. Second, the probe can target a specific final state if also provided control authority and closed-loop guidance, although the final state dispersions for a passive ballistic probe may already be sufficient for some applications. The performance results presented in this section are intended to serve as a proof of concept for one representative scenario at Mars under uncertainty.IV. ConclusionsThe proposed co-delivery method is an architecture for SmallSat ride-along missions to interplanetary destinations. This co-delivery architecture is shown to be feasible for wide ranges of vehicle and trajectory parameters at Earth, Mars, Venus, Titan, and Neptune, subject to mission-specific heating and g-load constraints that are quantified across this trade space. An example scenario is developed using FNPAG and FNPEG closed-loop guidance for the orbiter and probe, respectively, and the performance of the vehicles under uncertainty is shown to be adequate through a Monte Carlo analysis. Based on the trade space analysis and the uncertainty quantification results, a passive ballistic impactor or penetrator probe as a secondary mission on an orbiter delivered by a lift-modulated aerocapture trajectory is shown to be a particularly promising configuration. A number of challenges remain for implementation, including separation design, timing and observation geometry, packaging, and tight volume and mass constraints.K. T. EdquistAssociate EditorAcknowledgmentsThis work was supported by a NASA Space Technology Research Fellowship. The first author thanks Jay McMahon and Soumyo Dutta for help with the Fully Numerical Predictor–Corrector Aerocapture Guidance and the Fully Numerical Predictor–Corrector Entry Guidance materials.\r            References\r        [1] Halt T., Wieger A., Boensch N., Dolgopolov A., Smith P. and Hernandez A., “Smallsats by the Numbers 2019,”  Bryce Space and Technology, Alexandria, VA, 2019. Google Scholar[2] Poghosyan A. and Golkar A., “CubeSat Evolution: Analyzing CubeSat Capabilities for Conducting Science Missions,” Progress in Aerospace Sciences, Vol. 88, Jan. 2017, pp. 59–83. https://doi.org/10.1016/j.paerosci.2016.11.002 CrossrefGoogle Scholar[3] Norton C. D., Pellegrino S. and Johnson M., “Small Satellites: A Revolution in Space Science,” Keck Inst. for Space Studies,  California Inst. of Technology, Pasadena, CA, July 2014. Google Scholar[4] Mercer C. R., “Small Satellite Missions for Planetary Science,” Proceedings of the Small Satellite Conference, Upcoming Missions, SSC19-WKV-06, 2019, pp. 1–6, https://digitalcommons.usu.edu/smallsat/2019/all2019/102/. Google Scholar[5] Asmar S. W. and Matousek S., Mars Cube One (MarCO): Shifting the Paradigm in Relay Deep Space Operation, AIAA, Reston, VA, 2016, pp. 1–7. Google Scholar[6] Cassell A. M., Smith B. P., Wercinski P. F., Ghassemieh S. M., Hibbard K. E., Nelessen A. P. and Cutts J. A., “ADEPT, A Mechanically Deployable Re-Entry Vehicle System, Enabling Interplanetary CubeSat and Small Satellite Missions,” Proceedings of the Small Satellite Conference, Advanced Technologies I, SSC18-XII-08, 2018, pp. 1–8, https://digitalcommons.usu.edu/smallsat/2018/all2018/265/. Google Scholar[7] Barba N., Komarek T., Woolley R., Giersch L., Stamenkovié V., Gallagher M. and Edwards C. D., “Mars Small Spacecraft Studies: Overview,” 2019 IEEE Aerospace Conference, IEEE, New York, 2019, pp. 1–10. https://doi.org/10.1109/AERO.2019.8741735 Google Scholar[8] Gage P., Mahzari M., Peterson K., Ellerby D. and Venkatapathy E., “Technology Readiness Assessment for HEEET TPS,” 16th International Planetary Probe Workshop, 2019, pp. 1–19. Google Scholar[9] Putnam Z. R. and Braun R. D., “Drag-Modulation Flight-Control System Options for Planetary Aerocapture,” Journal of Spacecraft and Rockets, Vol. 51, No. 1, 2014, pp. 139–150. https://doi.org/10.2514/1.A32589 LinkGoogle Scholar[10] Deshmukh R. G., Spencer D. A. and Dutta S., “Investigation of Direct Force Control for Aerocapture at Neptune,” Acta Astronautica, Vol. 175, Oct. 2020, pp. 375–386. https://doi.org/10.1016/j.actaastro.2020.05.047 CrossrefGoogle Scholar[11] Lu P., Cerimele C. J., Tigges M. A. and Matz D. A., “Optimal Aerocapture Guidance,” Journal of Guidance, Control, and Dynamics, Vol. 38, No. 4, 2015, pp. 553–565. https://doi.org/10.2514/1.G000713 LinkGoogle Scholar[12] Heidrich C. R. and Braun R. D., “Aerocapture Trajectory Design in Uncertain Entry Environments,” AIAA SciTech 2020 Forum, AIAA Paper  2020-1741, Jan. 2020, pp. 1–21. https://doi.org/10.2514/6.2020-1741 LinkGoogle Scholar[13] Halder A. and Bhattacharya R., “Dispersion Analysis in Hypersonic Flight During Planetary Entry Using Stochastic Liouville Equation,” Journal of Guidance, Control, and Dynamics, Vol. 34, No. 2, 2011, pp. 459–474. https://doi.org/10.2514/1.51196 LinkGoogle Scholar[14] Ridderhof J. and Tsiotras P., “Stochastic Atmosphere Modeling for Risk Adverse Aerocapture Guidance,” 2020 IEEE Aerospace Conference, IEEE, New York, 2020, pp. 1–7. https://doi.org/10.1109/AERO47225.2020.9172724 Google Scholar[15] Albert S. W., Doostan A. and Schaub H., “Finite-Dimensional Density Representation for Aerocapture Uncertainty Quantification,” AIAA SciTech 2021 Forum, AIAA Paper  2021-0932, Jan. 2021, pp. 1–17. https://doi.org/10.2514/6.2021-0932 LinkGoogle Scholar[16] Smith B. P., Tanner C. L., Mahzari M., Clark I. G., Braun R. D. and Cheatwood F. M., “A Historical Review of Inflatable Aerodynamic Decelerator Technology Development,” 2010 IEEE Aerospace Conference, IEEE, New York, 2010, pp. 1–18. https://doi.org/10.1109/AERO.2010.5447013 Google Scholar[17] Hughes S., Cheatwood F., Dillman R., Wright H., DelCorso J. and Calomino A., “Hypersonic Inflatable Aerodynamic Decelerator (HIAD) Technology Development Overview,” 21st AIAA Aerodynamic Decelerator Systems Technology Conference and Seminar, AIAA Paper  2011-2524, May 2011, pp. 1–24. https://doi.org/10.2514/6.2011-2524 LinkGoogle Scholar[18] Spilker T. R., Adler M., Arora N., Beauchamp P. M., Cutts J. A., Munk M. M., Powell R. W., Braun R. D. and Wercinski P. F., “Qualitative Assessment of Aerocapture and Applications to Future Missions,” Journal of Spacecraft and Rockets, Vol. 56, No. 2, 2019, pp. 536–545. https://doi.org/10.2514/1.A34056 LinkGoogle Scholar[19] Austin A., “Enabling and Enhancing Science Exploration Across the Solar System: Aerocapture Technology for SmallSat to Flagship Missions,” Bulletin of the American Astronomical Society, Vol. 54, No. 4, March 2021, https://baas.aas.org/pub/2021n4i057. Google Scholar[20] Dutta S., “Aerocapture as an Enhancing Option for Ice Giants Missions,” Bulletin of the American Astronomical Society, Vol. 53, No. 4, March 2021, https://baas.aas.org/pub/2021n4i046. Google Scholar[21] Hofstadter M., Simon A., Reh K., Elliott J., Niebur C. and Colangeli L., “Ice Giants Pre-Decadal Study Final Report,”  NASA TR  JPL D-100520, June 2017. Google Scholar[22] Hall J. L., Noca A. N. and Bailey R. W., “Cost–Benefit Analysis of the Aerocapture Mission Set,” Journal of Spacecraft and Rockets, Vol. 42, No. 2, 2005, pp. 309–320. https://doi.org/10.2514/1.4118 LinkGoogle Scholar[23] Martin-Mur T. J., Kruizinga G. L., Burkhart P. D., Abilleira F., Wong M. C. and Kangas J. A., “Mars Science Laboratory Interplanetary Navigation,” Journal of Spacecraft and Rockets, Vol. 51, No. 4, 2014, pp. 1014–1028. https://doi.org/10.2514/1.A32631 LinkGoogle Scholar[24] Colin L., “The Pioneer Venus Program,” Journal of Geophysical Research: Space Physics, Vol. 85, No. A13, 1980, pp. 7575–7598. https://doi.org/10.1029/JA085iA13p07575 CrossrefGoogle Scholar[25] O’Neil W. J., The Three Galileos: The Man, the Spacecraft, the Telescope, Vol. 220, Springer, Dordrecht, The Netherlands, 1997, pp. 75–94. Google Scholar[26] Kazeminejad B., Atkinson D. H., Pérez-Ayũcar M., Lebreton J.-P. and Sollazzo C., “Huygens’ Entry and Descent Through Titan’s Atmosphere—Methodology and Results of the Trajectory Reconstruction,” Planetary and Space Science, Vol. 55, No. 13, 2007, pp. 1845–1876. https://doi.org/10.1016/j.pss.2007.04.013 CrossrefGoogle Scholar[27] Klesh A. T., Baker J. and Krajewski J., “MarCO: Flight Review and Lessons Learned,” Proceedings of the Small Satellite Conference, SSC19-III-04, 2019, pp. 1–6, https://digitalcommons.usu.edu/smallsat/2019/all2019/102/. Google Scholar[28] Albert S. W., Braun R. D. and Schaub H., “AeroDrop: Prospects and Challenges for Co-Delivery of Probe and Orbiter via Aerocapture,” AAS/AIAA Astrodynamics Specialist Conference, AAS Paper  20-718, Univelt, Inc., San Diego, CA, 2020, pp. 2275–2293. Google Scholar[29] Vinh N. X., Busemann A. and Culp R. D., Hypersonic and Planetary Entry Flight Mechanics, Univ. of Michigan Press, Ann Arbor, MI, 1980, pp. 26–27, Chap. 2. Google Scholar[30] Dormand J. R. and Prince P. J., “A Family of Embedded Runge-Kutta Formulae,” Journal of Computational and Applied Mathematics, Vol. 6, No. 1, 1980, pp. 19–26. https://doi.org/10.1016/0771-050X(80)90013-3. CrossrefGoogle Scholar[31] Graves C. A. and Harpold J. C., “Apollo Experience Report—Mission Planning for Apollo Entry,”  NASA  TN D-6725, 1972. Google Scholar[32] Lockwood M. K., Starr B. R., Paulson J. W., Kontinos D. A., Chen Y., Laub B., Olejniczak J., Wright M. J., Takashima N., Justus C. G. and Duval A. L., “Systems Analysis for a Venus Aerocapture Mission,”  NASA  TM-2006-214291, 2006. Google Scholar[33] Lockwood M. K., Edquist K. T., Starr B. R., Hollis B. R., Hrinda G. A., Bailey R. W., Hall J. L., Spilker T. R., Noca M. A., O’Kongo N. and Haw R. J., “Aerocapture Systems Analysis for a Neptune Mission,”  NASA  TM-2006-214300, 2006. Google Scholar[34] McNamara L. W. and Rea J. R., “Definition of the Design Entry Trajectory and Entry Flight Corridor for the NASA Orion Exploration Mission 1 Using an Integrated Approach and Optimization,” 2014 American Astronautical Society Guidance and Control Conference, AAS Paper  14-094, Univelt, Inc., San Diego, CA, 2014, pp. 529–542. Google Scholar[35] Justus C. G. and Braun R. D., “Atmospheric Environments for Entry, Descent and Landing (EDL),” 5th International Planetary Probes Workshop and Short Course, 2007, pp. 1–37. https://ntrs.nasa.gov/citations/20070032693 [retrieved 7 July 2021]. Google Scholar[36] Way D., Powell R., Chen A., Steltzner A., San Martin M., Burkhart P. and Mendeck G., “Mars Science Laboratory: Entry, Descent, and Landing System Performance,” IEEE Aerospace Conference Proceedings, IEEE, New York, 2006, pp. 1–19. Google Scholar[37] Trainer M. G., Wong M. H., McConnochie T. H., Franz H. B., Atreya S. K., Conrad P. G., Lefévre F., Mahaffy P. R., Malespin C. A., Manning H. L., Martín-Torres J., Martínez G. M., McKay C. P., Navarro-Gonzílez R., Vicente-Retortillo A., Webster C. R. and Zorzano M.-P., “Seasonal Variations in Atmospheric Composition as Measured in Gale Crater, Mars,” Journal of Geophysical Research: Planets, Vol. 124, No. 11, 2019, pp. 3000–3024. https://doi.org/10.1029/2019JE006175 CrossrefGoogle Scholar[38] Girija A. P., Saikia S. J., Longuski J. M., Bhaskaran S., Smith M. S. and Cutts J. A., “Feasibility and Performance Analysis of Neptune Aerocapture Using Heritage Blunt-Body Aeroshells,” Journal of Spacecraft and Rockets, Vol. 57, No. 6, 2020, pp. 1186–1203. https://doi.org/10.2514/1.A34719 LinkGoogle Scholar[39] Lindal G. F., Lyons J. R., Sweetnam D. N., Eshleman V. R., Hinson D. P. and Tyler G. L., “The Atmosphere of Neptune: Results of Radio Occultation Measurements with the Voyager 2 Spacecraft,” Geophysical Research Letters, Vol. 17, No. 10, 1990, pp. 1733–1736. https://doi.org/10.1029/GL017i010p01733 CrossrefGoogle Scholar[40] Leslie F. and Justus C., “The NASA Marshall Space Flight Center Earth Global Reference Atmospheric Model—2010 Version,”  NASA  TM–2011–216467, 2011. Google Scholar[41] Justh H. L., “Mars Global Reference Atmospheric Model 2010 Version: Users Guide,”  NASA  TM–2014–217499, 2014. Google Scholar[42] Justh H. L., “Venus Global Reference Atmospheric Model,”  NASA  TR M17-6248, 2017, https://ntrs.nasa.gov/citations/20170012290 [retrieved 7 July 2021]. Google Scholar[43] Justh H. L. and Hoffman J., “Titan Global Reference Atmospheric Model (Titan-GRAM): User Guide,”  NASA  TM–20205006805, 2020. Google Scholar[44] Justh H. L. and Hoffman J., “Neptune Global Reference Atmospheric Model (Neptune-GRAM): User Guide,”  NASA  TM–20205001193, 2020. Google Scholar[45] Sutton K. and Graves R. A., “A General Stagnation-Point Convective-Heating Equation for Arbitrary Gas Mixtures,”  NASA  TR R-376, 1971. Google Scholar[46] Heidrich C., Roelke E. E., Albert S. W. and Braun R. D., “Comparative Study of Lift- and Drag-Modulation Control Strategies for Aerocapture,” 43rd Annual AAS Guidance, Navigation and Control Conference, AAS Paper  20-074, Univelt, Inc., San Diego, CA, 2020, pp. 627–642. Google Scholar[47] Braun R. D., Mitcheltree R. A. and Cheatwood F. M., “Mars Microprobe Entry-to-Impact Analysis,” Journal of Spacecraft and Rockets, Vol. 36, No. 3, 1999, pp. 412–420. https://doi.org/10.2514/2.3461. LinkGoogle Scholar[48] Goodwin J. and Wegner P., “Evolved Expendable Launch Vehicle Secondary Payload Adapter—Helping Technology Get to Space,” AIAA Space 2001 Conference and Exposition, AIAA Paper  2001-4701, Aug. 2001, pp. 1–7. https://doi.org/10.2514/6.2001-4701 LinkGoogle Scholar[49] Barba N. J., Komarek T. A., Stamekovic V., Giersh L. R., Woolley R. C. and Edwards C. D., “Small Spacecraft Capabilities for Mars Exploration,” Ninth International Conference on Mars, Lunar and Planetary Inst., LPI Contrib. No. 2089, 2019, https://www.hou.usra.edu/meetings/ninthmars2019/pdf/6341.pdf. Google Scholar[50] Albert S. W. and Braun R. D., “Conceptual Development of AeroDrop: Aerocapture and Direct Entry for Two Spacecraft on a Common Approach Trajectory,” AIAA SciTech 2020 Forum, AIAA Paper  2020-1737, Jan. 2020, pp. 1–20. https://doi.org/10.2514/6.2020-1737 LinkGoogle Scholar[51] Vallado D. A., Fundamentals of Astrodynamics and Applications, 4th ed., Microcosm Press, Hawthorne, CA, 2013, pp. 1041–1042. Google Scholar[52] Brugarolas P., “Guidance, Navigation and Control for the Entry, Descent, and Landing of the Mars 2020 Mission,” 40th Annual AAS Guidance and Control Conference, AAS Paper  17-031, Univelt, Inc., San Diego, CA, 2017, pp. 81–92, https://trs.jpl.nasa.gov/handle/2014/46389. Google Scholar[53] Brent R. P., Algorithms for Minimization Without Derivatives, Courier Corp., Englewood Cliffs, NJ, 2013. Google Scholar[54] Lu P., “Entry Guidance: A Unified Method,” Journal of Guidance, Control, and Dynamics, Vol. 37, No. 3, 2014, pp. 713–728. https://doi.org/10.2514/1.62605 LinkGoogle Scholar[55] Austin A., Nelessen A., Strauss B., Ravich J., Jesick M., Venkatapathy E., Beck R., Wercinski P., Aftosmis M., Wilder M., Allen G., Braun R., Werner M. and Roelke E., “SmallSat Aerocapture to Enable a New Paradigm of Planetary Missions,” 2019 IEEE Aerospace Conference, IEEE, New York, 2019, pp. 1–20. https://doi.org/10.1109/AERO.2019.8742220 Google Scholar[56] Roelke E., Hattis P. and Braun R., “Improved Atmospheric Estimation for Aerocapture Guidance,” AAS/AIAA Astrodynamics Specialist Conference, AAS Paper  19-725, Univelt, Inc., San Diego, CA, 2019, pp. 2415–2430. Google Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Toward the Autonomous Assembly of Large Telescopes Using CubeSat Rendezvous and Docking",
        "url": "https://arc.aiaa.org/doi/10.2514/1.A34945",
        "date": "20210928",
        "content": "AbstractThis paper describes the results of a system study for the in-space assembly of large optical telescopes using a building block approach involving multiple mirror segments. Such an approach is enabled by CubeSat rendezvous and docking and mirror steering technologies for compensating misalignment of the assembly. This concept thus removes the constraints imposed by the limited volume of launchers’ fairing, and hence larger telescope dimensions can be envisaged, leading to new observation capabilities. Each mirror segment is mounted on top of a small satellite, containing the miniaturized subsystems to achieve autonomous docking to either the service module containing the science instruments or other segments to build up the primary mirror. A systems’ design of all the elements constituting the assembly is provided, including tradeoffs, optimization, as well as mass and power budgets. The proposed solution scales with the size of the telescope and can be used to build primary mirrors as large as 20 m in diameter. The critical guidance, navigation, and control function is introduced, and related docking performances are presented. The results indicate that the in-space assembly of such large telescopes is feasible once these two key technologies are demonstrated in flight in the coming years.NomenclatureH¯orbital momentum direction in the LVLH frameR¯anti-radial direction in the LVLH frameUCubeSat Unit, a 10×10×10 [cm] standardized volumeV¯velocity direction in the LVLH frameΔVchange of orbital velocity, m/sPpower, WEenergy, WhI. IntroductionToday, the size of orbiting optical space telescopes is constrained by the necessity to launch a single monolithic spacecraft (SC) within the maximum available volume of launch vehicle fairings. The James Webb Space Telescope (JWST), meant to replace the Hubble Space Telescope (HST), was originally planned in 1996. This telescope, equipped with a 6.5-m-diam segmented primary mirror (M1), is a NASA–European Space Agency–Canadian Space Agency collaboration and is set for launch in 2021 with an Ariane 5 from Kourou, French Guyana [1]. Besides the advanced instrument suite, which must operate at temperatures as low as 6 K [2], the platform was designed to be foldable to cope with the launcher volume constraints. This implied a complex folding, with 40 deployable structures and 178 release mechanisms [3], which will be deployed during the trajectory to the sun–Earth L2 Lagrange point, thus requiring extensive testing on the ground. The Luvoir Space Telescope (LST), which could be a JWST successor, follows the same design approach. This telescope will be equipped with a primary mirror of no less than 8 or 15 m, depending on the chosen configuration, and will extensively rely on the lessons learned from the JWST.The idea to assemble large structures in space is not novel, especially for optical telescopes. One common approach for building such structures is to rely on robotic manipulators. The primary mirror is built out of passive segments, which are stacked on a service module equipped with robotic capabilities and in charge of assembling the mirror using an external manipulator [4–6]. Another way is to rely on rendezvous and docking (RVD) following a tug-based approach. The segments are stacked in a service module, and a tug satellite then docks to these mirrors and positions them in the assembly [7]. The last approach is to position each mirror segment on top of a fully functional SC. Each segment can then autonomously dock to the Support Service Module (SSM) [8]. Such an approach provides the most flexibility, as the SSM does not have to carry the stacked mirror segments during launch, and can thus be sent in orbit using a separate launcher. The major inconvenience of this approach is that it relies extensively on RVD, which is notoriously difficult to achieve. How CubeSat or small-satellites-based technologies can serve such a challenging mission has been investigated in [9]. Some of these technologies will be demonstrated in the Autonomous Assembly of a Reconfigurable Space Telescope (AAReST) mission [10], to be launched in the near future. AAReST is a CubeSat-based sparse telescope, which will reconfigure its aperture in orbit relying on RVD. To relax some of the requirements on the guidance, navigation, and control (GNC) subsystem, the docking mechanism relies on three powerful electromagnets, which help steer the chaser satellite for the last tens of centimeters.It is estimated that JWST will be able to characterize 10 exoEarth candidates. To have meaningful statistics on potential biological life on other planets, at least 30 candidates must be characterized, which could be achieved with at least a 12 m aperture [11]. In [12], an evolvable telescope is proposed, where the primary mirror (M1) is built in three successive stages, diluting the total cost over more than a decade, starting with a 4-m-diam mirror in stage 1, 12 m in stage 2, and 20 m in stage 3. In between each stage, the telescope remains operational, allowing immediate scientific benefits. Finally, in [13], it is found that for apertures smaller than 15 m, in-space assembly (ISA) contributes to a significant cost reduction compared with traditional approaches. For larger apertures, ISA is likely to be the only development approach.In this paper, a strategy relying on autonomous RVD techniques as well as miniaturized CubeSat-based sensors and actuators technologies to assemble primary mirrors of several meters in diameter is proposed. It relies only on technologies used, or about to be used, on CubeSat missions. Critical operational aspects have been included, such as the need for several launch vehicles delivering the telescope in space, and their impact on the system design taken into account. Although RVD has never been demonstrated in orbit, all the necessary miniaturized technologies will be demonstrated on European Space Agency’s (ESA’s) upcoming Rendezvous and docking Autonomous CubeSats Experiment (RACE) mission [14], and the GNC algorithms have been extensively studied [15]. Mirror segments composing the M1, which can be each actively shaped to mitigate assembly errors, gravity effects, as well as thermo-elastic variations, are mounted on top of a fully functional SC containing all of the necessary subsystems to achieve autonomous RVD to either the SSM or other mirror segments. The SSM contains the necessary instrument suite for the science, command and data handling (C&DH), electric power system (EPS), communication system (COM), and GNC, to support the strict mission and systems requirements of a large space telescope. The SSM will be based, when possible, on low-cost CubeSat or small satellite technologies. It is well understood that some of the SSM’s critical components will have to be based on flight-proven or high-reliability components coming from the domain of large satellites, such as the science instruments, optics, high-performance gyroscope, or reaction wheels, and sized according to the larger telescope assembly. As each mirror segment is an active satellite, the final assembly represents a distributed architecture offering a high level of redundancy as well as important computing capabilities. The proposed strategy scales with the size of the primary mirror and can range from few meters to tens of meters. It finally allows obtaining mirror’s area density lower than current studies, thus minimizing the total launch mass. To assess the capability of the strategy, the JWST is used as a design model for the M1 dimensions and secondary mirror (M2) dimension and positioning. The proposed strategy is then used to build out a 20-m-diam mirror, similar to the one proposed in the NASA iSAT study [13].This paper is structured as follows: In Sec. II, the specifications of the HST, the LST, and JWST are provided together with the mirror technology on which this paper is based. The calibration procedure for such an assembly is discussed. In Sec. III, the system design of the telescope is proposed, in particular the design of the mirror segments and SSM. In Sec. IV, the mission and GNC design for the assembly process is detailed together with a preliminary analysis to assess the performance of the proposed approach. Section V concludes the paper, identifying technological gaps and future work.II. Telescope Optical Design and PerformanceA. Existing Space TelescopesTable 1 shows key parameters of the HST, JWST, and LST. The JWST parameters are going to be used for the proposed design. The LST and HST parameters are shown for scalability and comparison reasons.JWST carries a suite of four instruments, two of which, MIRI and NIRSpec, are being developed by ESA [21,22]. To collect data, these instruments need a pointing accuracy of ∼6 marcsec. To achieve such a performance, Hubble relies on the most precise gyroscope ever manufactured. JWST Attitude Determination and Control System (ADCS) is divided into two parts [19]. First, a coarse mode achieves a pointing of 8 arcsec (1σ) per axis using two star-trackers, gyroscopes, and reaction wheels. At this point, the fine guidance mode takes over. It relies on a fine guidance sensor, which is using reference stars in the JWST focal plane, in combination with fine steering mirrors and reaction wheels. In fine guidance mode, JWST can maintain a pointing accuracy of 6 marcsec (root mean square [RMS]) over 15 s windows. The main advantage of such a design is that readily available ADCS sensors can be used, without the need for high-performance gyroscopes, which were critical components of the HST [23].B. Mirror Steering TechnologiesOne of the possible drawbacks of using independent segments docked together, instead of already mounted and pre-aligned structures using unfolding mechanisms, could be the resulting optical performances due to the RVD tolerances. Several techniques could, however, be used to enhance the independent mirrors optical quality as well as the total one. An available technology is the large aperture telescope technology (LATT) [24], which was initially thought for deploying large primary mirrors in space telescopes. Funded under an ESA research activity, LATT can provide active primary mirrors by using contact-less electromechanical actuators mounted inside a honeycomb structure that could result in a final wavefront error of ≤20  nm RMS; counteracting deployment errors, gravity effects, as well as thermo-elastic variations. The technique could be implemented on autonomous mirror segments with diameters ranging from 0.4 to 1.2 m and with a thickness from 1 to 2 mm. The mirrors are built out of Zerodur glass material, thus providing a final lightweight assembled element of 12–17  kg/m2. Each mirror could be mounted using between 20 and 200 actuators (depending on the mirror diameter) and requiring just around 60 mW of power per each actuator unit [24,25]. Each independent mirror segment would be able to enhance its optical quality and adjust mirror shape and flatness, in accordance with all the other segments.The precise number of actuators needed for the proposed case cannot be known at this level because it will require a more precise study. However, for mirror segments with few tens of centimeters of radius, it is estimated that approximately 30 actuators would be required on each segment (approximation using LATT experiment area). This would result in a total power of 1.8 W per mirror segment.C. Mirror Alignment: The JWST CaseThe alignment process is not defined at this early stage. However, the JWST methodology can be used as a starting point. The in-orbit alignment process of JWST is enabled through WaveFront Sensing and Control methods via phase retrieval on the through-focus point spread function image data taken by the science instrument. The alignment process includes coarse adjustments on the primary mirror segments to correct tip-tilt and piston alignment errors, followed by fine adjustments to phase the mirror to serve as a monolithic surface with the desired figure. Both alignments require the telescope to be pointed at a bright star and make use of one of the telescope instruments (NIRCam in the case of JWST). Large errors between the individual segments are measured using a dispersed fringe sensing technique [26]. A combination of a subaperture mask and prisms included in the NIRCam filter wheel spreads the star white light into monochromatic lines on a detector. In the presence of errors, the spectrum takes on the appearance of a barber-pole pattern, and correcting measures for each segment are determined by analyzing the fringes in the pattern [27].For the final precise alignment, the NIRCam takes 18 out-of-focus images of the reference star, one from each mirror segment (see Fig. 1). A phase retrieval algorithm is then used to reconstruct the wavefront and determine how the mirrors must be actuated. For JWST, the alignment begins 40 days after launch and takes several months to complete.Depending on the curvature radius and wavelengths observed, the accuracy should be in the submicron range. The same technique used for JWST would allow such accuracy. Nonetheless, for the ISA case presented in this paper, comprehensive studies will be necessary to determine the accuracy requirements and alignment strategy.Fig. 1 JWST M1 alignment sequence (credit: NASA).III. Telescope System DesignTo achieve a consistent design, a three-step approach is followed. First, mirror segments are designed to achieve a JWST-like primary mirror, with the objective to minimize the total launch mass. Then, the design of the M2 and a strategy to position it are provided. Finally, an SSM design is proposed, compatible with the M1 and M2 chosen configurations. Based on this design, the case of a 20-m-diam telescope is discussed.A. Assembly StrategyThe M1 of the assembly is built out by the autonomous rendezvous and docking of several modules to achieve a desired targeted surface. Each module consists of a hexagonal mirror mounted on top of a fully functional SC using miniaturized sensor and actuator technologies derived from nanosatellites. To have a flexible assembly, it is desired to design the system with a minimum of different modules, which can then be easily swapped if needed. This requirement means that the M1 cannot be assembled in a curved manner, as it would require the use of hexagonal and pentagonal modules. Using hexagons only, the M1 is assembled flat, and the curvature is provided using a dedicated mechanism to appropriately orient each mirror. An M1 assembly using docked hexagonal mirrors is shown in Fig. 2. Only two different families of modules are needed to build out any desired mirror’s size as shown in Table 2. These two types of segments only differ by the number of male or female docking mechanisms they carry.The assembly can be carried out in a systematic approach, always following the same sequence. For a given layer, first, the six segments with two female mechanisms are attached. Then, the modules with three female mechanisms are docked in a clockwise sequence, until the layer is complete. Using this approach, six segments are being docked at the same time, at different places of the assembly. This reduces the overall time needed for the assembly and limits the risk of collision between two modules in docking mode, as they never are in close vicinity. Such a design ensures maximal rigidity in the assembly, as all modules are interconnected. Note that the system is designed so that only one docking mechanism (out of two or three) must satisfy the docking constraints. The docking sequence is further elaborated below.Fig. 2 Assembly sequence (left) and final assembly (right) using hexagonal mirror segments. The red and blue arrows represent, respectively, the female and male docking mechanisms.Two different mission design approaches can be considered for ISA and are shown in Fig. 3. Note that a baseline 600 km sun synchronous orbit (SSO) is selected for the assembly. A low Earth orbit (LEO) is selected as it provides a maximum of launch windows to carry out the assembly. Geostationary orbit could be targeted, although that would prevent the use of the Vega launcher, which is a very suitable candidate to launch small satellites. In addition, geostationary orbit major impact will be on the COM and usage of the magnetic torques to unload the reaction wheels, leading to a mass increase compared with the LEO design. The GNC will also be affected, however, in a positive way, as the orbital mean motion is smaller in GEO, leading to smaller actuation requirements and thus fuel consumption. Finally, orbits such as around Lagrange points would require significant modification of the design. The specific case of ISA around Lagrange points has been addressed by GMV under an ESA contract [28].In a scenario with more than one launch, each segment must be capable of phasing maneuvers as the 3σ launcher accuracy is typically 15 km for the semimajor axis, 0.15 deg for the inclination, and 0.2 for the right ascension of ascending node (RAAN). The phasing is followed by a period of station-keeping (SK) in the proximity of the SSM while waiting to start the approach and to finally dock to the assembly. In a single-launch scenario, due to differential drag following the deployment from the launcher, an important separation may exist between the segments and the SSM, which may then also require phasing maneuvers. For this reason, mirror segments are based on a unique design, independent of the launch strategy. Launchers equipped with a propulsion stage capable of bringing the stack of mirror segment directly to the vicinity of the SSM would be an alternative, and could become available in a near future with the emergence of microlaunchers. This would thus remove the need to embark high-impulse propulsion system and simplify the design. This option has been discarded for now as such capability is not yet available.Fig. 3 Dual launch (left) and single-launch (right) scenarios.B. Mirror Segments System DesignEach hexagonal module is based on CubeSat technologies and must be capable of autonomous RVD, i.e., potentially long phasing maneuvers as well as precise six-degree-of-freedom (6-DoF) control. The hardware serving this purpose represents a fixed mass and volume. The structure and mirror mass scale with the size of the modules. They can thus be optimized to limit the total launch mass. All subsystems are based on commercial-off-the-shelf (COTS) components. Most of the CubeSat’s COTS performances in terms of mass, power, and volume are very similar and can be procured from different companies. Because of the important mass difference between the total mass of a mirror segment compared with the mass of individual CubeSat components, the detail of each subsystem will not be provided. Instead, mass, power, and volume envelopes are allocated, representative of the European state-of-the-art CubeSat technologies. Only parts of the subsystems, which are mission-critical such as the propulsion, docking mechanism, or intersatellite link (ISL), are briefly detailed below.For a cooperative RVD scenario, the two segments to be docked together must be in communication with each other. Hence, an ISL is required. Such an ISL is being developed by GOMSpace Denmark as part of the RACE ESA mission Phase A/B. It is an S-band system allowing communication over distances of several kilometers at a rate of 19.2 kbps.To achieve the RVD, two different propulsion systems are necessary. For phasing and SK maneuvers, an electric propulsion (EP) system is chosen. The Nano AR3 thruster from Enpulsion [29] is capable of delivering thrust between 0.01 and 0.4 mN with a specific impulse (Isp) from 2000 to 6000 s, and a fuel mass of 230 g. Depending on the chosen operating point, the required power varies between 8 and 40 W. This system can deliver an impulse of more than 5000  N⋅s and has a thrust vector capability of up to 24 deg. Two of these thrusters are baselined and can be used for phasing and SK maneuvers. Because of the high power consumption and peak power constraints of the EP, the EPS shall be selected accordingly. Compatible subsystems are readily available on the market.For precise relative position and attitude control, a 6-DoF cold gas system is required. Such a system is being developed by GOMSpace Sweden under an ESA contract and its performances will be demonstrated on the RACE mission. A 1 DoF version of this system was already successfully flown on the GOMX-4b mission [30]. This system is composed of two modules, with six thrusters per module delivering 1 mN of thrust per nozzle and a minimum impulse bit (MIB) as small as 25  μN⋅s. It can carry a total of 250 g of butane and has an Isp of ∼57  s. A version with 10 mN of thrust per nozzle also exists and is going to be assumed in this study due to the control acceleration required to achieve docking. Each thruster can be canted, as shown in Fig. 4, allowing the system to be accommodated on a variety of SC.The selected GNC on-board computer (OBC) is based on the Xilinx z7000 System on a Chip (SoC) and is produced by GOMSpace Denmark [31]. This computer is a candidate for the RACE mission, and a processor-in-the-loop campaign, carried out by GMV Poland, has shown that it is capable of executing advanced RVD GNC algorithms in real-time, including image processing of the light-emitting diodes (LEDs) pattern on the target SC.Fig. 4 One of the two propulsion modules with canted thrusters, as integrated on both RACE satellites (credit: GOMSpace DK).Two types of Global Navigation Satellite Systems (GNSSs) are required for the mission. During phasing, a low-power-consumption absolute GNSS is sufficient, with an accuracy of a few meters [32]. However, for close-proximity operations, a precise relative GNSS is required. This is achieved using precise point positioning (PPP) GNSS. This technology allows a satellite to know its position with an accuracy better than 10 cm and 5  mm/s (3D RMS) and is currently being developed at ESA [33]. With such a technology, relative positioning between two nearby satellites could be known with sufficient accuracy to navigate a chaser satellite down to a 10 m range from a target satellite.Preliminary development of a docking system and vision navigation can be found in [15] and is shown in Fig. 5. Both parts of the docking mechanism fit in a volume of 0.5 CubeSat unit (U) each. It can tolerate misalignment of 2 deg around each axis and lateral displacements of 1 cm. The vision-based navigation (VBN) includes a camera, on the chaser side (10-megapixel monochromatic sensor, 4 mm focal length) and LEDs on the target side (see Fig. 6), serving the strict navigation requirements to complete the docking [34]. Experimental results show that each LED can be detected with a subpixel resolution of 0.06 pixel (1σ). Such VBN provides accuracy better than 1% of the range from 10 m (range between the camera and the LEDs) down to docking, with a final accuracy better than 1 mm at ranges smaller than 10 cm.To align the male and female parts of the docking system, pins are protruding from the mechanism on the target part. To avoid undesired contacts between the different mechanisms, only one docking system out of two or three (depending on the segment) is equipped with these pins (represented by bold arrows in Fig. 5). This active mechanism will be the only one equipped with a camera and LEDs. After successful hard docking of the active mechanism, using three threaded rods rigidly linking the two parts of the system, the remaining mechanisms deploy their docking screws finalizing the assembly. As mentioned above, with such an approach, only one docking mechanism must satisfy the docking requirements, and each mirror segment is linked to the assembly by six rigid connections. Note that future finite elements analyses will be required to assess the thermomechanical stability of the M1 assembly. Finally, as explained in Sec. III.A, the various mirror segments are assembled in a plane. To achieve a given curvature of the M1, each mirror is mounted on three deployable booms. These three booms, combined with the contactless electromechanical actuators, allow realizing the desired M1 configuration. The flight-tested deployable boom from Oxford Space Systems is a possible choice and compatible with JWST sagitta [35]. Because this technology will require some design iteration to meet the accuracy requirement of an optical telescope, a considerable mass allocation has been added to the actual mass of the mechanism. Note that because each mirror is positioned on deployable booms, the gap between the SC body and the mirror can be fine-tuned to meet thermal requirements, contributing to the overall telescope performance. Submicron positioning accuracy of the mirrors using the boom will be challenging to achieve. The final accuracy will be improved by actively shaping the mirrors and closing the loop with dedicated sensors. The fine mirror alignment and wavefront sensing techniques that will be demonstrated within the AAReST mission, for active control of the mirrors, will provide an essential first step and can be used for larger assemblies [10].Fig. 5 Docking mechanism [15] (left) and positions on the segments (right). The bold arrows represent the docking mechanisms equipped with pins.Fig. 6 LED pattern used by the VBN. The outer pattern is used between 10 and 5 m range. The central pattern is used from 5 m to docking.C. Launch Mass OptimizationOn each mirror segment, the GNC, EPS, C&DH, COM, and propulsion represent a fixed mass of 24.1 kg (without system margin). The mass of the structure, side panels, and mirror depend on the final dimensions of the hexagon and can be selected so that the total launch mass is minimized. A mass of 17  kg/m2 is assumed for the mirror, based on the previous proposed LATT technique. The mass of the satellite primary structure is extrapolated from COTS 1, 3, 6, and 12 U structures. Finally, the mass of the side panels is extrapolated based on the mass of a single 3 U panel containing eight solar cells. Because the mass of the structure and panels depend on the segment’s total volume and surface, respectively, a segment’s height of 15 cm will be assumed, compatible with subsystems satisfying the CubeSat form factor. The following assumptions are made: The SSM has a surface equivalent to seven hexagons (see Fig. 2).The mirror segments shall have a surface allowing to be accommodated on a Vega-C launcher, as shown in Fig. 7. This ensures maximum flexibility for the launch campaign design, as well as compatibility with larger launchers.The SSM shall have a surface allowing it to be accommodated on a Vega-C, or an Ariane 6 if combined with mirror segments.Assuming the propulsion system described in Sec. III.B, each mirror segment shall have a control acceleration allowing a successful docking. In addition, each segment shall be able to stay in SK at a range of 20 m cross-track (in the local-vertical/local-horizontal [LVLH] frame).The total volume of a segment shall be larger than 30 U (minimum required volume to accommodate all the necessary subsystems).The segment mass shall be compatible with the ΔV for phasing (40  m/s) and docking (1.5  m/s) (see Sec. IV for the rationale).Fig. 7 Segments and SSM accommodated on Ariane 6 (left). Segments accommodated on Vega-C (right). Both views are from the top. The segments are stacked vertically.The aim is to minimize the number of segments constituting the M1. Because of the way the M1 is built, there is always an optimal configuration between the surface of the segments versus the number of concentric layers. The example in Fig. 2 shows an assembly with three concentric layers. The number of segments needed to build a 27  m2 mirror as well as the actual surface of the mirror is shown in Fig. 8a. The plots are built using the following approach: for each segment size, configurations with different numbers of concentric layers are systematically computed. The configuration leading to at least 27  m2 with the minimum number of mirrors is kept. Increasing the surface of the individual segments increases the total M1 surface, until a point where to meet the 27  m2 target, it is advantageous to remove a full concentric layer, leading to this saw-tooth pattern for the total mirror surface area. Figure 8b shows the launch mass, computed using the definition of the mirror, structure, and side panels, parameterized with the radius of the segment. The launch mass is minimized by increasing the radius of the segments, as can be expected. This, however, does not satisfy the other constraints, i.e., fuel availability for docking and phasing, control acceleration, as well as volume availability. These constraints are shown in Fig. 9 and are computed based on the total mass and dimensions of the segments. As it can be seen, the maximum constraint comes from the available ΔV for the docking phase. This imposes an upper bound of 0.63 m on the segments’ radius.As shown in Fig. 7, two options are considered for the launch, using either Vega-C or Ariane 6. Their fairing dimensions put a constraint on the maximum radius, as shown in Fig. 10. For both launch configurations, the maximum allowed radius is then 0.5 m.Fig. 8 As a function of the segments’ radius: a) total M1 surface and number of segments, and b) total launch mass of the segments. Vega-C capacity in LEO is shown for reference.Fig. 9 As a function of the segments’ radius: a) control acceleration provided by the cold gas propulsion, b) available docking ΔV using the cold gas propulsion, c) available docking ΔV using the EP, and d) volume available in the SC.This then leads to an optimal segment’s radius of 0.44 m (see Fig. 8b). Such configuration will require a minimum of two Vega-C launches. It should be noted that there is a comfortable margin on the total launch mass. Once the structure to accommodate the segments in the fairing is designed, the remaining launch mass can be used to maximize the M1 surface, not exceeding the upper limit of 35  m2, corresponding to a 0.5 m segment’s radius. It is clear that the segments cannot be considered as CubeSats considering that the mass and form factor are not satisfying any of the specifications. Nonetheless, they are only relying on CubeSat technologies.Fig. 10 As a function of the segments’ radius: a) segments and SSM surface occupation in Vega-C, and b) combined segments and SSM surface occupation in Ariane 6.D. Mirror Segments BudgetsA radius of 0.44 m corresponds to a total mass of 60.87 kg per segment and a total of 54 mirrors to build up a 27  m2 M1 assembly. The total mass budget is shown in Table 3. The margin policy used for ESA CubeSat In-Orbit Demonstration (IOD) missions is applied for the mass and power (20% for new developments or existing units requiring major modifications, 10% for existing units requiring minor modifications, 5% for existing units, and a 20% system margin), as well ΔV (10% margin in total for low-thrust maneuvers) [36]. For volumes, a component margin of 10% is assumed to account for the harness as well as a 20% system margin. The dimensions of the segments are provided in Fig. 11. With such dimensions, a total volume of 100 U is available in each segment. The maximum mass per segment is limited by the fuel available for the docking. In the current configuration, a margin of 32 kg is available per segment, which can be used to cover the uncertainties present in the design.The mirror segments’ power budget is shown in Table 4, and it is built using information readily available from the COTS manufacturers. The following assumptions are made: To generate power, all the usable surface is assumed covered with CubeSat solar cells generating each 1 W of power. Whenever possible, the +z face is pointed toward the sun to maximize power generation. When not possible, e.g., during maneuvers or communication with the ground segment, it is assumed that 10% of the total cells can generate power.During phasing, it is assumed that 40% of the time is spent thrusting and that the EP is operated at 30 W, i.e., 0.35 mN.For the other mission phases, the EP is used at its maximum power of 40 W delivering 0.4 mN of thrust.A 25% depth of discharge (DoD) is assumed during all mission phases with an 80% remaining capacity (capacity after 1700 cycles).During docking, a DoD of 80% is accepted, as only happening once at the end of the mission.Fig. 11 Mirror segment representation with docking mechanisms in blue and propulsion in purple. The thrusters in the x and z directions are canted.Two of the most power-demanding modes are investigated: phasing and docking. For phasing, only EP is used. For the docking mode, which lasts over two orbits, it is assumed that EP and cold gas are both used in equal parts.Using EP for phasing puts considerable stress on the power budget and impacts the trajectory design; to have an energy-balanced budget, 60% of the time must be spent coasting, charging the batteries. A cold gas system could be used instead, which would have the advantage to reduce the phasing time of flight and the power needs. This can be done by including two titanium cylindrical tanks to store 6 kg of butane for the 6-DoF propulsion system, each weighing 710 g with a 14 cm diameter and a 47 cm length. That would lead to a wet mass of 65 kg for the mirror segments and 50  m/sΔV capability, compatible with the total ΔV requirements. Such an approach increases the wet mass by ∼10% and puts a significant constraint on the ΔV capabilities. For these reasons, the EP solution has been preferred.E. Secondary MirrorJWST’s M2 is positioned 7.2 m away from the M1 plane. This is achieved using a deployable tripod, which guarantees stability. This solution could not be used here due to the dimensions of such a system. The positioning of the M2 is achieved by docking six 12 U CubeSats, as shown in Fig. 12.Because of stray light, it would not be recommended to have solar cells on the boom segments and M2 module. They must, therefore, carry out all the docking relying only on batteries and shall thus be launched docked to the SSM. Six 12 U boom segments are needed. Each segment carries three docking mechanisms, two located at the ends, and one on the side. The 12 U’s are docked on top of each other and the M2 is attached using the side mechanism. The side mechanisms on the boom elements are used during the launch to attach the segments to the side of the SSM. The boom segments and M2 will only rely on cold gas, as no EP is required for long phasing maneuvers. At this level, the M2 and boom segments are based on the same systems’ design as the M1 segments (without EP, solar cells, and reduced number of batteries). The mass of the M2 and boom segments is provided in Sec. III.G.Fig. 12 Complete assembly concept with final dimensions of the M1 segments, M2, and boom segments.Based on the M1 segments’ budget, the total power needed for the M2 and 12 U CubeSats is 14.19 W. The battery capacity has been selected assuming that it would take two orbits between separation from the SSM until docking. This hypothesis is valid as the commissioning of the boom segments and M2 can take place while attached to the SSM. In the current configuration (77 W·h per battery, 80% DoD, 80% capacity), the batteries offer enough energy to offer a 30% margin on the available docking time.The proposed approach provides a lot of flexibility as the dimensions of each boom segment can be adapted to meet focal length and stability requirements as well as to minimize the optical path obstruction. At the moment, the M2 segment has the same size as the M1 segments. However, as it is a unique element of the assembly, its size can be specifically tailored to optimize the performance of the telescope.F. Support Service Module DesignThe SSM is represented by the gray hexagons in Fig. 12. Depending on the configuration, mirrors could be added to cover its surface and increase the collecting area. The SSM carries all the necessary technologies to achieve the necessary pointing accuracy for the complete large telescope assembly and carries the science instruments. It is based on European high-reliability equipment with flight heritage for large satellites. The list of equipment is detailed in the mass budget (see Table 5). Only the COM and GNSS PPP subsystems are based on CubeSat COTS equipment. To have the same GNSS PPP between the SSM and mirror segments is advantageous as it ensures consistent and coherent measurements for relative navigation purposes. In the same way, identical COM on both segments and SSM will simplify the ground segment and operations. A considerable redundancy can be planned due to the low mass of the subsystems, thus ensuring the reliability of the function. Note that this assumption is valid for LEO. For higher altitude orbits, this would need to be reassessed as the environment, in particular radiation conditions, is different.The EPS is sized to provide 2100 W over 5 h without power generation. This number is based on HST and should cover the power need for the mirror segments actuators, as well as scientific instruments. Using the design steps in [37], an allocation for batteries and the solar panel could be included in the budget (assuming a 100% margin on the power generation). Note that as each mirror segment is covered with solar cells; they represent a secondary source of power that can be routed to the SSM via electrical interconnects in the docking mechanisms. For a JWST like M1 built out of 54 segments, that corresponds to 6696 cells, each producing 1 W. Consequently, the solar panel of the SSM could be further minimized to save mass. The structure mass is estimated to be 20% of the dry mass without systems margin. The SSM carries 18 docking mechanisms for the mirror segments assembly and an additional three mechanisms located at the rear of the bus. These three mechanisms provide docking points for potential future servicing missions. This would also allow a tug satellite, for example, to modify the telescope orbit. As explained earlier, the SSM, six boom segments, and M2 must all be launched together, and fit within the mass envelope of a Vega-C (i.e., 2300 kg for 600 km SSO). With this constraint, an allocation of 850 kg can be made for the science instruments and dedicated thermal control. The SSM mass budget is provided in Table 5. In the current design, the fine guidance sensor is assumed to be part of the science suite. The pointing requirements and final selection of the GNC sensor and actuator suit will be finalized once the telescope design is fixed and the science instruments are defined.G. Assembly Mass BudgetThe total mass budget of an assembled telescope with a collecting area equivalent to the one of JWST is provided in Table 6. As a comparison, the JWST current wet mass is 6500 kg.The 54 mirrors are launched using two Vega-C (1644 kg per launcher). With a maximal payload mass of 2300 kg per launcher, this leaves more than 656 kg for the dispenser structure, for stacking the mirror segments, and as margin. The SSM, M2, and boom have a total mass of 2293.5 kg, including the launcher’s payload adapter ring. This leads to a total of three Vega-C.If more mass for science was required, an option using an Ariane 62 (6300 kg into 600 km SSO) could be envisaged. Still using one Vega-C for half of the mirror segments and an Ariane 62 for the remaining of the elements, using the configuration shown in Fig. 7, a 2430 kg allocation for the science instrumentation and thermal management would be available, leading to a total telescope mass of 7931.94 kg.As mentioned in the introduction, 20-m-diam class telescopes are now being researched. Using the proposed approach and with the current configuration, 540 mirror segments would be required in order to achieve a collecting area of 270  m2. With the 2430 kg allocation for science and thermal, a 20-m-diam mirror would require two Ariane 64 (14,700 kg into 600 km SSO) and at four Vega-C launches for a total mass of 37,518 kg. The launch mass can be further optimized if only Ariane 6 is used as it removes the constraints coming from Vega-C, and allows for larger mirror segments to be accommodated within the fairing. With 0.63 m radius hexagons, only 264 mirror segments would be required using the current design (each with a 93 kg wet mass, compatible with the docking ΔV requirement), and would fit within two Ariane 64. This represents a mass reduction of more than 8000 kg compared with the scenario using Vega-C. The M2, boom segments, and SSM can be launched using one Ariane 62 (with 2430 kg for science and thermal). Note that a 20 m aperture mirror is not a hard upper bound, and even larger telescopes could be targeted. One of the main limiting factors will be the flexible modes, which will inevitably increase with the size of the primary, and the boom length required for the curvature. As shown in Table 1, each telescope design comes with a specific M1 radius of curvature and thus distance to M2. However, with the proposed approach, a variety of telescope designs could be achieved by adapting the size and number of building blocks.The science capabilities of the proposed design are not precisely defined at this level; it is thus not possible to assess the scientific return per kilogram of SC with the JWST or LST. However, it can be seen that the total mass budget of the 27  m2 mirror is similar to JWST’s total mass. The 20-m-diam mirror offers a smaller overall launch mass than the LST. For LST-A, the primary mirror has an area density of 134  kg/m2. Here, the 20-m-diam mirror has an area density of 122  kg/m2 and goes down to 91  kg/m2 for the optimized version, representing a 32% mass reduction per square meter compared with LST-A. These numbers must of course be put in perspective as more detailed analysis may require increasing the thickness of the segments to increase stability throughout the primary, which would increase the area density. Nonetheless, it shows that the proposed approach has the potential to offer significant mass reduction.IV. Close Proximity Operations and GNCTwo different systems have been proposed concerning propulsion. The baseline version includes EP, capable of delivering a ΔV of 187  m/s, and a cold gas 6-DoF system delivering 2.37  m/s. The pure cold gas version is capable of delivering 50  m/s. The ΔV for the phasing can be approximated using Edelbaum formulation [38]. If only the launch uncertainties are to be mitigated, a 40  m/sΔV (including 10% margin) is required. This number assumes continuous thrust. Therefore, an optimized trajectory that includes coasting periods to satisfy the power budget will need to be computed in the future. Preliminary results using optimized low-thrust trajectories show that such a transfer is possible thrusting for only 40% of the time. Note that the selected EP system offers a lot of flexibility, and longer thrust arcs could be designed if lower thrust values, and thus power, were to be used. Using a Hohman-transfer-like approach, a 34  m/sΔV (including 10% margin) is necessary. Therefore, the two proposed designs for the segments (version with EP or with cold gas only) can provide sufficient ΔV to achieve both high- and low-thrust transfers.The proposed approach for close-proximity operations is provided in Fig. 13. Recall that due to the design of the assembly, six segments can always dock simultaneously. The segments are maintaining SK at 500 m range in V¯ of the LVLH frame, in an elliptic, passively safe relative trajectory, requiring only minimal fuel consumption. From the SK ellipse, six satellites at a time can maneuver to a hold point at a 30 m range, from which the 10 m from the docking port hold point can be targeted, and the docking sequence can start. Depending on the free drift speed, at most 1  m/s of ΔV is necessary to bring the segments from 500 to 30 m range, and it is provided by the EP. The segments will follow a forced straight-line trajectory with intermediate hold points at 5 and 2.5 m range from the docking port.Note that EP can be used until the hold point at a 30 m range along-track. The 6-DoF cold gas propulsion is only needed for the last fly-around and the forced straight-line approach. After phasing, the EP is still capable of delivering 147  m/s, which leaves a very comfortable margin for SK maneuvers and the controlled approach to the 30 m hold point.Fig. 13 RVD close-proximity operations.The GNC for RVD is thoroughly described in [15] and the same design has been used here. It is composed of a vision based-navigation, using the camera and LEDs embedded in the docking mechanism, and an H-Infinity controller. The GNC for the final docking is 6 DoF and includes coupling between rotations and translations. The tuning of the GNC algorithms is identical to [15]; only the mass and inertia of the chaser and target have been adapted, as well as the positioning and orientations of the docking ports. It is executed on the GNC OBC, consisting of two microcontrollers, running at up to 866 MHz, and an field programmable gate array (FPGA). Using these algorithms, any docking port of the telescope assembly can be targeted without changing the tuning of the GNC. Because of the relative dynamics, docking segments far from the target center of mass is more challenging. Figure 14 shows one of the most challenging locations to dock to, due to the important relative dynamics.A total of 300 Monte Carlo simulations have been executed. Uncertainties on the mirror segment’s (chaser) and SSM’s (target) mass, inertia, delay, and sensors’ noise have been included. Figure 14b shows the Monte Carlo in the LVLH frame. The docking accuracy and position in the docking port frame are shown in Fig. 15. The docking requirements for the GNC are 1 deg and 5 mm lateral (relative misalignment between the chaser and target docking mechanisms). This includes a 100% margin compared with the performance requirements of the docking mechanism (see Sec. III.B). All simulated approaches are well within the requirement and a ΔV of 0.5  m/s is needed. To cover the whole docking sequence starting at 30 m along-track, a total ΔV of 1.5  m/s is provisioned, which leaves a margin of 0.9  m/s for the selected cold gas system.Fig. 14 Graphical representation of the final 5 m of the docking (a) and Monte Carlo simulation (b). In (b), the red circle represents the edge of a 10-m-radius M1. The red marker represents the initial position of the chaser. The chaser trajectory is represented in blue.Fig. 15 Relative position in the docking port frame (a) and accuracy at docking (b). The red marks are the performance requirements.V. ConclusionsAn ISA strategy based exclusively on RVD is proposed. Relying on CubeSat-based miniaturized technologies, 88-cm-diam hexagonal mirror segments could be designed to create a segmented M1 with a diameter ranging from 6.7 to 20 m. This requires the docking of 54 segments for the 6.7 m version and up to 540 mirror segments for the 20 m aperture, with a possibility to reduce this number to 264 segments by increasing the size of the segments. The proposed approached can meet the docking requirements using technologies that will be demonstrated in-orbit during the upcoming ESA RACE CubeSat mission, increasing the confidence that such an approach can potentially be feasible.It is well understood that ISA using CubeSat components will not lead to a low-cost mission. It can provide, however, significant flexibility in the development itself and contributes to lowering the overall cost. The assembly being adaptable and based on identical segments, the launch of the various elements can be spread over time using multiple launches without compromising the mission.Several key elements have not been addressed in this study. In particular, the initial alignment accuracy between all the segments and the needed fine alignment strategy to reach submicron-level accuracy (depending on the final telescope design) needs to be investigated in detail. The analysis of the thermomechanical stability of the M1 and M2 needs to be conducted to assess the optical performance that such an assembly would provide, and assess the required stroke for the mirror steering mechanisms. For the M1, should a more rigid assembly be required, the height of each mirror segment could be increased at the expense of additional mass, leading, however, to an increased power generation, which could help decrease the phasing time of flight. For the M2, the main concern is the flexible modes in the 7.2 m boom. Here, the boom is built out of six CubeSats with dimensions 0.1×0.1×1.2  m3. These dimensions can be later precisely determined to achieve an M1–M2 boom stiffness compatible with the telescope design. The docking system will need to be adapted to sustain loads of the assembly during slew maneuvers. A capability for power and data transfer will also need to be included. Note that the mechanism is already designed to include such a connection. The deployable booms supporting the mirror segments, and providing coarse alignment, are based on a flight-proven technology. However, it will need to undergo a considerable redesign to meet the strict optical alignments requirements.Although detailed analyses are needed for different subsystems and critical technologies, the proposed system design offers sufficient margins so that it would remain valid even with a significant mass increase of different subsystems (a 52% mass margin is available).Another aspect of the proposed approach is the obsolescence of the various pieces of equipment in the mirror segments of the M1, the CubeSats of the boom, and the M2. As already mentioned, the solar cells of the M1 segments can be used to generate power. The GNC OBC on each mirror segment carries two microcontrollers, running at up to 866 MHz, and an FPGA. With 54 segments in the M1, this leads to the most powerful computing capability ever launched in orbit and could be used collectively in a parallel network to preprocess the science data before downlink to ground. Finally, the complete suite of GNC sensors and actuators on each mirror segment could be fused in the main GNC loop to further improve the pointing accuracy and stability of the overall telescope assembly.Although the world of space telescopes is usually reserved for large satellites, this study shows that CubeSat-derived technologies can potentially meet the strict requirements of in-space assembly using RVD techniques. With such technologies maturing as a result of ongoing development activities, and on the verge of being demonstrated during the ESA RACE mission in the near future, it is expected that the assembly of large structures in space can become technically feasible using RVD of building blocks, thus leading to significant improvements in astronomical observations and greater scientific knowledge about the universe.V. J. LappasAssociate EditorAcknowledgmentsThe authors would like to thank Matthew Smith, Finn Ankersen, and Kate Isaac, from European Space Research and Technology Centre—European Space Agency, for their support and expertise.\r            References\r        [1] “James Webb Space Telescope (WEBB/JWST) NASA,” NASA, March 2021, https://jwst.nasa.gov. Google Scholar[2] “JWST Instrumentation,” Space Telescope Science Institute, March 2021, http://www.stsci.edu/home/jwst/instrumentation. Google Scholar[3] Keith Belvin W., “Assembly In-Space: NASA Perspective and Experience,” Presentation, NASA, Nov. 2018, https://www.nasa.gov/sites/default/files/atoms/files/st_partnership_isa_open_forum_presentations.pdf. Google Scholar[4] Nanjangud A., Underwood C. I., Bridges C. P., Saaj C. M., Sweeting S. M. and Bianco P., “Towards Robotic On-Orbit Assembly of Large Space Telescopes: Mission Architectures, Concepts, and Analyses,” International Astronautical Congress, 2019, International Astronautical Federation (IAF), Paris, France, p. 25. Google Scholar[5] Lee N., Backes P., Burdick J., Pellegrino S., Fuller C., Hogstrom K., Kennedy B., Kim J., Mukherjee R., Seubert C. and Wu Y.-H., “Architecture for In-Space Robotic Assembly of a Modular Space Telescope,” Journal of Astronomical Telescopes, Instruments, and Systems, Vol. 2, No. 4, 2016, Paper 041207. https://doi.org/10.1117/1.JATIS.2.4.041207 CrossrefGoogle Scholar[6] Oegerle W. R., Purves L. R., Budinoff J. G., Moe R. V., Carnahan T. M., Evans D. C. and Kim C. K., “Concept for a Large Scalable Space Telescope: In-Space Assembly,” Space Telescopes and Instrumentation I: Optical, Infrared, and Millimeter, Vol. 6265, International Soc. for Optics and Photonics, Bellingham, WA, 2006, Paper 62652C. https://doi.org/10.1117/12.672244 Google Scholar[7] Miller D. W., Mohan S. and Budinoff J., “Assembly of a Large Modular Optical Telescope (ALMOST),” Space Telescopes and Instrumentation 2008: Optical, Infrared, and Millimeter, edited by Oschmann J. M., de Graauw M. W. M. and MacEwen H. A., International Soc. for Optics and Photonics, Bellingham, WA, 2008, Paper 70102H. https://doi.org/10.1117/12.788566 Google Scholar[8] Ward K., Kisdi A., Tubby W. and Marchetaux G., “The Hexswarm Mission,” Proceedings Small Satellite Systems and Services—The 4S Symposium, Majorca Spain, May 2014. Google Scholar[9] Saunders C., Lobb D., Sweeting M. and Gao Y., “Building Large Telescopes in Orbit Using Small Satellites,” Acta Astronautica, Vol. 141, Dec. 2017, pp. 183–195. https://doi.org/10.1016/j.actaastro.2017.09.022 CrossrefGoogle Scholar[10] Underwood C., Pellegrino S., Lappas V. J., Bridges C. P. and Baker J., “Using CubeSat/Micro-Satellite Technology to Demonstrate the Autonomous Assembly of a Reconfigurable Space Telescope (AAReST),” Acta Astronautica, Vol. 114, Sept.–Oct. 2015, pp. 112–122. https://doi.org/10.1016/j.actaastro.2015.04.008 CrossrefGoogle Scholar[11] Boyd I. D., Buenconsejo R. S., Piskorz D., Lal B., Crane K. W. and De La Rosa Blanco E., “On-Orbit Manufacturing and Assembly of Spacecraft,”  IDA Science & Technology Policy Inst., IDA Paper P-8335, Washington, D.C., 2017. Google Scholar[12] Polidan R. S., Breckinridge J. B., Lillie C. F., MacEwen H. A., Flannery M. R. and Dailey D. R., “An Evolvable Space Telescope for Future Astronomical Missions,” Space Telescopes and Instrumentation 2014: Optical, Infrared, and Millimeter Wave, Vol. 9143, International Soc. for Optics and Photonics, 2014, Paper 914319. https://doi.org/10.1117/12.2057161 Google Scholar[13] Mukherjee R., Siegler N., Thronson H., Aaron K., Arenberg J. and Backes P., “When is it Worth Assembling Observatories in Space? Astro2020 APC Whitepaper,” Astro2020 APC Whitepaper, Jet Propulsion Lab., California Inst. of Technology, Pasadena, CA, 2019. Google Scholar[14] “Technology CubeSats,” European Space Agency, Aug. 2021, https://www.esa.int/Enabling_Support/Space_Engineering_Technology/Technology_CubeSats. Google Scholar[15] Pirat C., “Guidance, Navigation and Control for Autonomous Rendezvous and Docking of Nano-Satellites,” Ph.D. Thesis,  École Polytechnique Fédérale de Lausanne, Lausanne, Switzerland, Dec. 2018. Google Scholar[16] Garner R., “NASA, ‘Hubble Space Telescope,’ ” NASA, May 2020, http://www.nasa.gov/content/goddard/hubble-space-telescope-optics-system. Google Scholar[17] Stahl H. P., “Testing the James Webb Space Telescope Primary Mirror,” 38th Optical Society of India Symposium: International Conference on Optics and Optoelectronics, 2014. Google Scholar[18] Lightsey P. A., Atkinson C. B., Clampin M. C. and Feinberg L. D., “James Webb Space Telescope: Large Deployable Cryogenic Telescope in Space,” Optical Engineering, Vol. 51, No. 1, 2012, Paper 011003. https://doi.org/10.1117/1.OE.51.1.011003 CrossrefGoogle Scholar[19] “JWST Pointing Performance—JWST User Documentation,” James Webb Space Telescope User Documentation, May 2021, https://jwst-docs.stsci.edu/jwst-observatory-hardware/jwst-pointing-performance. Google Scholar[20] LUVOIR Team, “The LUVOIR Final Report,”  NASA TR, Aug. 2019, https://asd.gsfc.nasa.gov/luvoir/reports/LUVOIR_FinalReport_2019-08-26.pdf. Google Scholar[21] “ESA—JWST NIRSpec Factsheet,” European Space Agency, May 2021, http://www.esa.int/Science_Exploration/Space_Science/JWST_NIRSpec_factsheet. Google Scholar[22] “ESA—JWST MIRI Factsheet,” European Space Agency, May 2021, https://www.esa.int/Science_Exploration/Space_Science/JWST_MIRI_factsheet. Google Scholar[23] “ESA/Hubble,” Space Telescope Science Institute, May 2021, https://www.spacetelescope.org/. Google Scholar[24] Briguglio R., Xompero M., Riccardi A., Lisi F., Duò F., Vettore C., Gallieni D., Tintori M., Lazzarini P., Patauner C., Biasi R., D’Amato F., Pucci M. and do Carmo J. P., “Development of Large Aperture Telescope Technology (LATT): Test Results on a Demonstrator Bread-Board,” International Conference on Space Optics — ICSO 2014, Vol. 10563, International Soc. for Optics and Photonics, 2017, Paper 105634F. https://doi.org/10.1117/12.2304228 Google Scholar[25] Briguglio R., Arcidiacono C., Xompero M., Lisi F., Riccardi A., Biasi R., Patauner C., Gallieni D., Lazzarini P., Tintori M., d’Amato F., Pucci M., Duò F., Vettore C. and Marchi A. Z., “The LATT Way towards Large Active Primaries for Space Telescopes,” Space Telescopes and Instrumentation 2016: Optical, Infrared, and Millimeter Wave, Vol. 9904, International Soc. for Optics and Photonics, Bellingham, WA, 2016, Paper 99041B. https://doi.org/10.1117/12.2231712. Google Scholar[26] Scott Acton D., Scott Knight J., Contos A., Grimaldi S., Terry J., Lightsey P., Barto A., League B., Dean B., Scott Smith J., Bowers C., Aronstein D., Feinberg L., Hayden W., Comeau T., Soummer R., Elliott E., Perrin M. and Starr C. W., “Wavefront sensing and controls for the James Webb Space Telescope,” Space Telescopes and Instrumentation 2012: Optical, Infrared, and Millimeter Wave, Vol. 8442, International Soc. for Optics and Photonics, Bellingham, WA, 2012, Paper 84422H. Google Scholar[27] Albanese M., Wirth A., Jankevics A., Gonsiorowski T., Ohara C., Shi F., Troy M., Chanan G. and Acton S., “Verification of the James Webb Space Telescope Coarse Phase Sensor Using the Keck Telescope,” SPIE Astronomical Telescopes + Instrumentation, edited by Mather J. C., MacEwen H. A. and de Graauw M. W. M., Bellingham, WA, 2006, Paper 62650Z. https://doi.org/10.1117/12.672055 Google Scholar[28] IOA-GNC Team, “Final REPORT—IOA-GNC: In Orbit Assembly—ESA Contract No. 4000117552/16jNL/HK,”  GMV  GMV 21994/19 V1.1/19, Madrid, 2019. Google Scholar[29] “ENPULSION NANO AR3,” Enpulsion, May 2021, https://www.enpulsion.com/order-old-2/nano-ar3/. Google Scholar[30] Pérez L. L., Koch P., Smith D. and Walker R., “GOMX-4, The Most Advance Nanosatellite Mission for IOD Purposes,” Proceedings Small Satellite Systems and Services—The 4S Symposium, Sorrento Italy, May 2011. Google Scholar[31] “GOMspace, Software Defined Radio,” GOMspace, May 2020, https://gomspace.com/shop/subsystems/communication-systems/software-defined-radio.aspx. Google Scholar[32] Fehse W., Automated Rendezvous and Docking of Spacecraft, Vol. 16, Cambridge Univ. Press, Cambridge, MA, 2003, Chap. 5. CrossrefGoogle Scholar[33] Palomo J. M., D’angelo P., Silva P. F., Fernández A. J., Giordano P., Zoccarato P., Tegedor J., Oerpen O., Hansen L. B., Hill C. and Moore T., “Space GNSS Receiver Performance Results With Precise Real-Time On-board Orbit Determination (P2OD) in LEO Missions,” Proceedings of the 32nd International Technical Meeting of the Satellite Division of The Institute of Navigation, Miami, FL, Sept. 2019, pp. 1172–1186. https://doi.org/10.33012/2019.17082 Google Scholar[34] Pirat C., Ankersen F., Walker R. and Gass V., “Vision Based Navigation for Autonomous Cooperative Docking of CubeSats,” Acta Astronautica, Vol. 146, May 2018, pp. 418–434. https://doi.org/10.1016/j.actaastro.2018.01.059 CrossrefGoogle Scholar[35] Reveles J., Lawton M., Fraux V., Gurusamy V. and Parry V., “In-Orbit Performance of AstroTube™: AlSat Nano’s Low Mass Deployable Composite Boom Payload,” Proceedings of the Small Satellite Conference, Paper  SSC17-II-08, Utah State Univ., Logan, Utah, Aug. 2017, p. 7. Google Scholar[36] Walker R., “System Margin Policy for ESA IOD CubeSat Projects TEC-SY/77/2016/POL/RW,”  ESA-ESTEC  TEC-SY/77/2016/POL/RW, Noordwijk, The Netherlands, 2016. Google Scholar[37] Wertz J. R. and Larson W., Space Mission Analysis and Design, 3rd ed., Space Technology Library, Springer, Netherlands, 1999, Chaps. 10, 11. Google Scholar[38] Edelbaum T. N., “Propulsion Requirements for Controllable Satellites,” ARS Journal, Vol. 31, No. 8, 1961, pp. 1079–1089. https://doi.org/10.2514/8.5723 LinkGoogle Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Coupling Simulation of Thermal Response to Exhaust Gas at External Nozzle",
        "url": "https://arc.aiaa.org/doi/10.2514/1.A35018",
        "date": "20210906",
        "content": "AbstractThis paper examines thermal response behind the high-Mach integrated control (HIMICO) experiment’s engine. In this experimental aircraft, instruments must be protected from heat load due to exhaust gas; therefore, a coupling calculation between the fluid and the wall is conducted to confirm the performance of HIMICO’s thermal protection system (TPS). First, the validity of the coupling calculation is confirmed through comparison with aerodynamic heating on a hollow cylinder. The present calculation result can reproduce the surface temperature distribution on the cylinder better than previous work has managed because we consider the turbulence effect. Second, one-dimensional heat-transfer analysis is conducted on the external nozzle, and the appropriateness of the calculation result is confirmed through comparison with the ramjet-engine experiment. Finally, a coupling calculation between the fluid and the wall is conducted to investigate the local temperature distribution. The calculation result indicates that the temperature increase easily meets design requirements and that TPS performance is sufficient.NomenclatureAarea, m2Aipre-exponential coefficient for each reactionBiactivation temperature for each reaction, KCpSpecific heat, J/(kg⋅K)Ddiffusion coefficient, m2/setotal energy, J/m3Finviscid flux vectorFvviscous flux vectorhspecific enthalpy, J/kgh¯specific enthalpy of resin, J/kgkturbulence energy, m2/s2m˙mass flux, kg/(m2⋅s)Nfnumber of surfaces in each cellniorder for each reactionppressure, PaQconserved-quantity vectorqheat flux, W/m2Ttemperature, KTvector about the turbulence effect in the turbulence modelttime, suvelocity, m/sxfcomponent of the unit normal vectorYmass fractionI. IntroductionIn modern times, the aviation industry has become indispensable due to globalization. If higher flight velocities can be achieved, flight times can be shortened, and the amount of transportation can be increased, generating significant economic effects [1]. A previous attempt at a supersonic airplane, the Concorde, which can fly at Mach 2, was developed and operated by France and the United Kingdom. The Concorde was operated as the only supersonic passenger plane, but because of its high cost and environmental load, it concluded operations in 2003. Attempts at supersonic passenger planes presently continue throughout the world. For example, a structural investigation of LAPCATII, which is supposed to fly at Mach 5, has been conducted by the European Union [2].The Japan Aerospace Exploration Agency (JAXA) proposes to conduct a demonstration test of a hypersonic passenger plane within the next 20 years [3]. JAXA has suggested separating the demonstration test into three steps and investigating them one at a time to validate both the flight technology and the integrated technology of the entire aircraft under actual environmental conditions [4]. The aircraft used in the first stage is called the high-Mach integrated control (HIMICO) experiment. The objective of the first stage is to investigate the interaction between the airframe and the air-breathing engine, which has already been developed independently. In detail, this experiment aims to verify the flight-control logic and instruments mounted on the airframe and to operate the variable-intake manifold and the exhaust nozzle under the influence of the entire airframe. Furthermore, the first stage is divided into two phases to examine this interaction. The purpose of the first phase is to establish a flight technique without conducting an engine combustion test; the second phase aims to investigate the interaction between the airframe and the engine under an engine combustion test.Figure 1 shows an overall view of HIMICO, which is used in the second phase of the experiment. In the experiment, HIMICO will be launched by a sounding rocket. The total length of the airframe is 1.5 m. This length has been determined by the size of the nose fairing of the sounding rocket. HIMICO has a ramjet engine composed of an intake, a ram combustor, and a nozzle.In the experiment, HIMCO’s velocity reaches Mach 5 at an altitude of 24 km. Therefore, the total temperature at the edge of the wing and airframe becomes 1200 K. Furthermore, the total temperature behind the engine becomes higher than that of wing and fuselage because of the exhaust gas. Conversely, the temperature within the fuselage must be maintained at 350 K to ensure that instruments operate properly. Thus, a thermal protection system (TPS) capable of maintaining this condition is necessary for HIMICO [5].Fig. 1 Overall view of HIMICO.There are many TPSs to be installed in the supersonic aircraft [6]. Heat pipe [7], opposing-jet, and spiked-body [8] are examples of TPSs. In this research, using an ablator is planned because of its simple structure and high reliability. Figure 2 shows the ablator’s schematic image. The ablator is a porous or fabric material impregnated with resin; it maintains its interior temperature by endothermic reaction and pyrolysis-gas emission. This material is applied mainly at the tip of the rocket and reentry vehicle and at the rocket nozzle. These areas are exposed to a high heat load from exhaust gas or compressed air. This material began to be used from the Apollo program, and therefore research about ablators starts from that period [9]. However, the thermal protection performance of ablation was estimated by using empirical parameters. Nowadays, because of high computer calculation performance, investigation of thermal protection performance is conducted by numerical investigation. Bianchi et al. [10] and Cross and Boyd [11] evaluated the heat load reduction effect on the rocket nozzle due to the ablator, and Chen et al. [12] evaluated the thickness of the ablator in the reentry vehicle. However, the flow behind the HIMICO engine is complicated by both the external flow and the exhaust gas, and it is difficult to construct a simplified model of this flow. One possible thermal protection system that may be installed in HIMICO is carbon-fiber reinforced plastic (CFRP), which is a type of ablator. The objective of this research is to consider the feasibility of design requirements by conducting a coupling analysis between heat-transfer analysis on the ablator and CFD analysis on the exhaust gas. In this paper, we first validate the thermal-response code and the coupling code. Afterwards, a coupling calculation is conducted between the fluid and the wall, and the temperature distribution within the wall is investigated.Fig. 2 Schematic image of an ablator.II. Governing EquationsA. Fluid SideThis research uses fluid dynamics governed by the two-dimensional compressible Reynolds-averaged Navier–Stokes equation. The k−ω model [13] is used as the turbulence model: ∂∂t∬ΩQ dA=−∬Ω∂∂xj(Fj−Fvj) dA+∬ΩT dA(1)Here, Q=(ρρuleρiρkρω)TFj=(ρujρuluj+pδlj(e+p)ujρiujρkujρωuj)TFvj=(0τljumτmj−qj(ρDi)∂jYi(μ+σkρk/ω)∂jk(μ+σωρk/ω)∂jω)TT=(0000τml∂lum−β*ρωk(αωkτml)∂lum−βρω2+(ρσd/ω)(∂lk)(∂lω))TNote that i is not the dummy index, but the chemical species F and Fv indicate the inviscid and viscous flux vectors, respectively, and T denotes summation of the turbulence generation, dissipation, cross-diffusion term. Equation (1) can be described for the conservation law in each cell: ∂Q∂t=−1Ω∑fNf{(Fj−Fvj)Δsfxfj}+T(2)where f is surface, Nf is number of the surface, and Δsf is the length of each face, respectively. In addition, xfj denotes the component of the unit normal vector in each surface. The variation of Q is calculated by evaluating the numerical flux on each surface.B. TPS SideThe thermal response of the ablator is calculated via a one-dimensional unsteady heat-transfer equation [14] in this research: ρ∂h∂t=∇⋅(κ∇T)−(hg−h¯)∇⋅m˙g−∇⋅(m˙ghg)(3)where ρ is the density of the material, h is its specific enthalpy, κ is its thermal conductivity, h¯ is the specific enthalpy of the resin, and hg and m˙g are the specific enthalpy and the mass flux, respectively. The left-hand side of Eq. (3) indicates the storage rate of sensible energy, while the terms on the right-hand side of Eq. (3) represent heat transfer, energy consumption by the pyrolysis reaction, and convected energy, respectively. Pyrolytic gas is assumed to be calorically perfect and emitted instantly after generation. Based on this assumption, the mass flux of pyrolytic gas is calculated according to the following equation: m˙g=−∫bottomsurface(∂ρ∂t) dx(4)Resin consumption is calculated as ∂ρ∂t=∑i∂ρi∂t=∑i{−Ai(ρi−ρciρvi−ρci)niexp(−BiT)}(5)where i is the number of the chemical reaction that occurred in the ablator, ρi is the density of the resin component, Ai is the pre-exponential coefficient, Bi is the activation temperature, and ni is the reaction order in each component. These Arrhenius parameters depend upon materials. Therefore, estimation of these parameters on CFRP is conducted later. The detailed composition of the pyrolytic gas is unknown; therefore, this gas is assumed to be phenol and its specific heat is set to 2296  J/(kg⋅K).The thermal conductivity of the ablator is evaluated as the weighted average of the char and virgin states. The weighting function is determined by ϕ, which indicates the reaction progress in the ablator: κ=ϕκv+(1−ϕ)κc(6)and ϕ is calculated by Eq. (7): ϕ=ρvρv−ρc(1−ρcρ)(7)The emission rate is calculated in the same way. The values of the thermal conductivity in the char and virgin states are referred to as the reference data [15]. The specific heat of the ablator is calculated according to the Potts formula [16], which is applicable to a carbon-based ablator: Cp(T)=c2TT2+c12(8)Here, c1=800  K and c2=2300  J/(kg⋅K), respectively.III. Numerical MethodA. Fluid SideEquation (1) is numerically solved in this research. H2, N2, O2, and H2O are considered exhaust gases in the conservation law of chemical species. In addition, C6H5OH is considered to be the pyrolytic gas in the coupling calculation. The viscosity coefficient and thermal conductivity are calculated by the Chapman–Enskog [17] and Eucken methods [18], respectively. In addition, the ideal-gas law is used to close the system. The gas is treated as thermally perfect, and the exhaust gas is assumed to be nonreactive.In this report, the convective term is discretized by the second-order Simple Low-dissipation AUSM 2 (SLAU2) [19] method using the Monotone Upstream-centered Schemes for Conservation Laws (MUSCL) [20] method, and the diffusion term is discretized by the second-order accurate central-differential scheme. The matrix free Gauss–Seidel implicit method [21] is used to perform the time integral.B. TPS SideThe chemical parameters of CFRP have to be determined to solve Eq. (5); therefore, the Arrhenius parameters of CFRP are estimated and verified. In this research, data from thermogravimetric analysis (TGA) by Suzuki et al. [22] are used. Figure 3 shows Suzuki et al.’s TGA experimental result for CFRP; it is apparent that the density of CFRP decreases by 12.9% at 1450 K. Thus, the mass fraction of the resin in CFRP is determined to be 0.129. In this experiment, the CFRP temperature increases by 1  K/min; therefore, this mass variation can be regarded as a function of time, and the time derivative of the mass change can be calculated. Figure 4 shows the pyrolytic reaction rate of CFRP. Note that the sign is opposite between the time derivatives of Figs. 3 and 4; this is because Fig. 3 indicates mass loss of CFRP, while Fig. 4 indicates the reaction rate. Figure 4 indicates that the number of the primary pyrolytic reactions is two. One reaches its peak at 500 K and is called “reaction1,” and the other reaches its peak at 840 K and is called “reaction2.” In this paper, we assume that the pyrolytic reaction of CFRP can be reproduced by the superposition of these two independent pyrolytic reactions. Figure 3 indicates that the amounts of resin consumption by each reaction are 1.6 and 11.1%, respectively.In the following, the Arrhenius parameters are estimated. The reaction rate of pyrolytic gas is described by the opposite sign of Eq. (5). Equation (9) is obtained by deforming the equation about the reaction rate of pyrolytic gas: (ρvi−ρciρi−ρci)ni∂ρi∂t=Aiexp(−BiT)(9)By replacing the left-hand side of Eq. (9) with Ki and taking the logarithm of Eq. (9), Eq. (10) is obtained: lnKi=−BiT+lnAi(10)Fig. 3 Thermogravimetric analysis on CFRP by Suzuki et al. [22].Fig. 4 Pyrolytic reaction rate of CFRP.Equation (10) indicates that the relationship between the inverse of temperature T and the corresponding lnKi value is linear. Therefore, Ai and Bi can be obtained from the section and the slope of the approximate line, respectively. Figure 5 shows the Arrhenius plot and approximate line in each reaction. The equation and R value in Fig. 5 indicate the equation of the approximate line and the correlation coefficient, respectively. The value of ni is set explicitly between −100 and 100 and determined when the correlation coefficient R is the largest. Figure 5 indicates that an accurate approximate line is obtained by selecting proper values of ni in both reactions. The obtained Arrhenius parameters Ai, Bi, and ni from Fig. 5 are listed in Table 1.The pyrolytic reaction calculation is conducted using the Arrhenius parameter obtained in the previous step. Figure 6 compares the experimental and calculation results. Figure 6a indicates that although the calculated reaction rate overestimates the experimental result, the peak position shows good agreement. Figure 6b indicates that the pyrolytic reaction is evaluated steeply, and the amount of mass decrease is evaluated largely at 840 K in the calculation result. However, the error between the experimental and calculation results is so small that the Arrhenius parameter obtained in this research can capture the actual phenomenon.Fig. 5 Arrhenius plot and approximate line in each pyrolytic reaction.Fig. 6 Comparison between the experimental and calculation results.C. Coupling CalculationThe interaction between the fluid and the wall must be considered in the rear part of HIMICO. One of the most important phenomena in this research is heat transfer between the fluid and the wall. To investigate the temperature distribution within the wall during the experiment, this effect must be reproduced by conducting a coupling calculation between the fluid and the wall. However, such a calculation has a very high cost, because the fluid time step is so small that the number of iterations will become very large. Thus, the coupling calculation assumes that the flowfield converges much faster than transitional heat transfer. The calculation method presented in [23] can hold for this assumption. An illustration of the procedure is shown in Fig. 7. Firstly, the temperature distribution in the wall is assumed (0 in Fig. 7). Next, a fluid calculation is conducted using the wall-surface temperature Tw (1 in Fig. 7). This calculation continues until convergence, and then the steady heat flux is calculated on the wall qcnv (2 in Fig. 7). The obtained heat flux on the wall qcnv is used in the heat-transfer calculation as a boundary condition (3 in Fig. 7). After fluid calculation, a heat-transfer calculation is conducted (4 in Fig. 7), which continues for Δtc and updates the temperature distribution in the wall. After the heat-transfer calculation, a fluid calculation is again conducted using the updated wall temperature. The coupling calculation is done by repeating this procedure.Information exchange between the fluid and heat-transfer calculations takes place through the wall’s surface. The surface temperature Tw and heat flux on the wall qcnv are determined from the state of both the fluid and the wall. Figure 8 shows a schematic image of the boundary condition on the wall surface, and Δx in Fig. 8 indicates the grid width in the heat-transfer calculation. As discretization is conducted using the cell-center method, the grid point is located at the surface. The heat budget of the following equation holds in the control volume shown by the broken red line in Fig. 8: ρ∂h(T)∂t=(qcnv+qdif−qchem−qrad−qcnd)/(Δx2)(11)where qcnv, qdif, qchem, qrad, and qcnd indicate heat convection from the fluid, energy convection by diffusion, energy transfer by pyrolysis gas from the ablator, radiation from the surface wall, and heat conduction into the wall, respectively. By determining these values in each step and calculating Eq. (11), we can calculate the surface temperature of the wall. Therefore, wall-heat convection obtained from the fluid calculation is used to evaluate wall temperature Tw in the heat-transfer calculation.Fig. 7 Coupling-calculation procedure [19].Fig. 8 Schematic image of the boundary condition in the coupling calculation.IV. Results and DiscussionA. Validation of the Coupling CalculationWe begin by validating the coupling calculation. The target for comparison is the experiment with a two-dimensional cylinder in hypersonic flow, as conducted by Wieting [24]. In the experiment, a hollow cylinder of thickness 12.7 mm is located in a hypersonic wind tunnel. The Mach number, static pressure, and static temperature from the wind tunnel are 6.47, 648 Pa, and 241.5 K, respectively. The Mach number of the inflows is so high that the effect of compressibility upon turbulence must be considered in this calculation target. Therefore, the compressibility correction proposed by Tang and Gao [25] is added to the turbulence calculation. The surface temperature and heat flux are measured during the experiment. Figure 9 shows the calculation domain and boundary condition about this target. The number of cells is about 85,000, and the minimum grid width to normal direction is 0.1  μm. In this grid, the value of y+ in the stagnation point is 1.6×10−3. From this calculation, this grid has sufficient resolution. Conversely, the number of cells in the heat-transfer calculation is about 24,000, and the grid width is uniformly set to 0.1  μm. The inflow condition is adjusted to match that of the experiment, and the inflowing chemical species is set to air. The material of the hollow cylinder is set to SUS321 [26]. The density, heat-conduction rate, and specific heat of SUS321 are constant at 8030  kg/m3, 16.24  W/(m⋅K), and 502.4  J/(kg⋅K), respectively. The initial flow condition is steady when the material wall temperature is fixed at 294.4 K. The coupling interval Δtc is set to 0.5 s, which has the same value as in previous research [23].Figure 10 shows the temperature distribution on the surface of the hollow cylinder when t=5  s. The experimental result [24] and calculation by Zhang et al. [23] are also shown. Compared with the result of previous research, the present calculation better reproduces the surface temperature distribution on the wall. Previous research neglected the turbulence effect in the governing equation. Conversely, the present calculation considers the turbulence effect, allowing the turbulence-heat conduction to be reproduced. This is why the present calculation finds a surface temperature that is closer to the experimental result. Although the present calculation result underestimates the temperature at the stagnation point at 20 K, the effect upon the temperature distribution in the wall is small. Thus, the validity of the coupling calculation is concluded to be sufficient in this research.Fig. 9 Calculation domain and boundary condition of the hollow cylinder.Fig. 10 Comparison of the surface temperature on the cylinder between the experiment and the simulations.B. Validation of Heat Transfer in CFRPThe thermal response analysis is conducted, and the validity of the calculation is confirmed in this section. The calculation is validated based on the results from a ramjet combustion experiment, conducted in the Kashiwa Campus high-enthalpy combustion wind tunnel of the University of Tokyo. Figure 11 shows the actual setup in the experiment. The ramjet engine is directly connected to the wind tunnel. The total pressure and temperature of the mainstream are 300 kPa and 900 K, respectively. Combustion occurs in the combustion chamber, and exhaust gas is emitted from the nozzle. Hydrogen fuel is used in this experiment. The fuel-injection time is 5 s, and the equivalence ratio is 0.55. Temperature measurement at the nozzle is conducted in this experiment. Figure 12 shows temperature measurement points in the experiment. Temperature is measured 28 and 58 mm away from the engine. The location close to the engine is called “upstream” while the other is called “downstream.” The surface temperature, interface temperature between the surface and adjacent materials, and bottom temperature are measured at each location. The external nozzle materials are CFRP, Inconel625, Cork, and SUS304 from the surface inward. Figure 13 shows the upstream temperature history, as obtained experimentally. The time at which the fluid from the wind tunnel touches the surface of the external nozzle in Fig. 13 is indicated by t=0. Fluid from the wind tunnel heats gradually, and the surface temperature reaches 400 K before combustion. Surface temperature increases rapidly after combustion by exhaust gas. The interface temperature increases because of heat conduction from the surface.Equation (3) is used to calculate heat-transfer analysis. The diffusion term is discretized by a second-order central-differential scheme. The second-order Crank–Nicolson method is used for time integration. The calculation target is the same as the external nozzle used experimentally. The thickness of each material is 3.07, 7.15, 3.07, and 7.15 mm from the surface inward. The thermal properties of Inconel 625, Cork, and SUS304 are referred to as reference data [27–29]. The boundary condition at the surface is set to the temperature obtained experimentally. Conversely, the boundary condition at the bottom is an adiabatic wall. The number of the grid points is 162, and they are arranged uniformly. The initial condition is calculated under the assumption that the temperature distribution is steady when calculation starts. Figure 14 shows the initial temperature distribution on the external nozzle.Fig. 11 Setup of the direct-connection combustion test.Fig. 12 Temperature measurement points in the experiment.Fig. 13 Experimentally obtained temperature history.Figure 15 compares the calculation and experimental results at the interface temperature and indicates that the calculation result overestimates the interface temperature by less than 0.5 K at t=77.6  s when minimum grid width is 125  μm. Calculation can capture the thermal-response tendency on the external nozzle, meaning the calculation is valid when minimum grid width is 125  μm.Fig. 14 Initial temperature distribution in the external nozzle.Fig. 15 Comparison between calculation and experiment in terms of interface temperature.C. Coupling Calculation with Fluid and Heat TransferIn this section, the coupling calculation is performed with fluid and heat transfer. The calculation target is the rear part of HIMICO. Figure 16 shows the calculation domain and boundary condition of the fluid. The minimum grid width is 1  μm near the wall. The initial condition of the coupling calculation is steady when the TPS wall is fixed at 300 K. The molar ratios and incoming-flow conditions are listed in Tables 2 and 3, respectively. The external flow is assumed to be air at an altitude of 24 km, and the molar ratio is set to N2:O2=0.79:0.21.One-dimensional (1-D) heat-transfer calculation is conducted to assess temperature distribution more dangerous side. The number of grid points in TPS is 265×162, and the grid width is uniformly set to 0.125 mm. The external nozzle materials are CFRP, Inconel625, Cork, and SUS304 from the surface inward, having thicknesses of 3, 7, 3, and 7, respectively. The thermal properties of CFRP, Inconel 625, Cork, and SUS304 are taken from reference data [27–29]. The initial condition of the TPS is 300 K uniformly, with a coupling interval Δtc set to 0.1 s.Fig. 16 Calculation domain and boundary condition in external flow.Before presenting the coupling calculation result, a steady calculation result is shown to discuss the flowfield formed behind the engine. Figure 17 shows the temperature distribution in the steady state. This calculation is conducted by fixing the TPS surface temperature at 300 K. Figure 17 shows that the exhaust gas from the nozzle expands and its temperature decreases. However, gas near the wall maintains a high temperature because of the thermal boundary layer. This high-temperature exhaust gas attaches to the rear of the engine and imposes a high heat load. Figure 17 also shows the heat-flux distribution behind the engine at the steady state; this takes its maximum value of 290  kW/m2 at xs=29.9  mm, where exhaust gas attaches directly.Figure 18 shows temperature history at xs=29.9  mm with a different time interval Δtc. From this result, temperature history becomes the same as time passed in all time intervals. However, if the time interval is large, unphysical oscillation occurs just after starting the calculation. In this research, the coupling interval Δtc is set to 0.1 s because sufficient convergence is obtained.Fig. 17 Temperature and heat-flux distribution at the steady state.Next, the coupling calculation between the fluid and the TPS is shown. The calculation duration is set to 25 s. Figure 19 shows the surface temperature in the coupling calculation; Fig. 19a indicates that the surface temperature increases over the whole region because of heat transfer from the exhaust gas; Fig. 19b shows the temperature history at xs=29.9  mm, where heat flux takes its maximum value, and indicates that surface temperature increases rapidly just after the calculation begins. Conversely, variation of the surface temperature lessens as time passes. At xs=29.9  mm and t=25  s, the temperature reaches 1100 K.Fig. 18 Validation of time interval in coupling calculation.Figure 20 shows the surface heat flux in the coupling calculation; Fig. 20a indicates that the surface heat flux decreases over the whole region. As noted previously, surface temperature increases during the coupling calculation. The temperature difference between exhaust gas and the TPS surface gradually becomes small; this is why the amount of heat flux gradually decreases in the coupling calculation. Fig. 20b shows the heat-flux history at xs=29.9  mm and indicates that the surface heat flux decreases rapidly just after starting the calculation. The heat flux at xs=29.9  mm decreases to 110  kW/m2 at t=25  s. This means that heat flux is reduced by approximately 60% compared with the steady state.Fig. 19 Surface temperature in the coupling calculation.Figure 21 shows the temperature distribution in the wall at xs=29.9  mm. Fig. 21a indicates that the temperature of CFRP, to which exhaust gases attach directly, increases gradually because of heat transfer from the exhaust gas. Conversely, there is little change in the temperature of the other material (Inconel, Cork, and SUS) over the whole duration of the calculation; Fig. 21b shows the temperature distribution at t=25  s and indicates that the temperature in the bottom of the SUS (y=20  mm) is 300.01 K at t=25  s. The temperature inside of HIMICO must remain less than 350 K, so temperature increase in the calculation is much smaller than the design requirement. Hence, the performance of the thermal protection system is sufficient in this structure.Fig. 20 Heat flux on the surface in the coupling calculation.To investigate the reduction effect of the ablator, the heat budget in CFRP at xs=29.9  mm is shown in Fig. 22. The values of each term in Eq. (3), which governs the ablator, are shown in Fig. 22. The second and third terms in Eq. (3) indicate the reduction effect of the ablator and correspond to Figs. 22b and 22c, respectively. Figure 22d shows the x−t graph of sensible energy in the CFRP, which corresponds to the left-hand side of Eq. (3); this means that the summation of values from Figs. 22a–22c is equal to Fig. 22d. Figure 22 indicates that there are two regions in which a remarkable reduction effect is seen in the ablator. The first region starts from t=0.5  s, and the second starts from t=6  s. These regions correspond to the chemical reactions of the ablator, as shown in Fig. 4. This means that the first region corresponds to the peak at 500 K (first reaction) in Fig. 4 and the second to that at 840 K (second region) in Fig. 4. The reduction effect of the first region reaches deeper than that of the second region. However, as is seen in Fig. 4, the rate of the first reaction is smaller than that in the second reaction. Therefore, the reduction effect by the first region is smaller than that by the second. A large reduction effect is expected in the second region in terms of the reaction rate. However, the region whose temperatuere reaches 1000 K is small when the combustion duration is set to 25 s. Therefore, the reduction effect of the second region becomes larger if the combustion duration increases.Fig. 21 Temperature distribution in the wall.To check the effect of the chemical reaction of CFRP on the heat reduction effect of ablator, the following four calculations are conducted and compared with each other. Figure 23 shows the comparison target of the effect of the chemical reaction of CFRP on the heat reduction effect of the ablator. In addition to normal CFRP (w/resin+w/reaction+w/emission), the calculation case without considering the gas emission from the ablator (w/resin+w/reaction+w/o emission), the calculation case without considering both the gas emission from the ablator and the chemical reaction in the ablator (w/resin+w/o reaction+w/o emission), and the calculation case without the existence of the ablator (w/o resin+w/o reaction+w/o emission) are considered. If the chemical reaction is not considered in the calculation, the density change in the ablation has not occurred and the value of right-hand side in Eq. (5) is always 0. Moreover, if the existence of the ablator is not considered in the calculation, the initial condition of CFRP density is assumed to be equal to the density when ablator is fully char state.Fig. 22 The x–t graph of the heat budget in CFRP at xs=29.9  mm.Figure 24 shows the comparison of temperature history at xs=29.9  mm. Figure 24 indicates that when comparing the results between “w/resin+w/reaction+w/emission” and “w/resin+w/reaction+w/o emission,” the difference of temperature history is little, regardless of the gas emission from the ablator. In more detail, the temperature difference between these two results is 0.1 K at best in all times. Here, Fig. 25 shows the mass fraction of phenol, which is emitted from ablator in the normal CFRP case. Figure 25 indicates that the amount of phenol mass fraction is at most 10−3. The heat conduction rate of the mixture gas is calculated by the weighted average of each mass fraction. Therefore, the amount of pyrolysis gas is so small that the effect of the existence of pyrolysis gas on heat reduction effect is very small in this calculation. In addition, this result shows that the amount of phenol mass fraction is so small that the effect of the chemical reaction near the surface on the heat flux is small if the chemical reaction is considered in the fluid calculation.Fig. 23 Comparison target of the effect of the chemical reaction of CFRP on the heat reduction effect of the ablator.Figure 24 also shows that when both the gas emission from the ablator and the chemical reaction in ablator are not considered (w/resin+w/o reaction+w/o emission), the surface temperature is evaluated higher than that of normal CFRP. On the other hand, when the existence of the ablator is not considered (w/o resin+w/o reaction+w/o emission), the surface temperature is evaluated lower than that of normal CFRP. This difference comes from the difference of the heat conduction rate in the CFRP. The heat conduction rate of CFRP is calculated by weighted average from the heat conduction rate of virgin state and char state. From the reference data [15], the value of the heat conduction rate of char state is larger than that of virgin state. When both the gas emission from the ablator and the chemical reaction in the ablator are not considered (w/resin+w/o reaction+w/o emission), resin in CFRP does not make a reaction, and the value of the heat conduction rate is always referred to the value of the virgin state. Therefore, the value of the heat conduction rate is evaluated lower than that of normal CFRP, and the heat is consumed to increase the surface temperature. On the other hand, when the existence of the ablator is not considered (w/o resin+w/o reaction+w/o emission), the value of the heat conduction rate is always referred to the value of the char state. Therefore, the value of the heat conduction rate is evaluated higher than that of normal CFRP, and heat moves to the depth direction. As a result, little heat is consumed to increase the surface temperature.Fig. 24 Comparison of surface temperature history at xs=29.9  mm.Fig. 25 Mass fraction of phenol from CFRP at t=25  s.V. ConclusionsIn this research, a coupling calculation is conducted behind the HIMICO. Before investigating the heat load due to exhaust gas and the temperature distribution within the wall, we validate the coupling and heat-transfer calculations of CFRP, which is installed in HIMICO as a thermal protection system. Firstly, the coupling between the fluid and heat-transfer calculation is validated based on aerodynamic heating on the hollow cylinder. The present calculation result shows that the temperature distribution on the cylinder wall can be reproduced by comparison with previous research. This is because a turbulence model is introduced to the governing equation, allowing the promotion of heat transfer by turbulent flow to be considered in the present calculation. Next, heat transfer in the wall is validated based on a ramjet-engine combustion experiment. The calculated temperature at the interface between CFRP and Inconel shows good agreement with experiment. Finally, the coupling calculation between the fluid and the wall is performed. The amount of heat flux on the surface decreases by 60% at xs=29.9  mm compared with the steady state. This is because surface temperature increases through heat transfer from the exhaust gas to the wall, and the temperature difference between the exhaust gas and wall surface becomes small. The temperature variation in the bottom of the wall is very small and meets design requirements. Hence, the thermal protection system installed in HIMICO offers adequate protection.Moreover, by investigating the reduction effect of the ablator, the effect of gas emission from the ablator on the heat reduction effect is small. Generally, coupling calculations between fluid and ablator need a high calculation cost and complex calculation procedure because of interaction between external fluid and pyrolysis gas. However, this result shows that the effect of pyrolysis gas is so small that the calculation result without considering pyrolysis gas emission can show reasonably adequate temperature history. This result indicates that it is not necessary to calculate pyrolysis gas emission when designing the thermal protection system on the aircraft.Before concluding this paper, several points that were not considered are explained. Firstly, we did not consider the chemical reaction of the exhaust gas. Unburnt hydrogen is contained in the exhaust gas, and, therefore, the temperature distribution may change if this hydrogen burns behind the engine. Secondly, surface recession is also not considered. Recession of the CFRP is not observed in the ramjet-engine combustion experiment. However, the combustion duration is 5 s and shorter than the combustion duration in the flight condition. Therefore, surface recession may occur during combustion in an actual flight experiment.S. SiltonAssociate EditorAcknowledgmentsThis work was supported by Japan Society for the Promotion of Science KAKENHI grant number JP20H05654. The author would like to extend his appreciation to Akiko Matsuo, who helped and supported enthusiastically in completing this report. Moreover, he would like to thank Junichi Oki, Hideyuki Taguchi, Takahiro Chiga, and Yutaka Ikeda for sharing the experimental dataset and for their useful discussion.\r            References\r        [1] “Research and Development Plan of Hypersonic Airplanes,” Japan Aerospace Exploration Agency TR JAXA-SP-06-025, Tokyo, 2007. Google Scholar[2] Steelant J., “Sustained Hypersonic Flight in Europe: First Technology Achievements Within LAPCATII,” 17th AIAA International Space Plane and Hypersonic Systems and Technologies Conference, AIAA Paper  2011-2243, 2011. https://doi.org/10.2514/6.2011-2243 Google Scholar[3] “JAXA’s Long Term Vision in Science,” Transactions of the Japan Society for Aeronautical and Space Sciences, Vol. 53, No. 618, 2005, pp. 216–228. Google Scholar[4] Taguchi H., Kobayashi H., Kojima T., Hongoh M., Sato T., Tsuchiya T. and Tsue M., “Flight Experiment Plan of Hypersonic Pre-Cooled Turbojet Engine,” Proceedings of Space Transportation Symposium FY2017, Inst. of Space and Astronautical Science, Japan Aerospace Exploration Agency, 2018, http://id.nii.ac.jp/1696/00015726/. Google Scholar[5] Taguchi H., Kojima T., Sato T., Tsue M. and Tsuchiya T., “Flight Demonstration Plan of Hypersonic Propulsion Technology,” Proceedings of Space Transportation Symposium FY2016, Inst. of Space and Astronautical Science, Japan Aerospace Exploration Agency, 2017, http://id.nii.ac.jp/1696/00015593/. Google Scholar[6] Glass D., “Ceramic Matrix Composite (CMC) Thermal Protection Systems (TPS) and Hot Structures for Hypersonic Vehicles,” 15th AIAA International Space Planes and Hypersonic Systems and Technologies Conference, AIAA Paper  2008-2682, May 2008. Google Scholar[7] Thornton E. A., Thermal Structures and Materials for High-Speed Flight, AIAA, Washington, D.C., 1992, Chap. 3. LinkGoogle Scholar[8] Huang J., Yao W. and Shan X., “Coupled Fluid-Thermal Analysis of Combinational Nonablative Thermal Protection System Concept,” Journal of Spacecraft and Rockets, Vol. 56, No. 4, 2019, pp. 1137–1151. https://doi.org/10.2514/1.A34212 LinkGoogle Scholar[9] Moyer C. B. and Rindal R. A., “An Analysis of the Coupled Chemically Reacting Boundary Layer and Charring Ablator. Part 2–Finite Difference Solution for the In-Depth Response of Charring Materials Considering Surface Chemical and Energy Balances,”  NASA  CR-1061, 1968. Google Scholar[10] Bianchi D., Turchi A., Nasuti F. and Onofri M., “Chemical Erosion of Carbon-Phenolic Rocket Nozzles with Finite-Rate Surface Chemistry,” Journal of Propulsion and Power, Vol. 29, No. 5, 2013, pp. 1220–1230. https://doi.org/10.2514/1.B34791 LinkGoogle Scholar[11] Cross P. G. and Boyd I. D., “Two-Dimensional Modeling of Ablation and Pyrolysis with Application to Rocket Nozzles,” Journal of Spacecraft and Rockets, Vol. 54, No. 1, 2017, pp. 212–224. https://doi.org/10.2514/1.A33656 LinkGoogle Scholar[12] Chen Y. K., Gökçen T. and Edquist K. T., “Two-Dimensional Ablation and Thermal Response Analyses for Mars Science Laboratory Heat Shield,” Journal of Spacecraft and Rockets, Vol. 52, No. 1, 2015, pp. 134–143. https://doi.org/10.2514/1.A32868 LinkGoogle Scholar[13] Wilcox D. C., Turbulence Modeling for CFD, 3rd ed., DCW Industries, La Cañada, CA, 2006, pp. 124–128. Google Scholar[14] Chen Y. K. and Milos F. S., “Ablation and Thermal Response Program for Spacecraft Heatshield Analysis,” Journal of Spacecraft and Rockets, Vol. 36, No. 3, 1999, pp. 475–483. https://doi.org/10.2514/2.3469 LinkGoogle Scholar[15] Suzuki T., Takizawa N., Aoki T., Ishida Y., Ogasawara T., Watanabe Y. and Fujita K., “Development of Aeroshell Module for Mars Exploration Mission,” Japan Aerospace Exploration Agency, 2016, pp. 183–188, http://id.nii.ac.jp/1696/00003619/. Google Scholar[16] Potts R. L., “Application of Integral Method to Ablation Charring Erosion, A Review,” Journal of Spacecraft and Rockets, Vol. 32, No. 2, 1995, pp. 200–209. https://doi.org/10.2514/3.26597 LinkGoogle Scholar[17] Chapman S. and Cowling T. G., The Mathematical Theory of Non-Uniform Gases, Cambridge Univ. Press, Cambridge, England, U.K., 1939, p. 148. Google Scholar[18] Svehla R. A., “Estimated Viscosities and Thermal Conductivities of Gases at High Temperature,”  NASA  TR-R-132, 1962. Google Scholar[19] Kitamura K. and Shima E., “Towards Shock-Stable and Accurate Hypersonic Heating Computations: A New Pressure Flux for AUSM-Family Schemes,” Journal of Computational Physics, Vol. 245, July 2013, pp. 62–83. https://doi.org/10.1016/j.jcp.2013.02.046 CrossrefGoogle Scholar[20] Burg C., “Higher Order Variable Extrapolation for Unstructured Finite Volume RANS Flow Solvers,” 17th AIAA Computational Fluid Dynamics Conference, AIAA Paper  2005-4999, 2005. https://doi.org/10.2514/6.2005-4999 Google Scholar[21] Shima E., “A Simple Implicit Scheme for Structured/Unstructured CFD,” Proceedings of 29th Japanese Fluid Dynamics Conference, Vol. 29, 1997, pp. 325–328. https://doi.org/10.2322/tjsass.47.195 Google Scholar[22] Suzuki T., Fujita K., Sakai T., Okuyama K., Kato S. and Nishio S., “Thermal Response Analysis of Low-Density CFRP Ablator,” Transactions of the Japan Society for Aeronautical and Space Sciences, Aerospace Technology Japan, Vol. 10, No. 28, 2012, pp. 21–30. https://doi.org/10.2322/tastj.10.Pe_21 Google Scholar[23] Zhang S., Chen F. and Liu H., “Time-Adaptive, Loosely Coupled Strategy for Conjugate Heat Transfer Problems in Hypersonic Flows,” Journal of Thermophysics and Heat Transfer, Vol. 28, No. 4, 2014, pp. 635–646. https://doi.org/10.2514/1.T4278 LinkGoogle Scholar[24] Wieting A. R., “Experimental Study of Shock Wave Interference Heating on Cylindrical Leading Edge,”  NASA  TM-100484, 1987. LinkGoogle Scholar[25] Tang H. and Gao Z., “Investigation of Turbulence Models with Compressibility Corrections for Hypersonic Boundary Flows,” Advances in Mechanical Engineering, Vol. 7, No. 12, 2015, pp. 1–23. https://doi.org/10.1177/1687814015620319 Google Scholar[26] “Stainless Steel—Grade 321 (UNS S32100),” Atlas Steels, Australia [online database], http://www.azom.com/article.aspx?ArticleID=967 [retrieved 23 Oct. 2001]. Google Scholar[27] “InconelAlloy625,”  Special Metals Corp., Huntington, WV, 2013. Google Scholar[28] Silva S. P., Sabino M. A., Fernandes E. M., Correlo V. M., Boesel L. F. and Reis R. L., “Cork: Properties, Capabilities and Applications,” International Materials Reviews, Vol. 50, No. 6, 2005, pp. 345–365. https://doi.org/10.1179/174328005X41168 CrossrefGoogle Scholar[29] Japan Journal of Thermophysical Properties,Thermophysical Properties Handbook, Yokendo Co. Ltd., Tokyo, 2008, p. 213. Google Scholar"
    },
    {
        "keyword": "target",
        "source": "AIAA",
        "title": "Deployment Dynamics Analysis of an Origami-Folded Spacecraft Structure with Elastic Hinges",
        "url": "https://arc.aiaa.org/doi/10.2514/1.A34938",
        "date": "20210916",
        "content": "AbstractSelf-actuated deployable space structures present a novel challenge for deployment dynamics modeling efforts, where the system-level influence of strain energy components must be captured. Here, the free deployment of an origami-folded structure through actuation of strain energy hinges is studied. Studies include experimental testing, multibody dynamics modeling, and finite element modeling. An approach for modeling high strain tape spring hinges for use in a multibody simulation of free-deployment dynamics analysis is presented and demonstrated. This approach considers hinges with multiple degrees of freedom beyond the primary fold axis angle. A novel folded deployable structure is designed and prototyped with a segmented fold pattern and strain energy hinges integrated in the design. A suite of deployment tests is conducted on the prototype using videogrammetry. A full simulation of the prototype is constructed from a multibody dynamics model and the hinge model, and the predicted deployment behavior for relative hinge states is evaluated against the experimental testing. Additionally, the prototype deployment is replicated using an explicit dynamic finite element analysis for a performance comparison. The models demonstrate strong correlation for deployment time predictions across the relative hinge states, and the finite element analysis correlates all deployment behaviors.NomenclatureAitape spring reference frameaipolynomial coefficienta^0ireference frame unit vectorbj,kpolynomial coefficientcipolynomial coefficientfigeneralized spatial force, NHihinge frameMimoment at frame i, N/mmNiforce at frame i, NPipanel framep(q)polynomial functionp^i,jreference frame unit vectorqgeneralized spatial coordinatesriglobal position vector, mmδrelative position vector, mmδirelative position coordinate, mmϵnumerical bufferθorientation coordinates, degθiEuler angle, degσispacecraft modified Rodrigues parameters’ attitude orientationsωispacecraft rotation rates, deg/sI. IntroductionAn emerging area in the deployable space structures field is known as origami structures and takes primary inspiration from origami-folding techniques. These are developed to stow flat structures with a large area to size ratio relative to the spacecraft bus, such as solar [1–3] and phase [4,5] arrays, star occulters [6], and reflector antennas [7,8]. Concept imagery is shown for two solar array designs in Fig. 1, where the Alliant Techsystems (ATK) design uses a cable and motor system to actuate deployment and the Brigham Young University (BYU) design uses an external perimeter truss and cable system [9].‡,§Adapting origami-folding techniques to space structures requires either creasing or segmentation of the structure surface. Creasing primarily applies to pliable membrane structures, and the challenges of membrane creasing have been [10] and continue to be [11] researched in the literature. The scope of this paper focuses on rigid or semirigid segmented structures, meaning the individual segmented panels of the structure can be treated as rigid or semirigid with respect to the mobility of the folds.Fig. 1 Folded deployable spacecraft structure solar array concept art.A central challenge for origami structures includes the deployment dynamics and deployment actuation of the folded structure and spacecraft system. A novel lightweight solution for deployment actuation is to integrate strain energy hinges that can also facilitate folding [12]. Elastic, flexible hinges are ideal for this application because they provide an intuitive lightweight solution to traditional mechanical hinges. Traditional hinges such as the pin/clevis rotation joints are mechanically complex and massive. An elastic hinge, such as a composite or metallic shell, has the potential to reduce mass, eliminate friction loss, and increase compaction. Additionally, elastically folding materials will store strain energy in the system, providing a built-in deployment actuator. This enables a free-deploying structure design, meaning the deployment is not controlled electronically by a motor actuation system.Deployment dynamics of such a system would typically be simulated through finite element analysis (FEA) [13]. However, for a structure with multiple high strain hinges, FEA modeling would require significant computational time and skill because these hinges exhibit large deformations of shell structures with nonlinear behavior. This limits the ability to explore parameter design spaces and iterate toward more optimal solutions. An alternative method for studying the system dynamics that uses multibody dynamics and a simplified hinge representation would provide significant gains in computation time [14,15]; however, this method still requires adequate skill and experience. In this approach, fold panels are treated as rigid bodies and the flexible joints are represented by internal forcing functions. In this paper, a model to represent the hinge mechanics is designed as a function of the hinge’s multiple degrees of freedom, as defined by the relative position and orientation states across the hinge [16]. This model is designed to be implemented in a multibody dynamics algorithm developed specifically for origami-folded deployable spacecraft structures [17]. The methodology aims to provide a deployment dynamics behavior approximation without a full FEA simulation of the system. The results show that the deployment phase behavior and deployment time are well modeled but settling behaviors are not due to the absence of damping or contact.The paper is organized as follows. A multibody dynamics model and a flexible hinge model are integrated to provide a complete deployable structure model based on a prototype structure. The approach to developing the high strain tape spring hinge descriptions is designed for direct use in multibody dynamics algorithms. First, a simulation of the prototype case is developed under the assumption that the elastic tape spring hinges are operating on a single degree of freedom. A single-degree-of-freedom hinge model is developed by fitting torque response data from experiments for the symmetric fold case. Following this, the full six-degree-of-freedom hinge case is built. A deployment test campaign is conducted on the prototype structure to provide experimental comparison data for the simulations. An additional deployment dynamics simulation is studied using FEA to further validate the results and provide context for performance and expectations of the multibody model. The literature lacks demonstration of FEA modeling for folding deployable structures, and therefore this study provides insights for the greater community on its relative use and performance with respect to a multibody model. Additionally, this FEA modeling effort quantifies the time and effort commitment of creating a high-fidelity deployment model and highlights the limitations of the multibody dynamics modeling approach.II. Dynamics of Folded Deployable Structures ReviewDesign development of deployable structures is primarily achieved through iterative prototyping and testing: a process that often yields novel research products that are shared through the community. Specifically for deployment dynamics, validation and verification are primarily achieved through rigorous testing; and this is sometimes presented in tandem with complex finite element simulation or a simplified model approximation. A review of relevant deployment dynamics studies in the literature is presented as follows:Deployment testing examples in the literature demonstrate several metrology methods for capturing adequate data of the deployment. The simplest validation that is often provided is a visual demonstration, either through video or sequential photography, of the deployment. This method has been published for the Ka-Band Parabolic Deployable Antenna (KaPDA) antenna [18], the Multi-Arm Radial Composite (MARCO) parabolic antenna [19], as well as many other structure concepts. This method is considered sufficient for controlled deployments, as were the KaPDA and MARCO antennas, but can be questionable for a free-deploying system where the dynamics are not controlled and are less predictable (and potentially less repeatable). A useful videogrammetry system for deployment dynamics testing is provided by motion capture systems. This system directly measures the position of multiple reflective targets on a moving body of interest through time. A notable test campaign that implements this in the literature features the Self-contained Meter-class deployable boom (SIMPLE) meter-class boom [20], which demonstrated a free deployment of a self-actuated boom.Considering now the modeling portion of the literature, there are few studies that developed modeling techniques for free-deploying strain-actuated spacecraft structures. One significant study of the free-deployment dynamics of a tape spring actuated system was provided by the Mars Advanced Radar for Subsurface and Ionosphere Sounding (MARSIS) antenna project that flew on the ESA’s Mars Express and was deployed in 2005 [21]. This antenna comprised three z-folded tubes, the longest of which was 40 m and had 12 folding hinges. A significant anomaly occurred during the deployment of the first boom, where a tape spring hinge did not deploy, and therefore created an intermediate deployment shape. Additional modeling efforts were needed to determine the partially deployed state, to determine the cause of the anomaly, and to design a spacecraft maneuver to correct it [22]. In these studies, a multibody dynamics modeling software (Adams) was implemented to model the deployment, treating the tape springs as spline hinge joints. Additionally, Abaqus finite element simulations were created to validate the Adams model at the component level, modeling only a single hinge connecting two tubes, due to the infeasible computational cost of modeling a full system. Major takeaways from this study are the risks taken in not being able to do a ground deployment test and the importance of predicting hinge behavior. An additional study of Adams demonstrated the software’s capabilities in modeling difficult benchmark problems [23] and discussed the limitations. Including higher-fidelity effects, such as contact and bending, is not an objective of the multibody dynamics model implemented here, and therefore Adams was not considered for this study.An additional example is a self-actuated z-folded solar array for CubeSats that included a finite element model and a deployment test using Vicon videogrammetry [24]. This system consisted of several 10-by-10 cm panels connected by flexure hinges at the folds. This study found issues with the panels self-contacting through deployment, where the likelihood of such behavior for systems of more than seven panels was high. Additionally, there was large variance in the deployment path of the array, although there was good correlation for the deployment time and final deployed distance between the simulations and experiments. Although these two studies provide clear approaches to studying free-deploying systems, they are both z-folded open-chain systems not subject to closure constraints, which is the dominant challenge of an origami structure. A study of the deployment of a self-deployable origami-folded structure has been seen in the literature [25]. The authors created a deployment dynamics model using commercial modeling software that includes linear stiffness models of strain joints with multiple degrees of freedom. However, this system included a cable system, and deployment dynamics of the design were not tested or correlated in the study. Additionally, strain joints and tape spring hinges have notable differences in behavior properties.The last idea to consider is representing hinge behavior with a reduced model. A similar concept of representing a complex mechanical hinge with a force/torque model for dynamics modeling has been demonstrated using an integrated finite element and multibody software [26] for a folded open-chain solar panel deployment. These hinges were traditional mechanical pin and clevis (or piano) hinges, where unlike tape spring hinges, the internal contact was the behavior of interest. This study demonstrates interest in the community in developing reduced hinge modeling techniques to better understand deployment dynamics simulations.This review highlights the current progress in the deployable space structures community on the topic of deployment dynamics analysis for structures with folding hinges. The research presented in this paper then sits at the intersection of several state-of-the-art elements, namely, the modeling of high strain elastic hinges, dynamics modeling for origami-folded structures, and the design and implementation of free-deployment strategies for origami-inspired space structures.III. Folding Structure Prototype and Deployment TestingThe objective here is to design and build a folding structure that can be used to qualitatively evaluate the dynamics modeling approach. A prototype structure is developed, and a deployment testing campaign is conducted. A concept illustration of the deployment test system is displayed in Fig. 2, where a four-body structure is shown suspended by gravity offload lines and a gravity compensation system of countermasses. The deployment tests include two sets of trials: one in the “cup-down” configuration, where the folded structure creates a “cup” that faces the ground during deployment; and a “cup-up” orientation, where this cup is facing the ceiling. These two sets of data can be used to observe any residual influence of gravity remaining beyond what is offset by the gravity compensation system.A. Four-Body Prototype Design and BuildThe prototype is developed for the simplest closed-chain system case: the four-body structure case. The panel pattern is modeled after the base unit of the Miura-ori pattern, where the fold line geometry of the theoretical pattern is designed such that there is only 1 deg of freedom through folding and unfolding. This makes the pattern ideal for space structures applications. Two tape spring hinges are implemented across a single fold line of the pattern, where spring steel tape spring hinges are used in the prototype build and are modeled in Sec. IV. The prototype structure is shown in the deployed configuration in Fig. 3, where several features are shown. A 60 deg Miura fold angle is chosen for the fold panels to maximize the stability of the folds, resulting in each panel having a parallelogram shape. The edges of the panels are each 337.3 mm long and chamfered to reduce the influence of contact dynamics in the deployment. These edges are attached using thin, 0.0025 in. Kapton tape such that the fold axis of the edge is approximated as the physical edge of the panels. Because thicker material is used for these fold lines, the influence of the material as it curves may become a concern. The tape spring hinges are observed on the lowest panels, where the mounting fixtures are manufactured from three-dimensionally (3-D) printed polylactic acid (PLA). Additional physical properties are listed in Table 1.The physical separation of the two panels along the fold line is a novel advantage for an origami-inspired structure. This opens the possibility of a flat-folded origami pattern, where the thickness of the panels would require extensive design of the fold line placements to ensure flat foldability [27,28]. Using segmentation to enable physical implementation of an origami-inspired pattern due to material thickness is demonstrated by the novel slipping fold design presented by Arya et al. [29] for membrane structure applications. Another example of adapting origami for thick folding was presented by Hernandez et al. [30]; however, their application did not include tight packaging for spacecraft purposes. The hinge design presented here offers another approach to this challenge as applied to rigid or semirigid folded structures, and a basic diagram of this concept is shown in Fig. 4. Figure 5 displays the prototype structure in a nearly folded configuration and suspended in the cup-down orientation. From the hinge view, the multiple degree-of-freedom (DOF) status of the tape spring hinge edge is revealed, where the edges have translated apart and the panels are rotated slightly open, in addition to the primary fold rotation. The panels are able to separate completely, and their relative position and orientation demonstrate multiple-DOF offsets.Fig. 2 Concept illustration of the gravity offloading system and structure prototype (not to scale).Fig. 3 Prototype structure in fully deployed configuration.Fig. 4 Three-view illustration of a thick flat-folded Miura pattern unit with tape spring hinges embedded. A midfold view is also included, where red indicates a valley fold and blue indicates a mountain fold.Fig. 5 Prototype structure in folded configuration in test bed.B. Four-Body Prototype Deployment Test BedDeployment testing of the prototype must provide gravity compensation, measure each panel body’s positions in 3-D space through the deployment duration, and operate at sufficient resolution through the deployment duration. These requirements are met by developing two systems: a suspension system that provides gravity offloading, and a metrology system that is capable of taking the desired measurements.The approach for gravity compensation for the deployment testing is designed as follows: Each panel of the system is treated as a rigid body. The attachment points of the gravity compensation lines are placed at the center of mass of each rigid body using a line tie point. The center of mass of each flat panel is determined from the panel geometry using CAD mass property evaluation tools. The placement of these points determines that the deployment must be tested in either the cup-up or cup-down configurations. A concept diagram of a gravity offloading system and four-body prototype is shown in Fig. 2. The mass of each panel is compensated for using a countermass made from narrow bottles of lead shot. The countermasses are calibrated carefully by hand such that a small angular or linear velocity perturbation along any axis of the structure is not restored by the compensation system, and the velocity is not damped over acceptably small motion ranges. This ensures that the gravity compensation system is not significantly influencing the dynamic response of the deployment. Each gravity compensation line is made from braided spectra and is approximately 6 ft long, where the length is limited by the offload frame. The braided spectra line is selected to eliminate dynamic flexing from the lines. The influence of the static offload point on the deployment is considered negligible, where the translation difference is an order of magnitude smaller than the suspension length. Finally, a detached clamp system is designed to hold the structure in the folded state at the initialization of the test, and it is displayed in Fig. 5. This clamp is activated using a pull pin to release and a stiff torsion spring to quickly open the clamp and move the clamp arms out of range of the structure as it deploys.The metrology system selected for this testing implements the Vicon MX T-series cameras and Tracker 3 software by Vicon Motion Systems. This is a motion capture system that is designed to track discrete targets in three-dimensional space and has established applications for deployable structures testing [20]. Ten Vicon cameras are installed around the gravity offload frame. These cameras are calibrated using a precision calibration tool that enables the Tracker 3 software to learn the camera’s position in space. The results of the calibration used in the test trials state that each camera has an error in knowledge of a target’s position in the camera frame of less than 60  μm. High-precision spherical targets of 14 mm in diameter are installed on the prototype and are visible in Fig. 3; and they are tracked to provide position and orientation data on each of the four panels. Figure 6 displays the panel and hinge frames defined from the spherical targets. Data are collected at a frame rate of 100 frames per second, providing sufficient resolution to observe the dynamic response well. A selection of camera frames from the deployment is shown in Fig. 7 to illustrate the deployment behavior of a single trial. Test results and experimental data are displayed and discussed in Sec. V. Two trial sets of 15 trials were completed: one set in each of the cup-up and cup-down orientations to consider two orientations relative to gravity so that a qualitative assessment of the gravity compensation can be made. All datasets have been treated with a five-point moving average smoothing algorithm on the raw measurements to reduce the appearance of noise. The initial conditions of each trial are found to not be absolutely the same for each case, due to the limitations of the fold clamp and the flexibility of the tape spring hinges. Generally, the cup-up trials have a slightly deployed initial angle of 177 deg, versus the more closed 179 deg of the cup-down cases. This difference in initial conditions is shown to be the primary influence in discrepancies between the two trial sets, and not the influence of gravity. The cup-down trials consistently deploy faster than the cup-up trials because there is more strain energy in the cup-down initial conditions. Both cup-up and cup-down initial conditions are therefore considered when comparing to the multibody dynamics modeling.Fig. 6 Reference frames defined in Vicon denoted as P, and hinge frames denoted by H. Body reference numbers are also included.Fig. 7 Prototype structure through deployment sequence. A video is available in the Supplemental Material.IV. Steel Tape Springs Hinge ModelsSpring steel tape springs are selected for the folded deployable structure study because the behavior of this material is well known and the simulation of the behavior in a finite element software is more reliable. A force-displacement and moment-rotation model of the tape springs is needed to represent the hinge in the multibody dynamics simulations. Data for this are generated from a finite element model for this study and are considered sufficient due to the well-established properties of the hinge materials, and therefore a hinge experiment is not conducted for the spring steel tape springs. A study of developing this approach for high strain composite hinge modeling, including experimental analysis, demonstrated performance with special consideration for the complex composite material [16]. This section provides the details of the hinge relative state model definition, data library generation, the nonlinear regression models, and a statistical evaluation of the model fits.Several research studies characterize the moment-curvature behavior of tape spring hinges for various materials by assuming the hinge folds symmetrically, meaning through only one rotational degree of freedom. Typically, the equal-sense and opposite-sense bending moments are characterized through theoretical analysis and experimental testing, as well as empirical modeling [31,32]. Here, equal sense refers to a fold where the open cross sections face each other, and opposite sense is a fold where the open cross sections face away, as is consistent with the tape spring literature (and can be viewed in Fig. 8). There has been further interest in characterizing the behavior of a diagonally folded hinge [33]. These studies provide fundamental understanding of a hinge’s structural mechanics behavior, focusing on failure and stiffness, as well as demonstrate their correlation with mechanics theory. However, here, the objective is to reframe the hinge as a dynamic actuator and capture the deployment behavior of a system as actuated by the hinge. The tape spring introduces unique challenges from this perspective. A typical fold joint is treated as a single-DOF revolute joint where the attachment points on each connected body are coincident and have one relative rotation. Under certain assumptions, the symmetric behavior of the tape spring hinge can be modeled as a single rotation where themoment-curvature behavior describes the internal torque due to the hinge. However, the connection points are separated by the length of the hinge and will be displaced from each other over the deployment. The actual force and torque response of the hinge will depend on the loading of either side of the hinge, and small displacements from the nominal configuration may introduce significant force and torque responses. Therefore, the established moment-curvature approach is not sufficient for the modeling fidelity desired here; and a study of force and torque responses due to nonsymmetric behavior is conducted.The phenomenon of undesirable nonsymmetric configurations in the tape spring hinge fold is not well studied. Here, nonsymmetric behavior refers to any change in position and orientation that does not follow the nominal fold rotation, as is illustrated in Fig. 9. To guarantee symmetric behavior, additional components must be included in a hinge assembly to constrain the hinge, which can add mass and complexity where lightweight simplicity is desired. Such solutions are not addressed here. Inclusion of multiple independent state variables in this study makes it difficult to approach the problem with classical theory; therefore, to study this phenomenon, numerical techniques are employed to create an empirical model of hinge behavior.Fig. 8 Fold orientations of a high strain tape spring hinge.A. Rigid-Body Dynamics and the Six-State Hinge Model of Forces and TorquesThe tape spring hinge is represented in the rigid-body dynamics simulations as an internal forcing function in terms of the position and orientation of the hinge connection points. This concept is illustrated in Fig. 9, where the fixed end points of the hinge are each assigned a reference frame (A0 and A1), the reaction forces from the hinge are denoted as N0 and N1, and the reaction moments are denoted as M0 and M1. These mechanics are modeled as functions of the relative position δ and orientation of frame A0 with respect to A1.The hinge model is developed to be compatible with a preexisting multibody dynamics framework based on the spatial operator algebra multibody dynamics approach [34]. This approach deconstructs a system of linked rigid bodies by defining the interactions across the hinge connecting an outbound body to an inboard body through relative coordinates and selecting these as the generalized coordinates of the dynamics model. The framework of the algorithm then calculates the system dynamics having only needed the relative hinge definitions and rigid-body properties. To provide consistency with this, the generalized coordinates are selected to be the displacement of the relative hinge frame coordinates and the relative orientation: q=[θ(A0,A1)δ(A0,A1)](1)For this analysis, all dynamics quantities are expressed with respect to the hinge origin frame defined as the inbound frame A0. This lends insight into how the hinge affects any inbound body directly, as well as how an outbound body is affected relative to the inbound body. This information can be easily transformed to desired frames as needed. The hinge origin frame is oriented on the hinge such that the third axis a03 pointed down the length of the hinge a02 is normal to the hinge cross section, and a01 completes the right-hand convention. The relative orientation θ(A0,A1) contains 123 Euler angles for ease of interpretation and because the second axis, where the 90 deg Euler angle singularity resides, can be oriented with an axis that does not accommodate significant relative deflection. The A1 frame is oriented identically to the A0 frame when the hinge is deployed in the zero energy state. The displacement of the relative hinge frame coordinates δ is selected over the relative position r to better correlate the physical behavior with the numerical fit. The relation of these vectors is displayed in Fig. 9, which is defined as δ=r−ri(2)Then. the generalized forces and torques acting at frame A0 are written as a function of the relative coordinates across the hinge frames, in spatial notation, as f0(q)=[M0N0]=[M01M02M03N01N02N03]T(3)Fig. 9 Definitions for a tape spring hinge in deployed (left) and nonsymmetric (right) configurations.B. Model Estimation and Nonlinear Regression ApproachThe next objective is to determine adequate empirical models for the six entries of f0(q). There are several options for determining response functions that include large multivariable datasets. Simple approaches include using a lookup table or interpolation between data points. However, these will not necessarily provide insight into predictor variable relationships and cannot be further manipulated. Therefore, a function fit is desired. A polynomial containing both first-order and second-order coupled polynomials is first proposed for capturing the nonsymmetric relationships, where the number of coefficients would be excessive for higher-order polynomials: p(q)=∑i=16aiqi+∑j=16∑k=16bj,kqjqk(4)For the symmetric fold, it is suggested from the literature that the nominal fold produces a pure moment in the symmetric case, and this moment can be represented empirically using a seventh-order polynomial [31]. However, in this study, the best-fit empirical regression model is determined to be a piecewise nonlinear function of the form M01={∑i=26aiθ1i+∑i=14bi1(θ1+ϵ)iθ1>0c1θ1+c2θ12θ1<0(5)where the inclusion of the inverse polynomial terms in Eq. (5) greatly increases the fitting performance for the theoretical peak moment due to snapthrough of a tape spring hinge, as seen in Fig. 10. In this expression, θ1 is the Euler angle about axis 1 (or the nominal fold angle on the primary hinge axis); ϵ,=0.001 is a small numerical buffer to prevent numerical issues at zero; and ai, bi, and ci are the coefficients to be determined through regression techniques. A nonlinear regression approach is best suited for the nonlinear, multivariate model functions in Eqs. (4) and (5). For practical applications, a unique regression should be fit for tape springs of different materials or geometry. The Statistics and Machine Learning Toolbox published for MATLAB is used to fit and evaluate the models. The quality of the fit is evaluated by several means. The toolbox is further used to acquire an R-squared estimate, the root-mean-squared error (RMSE), and the histograms of the raw residuals. The coefficient of determination (R squared) is meant to indicate how much of the variation in the response is captured by the model and is expressed on a scale of zero to one, where the fit is better the closer it is to one. For a nonlinear regression, the R-squared value is not entirely trustworthy but is included here for initial evaluations. The root-mean-squared error is the average standard deviation of the fit, and the residual histograms provide a full picture of how variable the fit is.C. Prototype Tape Spring Actuated Hinge DesignThe folded deployable structure prototype hinge design is as follows. For this study, only the fold line where tape spring hinges are embedded is of immediate interest. Two tape springs are embedded to provide stability, to reduce the degrees of freedom, and to provide sufficient torque for deployment. This configuration of this hinge design is displayed in Fig. 11, as depicted in the Abaqus 6.14 user interface. The tape springs are identical, and their relevant geometry and material properties are reported in Table 2. One hinge model is created from the two-tape-spring configuration shown in Fig. 11, to be used in the multibody dynamics model. The multibody dynamics model defines the relationship between two bodies and is not sophisticated enough to implement two relationships for the same two bodies.Fig. 10 Nonlinear regression fit curves for the nominal fold hinge data.Fig. 11 Implementation of two tape spring hinges on a single fold line of two panels and examples of displacements implemented in Abaqus where the symmetric angle is ±90  deg.D. FEA Hinge Model ConstructionThe finite element analysis simulations of hinge behavior are built in Abaqus 6.14 using a static, general analysis. The hinge is represented as a shell with elastic behavior defined by the elastic modulus and a Poisson’s ratio of 0.3. The hinge mounting plates and panel assembly are represented as a discrete rigid part, and the tape springs are constrained to them using tie constraints. The rigid panel assembly is only included to enforce the hinge boundary conditions and does not affect the hinge model generated in the static analysis. Four-node shell (S4R) elements are meshed on the hinge shell using a 2 mm mesh because this is the largest mesh size that results in successful folding of the prototype due to the large deformation of the fold radius on the tape springs, where element deformations above 20 deg are not desirable. Further mesh refinement to 1 mm or smaller mesh sizes was completed and had comparable results to the 2 mm mesh; however, a more coarse mesh was not as accurate. The largest accurate mesh is selected to reduce run time. The asymmetric configurations are implemented as displacement and rotation boundary conditions in static/general steps. Each range of asymmetric configurations is explored as a separate step enforced on an initially symmetric configuration. An asymmetric dataset is generated for each primary fold angle θ1 at increments of 5 deg from 100 to 180 deg of the fold, resulting in nine equal-sense datasets. Asymmetries on smaller fold angles are excluded because they are unlikely and introduce Abaqus convergence issues. Figure 11 shows example profiles for the equal-sense cases with nonsymmetric displacements, with a no-added-deformation scaling.The configuration of the hinge within the prototype design informs the definition of the asymmetric configurations. From inspection, three degrees of freedom from the six-state hinge model defined in Sec. IV.A can be excluded for this study. This is due to the fact that the prototype has single-degree-of-freedom hinges on the other fold lines, constraining linear motion in the first and second axes and rotations about the second axis. Therefore, the configuration constraints in the model simulation contain three asymmetric configurations beyond the nominal fold. These are defined in Table 3, where the first asymmetry is on the primary degree of freedom, and the second asymmetry captures the remaining observed degrees of freedom on the fold line. Considering the opposite-sense behavior of this hinge, all potential asymmetries are eliminated due to the constraining design of the panels when folded in this direction. Therefore, only the nominal fold data in the opposite sense are needed from the simulation.The effects of hysteresis on the tape spring moment-curvature behavior, which are dependent on the trajectory of the folding, are not included in this model. This is not necessary because the deployment direction behavior is the primary driver of the deployment, and computational and numerical issues that are observed around the asymptotic peak outweigh any subtle difference due to hysteresis.E. Nonlinear Regression ModelsThe hinge profile data are fit to polynomial expressions using the nonlinear regression techniques from Sec. IV.B. Two models are created for use in the prototype deployment model. The first model is for the nominal fold torque and is only a function of the nominal fold angle. This provides an idealized model for initial evaluation of the deployment characteristics. The second model considers the full spatial force and torque profile from the asymmetric profiles of the prototype hinge. For both models, a piecewise function is designed for the primary moment such that the equal-sense and opposite-sense behaviors are modeled independently. This provides a much more accurate behavior model, where the opposite-sense fold behavior is significantly different due to the presence of the rigid-body panels and restricted freedoms due to contact with the panels.1. Nominal Fold MomentThe resulting coefficients are reported in the Appendix in Table A1, and the fit function is plotted over the source data in Fig. 10. Additionally, the statistic evaluations of these regressions are reported in Table 4; and the histograms and normal probability are shown in Fig. 12, where the residuals of the fit are shown in blue and indicate the fit is centered around zero, confirming the quality of the fit. The RMSE for the opposite-sense case is much higher due to the stiffness of the system folding in the opposite-sense direction. For this same reason, the opposite-sense fold angle range is limited because the structure will not be able to fold very far in this direction. The nonlinear regression model for the nominal fold data is seen to be a strong fit in both the equal- and opposite-sense cases. The model histograms show a near-Gaussian distribution with no outliers, and the normal probability is approximately linear as expected. This model therefore provides a sufficient representation of the hinge behavior when restricted to a single-degree-of-freedom deployment demonstration.Fig. 12 Fit function histogram and normal probability for the nominal fold simulation data.2. Six-DOF Asymmetric Fold MomentThe proposed polynomial from Eq. (4) is implemented for the secondary forces and torques of the steel tape springs prototype hinge model using the asymmetric data library, and coefficients are reported in Table A2 in the Appendix. The primary moment M01 is found to be sufficiently modeled with just the expression of Eq. (5) using the steel spring hinge data library as well, and the coefficients for this case are recorded in Table A3 in the Appendix. The opposite-sense behavior of the hinge is modeled with the same data of the one-DOF model in Sec. IV.E.1. The RSME and R-squared values for each fit are shown in Table 5, and the fits are for all but the second axis force are all in a high percentile with relatively small RSMEs compared to the force and torque magnitudes. The histograms in Fig. 13 reflect this, where the fits fall in a narrow distribution with few outliers. These force and torque models are therefore sufficient for use in the demonstration of a multi-DOF hinge actuated deployment.Fig. 13 Fit function histograms for the asymmetric hinge fold simulation data.V. Results: Multibody Model Deployment Dynamics PredictionA multibody dynamics model is developed from an approach outlined in previous work [15,17] by the authors. The approach implements a spatial operator algebra framework and is based on the articulated body forward dynamics algorithm to simulate the dynamics of origami-inspired systems. The framework is customized for this application, and is therefore computationally efficient; however, challenges from constraint violation management are acknowledged. Two deployment simulations are presented with the multibody dynamics model, absent of contact or damping effects. The first simulation implements the 1-DOF hinge model in an idealized 1-DOF fold. The second simulation implements a 4-DOF hinge definition with a multi-DOF hinge force and torque model. The idealized 1-DOF simulation shows a smooth deployment behavior with a predicted time to peak deployment at 0.70 s, as seen in Fig. 14. Additionally, the spacecraft motion is shown in Fig. 15 and the constraint violations are shown in Fig. 16. The multi-DOF models, on the other hand, show a behaviors curve that more closely tracks the experimental models and exhibits small oscillations, as well as peak deployments at 0.82 and 0.92 s for the two sets of initial conditions, as seen in Figs. 17 and 18. Again, the spacecraft motion is shown for this case in Fig. 19 and the constraint violations are shown in Fig. 20. Both models exhibit unstable constraint violations at peak panel deployment that can be attributed to the asymptotic behavior of the hinge model around this state, where deployment is driven entirely by hinge strain energy. This identifies a central challenge for modeling the deployment dynamics of free-deploying structures with a fast deployment. The computation time for the 1-DOF model is 6.7 s; and for the 4-DOF model, it is 6.3 s to simulate 1 s of deployment. The simulation is run on a machine with a 2.5 GHz quadcore Intel Core i7 processor with 16 GB of memory, using a fixed-step fourth-order Runge–Kutta integrator.A. One-DOF Hinge Deployment ModelThe initial conditions for the simulation are provided in Table 6 and are selected for the idealized flat-folded relative angles. All initial rates are set to zero. The hinge between panels 4 and 3 is restricted to a single-degree-of-freedom rotation about the first axis. The simulation is shown in Fig. 14 to predict a smooth deployment behavior, with peak deployment occurring at 0.7 s. After the structure reaches a fully deployed configuration, however, the structure enters a difference folding mode, where only the folds at hinges 2-1 and 4-3 are changing; and folds 3-2 and 4-1 remain open. This can be interpreted as the structure folding in half, and it is not observed during the testing. Note that the orientation angles are expressed in the relative hinge frames defined in Fig. 6. This discrepancy is attributed to the presence of unmodeled contact in the prototype, where contact along the chamfered edges of Kapton hinges prevents this folding mode. In Fig. 15, the states of the root body with respect to inertial space show there is a significant general tumble introduced to the system in response to the deployment. The effect of the deployment to the system states in an actual implementation of this structure would rely heavily on energy damping and contact within the structure as well as energy management techniques within the spacecraft. Figure 16 reveals a significant constraint violation at the peak deployment and indicates that better constraint management techniques are needed for accurate prediction of deployment behavior as the system crosses this state. The constraint equation requires the bodies of the system to create a closed-chain origami pattern. A perfectly constrained model would produce a zero curve for the constraint violation over time; and in Fig. 16, this is not the case. Constraint management such as the Baumgarte stabilization used here balances tuning the correction gains and the integration time step. This is in direct opposition to the asymptotic nature of the hinge behavior close to the deployed configuration (θ1=0), where smaller time steps will generate more data points along the asymptotic legs of the curve, producing a more erratic (and therefore unstable) behavior that is difficult to correct with a simple linear gain. It is possible to reduce the asymptotic peak of the hinge model, where the theoretical peak is often higher than the observed, and this might improve model stability.Fig. 14 Deployment actuation predictions of 1-DOF hinge simulation and experimental behavior from cup-up and cup-down trials. Orientation angles expressed in relative hinge frames defined in Fig. 6.Fig. 15 Angular orientation and rates of the spacecraft body in three-dimensional space. (MRPs denotes modified Rodrigues parameters.)Fig. 16 Constraint violations during 1-DOF prototype numerical simulation peak as simulation enters asymptotic range of hinge behavior, where a perfectly modeled constraint would track zero.Fig. 17 Deployment actuation predictions of the four states of hinge 4-3 and their experimental counterparts from all trials.B. Four-DOF Hinge Deployment ModelThe initial conditions of the two numerical simulations for the 4-DOF case, shown in Table 7, are set to emulate the nonideal, actual conditions of the average deployment from the cup-up and cup-down trials. Initial conditions of the two configurations differ due to differences in gravity orientation and boundary condition enforcements in the cup-up and cup-down trials. The nonideal initial conditions were not implemented in Sec. V.A because these initial conditions do not satisfy the constraint conditions of a 1-DOF hinged structure, and therefore were not stable. From the design of the prototype, the tape spring hinge fold line between panels 4 and 3 (hinge 4-3) is constrained due to the configuration of the other three hinges; therefore, two of the degrees of freedom can be removed such that the generalized coordinates are q=[θ1θ2δ2δ3]T(6)where δ2 and δ3 are measured from the panel edge as shown in Fig. 6.From Fig. 17, the numerical simulation of these four states shows good correlation of the primary fold; however, the three asymmetric states are not well predicted. The observed oscillatory behavior has a much lower frequency and greater magnitude than what is predicted for θ2 and δ3, and the δ2 simulation does not predict the oscillation observed. The difference between the model and the experimental behavior may be due to further unmodeled effects from the hinge or may be influenced by unknown perturbations from the gravity compensation system. The primary angle θ1 is observed to better track the observed behavior curve than the 1-DOF model, and the deployment peak times are closer to the observed: at 0.82 s and 0.92 s for the cup-down and cup-up initial conditions as compared to 0.83 and 0.93 s of the cup-up and cup-down trials, respectively. However, the predicted behavior at and after the snapthrough at the peak deployment is observed to quickly go unstable for these simulations. The constraint violations for the cup-up simulation in Fig. 20 show the simulation is not able to resolve the constraints near this point, and therefore the results are not reliable: particularly for the translational degrees of freedom. However, inclusion of the additional DOFs resulted in a more accurate prediction for the primary fold behavior, indicating that these DOFs have significant influence on deployment behavior. Modeling challenges can partially be attributed to numerical difficulties near the deployed configuration, where there are numerical singularities when the relative orientations pass through zero, and may be having greater influence on the multi-DOF constraint equations. This behavior is also attributed to the hinge function issues highlighted in Sec. V.A, where the instability then influences multiple forcing functions across several states, and therefore yields more erratic behavior. Further investigation into the hinge model approach will yield better predictions for structure behavior, such as considering the sensitivity of the hinge model to initial conditions. The states of the other fold lines, seen in Fig. 18, show good tracking of the observed behavior for the simulations. The predicted behavior for all fold angles is seen to accelerate at a greater rate near the deployed state than what is observed, and this is attributed again to the theoretical peak moment of the tape springs. The prediction does not settle out due to a lack of contact and damping in this model. The inertial states of the root body in Fig. 19 shows very similar behavior as that in Fig. 15, predicting a general inertial tumble of the system.Fig. 18 Deployment actuation predictions of the three 1-DOF hinges and their experimental counterparts from all trials.Fig. 19 States of the root body in three-dimensional space for cup-up initial conditions.Fig. 20 Constraint violations during the 4-DOF prototype numerical simulation peak as the simulation enters the asymptotic range of the hinge behavior for cup-up initial conditions.VI. Finite Element Model ComparisonA matching finite element simulation-based model provides an additional analysis that complements the research demonstrated in this paper. Although the first Abaqus model informed a hinge behavior model using static analysis, this Abaqus model will simulate the free-deployment dynamics of the prototype. A model of the prototype is constructed in Abaqus to generate deployment dynamics data and is compared to both the experimental data and the folding system multibody dynamics model. The graphic representation of this model is shown in Fig. 21 in various states of deployment. The finite element model is expected to capture more subtle behaviors in the system than the multibody model; however, the computation time is expected to reach long times. The prototype is composed of two tape spring hinges in a system subject to closure constraints in full three-dimensional space, creating additional computational complexity. This simulation provides a point of comparison for the performance of the multibody model with another approach seen in the deployable structures field for studying this kind of system. The literature lacks demonstration of FEA modeling for folding deployable structures; therefore, this study provides insights for the greater community on its relative use and performance with respect to a multibody model.A. Abaqus Model ConstructionFinite element analysis has been applied extensively to deployable spacecraft structure problems and represents the industry standard for understanding complex deformable and deployable systems. An FEA model of the prototype structure is created to provide an additional point of reference for the expected deployment behavior. FEA modeling capabilities are required in addition to multibody modeling due to the large deformation behavior of the two tape spring hinges in the system. The behavior of these tape springs as they work together in a closed-chain system is not possible to capture without the full FEA. The model is developed using the Abaqus/CAE 6.14 program. The program architecture of Abaqus heavily influences and limits the construction of the model and will now be discussed in detail. The discussion will be formatted to follow the module design of Abaqus to provide continuity for familiar users.1. Abaqus/Standard and Abaqus/ExplicitFirst, the two Abaqus software packages used, Abaqus/Standard and Abaqus/Explicit, are discussed. These two packages are designed by Abaqus as two complementary analysis tools to be applied as appropriate to a wide variety of problems. Although the tools are used for similar problems, they are designed with fundamental differences in the theories applied. Abaqus/Standard provides good static analysis tools by solving for true static equilibrium in structural analysis. It also contains dynamic/implicit analysis, which is well suited for slow and stable dynamics problems. Implicit analysis uses the current information available at the current time to calculate the unknown values and requires iterations and convergence checks, which are implemented in Abaqus using the Hilber–Hughes–Taylor operator (an extension of the trapezoidal rule). Conversely, the dynamic/explicit analysis in the Abaqus/Explicit package obtains unknown values at the current time step using the information obtained from the previous time step, in what is known as an explicit dynamic integration method (or forward dynamics). Abaqus uses the forward Euler or central difference algorithm, and it adjusts the time increment to be small enough that the result lies on the curve. Abaqus/Explicit is best for dynamic problems that are high speed, have large nonlinear behavior, or are highly discontinuous. For the context of this research, the large nonlinear deformations of the tape spring hinges combined with the use of a complex system assembly requires that a dynamic/explicit analysis be used for the free-deployment simulation. Therefore, the analysis is set up in two main phases. The first phase creates a preload condition on the system to replicate the stowed configuration of the structure, and this is completed in Abaqus/Standard. Then, the results are imported to an Abaqus/Explicit model as the initial state and a full dynamic/explicit step is run. Although it was not considered here, dynamic/explicit could have been used for the stow phase to potentially achieve a faster computation time while implementing mass scaling and damping.2. Parts, Material Properties, and AssemblyThe physical structure is represented using ten parts with the following attributes. Each panel assembly (including the Vicon targets, hinge assemblies, and hardware) is represented by a unique deformable trapezoidal shell part. This is required to minimize the complexity of the mesh and reduce the computation time of the analysis. The full panel assembly is then represented by the user input inertia properties. The properties are generated by the solid CAD model approximation, where physically measuring the inertia properties was not an option. The inertia properties are applied at the center-of-mass location of each panel for correct geometric representation. The panels are assigned elastic mechanical properties and set with the Young’s modulus for cast acrylic because this is the material of the panels and additional assemblies are represented by rigid bodies. Then, four rigid-body hinge attachment plates are used to interface between the folding panels and the tape spring hinges. These parts are geometrically simplified versions of the hinge attachment plates and are modified to provide the best mesh and constraint surface definitions in the analysis. Finally, the tape springs are represented by deformable extruded shell parts with a Young’s modulus for spring steel. The details of this construction are summarized in Table 8. The mesh size of the tape springs is set to 2 mm because this is the largest mesh size that results in successful folding of the prototype due to the large deformation of the fold radius on the tape springs, where element deformations above 20 deg are not desirable. Then, for successful interactions between the tape spring and the attachment plate, the same mesh size is applied to the attachment plate. The mesh of the panels is set to the recommended size of 33 mm, but it is refined to 2 mm at the region that interacts with the attachment plate: again, for interaction purposes. The sensitivity of the tape spring component to mesh size is therefore the driving factor for the mesh design. A lower-fidelity mesh would reduce computation time but would yield unreliable results.3. Lessons Learned: Interactions and ConstraintsDetermining the best implementation of the interactions and constraints is a central challenge to the application of Abaqus to folded deployable structures. First, consider the constraints. The initial approach concept strove to represent the panels as rigid bodies to reduce the computational complexity of the simulation. However, the interconnected nature of the panels proved to make this infeasible using the Abaqus framework. The primary way to connect the panels would be through either constraints or connector elements. A tie constraint between the mesh nodes of the edge of the panel can represent this behavior if the rotational degrees of freedom are not included in the constraint between the nodes. This is the method used in this analysis. However, Abaqus is not capable of enforcing a tie constraint between two rigid bodies. The rigid-body tools have been developed to represent interactions between test coupons and their fixtures, and therefore are not well suited to create this kind of model. Therefore, the panels are represented by deformable parts and are given accurate material properties to capture the real system’s flexibility. The tape springs are attached to the hinge attachment plates using a surface-to-surface tie constraint between the overlapping surfaces. Finally, the hinge attachment plates are constrained to the panels at their attachment points using coupling constraints. Coupling constraints require that a set of slave nodes follow the behavior of a master point. The master point is set to a reference point on the hinge plates. In the full assembly, each panel is subject to either a master or slave tie constraint designation for the fold line. This reduces the available nodes for the slave nodes, and therefore a small radius of influence (set to 60 mm) is dictated for the coupling constraint slave node designation. A summary of all constraints needed to capture the prototype Miura unit structure is provided in Table 9.Considering the interactions, there are a few primary concerns to address. These are all due to the presence of contact in the stowed step of the simulation. Obtaining the stowed configuration requires the tape springs contact with the attachment plates while not self-intersecting when they are brought together in the final configuration. Additionally, the shell representations of the panels may intersect in the fully stowed configuration. The panel contact interactions are considered negligible due to their thin shell designation, where at a full 180 deg fold, they would be occupying the same plane. Additionally, the expected behavior of the system does not include panel-to-panel contact through deployment. A basic “hard contact” property is defined for all contact interactions. Contact interactions are defined between each of the attachment plates and the tape springs. These contact interactions are found to be a primary influence on the deployment behavior, where a hard contact definition results in a failed deployment, but a staged multistep defined separation results in the expected deployment behavior. No experiments were conducted to model this contact surface, and so these results must be taken with a grain of salt. Future work must be careful in modeling any contact surfaces within the structure. Additionally, self-contact interactions are defined for the tape springs to prevent self-intersection in the fully deployed configuration. A general self-contact designation for the full model is not used because it is unnecessary and computationally infeasible.4. Lessons Learned: Loads and Boundary ConditionsTo obtain the free-deployment dynamics behavior, the system must first be preloaded into the high strain initial condition and then released for deployment. The loads and boundary conditions modules provide tools to manipulate the model into the desired initial conditions for the dynamic analysis. The limitations of the software require this to be a multistep process. The specific sequential implementation of these loads and boundary conditions is outlined in the next section. The first boundary condition fixes the position of the P4 panel by applying encastre boundary conditions at each of the reference points of the hinge attachment plates. These plates are selected because the rigid bodies control both the panel behavior and the tape spring behaviors. Similarly, the primary fold-enforcing boundary condition is applied at the hinge attachment plate Reference Points (RPs) that are mounted to the P3 panel. A small initial fold is introduced to the 2-1 hinge fold line to ensure the fold starts in the correct direction but is otherwise uncontrolled. The boundary conditions of the static general analysis are applied over a linear ramp on an arbitrary time step, and simultaneously controlling more than one fold line is not recommended over the full course of the folding step. Additionally, a loading condition is applied to the tape springs to help initialize the folding behavior. This is a pressure load applied uniformly across the tape springs to press them flat against the panels at the initial fold. This is necessary because of the high stiffness condition of the tapes close to the initial buckling in folding. After the initial fold, the pressure is reduced for the duration of the folding. After folding, the pressure is deactivated. All boundary conditions and loads are summarized in Tables 10 and 11, and they are removed for the free-deployment step. The initial conditions enforced in Abaqus are not the same as the measured boundary conditions using this preloading approach, and Abaqus was unable to converge to those initial conditions with further iteration. However, the idealized initial conditions of the Abaqus simulation are close enough to simulate the deployment.5. Lessons Learned: Step SequenceThe step sequence is outlined in detail in Table 12 and references the same loads and boundary conditions defined in Tables 10 and 11. The complexity of the multistep approach to creating the desired preloaded condition of this structure illustrates the difficulty of this approach for folded deployable spacecraft structures. This prototype only contains one fold pattern unit structure and is the minimum pattern case where, in practice, tens to hundreds of unit structures are desired. The analysis clock time for the preloaded condition steps is 45 min.B. Abaqus Deployment Trial Results and Comparison to Measured TestsThe Abaqus/Explicit deployment simulation results are displayed over the experimental deployment data in Fig. 22, and they show the bulk deployment behavior is well predicted. Two seconds of simulation requires approximately 22 h of user clock time to compute using Windows 10 on a Parallels virtual machine with 4 GB of memory and two processors. The clock time can be significantly improved with more advanced computer hardware. Additionally, an optimization study to provide a refined mesh may improve the simulation time. Looking at the secondary behaviors, such as the oscillations and motion trends, it is possible the discrepancies between the experimental and Abaqus simulations are due to test environment effects, such as atmospheric drag and gravity. Although these effects can be simulated in Abaqus, this is not done due to challenges with defining the relative orientation of these effects. The predicted deployment time is seen to be 0.88 s, midway between the cup-up and cup-down trials. The result is suspected to be due to the initial conditions of the simulation, as well as the imperfect modeling of the contact behavior between the tape springs and their attachment plates. Overall, the simulation is able to predict the bulk behaviors and the settling of the structure in the deployed state well, where the initial oscillations appear to settle out over 1 s in both the Abaqus simulation and the experimental data (see Fig. 22).This Abaqus modeling effort quantifies the time and effort commitment of creating a high-fidelity deployment model, and it highlights the limitations of the multibody dynamics modeling approach. In practice, it is recommended that the multibody modeling approach be implemented for large-scale fold patterns of many bodies and for early design iterations of the geometry, mass, and hinge properties. The fast computation speed of the multibody framework increases feasibility of large parameter design studies, and the accuracy of the deployment model is shown to be sufficient for informing early design evaluations. A high-fidelity FEA deployment model should also be studied, but it is primarily recommended for validation phases of the project. The FEA model is best able to capture the secondary behaviors of the flexible panels, the lockout of the hinges, and contact behaviors. Deployment testing of a prototype provides context for expected performance and should be conducted during the design cycle of the project. All three datasets confirm the prototype folded structure will successfully self-deploy with the tape spring actuated hinge design.Fig. 21 Graphic representation of the deployment stages from the Abaqus simulation graphic user interface. A video is available in the Supplemental Material.Fig. 22 Deployment actuation predictions from the Abaqus FEA model of the four states of hinge 4-3 and their experimental counterparts from all trials.VII. ConclusionsIn this paper, simulations of a self-actuated origami-folded prototype structure are constructed from complex hinge models integrated into a multibody dynamics model of the prototype. The simulations are compared to experimental deployment dynamics data, and performance is evaluated. The simulations of both 1-DOF and 4-DOF hinge models show good prediction of the deployment time; however, deployment behavior past the peak deployment is not well predicted due to constraint violations and a lack of contact and damping in the model. Issues due to constraint violations are identified as the primary challenge of accurate deployment dynamics modeling for free-deploying high strain structures. An additional simulation is constructed using a full finite element analysis, and the deployment time is also well predicted, as well as the settling period. The overall deployment behavior is also captured across multiple degrees of freedom; however, the simulation takes 22 h of computation time to complete, as compared to 6–7 s for the multibody dynamics models. This confirms the original motivation of designing a more computationally efficient method of deployment dynamics modeling, and it demonstrates that multibody dynamics modeling is able to predict some deployment behavior with similar accuracy. In practice, it is recommended that the multibody modeling approach be implemented for large-scale fold patterns of many bodies and for early design iterations of the geometry, mass, and hinge properties. The fast computation speed of the multibody framework increases feasibility of large parameter design studies, and the accuracy of the deployment model is shown to be sufficient for informing early design evaluations. The FEA model is best able to capture the secondary behaviors of the flexible panels, the lockout of the hinges, and contact behaviors. Deployment testing of a prototype provides context for expected performance and should be conducted during the design cycle of the project. All three datasets confirm the prototype folded structure will successfully self-deploy with the tape spring actuated hinge design, demonstrating the feasibility of implementing this novel design concept.V. BabuskaAssociate EditorAppendix:  Nonlinear Regression Coefficients‡ “ATK Demonstrates High-Power MegaFlex Solar Array for NASA,” ATK, 2014, http://photos.prnewswire.com/prnh/20140121/CG49597 [retrieved 14 April 2020].§ “Origami in Space: BYU-Designed Solar Arrays Inspired by Origami,” Brigham Young Univ., Provo, UT, 2013, https://www.youtube.com/watch?v=3E12uju1vgQ [retrieved 14 April 2020].AcknowledgmentsThis research was conducted under support from the NASA Space Technology Research Fellowship under grant 80NSSC17K0136. The authors would like to acknowledge the NASA Jet Propulsion Laboratory and Tendeg, LLC, for support with testing efforts, as well as NASA collaborators Olive Stohlman and Fransisco Lopez-Jimenez for their support with Abaqus.\r            References\r        [1] Zirbel S. A., Trease B. P., Thomson M. W., Lang R. J., Magleby S. P. and Howell L. H., “HanaFlex: A Large Solar Array for Space Applications,” Micro- and Nanotechnology Sensors, Systems, and Applications VII, edited by George T., Dutta A. K. and Islam M. S., Vol. 9467, SPIE, Bellingham, WA, 2015, pp. 179–187. https://doi.org/10.1117/12.2177730 Google Scholar[2] Murphy D., “MegaFlex—The Scaling Potential of UltraFlex Technology,” 53rd AIAA/ASME/ASCE/AHS/ASC Structures, Structural Dynamics and Materials Conference, AIAA Paper  2012-1581, 2012. https://doi.org/10.2514/6.2012-1581 LinkGoogle Scholar[3] Jeon S. K. and Footdale J. N., “Scaling and Design of a Modular Origami Solar Array,” AIAA SciTech Spacecraft Structures Conference, AIAA Paper  2018-2204, 2018. Google Scholar[4] Jeon S. and Murphey T., “Fundamental Design of Tensioned Precision Deployable Space Structures Applied to an X-Band Phased Array,” 53rd AIAA/ASME/ASCE/AHS/ASC Structures, Structural Dynamics and Materials Conference, AIAA Paper  2012-1447, 2012. https://doi.org/10.2514/6.2012-1447 LinkGoogle Scholar[5] Pehrson N. A. and Banik J., “Folding Approaches for Tensioned Precision Planar Shell Structures,” AIAA SciTech Spacecraft Structures Conference, AIAA Paper  2018-1439, 2018. LinkGoogle Scholar[6] Thomson M., Lisman D., Helms R., Walkemeyer P., Kissil A., Polanco O. and Lee S.-C., “Starshade Design for Occulter Based Exoplanet Missions,” Space Telescopes and Instrumentation 2010: Optical, Infrared, and Millimeter Wave, Vol. 7731, SPIE Proceedings, 2010. Google Scholar[7] Reynolds W., Jeon S. and Banik J., “Advanced Folding Approaches for Deployable Spacecraft Payloads,” Proceedings of the ASME 2013 International Design Engineering Technical Conference and Computers and Information in Engineering Conference, ASME, New York, 2013. Google Scholar[8] Kling D., Jeon S. and Banik J., “Novel Folding Methods for Deterministic Deployment of Common Space Structures,” 3rd AIAA Spacecraft Structures Conference, AIAA Paper  2016-2168, 2016. LinkGoogle Scholar[9] Zirbel S. A., Trease B., Magleby S. P. and Howell L. L., “Deployment Methods for an Origami-Inspired Rigid-Foldable Array,” Proceedings of the 40th Aerospace Mechanisms Symposium, NASA Goddard Space Flight Center, May 2014, pp. 189–194. Google Scholar[10] Huffman D. A., “Curvature and Creases: A Primer on Paper,” IEEE Transactions on Computers, Vol. c-25, No. 10, 1976, pp. 1010–1019. CrossrefGoogle Scholar[11] Woo K. and Jenkins C. H., “Effect of Crease Orientation on Wrinkle–Crease Interaction for Thin Membranes,” Journal of Spacecraft and Rockets, Vol. 50, No. 5, 2013, pp. 1024–1034. https://doi.org/10.2514/1.A32183 LinkGoogle Scholar[12] Murphey T. W. and Pellegrino S., “A Novel Actuated Composite Tape-Spring for Deployable Structures,” 45th AIAA/ASME/ASCE/AHS/ASC Structures, Structural Dynamics and Materials Conference, AIAA Paper  2004-1528, 2004. LinkGoogle Scholar[13] Pellegrino S., Deployable Structures, Springer-Verlag, Berlin, 2001. CrossrefGoogle Scholar[14] Fulton J. and Schaub H., “Dynamic Modeling of Folded Deployable Space Structures with Flexible Hinges,” 2017 AAS/AIAA Astrodynamics Specialist Conference, AAS Paper  17-747, 2017. Google Scholar[15] Fulton J. and Schaub H., “Closed-Chain Forward Dynamics Modeling of a Four-Panel Folding Spacecraft Structure,” International Astronautical Congress, Paper  IAC-18.C1.4.3x42523, 2018. Google Scholar[16] Fulton J. and Schaub H., “Non-Symmetric Behavior of High Strain Composite Tape Spring Hinges for Folding Structures,” Spacecraft Structures Conference, AIAA SciTech Forum, AIAA Paper  2019-1747, 2019. LinkGoogle Scholar[17] Fulton J. and Schaub H., “Forward Dynamics Algorithm for Origami-Folded Deployable Spacecraft Structures,” International Astronautical Congress, Paper  IAC-19.C1.5.8x50478, 2019. Google Scholar[18] Sauder J., Chahat N., Hodges R. E., Peral E., Rahmat-Samii Y. and Thomson M., “Lessons Learned from a Deployment Mechanism for a Ka-Band Deployable Antenna for CubeSats,” Proceedings of the 44th Aerospace Mechanisms Symposium, NASA Glenn Research Center, May 2018, pp. 361–373. Google Scholar[19] Footdale J. N. and Banik J., “Design and Deployment Testing of the Multi-Arm Radial Composite (MARCO) Reflector Antenna,” 3rd AIAA Spacecraft Structures Conference, AIAA Paper  2016-0700, 2016. https://doi.org/10.2514/6.2016-0700 LinkGoogle Scholar[20] Fulton J., Jeon S. and Murphey T. W., “Flight Qualification Testing of a Meter-Class CubeSat Deployable Boom,” 4th AIAA Spacecraft Structures Conference, AIAA Paper  2017-0621, 2017. LinkGoogle Scholar[21] Mobrem M. and Adams D. S., “Deployment Analysis of the Lenticular Jointed Antennas Onboard the Mars Express Spacecraft,” Journal of Spacecraft and Rockets, Vol. 46, No. 2, 2009, pp. 394–402. https://doi.org/10.2514/1.36890 LinkGoogle Scholar[22] Adams D. and Mobrem M., “MARSIS Antenna Flight Deployment Anomaly and Resolution,” 47th AIAA/ASME/ASCE/AHS/ASC Structures, Structural Dynamics, and Materials Conference, AIAA Paper  2006-1684, 2006. https://doi.org/10.2514/6.2006-1684 LinkGoogle Scholar[23] Montazersadgh F. and Mobrem M., “Structural Analysis Methodology for Space Deployable Structures Using Multi-Body Dynamic Analysis Solver,” AIAA Modeling and Simulation Technologies Conference, AIAA Paper  2018-0421, 2018. Google Scholar[24] Olson G., Murphey T. and Thomas G., “Free Deployment Dynamics of a Z-Folded Solar Array,” AIAA Paper  2011-1730, 2011. https://doi.org/10.2514/6.2011-1730 LinkGoogle Scholar[25] Pehrson N. A., Smith S. P., Ames D. C., Magleby S. P. and Arya M., “Self-Deployable, Self-Stiffening, and Retractable Origami-Based Arrays for Spacecraft,” AIAA SciTech Spacecraft Structures Conference, AIAA Paper  2019-0484, 2019. LinkGoogle Scholar[26] Blandino J. R., Ross B., Woo N., Smith Z. and McNaul E., “Simulating CubeSat Structure Deployment Dynamics,” AIAA SciTech Spacecraft Structures Conference, AIAA Paper  2018-1677, 2018. LinkGoogle Scholar[27] Tachi T., “Rigid-Foldable Thick Origami,” Vol. 5, 5th International Meeting of Origami Science, Mathematics, and Education, Singapore Management Univ., CRC Press, July 2010. https://doi.org/10.1201/b10971-24 Google Scholar[28] Ku J. S. and Demaine E. D., “Folding Flat Crease Patterns with Thick Materials,” Journal of Mechanisms and Robotics, Vol. 8, No. 3, March 2016, Paper 031003. https://doi.org/10.1115/1.4031954 CrossrefGoogle Scholar[29] Arya M., Lee N. and Pellegrino S., “Crease-Free Biaxial Packaging of Thick Membranes with Slipping Folds,” International Journal of Solids and Structures, Vol. 108, March 2017, pp. 24–39. https://doi.org/10.1016/j.ijsolstr.2016.08.013 CrossrefGoogle Scholar[30] Hernandez H., Hartl D. J. and Lagoudas D. C., “Modeling and Design of Shape Memory Alloy-Based Origami Structures with Smooth Folds,” AIAA SciTech Conference, AIAA Paper  2017-1875, 2017. LinkGoogle Scholar[31] Seffen K. A. and Pellegrino S., “Deployment Dynamics of Tape Springs,” Proceedings of the Royal Society of London, Series A: Mathematical and Physical Sciences, Vol. 455, No. 1983, March 1999, pp. 1003–1048. Google Scholar[32] Soykasap O., “Analysis of Tape Spring Hinges,” International Journal of Mechanical Sciences, Vol. 49, 2007, pp. 853–860. CrossrefGoogle Scholar[33] Walker S. J. I. and Aglietti G., “Study of the Dynamics of Three-Dimensional Tape Spring Folds,” AIAA Journal, Vol. 42, No. 4, 2004, pp. 850–856. LinkGoogle Scholar[34] Jain A., Robot and Multibody Dynamics, Springer Science+Business Media, Berlin, 2011, pp. 35–40, 123–131. CrossrefGoogle Scholar"
    }
]